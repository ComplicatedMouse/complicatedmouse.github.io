<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ThreadLocalStorage Sample | NintendoSDK API Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<script type="text/javascript" src="searchapi.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   &#160;<span id="projectnumber">14.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="_page_sample.html">Sample Descriptions</a></li><li class="navelem"><a class="el" href="_page_sample_os.html">Operating System Library Samples</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ThreadLocalStorage Sample </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#PageSampleOsThreadLocalStorage_SectionBrief">Overview</a></li>
<li class="level1"><a href="#PageSampleOsThreadLocalStorage_SectionFileStructure">File Structure</a></li>
<li class="level1"><a href="#PageSampleOsThreadLocalStorage_SectionNecessaryEnvironment">Required Environment</a></li>
<li class="level1"><a href="#PageSampleOsThreadLocalStorage_SectionHowToOperate">How to Use</a></li>
<li class="level1"><a href="#PageSampleOsThreadLocalStorage_SectionPrecaution">Important Information</a></li>
<li class="level1"><a href="#PageSampleOsThreadLocalStorage_SectionHowToExecute">Execution Procedure</a></li>
<li class="level1"><a href="#PageSampleOsThreadLocalStorage_SectionDetail">Description</a><ul><li class="level2"><a href="#PageSampleOsThreadLocalStorage_SectionSampleProgram">Sample Program</a></li>
<li class="level2"><a href="#PageSampleOsThreadLocalStorage_SectionSampleDetail">Sample Program Description</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>A sample program for the thread local storage (TLS) feature</p>
<h1><a class="anchor" id="PageSampleOsThreadLocalStorage_SectionBrief"></a>
Overview</h1>
<p>This sample shows the thread local storage feature.</p>
<p>For more information about using the thread local storage feature, see the Thread Local Storage Feature Manual and the <code><a class="el" href="namespacenn_1_1os.html">OS API Reference</a></code>.</p>
<h1><a class="anchor" id="PageSampleOsThreadLocalStorage_SectionFileStructure"></a>
File Structure</h1>
<p>This sample program is located in <code><a class="el" href="dir_a3ef85e2740fe4435d445527619eafef.html">Samples/Sources/Applications/OsThreadLocalStorage/ </a> </code>.</p>
<h1><a class="anchor" id="PageSampleOsThreadLocalStorage_SectionNecessaryEnvironment"></a>
Required Environment</h1>
<p>Nothing specific.</p>
<h1><a class="anchor" id="PageSampleOsThreadLocalStorage_SectionHowToOperate"></a>
How to Use</h1>
<p>Nothing specific.</p>
<h1><a class="anchor" id="PageSampleOsThreadLocalStorage_SectionPrecaution"></a>
Important Information</h1>
<p>This sample program does not display anything on the screen. The execution results are output to a log.</p>
<h1><a class="anchor" id="PageSampleOsThreadLocalStorage_SectionHowToExecute"></a>
Execution Procedure</h1>
<p>Build the sample program and then run it.</p>
<h1><a class="anchor" id="PageSampleOsThreadLocalStorage_SectionDetail"></a>
Description</h1>
<h2><a class="anchor" id="PageSampleOsThreadLocalStorage_SectionSampleProgram"></a>
Sample Program</h2>
<p>This sample program uses the following source code.</p>
<p><a class="el" href="_os_thread_local_storage_8cpp.html" title="Sample program showing how to use the thread local storage (TLS) feature.">OsThreadLocalStorage.cpp</a> </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*--------------------------------------------------------------------------------*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">  Copyright Nintendo.  All rights reserved.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">  These coded instructions, statements, and computer programs contain proprietary</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">  information of Nintendo and/or its licensed developers and are protected by</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">  national and international copyright laws. They may not be disclosed to third</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">  parties or copied or duplicated in any form, in whole or in part, without the</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">  prior written consent of Nintendo.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">  The content herein is highly confidential and should be handled accordingly.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *--------------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="nn___macro_8h.html">nn/nn_Macro.h</a>&gt;</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="nn___log_8h.html">nn/nn_Log.h</a>&gt;</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="nn___abort_8h.html">nn/nn_Abort.h</a>&gt;</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#include &lt;nn/os.h&gt;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keyword">const</span> <span class="keywordtype">size_t</span>            ThreadStackSize = 8192;             <span class="comment">// Stack size of the thread operation thread.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<a class="code" href="os___thread_common_8h.html#a5ce0c3c0aaceb976178a60a18d90f470">NN_OS_ALIGNAS_THREAD_STACK</a> <span class="keywordtype">char</span>   g_ThreadStack1[ ThreadStackSize ];  <span class="comment">// The first thread stack.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<a class="code" href="os___thread_common_8h.html#a5ce0c3c0aaceb976178a60a18d90f470">NN_OS_ALIGNAS_THREAD_STACK</a> <span class="keywordtype">char</span>   g_ThreadStack2[ ThreadStackSize ];  <span class="comment">// The second thread stack.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<a class="code" href="os___thread_common_8h.html#a5ce0c3c0aaceb976178a60a18d90f470">NN_OS_ALIGNAS_THREAD_STACK</a> <span class="keywordtype">char</span>   g_ThreadStack3[ ThreadStackSize ];  <span class="comment">// The third thread stack.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<a class="code" href="structnn_1_1os_1_1_tls_slot.html">nn::os::TlsSlot</a>         g_tlsSlot;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}   <span class="comment">// Namespace.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">//  Access to thread local storage.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keywordtype">void</span>    CommonFunction()</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;{</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// Get the TLS parameters.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keyword">auto</span> name = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>( <a class="code" href="namespacenn_1_1os.html#a452445507fba4dc49cb9cfb77b4c88c1">nn::os::GetTlsValue</a>( g_tlsSlot ) );</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// The obtained TLS values are different for each thread.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;%s: Succeeded in getting a TLS value.\n&quot;</span>, name);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">//  Thread function (shared implementation).</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keywordtype">void</span> ThreadSample(<span class="keywordtype">void</span> *arg)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keyword">auto</span> name = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>( arg );</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// Set the arg parameter in TLS.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="namespacenn_1_1os.html#a8f54d6581f3380bc9b6b7d92c9855acd">nn::os::SetTlsValue</a>( g_tlsSlot, <span class="keyword">reinterpret_cast&lt;</span>uintptr_t<span class="keyword">&gt;</span>( arg ) );</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;%s: Succeeded in setting a TLS value.\n&quot;</span>, name );</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// Call the common function (all threads perform the same process).</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    CommonFunction();</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// Display the message before the thread ends.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;%s: End of thread.\n&quot;</span>, name );</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">//  TLS destructor function.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordtype">void</span>    TlsDestructFunction(uintptr_t value)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">char</span>* name = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>( value );</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;%s: TLS destructor function is called back.\n&quot;</span>, name);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;}</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">//  The main function.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> nnMain()</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;{</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="classnn_1_1_result.html">nn::Result</a>      result;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="structnn_1_1os_1_1_thread_type.html">nn::os::ThreadType</a>  thread1;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="structnn_1_1os_1_1_thread_type.html">nn::os::ThreadType</a>  thread2;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="structnn_1_1os_1_1_thread_type.html">nn::os::ThreadType</a>  thread3;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// Allocate one TLS slot.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>( <a class="code" href="namespacenn_1_1os.html#a2a67ebeb78e5d624b45ec27d66bdf0b2">nn::os::AllocateTlsSlot</a>( &amp;g_tlsSlot, TlsDestructFunction ) );</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// Generate threads.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>( <a class="code" href="namespacenn_1_1os.html#a75f43e1d3c194c0d2173ef5d95785933">nn::os::CreateThread</a>( &amp;thread1, ThreadSample, <span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(<span class="stringliteral">&quot;Thread1&quot;</span>), g_ThreadStack1, ThreadStackSize, <a class="code" href="namespacenn_1_1os.html#a5985811d04e64c0823ed758fd420591d">nn::os::DefaultThreadPriority</a> ) );</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>( <a class="code" href="namespacenn_1_1os.html#a75f43e1d3c194c0d2173ef5d95785933">nn::os::CreateThread</a>( &amp;thread2, ThreadSample, <span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(<span class="stringliteral">&quot;Thread2&quot;</span>), g_ThreadStack2, ThreadStackSize, <a class="code" href="namespacenn_1_1os.html#a5985811d04e64c0823ed758fd420591d">nn::os::DefaultThreadPriority</a> ) );</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>( <a class="code" href="namespacenn_1_1os.html#a75f43e1d3c194c0d2173ef5d95785933">nn::os::CreateThread</a>( &amp;thread3, ThreadSample, <span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(<span class="stringliteral">&quot;Thread3&quot;</span>), g_ThreadStack3, ThreadStackSize, <a class="code" href="namespacenn_1_1os.html#a5985811d04e64c0823ed758fd420591d">nn::os::DefaultThreadPriority</a> ) );</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// Start thread execution.</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="namespacenn_1_1os.html#a18eec7c4c4c298f7abaa9ef41d6de76b">nn::os::StartThread</a>( &amp;thread1 );</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="namespacenn_1_1os.html#a18eec7c4c4c298f7abaa9ef41d6de76b">nn::os::StartThread</a>( &amp;thread2 );</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="namespacenn_1_1os.html#a18eec7c4c4c298f7abaa9ef41d6de76b">nn::os::StartThread</a>( &amp;thread3 );</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// Wait for the thread to end.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="namespacenn_1_1os.html#a8070c91be85c5ccb36b56e9ff3a75b26">nn::os::WaitThread</a>( &amp;thread1 );</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="namespacenn_1_1os.html#a8070c91be85c5ccb36b56e9ff3a75b26">nn::os::WaitThread</a>( &amp;thread2 );</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="namespacenn_1_1os.html#a8070c91be85c5ccb36b56e9ff3a75b26">nn::os::WaitThread</a>( &amp;thread3 );</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// Free threads.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="namespacenn_1_1os.html#a9dbfcfb82583a9e34431e8c11d2411dd">nn::os::DestroyThread</a>( &amp;thread1 );</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="namespacenn_1_1os.html#a9dbfcfb82583a9e34431e8c11d2411dd">nn::os::DestroyThread</a>( &amp;thread2 );</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="namespacenn_1_1os.html#a9dbfcfb82583a9e34431e8c11d2411dd">nn::os::DestroyThread</a>( &amp;thread3 );</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// Release the TLS slot.</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="namespacenn_1_1os.html#afded66e76230ba96acc86ba3d48d76c4">nn::os::FreeTlsSlot</a>( g_tlsSlot );</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="ttc" id="aclassnn_1_1_result_html"><div class="ttname"><a href="classnn_1_1_result.html">nn::Result</a></div><div class="ttdoc">Represents the generic result of an operation.</div><div class="ttdef"><b>Definition:</b> nn_Result.h:32</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a18eec7c4c4c298f7abaa9ef41d6de76b"><div class="ttname"><a href="namespacenn_1_1os.html#a18eec7c4c4c298f7abaa9ef41d6de76b">nn::os::StartThread</a></div><div class="ttdeci">void StartThread(ThreadType *thread) NN_NOEXCEPT</div><div class="ttdoc">Starts execution on a thread.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a2a67ebeb78e5d624b45ec27d66bdf0b2"><div class="ttname"><a href="namespacenn_1_1os.html#a2a67ebeb78e5d624b45ec27d66bdf0b2">nn::os::AllocateTlsSlot</a></div><div class="ttdeci">nn::Result AllocateTlsSlot(TlsSlot *outTlsSlot, TlsDestructor function) NN_NOEXCEPT</div><div class="ttdoc">Allocates an empty TLS slot.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a452445507fba4dc49cb9cfb77b4c88c1"><div class="ttname"><a href="namespacenn_1_1os.html#a452445507fba4dc49cb9cfb77b4c88c1">nn::os::GetTlsValue</a></div><div class="ttdeci">uintptr_t GetTlsValue(TlsSlot tlsSlot) NN_NOEXCEPT</div><div class="ttdoc">Gets the value from the specified TLS slot.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a5985811d04e64c0823ed758fd420591d"><div class="ttname"><a href="namespacenn_1_1os.html#a5985811d04e64c0823ed758fd420591d">nn::os::DefaultThreadPriority</a></div><div class="ttdeci">const int DefaultThreadPriority</div><div class="ttdoc">Constant indicating the default value of thread priority.</div><div class="ttdef"><b>Definition:</b> os_ThreadCommon.h:47</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a75f43e1d3c194c0d2173ef5d95785933"><div class="ttname"><a href="namespacenn_1_1os.html#a75f43e1d3c194c0d2173ef5d95785933">nn::os::CreateThread</a></div><div class="ttdeci">nn::Result CreateThread(ThreadType *thread, ThreadFunction function, void *argument, void *stack, size_t stackSize, int priority, int idealCoreNumber) NN_NOEXCEPT</div><div class="ttdoc">Generates a thread.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a8070c91be85c5ccb36b56e9ff3a75b26"><div class="ttname"><a href="namespacenn_1_1os.html#a8070c91be85c5ccb36b56e9ff3a75b26">nn::os::WaitThread</a></div><div class="ttdeci">void WaitThread(ThreadType *thread) NN_NOEXCEPT</div><div class="ttdoc">Waits for the specified thread to stop.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a8f54d6581f3380bc9b6b7d92c9855acd"><div class="ttname"><a href="namespacenn_1_1os.html#a8f54d6581f3380bc9b6b7d92c9855acd">nn::os::SetTlsValue</a></div><div class="ttdeci">void SetTlsValue(TlsSlot tlsSlot, uintptr_t value) NN_NOEXCEPT</div><div class="ttdoc">Sets a value in the specified TLS slot.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a9dbfcfb82583a9e34431e8c11d2411dd"><div class="ttname"><a href="namespacenn_1_1os.html#a9dbfcfb82583a9e34431e8c11d2411dd">nn::os::DestroyThread</a></div><div class="ttdeci">void DestroyThread(ThreadType *thread) NN_NOEXCEPT</div><div class="ttdoc">Deletes a thread.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_afded66e76230ba96acc86ba3d48d76c4"><div class="ttname"><a href="namespacenn_1_1os.html#afded66e76230ba96acc86ba3d48d76c4">nn::os::FreeTlsSlot</a></div><div class="ttdeci">void FreeTlsSlot(TlsSlot tlsSlot) NN_NOEXCEPT</div><div class="ttdoc">Frees a TLS slot.</div></div>
<div class="ttc" id="ann___abort_8h_html"><div class="ttname"><a href="nn___abort_8h.html">nn_Abort.h</a></div><div class="ttdoc">Declarations for API resources to abort execution when conditions are not satisfied.</div></div>
<div class="ttc" id="ann___abort_8h_html_a1e657a678a588533a020c2e947df7772"><div class="ttname"><a href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a></div><div class="ttdeci">#define NN_ABORT_UNLESS_RESULT_SUCCESS(result)</div><div class="ttdoc">Tests whether the specified nn::Result is successful or not, and stops if it is not.</div><div class="ttdef"><b>Definition:</b> nn_Abort.h:188</div></div>
<div class="ttc" id="ann___log_8h_html"><div class="ttname"><a href="nn___log_8h.html">nn_Log.h</a></div><div class="ttdoc">Declarations for the logging API.</div></div>
<div class="ttc" id="ann___log_8h_html_a2d720c8bc6b733bce63879350d134a84"><div class="ttname"><a href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a></div><div class="ttdeci">#define NN_LOG(...)</div><div class="ttdoc">Adds the string specified in the parameter as a log entry.</div><div class="ttdef"><b>Definition:</b> nn_Log.h:33</div></div>
<div class="ttc" id="ann___macro_8h_html"><div class="ttname"><a href="nn___macro_8h.html">nn_Macro.h</a></div><div class="ttdoc">Defines the macros used throughout all libraries.</div></div>
<div class="ttc" id="aos___thread_common_8h_html_a5ce0c3c0aaceb976178a60a18d90f470"><div class="ttname"><a href="os___thread_common_8h.html#a5ce0c3c0aaceb976178a60a18d90f470">NN_OS_ALIGNAS_THREAD_STACK</a></div><div class="ttdeci">#define NN_OS_ALIGNAS_THREAD_STACK</div><div class="ttdoc">Macro to specify the stack space alignment.</div><div class="ttdef"><b>Definition:</b> os_ThreadCommon.h:108</div></div>
<div class="ttc" id="astructnn_1_1os_1_1_thread_type_html"><div class="ttname"><a href="structnn_1_1os_1_1_thread_type.html">nn::os::ThreadType</a></div><div class="ttdoc">This structure defines a thread object.</div><div class="ttdef"><b>Definition:</b> os_ThreadTypes.h:92</div></div>
<div class="ttc" id="astructnn_1_1os_1_1_tls_slot_html"><div class="ttname"><a href="structnn_1_1os_1_1_tls_slot.html">nn::os::TlsSlot</a></div><div class="ttdoc">This type represents a TLS slot number.</div><div class="ttdef"><b>Definition:</b> os_ThreadLocalStorageCommon.h:43</div></div>
</div><!-- fragment --><h2><a class="anchor" id="PageSampleOsThreadLocalStorage_SectionSampleDetail"></a>
Sample Program Description</h2>
<p>This sample program has the following flow.</p>
<ul>
<li>Three threads are created and one TLS is allocated with <code>nnMain()</code>.</li>
<li>All three threads share <code>ThreadSample()</code>.</li>
<li><code>ThreadSample()</code> receives a string such as "Thread1" as a parameter. (The thread number differs for each thread.)</li>
<li>The parameter received with <code>ThreadSample()</code> is stored in TLS and <code>CommonFunction</code> is called.</li>
<li><code>CommonFunction()</code> gets a value from TLS and displays a message.</li>
<li>Returns to <code>ThreadSample()</code>, and displays the message until immediately before the thread terminates.</li>
<li>When the thread terminates, the TLS destructor function, <code>TlsDestructFunction()</code>, is called.</li>
<li>The <code>TlsDestructFunction()</code> displays the TLS value, which was received as a parameter, as a message.</li>
<li>Each of the three threads runs the preceding process in parallel.</li>
<li><code>nnMain()</code> waits until the three threads complete.</li>
<li>The three threads are freed and TLS is released by <code>nnMain()</code>.</li>
</ul>
<p>This sample program shows the basic usage of TLS. It shows how, although the common function, <code>CommonFunction()</code>, is issued from the three threads, a different parameter is handled by accessing TLS.</p>
<p>This sample program sets the parameters from each thread function in TLS without modification. However, in actual use, the address of the memory dynamically allocated with each thread is stored, and the destructor function can receive that address as a parameter. This means that returning the memory with that value is expected.</p>
<p>The following file shows the execution results of this sample program.</p>
<pre class="fragment">Thread2: Succeeded in setting a TLS value
Thread1: Succeeded in setting a TLS value
Thread3: Succeeded in setting a TLS value
Thread2: Succeeded in getting a TLS value
Thread1: Succeeded in getting a TLS value
Thread3: Succeeded in getting a TLS value
Thread2: End of thread
Thread1: End of thread
Thread3: End of thread
Thread2: TLS destructor function is called back.
Thread1: TLS destructor function is called back.
Thread3: TLS destructor function is called back.
</pre><p>Because the three threads operate independently, the output messages of these three threads are not limited to this order. This depends on the actual execution environment, and the message output may be before or after. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
</body>
</html>

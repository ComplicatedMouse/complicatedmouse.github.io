<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Streaming Decompression Sample | NintendoSDK API Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<script type="text/javascript" src="searchapi.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   &#160;<span id="projectnumber">14.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="_page_sample.html">Sample Descriptions</a></li><li class="navelem"><a class="el" href="_page_sample_util.html">Utility Library Samples</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Streaming Decompression Sample </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#PageSampleUtilStreamingDecompression_SectionBrief">Overview</a></li>
<li class="level1"><a href="#PageSampleUtilStreamingDecompression_SectionFileStructure">File Structure</a></li>
<li class="level1"><a href="#PageSampleUtilStreamingDecompression_SectionNecessaryEnvironment">Required Environment</a></li>
<li class="level1"><a href="#PageSampleUtilStreamingDecompression_SectionHowToOperate">How to Use</a></li>
<li class="level1"><a href="#PageSampleUtilStreamingDecompression_SectionPrecaution">Important Information</a></li>
<li class="level1"><a href="#PageSampleUtilStreamingDecompression_SectionHowToExecute">Execution Procedure</a></li>
<li class="level1"><a href="#PageSampleUtilStreamingDecompression_SectionDetail">Description</a><ul><li class="level2"><a href="#PageSampleUtilStreamingDecompression_SectionSampleProgram">Sample Program</a></li>
<li class="level2"><a href="#PageSampleUtilStreamingDecompression_SectionSampleDetail">Sample Program Description</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>A sample program that uses the streaming decompression library.</p>
<h1><a class="anchor" id="PageSampleUtilStreamingDecompression_SectionBrief"></a>
Overview</h1>
<p>This sample streaming decompresses compressed data using the streaming decompression library.</p>
<p>Sample program for the streaming decompression library. For more information about using the decompression library, see the <a class="el" href="namespacenn_1_1util.html">Utility Library API Reference</a>.</p>
<h1><a class="anchor" id="PageSampleUtilStreamingDecompression_SectionFileStructure"></a>
File Structure</h1>
<p>This sample program is located in <code><a class="el" href="dir_b5316e63f05af3c35782ef340a77fcae.html">Samples/Sources/Applications/UtilStreamingDecompression/ </a> </code>.</p>
<h1><a class="anchor" id="PageSampleUtilStreamingDecompression_SectionNecessaryEnvironment"></a>
Required Environment</h1>
<p>Nothing specific.</p>
<h1><a class="anchor" id="PageSampleUtilStreamingDecompression_SectionHowToOperate"></a>
How to Use</h1>
<p>Nothing specific.</p>
<h1><a class="anchor" id="PageSampleUtilStreamingDecompression_SectionPrecaution"></a>
Important Information</h1>
<p>This sample program does not display anything on the screen. The execution results are output to a log.</p>
<h1><a class="anchor" id="PageSampleUtilStreamingDecompression_SectionHowToExecute"></a>
Execution Procedure</h1>
<p>Build the sample program and then run it.</p>
<h1><a class="anchor" id="PageSampleUtilStreamingDecompression_SectionDetail"></a>
Description</h1>
<h2><a class="anchor" id="PageSampleUtilStreamingDecompression_SectionSampleProgram"></a>
Sample Program</h2>
<p>This sample program uses the following source code.</p>
<p>UtilStreamingDecompression.h </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*--------------------------------------------------------------------------------*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">  Copyright Nintendo.  All rights reserved.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">  These coded instructions, statements, and computer programs contain proprietary</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">  information of Nintendo and/or its licensed developers and are protected by</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">  national and international copyright laws. They may not be disclosed to third</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">  parties or copied or duplicated in any form, in whole or in part, without the</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">  prior written consent of Nintendo.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">  The content herein is highly confidential and should be handled accordingly.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *--------------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// Sample program showing how to use compressed data in ZLIB format with streaming decompression.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">const</span> uint8_t SampleData[] ={0x78, 0x9c, 0xd3, 0xd2, 0xa2, 0x1e, 0x50, 0x88, 0x0e, 0x2d, 0xc9,</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    0xcc, 0x71, 0xce, 0xcf, 0x2d, 0x28, 0x4a, 0x2d, 0x2e, 0xce, 0xcc, 0xcf, 0xd3, 0x07, 0xf1,</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    0x5d, 0x52, 0x93, 0xd1, 0x44, 0x82, 0x4b, 0x8a, 0x52, 0x13, 0x73, 0x33, 0xf3, 0xd2, 0x51,</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    0xa4, 0x62, 0x15, 0x82, 0x13, 0x73, 0x0b, 0x72, 0x52, 0x15, 0x5c, 0x12, 0x4b, 0x12, 0x15,</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    0xa8, 0xe8, 0x2c, 0x2d, 0x06, 0x00, 0x82, 0x67, 0x36, 0x2f,};</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// Size of SampleData.</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">const</span> <span class="keywordtype">size_t</span> SampleDataSize = <span class="keyword">sizeof</span>(SampleData) / <span class="keyword">sizeof</span>(SampleData[0]);</div>
</div><!-- fragment --><p><a class="el" href="_util_streaming_decompression_8cpp.html" title="Sample program showing how to use the streaming decompression library.">UtilStreamingDecompression.cpp</a> </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*--------------------------------------------------------------------------------*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">  Copyright Nintendo.  All rights reserved.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">  These coded instructions, statements, and computer programs contain proprietary</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">  information of Nintendo and/or its licensed developers and are protected by</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">  national and international copyright laws. They may not be disclosed to third</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">  parties or copied or duplicated in any form, in whole or in part, without the</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">  prior written consent of Nintendo.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">  The content herein is highly confidential and should be handled accordingly.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *--------------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#include &lt;cstring&gt;</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="nn___abort_8h.html">nn/nn_Abort.h</a>&gt;</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="nn___log_8h.html">nn/nn_Log.h</a>&gt;</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="util___streaming_decompression_8h.html">nn/util/util_StreamingDecompression.h</a>&gt;</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">#include &quot;UtilStreamingDecompression.h&quot;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">// ZLIB streaming decompression occurs with smaller input and output buffers, and</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">// the decompression results are written out to a log as a string in this sample function.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keywordtype">void</span> DisplayWithStreamingDecompressionZlib(<span class="keyword">const</span> uint8_t* pComressedData,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                           <span class="keywordtype">size_t</span> compressedDataSize)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;{</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// Pointer to the original compressed data.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keyword">const</span> uint8_t* pCompressedDataPtr       = pComressedData;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// Remaining size of the compressed data.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">size_t</span>         compressedDataRemainSize = compressedDataSize;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span>   SrcBufSize               = 32;      <span class="comment">// Size of the input buffer.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">char</span>           srcBuf[SrcBufSize];                 <span class="comment">// The input buffer that temporarily stores compressed data.</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">char</span>*          pSrcBufCurrent           = <span class="keyword">nullptr</span>; <span class="comment">// Pointer indicating the position within the input buffer.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">size_t</span>         remainSrcBufSize         = 0;       <span class="comment">// Remaining size in the input buffer.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span>   DstBufSize               = 64;  <span class="comment">// Size of the output buffer.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordtype">char</span>           dstBuf[DstBufSize];             <span class="comment">// The output buffer that temporarily stores decompressed data.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordtype">size_t</span>         dstConsumedSize; <span class="comment">// The amount of output data.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">size_t</span>         srcConsumedSize; <span class="comment">// The amount of data used for decompression.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// Get the context for streaming decompression from the heap.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    std::unique_ptr&lt;nn::util::StreamingDecompressZlibContext&gt;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        pContext(<span class="keyword">new</span> <a class="code" href="structnn_1_1util_1_1_streaming_decompress_zlib_context.html">nn::util::StreamingDecompressZlibContext</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a>(pContext);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// Initialize the context for streaming decompression.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="namespacenn_1_1util.html#a95a0c92775590454820ac267996f2461">nn::util::InitializeStreamingDecompressZlibContext</a>(pContext.get());</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// Streaming decompression loop.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">for</span>(;;)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">// After the input buffer is empty, continue loading the compressed data.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">if</span>(remainSrcBufSize == 0)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="comment">// Load either just the size of the input buffer or the size of the remaining compressed data.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keywordtype">size_t</span> inputSize = std::min(compressedDataRemainSize, SrcBufSize);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="comment">// Because this sample is simple, load the compressed data placed in memory from the beginning.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            std::memcpy(srcBuf, pCompressedDataPtr, inputSize);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            pCompressedDataPtr       += inputSize;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            compressedDataRemainSize -= inputSize;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            pSrcBufCurrent            = srcBuf;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            remainSrcBufSize          = inputSize;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">// After either the input buffer is empty or the output buffer is full, pass the content of the output buffer</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="comment">// minus the terminating character as a streaming decompression string to be written to the log.</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordtype">bool</span> isSuccess = <a class="code" href="namespacenn_1_1util.html#a7545b1458e6ce1847a83d1a04d21cb7a">nn::util::StreamingDecompressZlib</a>(&amp;dstConsumedSize, &amp;srcConsumedSize,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            dstBuf, (DstBufSize - <span class="keyword">sizeof</span>(dstBuf[0])),</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            pSrcBufCurrent, remainSrcBufSize, pContext.get());</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">// Check the return value from the library.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">if</span>(!isSuccess)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="comment">// When the library returns false, either the input data is corrupted or the compression format is not GZIP.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Streaming Decompression (ZLIB): NG.\n&quot;</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; (The input data is corrupted or in an unsupported format.)\n&quot;</span>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            return ;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="comment">// Processing ends if neither input nor output is being used for decompression.</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">if</span>(dstConsumedSize == 0 &amp;&amp; srcConsumedSize == 0)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            return ;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="comment">// If there is decompression data in the output buffer, write it to the log.</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">if</span>(dstConsumedSize &gt; 0)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="comment">// Insert a terminating character to the end of the derived decompression results because the string will be written to the log.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <a class="code" href="nn___abort_8h.html#a5c1a90d3a6474658ae0ac5dc5bcb14e4">NN_ABORT_UNLESS</a>(dstConsumedSize &lt; DstBufSize);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            dstBuf[dstConsumedSize] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="comment">// Write the string derived from this episode of streaming decompression to the log.</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;&lt; Streaming decompressed data &gt;: %s\n&quot;</span>, dstBuf);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="comment">// Update the pointer to the input buffer and the size, because there will continue to be input.</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        pSrcBufCurrent   += srcConsumedSize;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        remainSrcBufSize -= srcConsumedSize;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;} <span class="comment">// Namespace.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">//  Main function.</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> nnMain()</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;{</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// Write the size of the compressed data to the log.</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;\nCompressed data size ( %d Bytes )\n\n&quot;</span>, SampleDataSize);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// Log output of the results of the ZLIB streaming decompression.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    DisplayWithStreamingDecompressionZlib(SampleData, SampleDataSize);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;}</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="ttc" id="anamespacenn_1_1util_html_a7545b1458e6ce1847a83d1a04d21cb7a"><div class="ttname"><a href="namespacenn_1_1util.html#a7545b1458e6ce1847a83d1a04d21cb7a">nn::util::StreamingDecompressZlib</a></div><div class="ttdeci">bool StreamingDecompressZlib(size_t *pOutDstSize, size_t *pOutConsumedSrcSize, void *pDst, size_t dstSize, const void *pSrc, size_t srcSize, StreamingDecompressZlibContext *pContext) NN_NOEXCEPT</div><div class="ttdoc">Performs streaming deflate decompression in zlib format.</div></div>
<div class="ttc" id="anamespacenn_1_1util_html_a95a0c92775590454820ac267996f2461"><div class="ttname"><a href="namespacenn_1_1util.html#a95a0c92775590454820ac267996f2461">nn::util::InitializeStreamingDecompressZlibContext</a></div><div class="ttdeci">void InitializeStreamingDecompressZlibContext(StreamingDecompressZlibContext *pContext) NN_NOEXCEPT</div><div class="ttdoc">Initializes the context for streaming decompression in zlib format.</div></div>
<div class="ttc" id="ann___abort_8h_html"><div class="ttname"><a href="nn___abort_8h.html">nn_Abort.h</a></div><div class="ttdoc">Declarations for API resources to abort execution when conditions are not satisfied.</div></div>
<div class="ttc" id="ann___abort_8h_html_a5c1a90d3a6474658ae0ac5dc5bcb14e4"><div class="ttname"><a href="nn___abort_8h.html#a5c1a90d3a6474658ae0ac5dc5bcb14e4">NN_ABORT_UNLESS</a></div><div class="ttdeci">#define NN_ABORT_UNLESS(condition,...)</div><div class="ttdoc">Tests whether a condition has been satisfied and stops execution if it has not.</div><div class="ttdef"><b>Definition:</b> nn_Abort.h:38</div></div>
<div class="ttc" id="ann___abort_8h_html_ae872300a22548da2b586ef68d2c048a3"><div class="ttname"><a href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a></div><div class="ttdeci">#define NN_ABORT_UNLESS_NOT_NULL(pointer)</div><div class="ttdoc">Tests whether the pointer is a null pointer and stops execution if it is.</div><div class="ttdef"><b>Definition:</b> nn_Abort.h:56</div></div>
<div class="ttc" id="ann___log_8h_html"><div class="ttname"><a href="nn___log_8h.html">nn_Log.h</a></div><div class="ttdoc">Declarations for the logging API.</div></div>
<div class="ttc" id="ann___log_8h_html_a2d720c8bc6b733bce63879350d134a84"><div class="ttname"><a href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a></div><div class="ttdeci">#define NN_LOG(...)</div><div class="ttdoc">Adds the string specified in the parameter as a log entry.</div><div class="ttdef"><b>Definition:</b> nn_Log.h:33</div></div>
<div class="ttc" id="astructnn_1_1util_1_1_streaming_decompress_zlib_context_html"><div class="ttname"><a href="structnn_1_1util_1_1_streaming_decompress_zlib_context.html">nn::util::StreamingDecompressZlibContext</a></div><div class="ttdoc">Context for streaming decompression of data compressed in zlib format.</div><div class="ttdef"><b>Definition:</b> util_StreamingDecompression.h:32</div></div>
<div class="ttc" id="autil___streaming_decompression_8h_html"><div class="ttname"><a href="util___streaming_decompression_8h.html">util_StreamingDecompression.h</a></div><div class="ttdoc">Declarations for API resources related to streaming deflate decompression using zlib.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="PageSampleUtilStreamingDecompression_SectionSampleDetail"></a>
Sample Program Description</h2>
<p>In the sample program, streaming decompression occurs for <code><em>SampleData</em></code>, which was originally a string and is now compressed data in ZLIB format. With streaming decompression, you can use decompression sequentially to store smaller input from compression data into output buffers as decompression results, dividing as you go. The streaming decompression library supports two other formats: GZIP and RAW DEFLATE.</p>
<p>This sample program has the following flow.</p>
<ul>
<li>Write the size of <code><em>SampleData</em></code>, which serves as the source for the decompression data, to the log.<ul>
<li>The compression source data for <code><em>SampleData</em></code> is a string that was compressed using <code><a class="el" href="_page_sample_util_compression.html">Compression Sample</a></code>.</li>
<li>The size of the compressed data is different because <code><a class="el" href="_page_sample_util_compression.html">Compression Sample</a></code> compressed into the GZIP format.</li>
</ul>
</li>
<li>Allocate a memory region for the context, <code><em>pContext</em></code>, for streaming decompression.<ul>
<li>The context's type is <code><a class="el" href="structnn_1_1util_1_1_streaming_decompress_zlib_context.html" title="Context for streaming decompression of data compressed in zlib format.">nn::util::StreamingDecompressZlibContext</a></code>.</li>
</ul>
</li>
<li>Call the streaming decompression library's <code><a class="el" href="namespacenn_1_1util.html#a95a0c92775590454820ac267996f2461" title="Initializes the context for streaming decompression in zlib format.">nn::util::InitializeStreamingDecompressZlibContext()</a></code> function and initialize <code><em>pContext</em></code>.</li>
<li>Execute streaming decompression's loop process.<ul>
<li>Have 32 bytes ready for the input buffer, <code><em>srcBuf</em></code>.</li>
<li>Have 64 bytes ready for the output buffer, <code><em>dstBuf</em></code>.</li>
</ul>
</li>
</ul>
<p>The streaming decompression loop process uses the following flow.</p>
<ul>
<li>Determine whether <code><em>srcBuf</em></code> is empty.<ul>
<li>When empty, continue to load compressed data, <code><em>pCompressedData</em></code>, to <code><em>srcBuf</em></code>.</li>
</ul>
</li>
<li>Call the streaming decompression library's <code>nn::util::InitializeStreamingDecompressZlib()</code> function and streaming decompress.<ul>
<li>Continue decompression until either the passed input buffer becomes empty or the output buffer becomes full.</li>
<li>Write the input data size (<code><em>srcConsumedSize</em></code>) and the output data size (<code><em>dstConsumedSize</em></code>) used for decompression to the log.</li>
</ul>
</li>
<li>Determine whether <code><em>srcConsumedSize</em></code> and <code><em>dstConsumedSize</em></code> are both zero (0).<ul>
<li>When both are zero (0), end the loop, because streaming decompression is complete.</li>
</ul>
</li>
<li>Write the decompression data stored in <code><em>dstBuf</em></code> as a string to the log.</li>
<li>Update <code><em>pSrcBufCurrent</em></code> and <code><em>remainSrcBufSize</em></code>.<ul>
<li><code><em>pSrcBufCurrent</em></code> is a pointer indicating the position where the next decompression is to start in <code><em>srcBuf</em></code>.</li>
<li><code><em>remainSrcBufSize</em></code> is the size of the data within <code><em>srcBuf</em></code> that has yet to be decompressed.</li>
</ul>
</li>
</ul>
<p>Because of the simplicity of this sample program, <code><em>SampleData</em></code> is in memory to begin with and is loaded into <code><em>srcBuf</em></code> using <code>std::memcpy()</code>, and not a stream, while splitting it. When loading a file of compressed data into the input buffer, change the relevant code.</p>
<p>The following file shows the execution results of this sample program. The string that is written to the log matches the <code><em>SampleData</em></code> string from <code><a class="el" href="_page_sample_util_compression.html">Compression Sample</a></code>.</p>
<pre class="fragment">
Compressed data size ( 66 Bytes )

&lt; Streaming decompressed data &gt;: ***************************************************************
&lt; Streaming decompressed data &gt;: ************* [UtilCompression/UtilDecompression/Util
&lt; Streaming decompressed data &gt;: StreamingDecompression] Sample Data ***************************
&lt; Streaming decompressed data &gt;: *************************************************
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
</body>
</html>

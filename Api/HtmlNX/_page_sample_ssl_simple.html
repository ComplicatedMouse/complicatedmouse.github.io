<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Simple Https communication with SSL library | NintendoSDK API Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<script type="text/javascript" src="searchapi.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   &#160;<span id="projectnumber">14.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="_page_sample.html">Sample Descriptions</a></li><li class="navelem"><a class="el" href="_page_sample_ssl.html">SSL Library Samples</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Simple Https communication with SSL library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#PageSampleSslSimple_SectionBrief">Overview</a></li>
<li class="level1"><a href="#PageSampleSslSimple_SectionFileStructure">File Structure</a></li>
<li class="level1"><a href="#PageSampleSslSimple_SectionNecessaryEnvironment">System Requirements</a></li>
<li class="level1"><a href="#PageSampleSslSimple_SectionHowToOperate">Operation Procedure</a></li>
<li class="level1"><a href="#PageSampleSslSimple_SectionPrecaution">Precautions</a></li>
<li class="level1"><a href="#PageSampleSslSimple_SectionHowToExecute">Execution Procedure</a></li>
<li class="level1"><a href="#PageSampleSslSimple_SectionDetail">Detail</a></li>
</ul>
</div>
<div class="textblock"><p>Documentation about the sample program of SSL library</p>
<h1><a class="anchor" id="PageSampleSslSimple_SectionBrief"></a>
Overview</h1>
<p>First this sample prepares network connection by using the NIFM library. If network can be used, it establishes the TCP connection on port 443 with the specified server. Then it performs SSL handshake on the TCP connection and sends HTTP GET request. Finally it receives HTTP data which is sent by the server per HTTP GET request.</p>
<h1><a class="anchor" id="PageSampleSslSimple_SectionFileStructure"></a>
File Structure</h1>
<p>This sample program can be found at <a class="el" href="dir_259975678c48dfd907a38db8ec43eee2.html">Samples/Sources/Applications/SslSimple </a>.</p>
<h1><a class="anchor" id="PageSampleSslSimple_SectionNecessaryEnvironment"></a>
System Requirements</h1>
<p>It is required to import network setting by SettingsManager prior to running this sample. Please refer <a href="../../Package/contents/Pages/Page_104465190.html#Anchor_104465190_SettingsManager_network">ネットワーク接続設定の登録</a> for further information.</p>
<p>By default this sample sends HTTP GET request to example.com on port 443 thus Internet connection is required. Please pass desired host name in the command line argument to run it with other servers. Note that "https://" should not be included when passing the host name in the argument because this sample doesn't parse it.</p>
<h1><a class="anchor" id="PageSampleSslSimple_SectionHowToOperate"></a>
Operation Procedure</h1>
<p>None.</p>
<h1><a class="anchor" id="PageSampleSslSimple_SectionPrecaution"></a>
Precautions</h1>
<p>None.</p>
<h1><a class="anchor" id="PageSampleSslSimple_SectionHowToExecute"></a>
Execution Procedure</h1>
<p>Build the Visual Studio Solution in the desired configuration and run it.</p>
<h1><a class="anchor" id="PageSampleSslSimple_SectionDetail"></a>
Detail</h1>
<p>Here is the sequence of this sample program.</p>
<ul>
<li>Sends request to use network connection by the NIFM library</li>
<li>Initializes the socket library and the SSL library</li>
<li>Resolves host name and establishes TCP connection on port 443 in SimpleHttpsClient::SetupTcpSocket()</li>
<li>Prepares the SSL context in SimpleHttpsClient::SetupSslContext()</li>
<li>Prepares the SSL connection context in SimpleHttpsClient::SetupSslConnection()</li>
<li>Performs SSL handshake with the server on the TCP connection in SimpleHttpsClient::PerformSslHandshake(), by default this sample verifies server certificate and its host name</li>
<li>Sends HTTP GET request to the server over the SSL connection in SimpleHttpsClient::SendHttpGetOverSsl()</li>
<li>Receives HTTP data sent from the server per HTTP GET request in SimpleHttpsClient::ReceiveAllHttpData() until the connection is disconnected by the server or timeout occurs</li>
<li>Print received content in SimpleHttpsClient::PrintReceivedData()</li>
<li>Destroys the SSL connection context and the SSL context in SimpleHttpsClient::Finalize()</li>
<li>Finalizes the socket library and the SSL library</li>
</ul>
<p>Please enable "#define PRINT_ALL_VERIFY_ERRORS" to demonstrate how get all of the verify certificate errors.</p>
<p>Please enable "#define PRINT_SERVER_CERT" to demonstrate how to get the server certificate which is obtained during SSL handshake.</p>
<p>Please enable "#define PERFORM_NON_BLOCKING" to demonstrate how to use I/O APIs in non-blocking mode.</p>
<p>Please enable "#define IMPORT_SERVER_PKI" to import CA certificate. Please don't forget to supply appropriate CA certificate when enabling the flag otherwise <a class="el" href="classnn_1_1ssl_1_1_context.html#a43b4cf238b81ba8d166c65b92b2e4ef2" title="Import a trusted CA certificate to be used to verify the peer certificate.">nn::ssl::Context::ImportServerPki</a> will assert since nullptr will be passed. It is imported in SimpleHttpsClient::SetupSslContext().</p>
<p>Please enable "#define IMPORT_CLIENT_PKI" to import client PKI information. Please don't forget to supply appropriate pkcs12 data when enabling the flag otherwise <a class="el" href="classnn_1_1ssl_1_1_context.html#a2a7677e363b3bad66086670dc0ec73ec" title="Import a client certificate and a private key in PKCS12 format, and its password.">nn::ssl::Context::ImportClientPki</a> will assert since nullptr will be passed. It is imported in SimpleHttpsClient::SetupSslContext().</p>
<p>Please enable "#define DISABLE_RENEGOTIATION" to disable renegotiation for the ssl handshake.</p>
<p>Please enable "#define DISABLE_SESSION_CACHE" to disable ssl session cache. Note: This option is not compatible with SESSION_CACHE_TICKET.</p>
<p>Please enable "#define SESSION_CACHE_TICKET" to enable ssl session tickets. Note: This option is not compatible with DISABLE_SESSION_CACHE.</p>
<p>Please enable "#define FLUSH_SESSION_CACHE" to flush the ssl session cache before destroying the connection."</p>
<p>Please enable "#define SKIP_SERVER_CERT_VERIFY_PROD" to allow client application to skip verification of the server certificate and its host name for any build &ndash; Debug, Develop, or Release. Below please find how to implement it.</p>
<ul>
<li>Call <a class="el" href="classnn_1_1ssl_1_1_connection.html#a9b42b2718ff9476e87aaed6317a27269" title="Enable/Disable the option of this connection.">nn::ssl::Connection::SetOption()</a> to set <a class="el" href="classnn_1_1ssl_1_1_connection.html#a3d643dba979c0f51472467a7f7a30e23a28b6e3e4e3c1fe5fc89b72f369459c78" title="Allow the connection to skip default certificate validation (disabled by default).">nn::ssl::Connection::OptionType_SkipDefaultVerify</a> option to "true". This call enables skipping SSL certificate and/or host name verification.</li>
<li>Prepare verify option according to what verification is needed. It can be any combination of the options defined in <a class="el" href="classnn_1_1ssl_1_1_connection.html#af9b603bce2d533ca6fdd3f1d7f2f0b12" title="Option value to specify what is verified during SSL handshake.">nn::ssl::Connection::VerifyOption</a></li>
<li>Call <a class="el" href="classnn_1_1ssl_1_1_connection.html#a41e963b74c54952cc679812f0e8fa7b8" title="Set option value regarding server verification.">nn::ssl::Connection::SetVerifyOption()</a> with the desired verify options.</li>
</ul>
<p>Please enable "#define SKIP_SERVER_CERT_VERIFY" to allow client application to skip verification of the server certificate and its host name. Below please find how to implement it for non-Release builds. Don't forget to include <a class="el" href="ssl___debug_api_8h.html" title="Public header file for SSL library.">ssl_DebugApi.h</a> header file. Let's suppose that all initialization is completed at this moment.</p>
<ul>
<li>Call <a class="el" href="namespacenn_1_1ssl.html#a7a08119eb456ef497aa7db1e298ee130" title="Set the value for debug options.">nn::ssl::SetDebugOption()</a> and specify <a class="el" href="namespacenn_1_1ssl.html#a8a74feada7666cb984b42bef2bd61dfcadc43c0fc803a5fdcb45e428b17563a4c" title="Allows unsetting of Connection::VerifyOption::VerifyOption_Default options in a non-Release build.">nn::ssl::DebugOption_AllowDisableVerifyOption</a> as an option and "true" as an option value. Otherwise, the assertion will terminate application upon <a class="el" href="classnn_1_1ssl_1_1_connection.html#a41e963b74c54952cc679812f0e8fa7b8" title="Set option value regarding server verification.">nn::ssl::Connection::SetVerifyOption()</a> call.</li>
<li>Prepare verify option according to what verification needed. It can be any combination of the options defined in <a class="el" href="classnn_1_1ssl_1_1_connection.html#af9b603bce2d533ca6fdd3f1d7f2f0b12" title="Option value to specify what is verified during SSL handshake.">nn::ssl::Connection::VerifyOption</a></li>
<li>Call <a class="el" href="classnn_1_1ssl_1_1_connection.html#a41e963b74c54952cc679812f0e8fa7b8" title="Set option value regarding server verification.">nn::ssl::Connection::SetVerifyOption()</a> with the desired verify options.</li>
</ul>
<p>Methods <a class="el" href="namespacenn_1_1ssl.html#a7a08119eb456ef497aa7db1e298ee130" title="Set the value for debug options.">nn::ssl::SetDebugOption()</a> and <a class="el" href="namespacenn_1_1ssl.html#a9597cc065162f29a8c4b44dd3049e69c" title="Return option value for debug options.">nn::ssl::GetDebugOption()</a> are only introduced for debug purposes. IT IS PROHIBITED TO USE THESE METHODS IN A RELEASE BUILD.</p>
<p>Here is the expected output log of this sample program. Please note that it will not be printed in the Release build.</p>
<pre class="fragment">Waiting for network interface availability...
Allocated 524288 bytes for receive buffer.
Created TCP socket (sockfd: 0).
Resolving example.com
Established TCP connection (addr:0x22d8b85d on port :443).
Created SSL context (ID:0).
HostNameLen: 11, HostName: example.com
Verify option: 3
Session cache mode: 1
Renegotiation Mode: 1
Io mode: 1
Created SSL connection (ID:0).
Initialized SimpleHttpsClient.
SSL Handshake completed.
Sent HTTP request via SSL (37 bytes).
Received 352 bytes (total:352 bytes)
Received 1270 bytes (total:1622 bytes)
Connection closed by the server.

------------ Received body (total: 1622 bytes received)---------------
HTTP/1.0 200 OK
Cache-Control: max-age=604800
Content-Type: text/html
Date: Tue, 10 Jan 2017 18:55:34 GMT
Etag: "359670651+gzip+ident"
Expires: Tue, 17 Jan 2017 18:55:34 GMT
Last-Modified: Fri, 09 Aug 2013 23:54:35 GMT
Server: ECS (pae/37B9)
Vary: Accept-Encoding
X-Cache: HIT
x-ec-custom-error: 1
Content-Length: 1270
Connection: close

&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Example Domain&lt;/title&gt;

    &lt;meta charset="utf-8" /&gt;
    &lt;meta http-equiv="Content-type" content="text/html; charset=utf-8" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;
    &lt;style type="text/css"&gt;
    body {
        background-color: #f0f0f2;
        margin: 0;
        padding: 0;
        font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
        
    }
    div {
        width: 600px;
        margin: 5em auto;
        padding: 50px;
        background-color: #fff;
        border-radius: 1em;
    }
    a:link, a:visited {
        color: #38488f;
        text-decoration: none;
    }
    @media (max-width: 700px) {
        body {
            background-color: #fff;
        }
        div {
            width: auto;
            margin: 0 auto;
            border-radius: 0;
            padding: 1em;
        }
    }
    &lt;/style&gt;    
&lt;/head&gt;

&lt;body&gt;
&lt;div&gt;
    &lt;h1&gt;Example Domain&lt;/h1&gt;
    &lt;p&gt;This domain is established to be used for illustrative examples in documents. You may use this
    domain in examples without prior coordination or asking for permission.&lt;/p&gt;
    &lt;p&gt;&lt;a href="http://www.iana.org/domains/example"&gt;More information...&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;

--------------------------------------------------------------------
Finalized SimpleHttpsClient.
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
</body>
</html>

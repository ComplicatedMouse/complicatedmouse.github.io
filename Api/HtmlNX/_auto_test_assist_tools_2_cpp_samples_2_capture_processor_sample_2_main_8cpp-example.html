<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AutoTestAssistTools/CppSamples/CaptureProcessorSample/Main.cpp | NintendoSDK API Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<script type="text/javascript" src="searchapi.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   &#160;<span id="projectnumber">14.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AutoTestAssistTools/CppSamples/CaptureProcessorSample/Main.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>For an explanation of the source code, see <a class="el" href="_page_sample_capture_processor_cpp_sample.html">CaptureProcessorCppSample</a> and <tt>AutoTestAssistTools/CppSamples/CaptureProcessorSample/Main.cpp</tt>.</p>
<div class="fragment"><div class="line"><span class="comment">/*--------------------------------------------------------------------------------*</span></div>
<div class="line"><span class="comment">  Copyright Nintendo.  All rights reserved.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  These coded instructions, statements, and computer programs contain proprietary</span></div>
<div class="line"><span class="comment">  information of Nintendo and/or its licensed developers and are protected by</span></div>
<div class="line"><span class="comment">  national and international copyright laws. They may not be disclosed to third</span></div>
<div class="line"><span class="comment">  parties or copied or duplicated in any form, in whole or in part, without the</span></div>
<div class="line"><span class="comment">  prior written consent of Nintendo.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  The content herein is highly confidential and should be handled accordingly.</span></div>
<div class="line"><span class="comment"> *--------------------------------------------------------------------------------*/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Shlwapi.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;CaptureProcessorWrapper.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;TmUtilityWrapper.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceauto_test_assist_tool.html">autoTestAssistTool</a>;</div>
<div class="line"> </div>
<div class="line">std::string GetSdkRootPath()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> std::string pathResult = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pathResult.length() &gt; 0)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> pathResult;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> DWORD BufferLength = 2048;</div>
<div class="line"> </div>
<div class="line">    TCHAR pathBuffer[BufferLength];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (::GetCurrentDirectory(BufferLength, pathBuffer) == 0)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">throw</span> std::exception(<span class="stringliteral">&quot;GetCurrentDirectory failed&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    std::string currentDirectory = std::string(pathBuffer);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line">    {</div>
<div class="line">        std::string sdkRootMarkFilePath = std::string(currentDirectory + <span class="stringliteral">&quot;\\NintendoSdkRootMark&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (::PathFileExists(sdkRootMarkFilePath.c_str()))</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">return</span> currentDirectory;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">size_t</span> lastDelimiterPos = currentDirectory.find_last_of(<span class="stringliteral">&quot;\\&quot;</span>, currentDirectory.length());</div>
<div class="line">        <span class="keywordflow">if</span> (lastDelimiterPos == std::string::npos)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        currentDirectory = currentDirectory.substr(0, lastDelimiterPos);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    memset(pathBuffer, 0, <span class="keyword">sizeof</span>(TCHAR) * BufferLength);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (::<a class="code" href="namespacenn_1_1htc.html#a370e114a42a12b384ef2b2246618168e">GetEnvironmentVariable</a>(<span class="stringliteral">&quot;NINTENDO_SDK_ROOT&quot;</span>, pathBuffer, BufferLength) == 0)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">throw</span> std::exception(<span class="stringliteral">&quot;GetSdkRootPath failed&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pathResult = pathBuffer;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> pathResult;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> InitializeLibrary()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> captureDeviceCount = 0;</div>
<div class="line">    captureProcessor::GetCaptureDeviceCount(&amp;captureDeviceCount);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> targetCount = 0;</div>
<div class="line">    tmUtility::GetConnectedTargetCount(&amp;targetCount);</div>
<div class="line">    <span class="keywordflow">if</span> (captureDeviceCount &lt; 1 &amp;&amp; targetCount &lt; 1)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Capture device is not found\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get capture device list.</span></div>
<div class="line">    std::vector&lt;std::string&gt; captureDeviceList;</div>
<div class="line">    <span class="keywordflow">if</span> (captureDeviceCount &gt; 0)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">char</span> deviceName[256] = {};</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; captureDeviceCount; i++)</div>
<div class="line">        {</div>
<div class="line">            captureProcessor::GetCaptureDeviceName(deviceName, 256, i);</div>
<div class="line"> </div>
<div class="line">            captureDeviceList.push_back(deviceName);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get network capture target.</span></div>
<div class="line">    std::vector&lt;SerialNumberString&gt; serialList;</div>
<div class="line">    <span class="keywordflow">if</span> (targetCount &gt; 0)</div>
<div class="line">    {</div>
<div class="line">        <a name="_a0"></a><a class="code" href="struct_serial_number_string.html">SerialNumberString</a>* serialListBuffer = <span class="keyword">new</span> <a class="code" href="struct_serial_number_string.html">SerialNumberString</a>[targetCount];</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; targetCount; i++)</div>
<div class="line">        {</div>
<div class="line">            serialListBuffer[i].<a name="a1"></a><a class="code" href="struct_serial_number_string.html#a3975562a9db62a323dba889acc13165c">value</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        tmUtility::GetConnectedTargetSerialNumbers(serialListBuffer, targetCount);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; targetCount; i++)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (strlen(serialListBuffer[i].value) &gt; 0)</div>
<div class="line">            {</div>
<div class="line">                serialList.push_back(serialListBuffer[i]);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">delete</span>[] serialListBuffer;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Please select target\n&quot;</span>);</div>
<div class="line">    <span class="keywordtype">int</span> selectionCount = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; deviceName : captureDeviceList)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;[%d] : %s\n&quot;</span>, selectionCount++, deviceName.c_str());</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; targetSerial : serialList)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;[%d] : %s\n&quot;</span>, selectionCount++, targetSerial.value);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> selection = -1;</div>
<div class="line">    scanf_s(<span class="stringliteral">&quot;%d&quot;</span>, &amp;selection);</div>
<div class="line">    <span class="keywordflow">if</span> (selection &lt; 0 || selection &gt;= selectionCount)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Invalid input&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Initialize CaptureProcessor.</span></div>
<div class="line">    captureProcessor::CaptureResult result = captureProcessor::CaptureResult_Success;</div>
<div class="line">    <span class="keywordflow">if</span> (selection &lt; captureDeviceCount)</div>
<div class="line">    {</div>
<div class="line">        captureProcessor::InitializeForCaptureDevice(</div>
<div class="line">            selection, <span class="keyword">true</span>, captureProcessor::CaptureResolution_720p);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        selection = selection - captureDeviceCount;</div>
<div class="line">        <span class="keywordflow">if</span> (selection &lt; 0 || selection &gt;= serialList.size())</div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Invalid input&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="struct_serial_number_string.html">SerialNumberString</a> targetSerial = serialList.at(selection);</div>
<div class="line"> </div>
<div class="line">        printf(<span class="stringliteral">&quot;Please select capture type.\n&quot;</span>);</div>
<div class="line">        printf(<span class="stringliteral">&quot;0 : Use Devkit Capture (SDEV only)\n&quot;</span>);</div>
<div class="line">        printf(<span class="stringliteral">&quot;1 : Use Remote Video\n&quot;</span>);</div>
<div class="line">        printf(<span class="stringliteral">&quot;2 : Use Screenshot\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">int</span> captureFormat = 0;</div>
<div class="line">        scanf_s(<span class="stringliteral">&quot;%d&quot;</span>, &amp;captureFormat);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (captureFormat == 0)</div>
<div class="line">        {</div>
<div class="line">            result = captureProcessor::InitializeForDevkitCapture(</div>
<div class="line">                targetSerial, <span class="keyword">true</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (captureFormat == 1)</div>
<div class="line">        {</div>
<div class="line">            result = captureProcessor::InitializeForRemoteVideo(</div>
<div class="line">                targetSerial, <span class="keyword">true</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (captureFormat == 2)</div>
<div class="line">        {</div>
<div class="line">            result = captureProcessor::InitializeForScreenshot(</div>
<div class="line">                targetSerial, <span class="keyword">true</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Invalid input\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (result != captureProcessor::CaptureResult_Success)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Initialize CaptureProcessor is failed\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}<span class="comment">//NOLINT(impl/function_size)</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> DetectObjectImage()</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;&lt;DetectObjectImage&gt;\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    std::string templateImagePath = GetSdkRootPath();</div>
<div class="line">    templateImagePath.append(</div>
<div class="line">        <span class="stringliteral">&quot;/Samples/Sources/Tools/AutoTestAssistTools/ScriptSamples/TemplateImage/Home/Config_Icon.png&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    captureProcessor::ImageIdType imageId = {};</div>
<div class="line">    captureProcessor::CaptureResult result</div>
<div class="line">        = captureProcessor::LoadImageFile(&amp;imageId, templateImagePath.c_str());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (result != captureProcessor::CaptureResult_Success)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Load image failed(%s)\n&quot;</span>, templateImagePath.c_str());</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> durationTime = 0;</div>
<div class="line">    std::chrono::system_clock::time_point beginTime = std::chrono::system_clock::now();</div>
<div class="line">    <span class="keywordflow">do</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">int</span> x = 0;</div>
<div class="line">        <span class="keywordtype">int</span> y = 0;</div>
<div class="line">        captureProcessor::MatchingResult mathingResult</div>
<div class="line">            = captureProcessor::WaitDetectObject(&amp;x, &amp;y, imageId, 0.95, 1000);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (mathingResult == captureProcessor::MatchingResult_Success)</div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">&quot;%s found at (%d,%d)\n&quot;</span>, templateImagePath.c_str(), x, y);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">&quot;%s was not found\n&quot;</span>, templateImagePath.c_str());</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        Sleep(16);</div>
<div class="line"> </div>
<div class="line">        durationTime</div>
<div class="line">            = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(</div>
<div class="line">                std::chrono::system_clock::now() - beginTime).count());</div>
<div class="line">    } <span class="keywordflow">while</span> (durationTime &lt; (10 * 1000));</div>
<div class="line"> </div>
<div class="line">    captureProcessor::ReleaseImage(imageId);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> DotColor()</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;&lt;DotColor&gt;\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    constexpr <span class="keywordtype">int</span> targetPositionX = 855;</div>
<div class="line">    constexpr <span class="keywordtype">int</span> targetPositionY = 495;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> durationTime = 0;</div>
<div class="line">    std::chrono::system_clock::time_point beginTime = std::chrono::system_clock::now();</div>
<div class="line">    <span class="keywordflow">do</span></div>
<div class="line">    {</div>
<div class="line">        captureProcessor::ImageIdType imageId = {};</div>
<div class="line">        captureProcessor::Rgb24Color color = {};</div>
<div class="line"> </div>
<div class="line">        captureProcessor::CaptureResult result;</div>
<div class="line">        result = captureProcessor::GetImageFromCaptureDevice(&amp;imageId);</div>
<div class="line">        <span class="keywordflow">if</span> (result == captureProcessor::CaptureResult_Success)</div>
<div class="line">        {</div>
<div class="line">            result = captureProcessor::GetDotColor(&amp;color, imageId, targetPositionX, targetPositionY);</div>
<div class="line">            <span class="keywordflow">if</span> (result == captureProcessor::CaptureResult_Success)</div>
<div class="line">            {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Color of Position (%d, %d) is (%d, %d, %d)\n&quot;</span>,</div>
<div class="line">                    targetPositionX, targetPositionY, color.red, color.green, color.blue);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            captureProcessor::ReleaseImage(imageId);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        Sleep(100);</div>
<div class="line"> </div>
<div class="line">        durationTime</div>
<div class="line">            = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(</div>
<div class="line">                std::chrono::system_clock::now() - beginTime).count());</div>
<div class="line">    } <span class="keywordflow">while</span> (durationTime &lt; (10 * 1000));</div>
<div class="line"> </div>
<div class="line">    captureProcessor::Rgb24Color lowerColor = { 0, 180, 180 };</div>
<div class="line">    captureProcessor::Rgb24Color upperColor = { 128, 255, 255 };</div>
<div class="line"> </div>
<div class="line">    captureProcessor::MatchingResult matchingResult = captureProcessor::WaitDetectDotColor(</div>
<div class="line">        targetPositionX, targetPositionY, lowerColor, upperColor, 1000);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (matchingResult == captureProcessor::MatchingResult_Success)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Setting was selected\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Setting was not selected\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="_capture_processor_library_8h.html#a888c76c42c104f7df4aa719879d1e0f9">ApplyFilter</a>()</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;&lt;ApplyFilter&gt;\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* nameForBinarization = <span class="stringliteral">&quot;Binarization&quot;</span>;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* nameForColorRange = <span class="stringliteral">&quot;ColorRange&quot;</span>;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* nameForMorphology = <span class="stringliteral">&quot;Morphology&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    captureProcessor::FilterIdType binarizationFilter = {};</div>
<div class="line">    captureProcessor::CreateFilter(&amp;binarizationFilter);</div>
<div class="line">    captureProcessor::SetBinarizationFilter(binarizationFilter, 128);</div>
<div class="line"> </div>
<div class="line">    captureProcessor::FilterIdType colorRangeFilter = {};</div>
<div class="line">    captureProcessor::CreateFilter(&amp;colorRangeFilter);</div>
<div class="line">    captureProcessor::Rgb24Color lowerColor = { 254, 254, 254 };</div>
<div class="line">    captureProcessor::Rgb24Color upperColor = { 255, 255, 255 };</div>
<div class="line">    captureProcessor::SetColorRangeFilter(colorRangeFilter, lowerColor, upperColor);</div>
<div class="line"> </div>
<div class="line">    captureProcessor::FilterIdType morphologyFilter = {};</div>
<div class="line">    captureProcessor::CreateFilter(&amp;morphologyFilter);</div>
<div class="line">    captureProcessor::SetMorphologyFilter(</div>
<div class="line">        morphologyFilter, captureProcessor::MorphologyConversionType_Erosion, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> durationTime = 0;</div>
<div class="line">    std::chrono::system_clock::time_point beginTime = std::chrono::system_clock::now();</div>
<div class="line">    <span class="keywordflow">do</span></div>
<div class="line">    {</div>
<div class="line">        captureProcessor::ImageIdType imageId = {};</div>
<div class="line">        captureProcessor::CaptureResult result;</div>
<div class="line">        result = captureProcessor::GetImageFromCaptureDevice(</div>
<div class="line">            &amp;imageId);</div>
<div class="line">        <span class="keywordflow">if</span> (result == captureProcessor::CaptureResult_Success)</div>
<div class="line">        {</div>
<div class="line">            captureProcessor::ImageIdType filteredImageId = {};</div>
<div class="line"> </div>
<div class="line">            result = captureProcessor::ApplyFilter(&amp;filteredImageId, imageId, binarizationFilter);</div>
<div class="line">            <span class="keywordflow">if</span> (result == captureProcessor::CaptureResult_Success)</div>
<div class="line">            {</div>
<div class="line">                captureProcessor::OpenImageWindow(nameForBinarization, filteredImageId);</div>
<div class="line">                captureProcessor::ReleaseImage(filteredImageId);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            result = captureProcessor::ApplyFilter(&amp;filteredImageId, imageId, colorRangeFilter);</div>
<div class="line">            <span class="keywordflow">if</span> (result == captureProcessor::CaptureResult_Success)</div>
<div class="line">            {</div>
<div class="line">                captureProcessor::OpenImageWindow(nameForColorRange, filteredImageId);</div>
<div class="line">                captureProcessor::ReleaseImage(filteredImageId);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            result = captureProcessor::ApplyFilter(&amp;filteredImageId, imageId, morphologyFilter);</div>
<div class="line">            <span class="keywordflow">if</span> (result == captureProcessor::CaptureResult_Success)</div>
<div class="line">            {</div>
<div class="line">                captureProcessor::OpenImageWindow(nameForMorphology, filteredImageId);</div>
<div class="line">                captureProcessor::ReleaseImage(filteredImageId);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            captureProcessor::ReleaseImage(imageId);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        Sleep(100);</div>
<div class="line"> </div>
<div class="line">        durationTime</div>
<div class="line">            = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(</div>
<div class="line">                std::chrono::system_clock::now() - beginTime).count());</div>
<div class="line">    } <span class="keywordflow">while</span> (durationTime &lt; (10 * 1000));</div>
<div class="line"> </div>
<div class="line">    captureProcessor::CloseImageWindow(nameForBinarization);</div>
<div class="line">    captureProcessor::CloseImageWindow(nameForColorRange);</div>
<div class="line">    captureProcessor::CloseImageWindow(nameForMorphology);</div>
<div class="line"> </div>
<div class="line">    captureProcessor::DeleteFilter(binarizationFilter);</div>
<div class="line">    captureProcessor::DeleteFilter(colorRangeFilter);</div>
<div class="line">    captureProcessor::DeleteFilter(morphologyFilter);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="_capture_processor_library_8h.html#ada70672647d8dc5b65440c37c9fa7cfd">DetectObjectWithFilter</a>()</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;&lt;DetectObjectWithFilter&gt;\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* windowName = <span class="stringliteral">&quot;Template&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    captureProcessor::FilterIdType filter = {};</div>
<div class="line">    captureProcessor::CreateFilter(&amp;filter);</div>
<div class="line"> </div>
<div class="line">    captureProcessor::Rgb24Color lowerColor = {254, 254, 254};</div>
<div class="line">    captureProcessor::Rgb24Color upperColor = {255, 255, 255};</div>
<div class="line">    captureProcessor::SetColorRangeFilter(filter, lowerColor, upperColor);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> durationTime = 0;</div>
<div class="line">    std::chrono::system_clock::time_point beginTime = std::chrono::system_clock::now();</div>
<div class="line">    <span class="keywordflow">do</span></div>
<div class="line">    {</div>
<div class="line">        captureProcessor::ImageIdType imageId = {};</div>
<div class="line"> </div>
<div class="line">        captureProcessor::CaptureResult result;</div>
<div class="line">        result = captureProcessor::GetImageFromCaptureDevice(&amp;imageId);</div>
<div class="line">        <span class="keywordflow">if</span> (result == captureProcessor::CaptureResult_Success)</div>
<div class="line">        {</div>
<div class="line">            captureProcessor::ImageIdType clipImage = {};</div>
<div class="line">            captureProcessor::ImageRect rect = { 580, 490, 120, 120 };</div>
<div class="line"> </div>
<div class="line">            result = captureProcessor::ExtractImage(&amp;clipImage, imageId, rect);</div>
<div class="line">            <span class="keywordflow">if</span> (result == captureProcessor::CaptureResult_Success)</div>
<div class="line">            {</div>
<div class="line">                captureProcessor::ImageIdType filteredImage = {};</div>
<div class="line">                captureProcessor::ApplyFilter(&amp;filteredImage, clipImage, filter);</div>
<div class="line"> </div>
<div class="line">                captureProcessor::OpenImageWindow(windowName, filteredImage);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordtype">int</span> x = 0;</div>
<div class="line">                <span class="keywordtype">int</span> y = 0;</div>
<div class="line">                captureProcessor::MatchingResult machingResult =</div>
<div class="line">                    captureProcessor::WaitDetectObjectWithFilter(</div>
<div class="line">                        &amp;x, &amp;y, filteredImage, 0.95, 1000, filter);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (machingResult == captureProcessor::MatchingResult_Success)</div>
<div class="line">                {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Template image was found at (%d, %d)\n&quot;</span>, x, y);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Template image was not found\n&quot;</span>);</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                captureProcessor::ReleaseImage(filteredImage);</div>
<div class="line">                captureProcessor::ReleaseImage(clipImage);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            captureProcessor::ReleaseImage(imageId);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        Sleep(16);</div>
<div class="line"> </div>
<div class="line">        durationTime</div>
<div class="line">            = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(</div>
<div class="line">                std::chrono::system_clock::now() - beginTime).count());</div>
<div class="line">    } <span class="keywordflow">while</span> (durationTime &lt; (10 * 1000));</div>
<div class="line"> </div>
<div class="line">    captureProcessor::CloseImageWindow(windowName);</div>
<div class="line">    captureProcessor::DeleteFilter(filter);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> OcrSample()</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;&lt;OcrSample&gt;\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    std::string imagePath = GetSdkRootPath();</div>
<div class="line">    imagePath.append(</div>
<div class="line">        <span class="stringliteral">&quot;/Samples/Sources/Tools/AutoTestAssistTools/ScriptSamples/ImageProcessSample/Ocr_Sample.png&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* nameForTargetImage = <span class="stringliteral">&quot;TargetImage&quot;</span>;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* nameForDetectedImage = <span class="stringliteral">&quot;DetectedImage&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    captureProcessor::ImageIdType imageId = {};</div>
<div class="line">    captureProcessor::CaptureResult result =</div>
<div class="line">        captureProcessor::LoadImageFile(&amp;imageId, imagePath.c_str());</div>
<div class="line">    <span class="keywordflow">if</span> (result != captureProcessor::CaptureResult_Success)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Load image failed(%s).\n&quot;</span>, imagePath.c_str());</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    captureProcessor::OpenImageWindow(nameForTargetImage, imageId);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> count = 0;</div>
<div class="line">    captureProcessor::OcrResultHandleType resultHandle;</div>
<div class="line">    captureProcessor::ExecuteOcr(&amp;count, &amp;resultHandle, imageId,</div>
<div class="line">        captureProcessor::OcrSeparateLevel_Word, captureProcessor::OcrLanguage_English);</div>
<div class="line"> </div>
<div class="line">    captureProcessor::ImageRect rect = {};</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; count; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">char</span> resultText[256];</div>
<div class="line">        <span class="keywordtype">int</span> resultSize = 0;</div>
<div class="line"> </div>
<div class="line">        captureProcessor::GetOcrResultString(&amp;rect, &amp;resultSize, resultText, 256, resultHandle, i);</div>
<div class="line">        printf(<span class="stringliteral">&quot;%s\n&quot;</span>, resultText);</div>
<div class="line">    }</div>
<div class="line">    captureProcessor::ReleaseOcrResult(resultHandle);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;--------------------------\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* regexString = <span class="stringliteral">&quot;Sample&quot;</span>;</div>
<div class="line">    captureProcessor::MatchingResult machingResult =</div>
<div class="line">        captureProcessor::DetectTextForImage(&amp;rect, imageId, regexString,</div>
<div class="line">            captureProcessor::OcrSeparateLevel_Word, captureProcessor::OcrLanguage_English);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (machingResult == captureProcessor::MatchingResult_Success)</div>
<div class="line">    {</div>
<div class="line">        captureProcessor::ImageIdType clipImage = {};</div>
<div class="line">        captureProcessor::ExtractImage(&amp;clipImage, imageId, rect);</div>
<div class="line">        captureProcessor::OpenImageWindow(nameForDetectedImage, clipImage);</div>
<div class="line">        captureProcessor::ReleaseImage(clipImage);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;\&quot;%s\&quot; was not found\n&quot;</span>, regexString);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Sleep(10 * 1000);</div>
<div class="line"> </div>
<div class="line">    captureProcessor::ReleaseAllImages();</div>
<div class="line">    captureProcessor::CloseImageWindow(nameForDetectedImage);</div>
<div class="line">    captureProcessor::CloseImageWindow(nameForTargetImage);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> LabeligSample()</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;&lt;LabelingSample&gt;\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    std::string imagePath = GetSdkRootPath();</div>
<div class="line">    imagePath.append(</div>
<div class="line">        <span class="stringliteral">&quot;/Samples/Sources/Tools/AutoTestAssistTools/ScriptSamples/ImageProcessSample/Labeling_Sample.png&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    captureProcessor::ImageIdType imageId = {};</div>
<div class="line">    captureProcessor::CaptureResult result =</div>
<div class="line">        captureProcessor::LoadImageFile(&amp;imageId, imagePath.c_str());</div>
<div class="line">    <span class="keywordflow">if</span> (result != captureProcessor::CaptureResult_Success)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Load image failed(%s).\n&quot;</span>, imagePath.c_str());</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    captureProcessor::FilterIdType filter = {};</div>
<div class="line">    captureProcessor::CreateFilter(&amp;filter);</div>
<div class="line"> </div>
<div class="line">    captureProcessor::Rgb24Color lowerColor = { 255, 0, 0 };</div>
<div class="line">    captureProcessor::Rgb24Color upperColor = { 255, 255, 255 };</div>
<div class="line">    captureProcessor::SetColorRangeFilter(filter, lowerColor, upperColor);</div>
<div class="line"> </div>
<div class="line">    captureProcessor::ImageIdType filteredImage = {};</div>
<div class="line">    captureProcessor::ApplyFilter(&amp;filteredImage, imageId, filter);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> resultAreaCount = 0;</div>
<div class="line">    captureProcessor::LabelingResultHandleType resultHandle = {};</div>
<div class="line">    result = captureProcessor::ExecuteLabeling(&amp;resultAreaCount, &amp;resultHandle, filteredImage);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (result == captureProcessor::CaptureResult_Success)</div>
<div class="line">    {</div>
<div class="line">        captureProcessor::LabelingResult* resultList</div>
<div class="line">            = <span class="keyword">new</span> captureProcessor::LabelingResult[resultAreaCount];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">int</span> resultCount = 0;</div>
<div class="line">        captureProcessor::ImageRect rect = {};</div>
<div class="line">        captureProcessor::GetLabelingResults(&amp;resultCount, resultList, resultHandle, resultAreaCount);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; resultCount; i++)</div>
<div class="line">        {</div>
<div class="line">            printf(<span class="stringliteral">&quot;result %d ----\n&quot;</span>, i);</div>
<div class="line">            printf(<span class="stringliteral">&quot;area:%d, center:(%d, %d)\n&quot;</span>,</div>
<div class="line">                resultList[i].area, resultList[i].centerX, resultList[i].centerY);</div>
<div class="line">            printf(<span class="stringliteral">&quot;left:%d, top:%d, width:%d, height:%d\n&quot;</span>,</div>
<div class="line">                resultList[i].rect.left, resultList[i].rect.top,</div>
<div class="line">                resultList[i].rect.width, resultList[i].rect.height);</div>
<div class="line"> </div>
<div class="line">            captureProcessor::ImageIdType clipImage = {};</div>
<div class="line">            captureProcessor::ExtractImage(&amp;clipImage, imageId, resultList[i].rect);</div>
<div class="line">            captureProcessor::OpenImageWindow(</div>
<div class="line">                (<span class="stringliteral">&quot;LabelingImage&quot;</span> + std::to_string(i)).c_str(), clipImage);</div>
<div class="line">            captureProcessor::ReleaseImage(clipImage);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">delete</span>[] resultList;</div>
<div class="line"> </div>
<div class="line">        Sleep(10 * 1000);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; resultCount; i++)</div>
<div class="line">        {</div>
<div class="line">            captureProcessor::CloseImageWindow(</div>
<div class="line">                (<span class="stringliteral">&quot;LabelingImage&quot;</span> + std::to_string(i)).c_str());</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    captureProcessor::DeleteFilter(filter);</div>
<div class="line">    captureProcessor::ReleaseAllImages();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> RunSample()</div>
<div class="line">{</div>
<div class="line">    DetectObjectImage();</div>
<div class="line">    DotColor();</div>
<div class="line">    <a class="code" href="_capture_processor_library_8h.html#a888c76c42c104f7df4aa719879d1e0f9">ApplyFilter</a>();</div>
<div class="line">    <a class="code" href="_capture_processor_library_8h.html#ada70672647d8dc5b65440c37c9fa7cfd">DetectObjectWithFilter</a>();</div>
<div class="line">    OcrSample();</div>
<div class="line">    LabeligSample();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!InitializeLibrary())</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Initialize failed\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    RunSample();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Finalize CaptureProcessor.</span></div>
<div class="line">    captureProcessor::Finalize();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="a_capture_processor_library_8h_html_a888c76c42c104f7df4aa719879d1e0f9"><div class="ttname"><a href="_capture_processor_library_8h.html#a888c76c42c104f7df4aa719879d1e0f9">ApplyFilter</a></div><div class="ttdeci">CAPTUREPROCESSOR_API CaptureResult ApplyFilter(ImageIdType *pOutId, ImageIdType id, FilterIdType filterId)</div><div class="ttdoc">Applies an image processing filter to the target image.</div></div>
<div class="ttc" id="a_capture_processor_library_8h_html_ada70672647d8dc5b65440c37c9fa7cfd"><div class="ttname"><a href="_capture_processor_library_8h.html#ada70672647d8dc5b65440c37c9fa7cfd">DetectObjectWithFilter</a></div><div class="ttdeci">CAPTUREPROCESSOR_API MatchingResult DetectObjectWithFilter(int *pOutX, int *pOutY, ImageIdType id, double threshold, FilterIdType filterId)</div><div class="ttdoc">Performs template matching for the latest image obtained from the capture target device with an image...</div></div>
<div class="ttc" id="anamespaceauto_test_assist_tool_html"><div class="ttname"><a href="namespaceauto_test_assist_tool.html">autoTestAssistTool</a></div><div class="ttdoc">Namespace for the AutoTestAssistTool sample.</div><div class="ttdef"><b>Definition:</b> Program.cs:80</div></div>
<div class="ttc" id="anamespacenn_1_1htc_html_a370e114a42a12b384ef2b2246618168e"><div class="ttname"><a href="namespacenn_1_1htc.html#a370e114a42a12b384ef2b2246618168e">nn::htc::GetEnvironmentVariable</a></div><div class="ttdeci">Result GetEnvironmentVariable(size_t *pOutSize, char *outBuffer, size_t bufferSize, const char *variableName) NN_NOEXCEPT</div><div class="ttdoc">Gets the value of the specified environment variable as a UTF-8 string from the host.</div></div>
<div class="ttc" id="astruct_serial_number_string_html"><div class="ttname"><a href="struct_serial_number_string.html">SerialNumberString</a></div><div class="ttdoc">This structure handles serial number strings.</div><div class="ttdef"><b>Definition:</b> autoTestAssistTool_LibTypes.h:24</div></div>
<div class="ttc" id="astruct_serial_number_string_html_a3975562a9db62a323dba889acc13165c"><div class="ttname"><a href="struct_serial_number_string.html#a3975562a9db62a323dba889acc13165c">SerialNumberString::value</a></div><div class="ttdeci">char value[15]</div><div class="ttdoc">This is a serial number string with a null terminator.</div><div class="ttdef"><b>Definition:</b> autoTestAssistTool_LibTypes.h:26</div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
</body>
</html>

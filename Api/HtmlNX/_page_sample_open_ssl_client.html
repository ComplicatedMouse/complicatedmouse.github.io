<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HTTPS communication using OpenSSL library | NintendoSDK API Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<script type="text/javascript" src="searchapi.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   &#160;<span id="projectnumber">14.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="_page_sample.html">Sample Descriptions</a></li><li class="navelem"><a class="el" href="_page_sample_openssl.html">OpenSSL</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">HTTPS communication using OpenSSL library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#PageSampleOpenSslClient_SectionBrief">Overview</a></li>
<li class="level1"><a href="#PageSampleOpenSslClient_SectionFileStructure">File Structure</a></li>
<li class="level1"><a href="#PageSampleOpensslClient_SectionNecessaryEnvironment">System Requirements</a></li>
<li class="level1"><a href="#PageSampleOpensslClient_SectionHowToOperate">Operation</a></li>
<li class="level1"><a href="#PageSampleOpensslClient_SectionPrecaution">Important Information</a></li>
<li class="level1"><a href="#PageSampleOpensslClient_SectionHowToExecute">Execution Procedure</a></li>
<li class="level1"><a href="#PageSampleOpensslClient_SectionDetail">Detail</a></li>
</ul>
</div>
<div class="textblock"><p>Documentation about the sample program running OpenSSL library</p>
<h1><a class="anchor" id="PageSampleOpenSslClient_SectionBrief"></a>
Overview</h1>
<p>First this sample prepares a network connection by using the NIFM library. If the network can be used, it establishes the TCP connection on port 443 with the specified server. Then it performs an SSL handshake on the TCP connection. Once the connection has been established it sends an HTTP GET request and awaits receipt of the requested HTTP data.</p>
<h1><a class="anchor" id="PageSampleOpenSslClient_SectionFileStructure"></a>
File Structure</h1>
<p>This sample program can be found at <a class="el" href="dir_e0169bc9a35c4cc2d10c60af3ed287d4.html">Samples/Sources/Applications/Openssl/Client </a>.</p>
<h1><a class="anchor" id="PageSampleOpensslClient_SectionNecessaryEnvironment"></a>
System Requirements</h1>
<p>Importing network settings by SettingManager is required prior to running this sample. For more information, see the Nifm Library <a href="../../Package/contents/Pages/Page_104465190.html#Anchor_104465190_SettingsManager_network">Registering Network Connection Settings</a> documentation.</p>
<p>By default this sample sends an HTTP GET request to example.com on port 443, and therefore an internet connection is required. By default, certificate verification is turned off.</p>
<h1><a class="anchor" id="PageSampleOpensslClient_SectionHowToOperate"></a>
Operation</h1>
<p>Make sure that development hardware has internet access.</p>
<p>Command Line Arguments: Format: [URL] [Is Certificate Verified] [Certificate file path on host OR rom] Default arguments: "example.com false (empty string)" Example arguments: "example.com true host:E:/openssl/CaCertBundle.pem" Example arguments: "example.com true rom:CaCertBundle.pem"</p>
<ul>
<li>URL: The hostname to which you want to connect and send the HTTPS GET command. Exclude "https://" (defaults to example.com).</li>
<li>Verified: Enable certificate verification. If true, you need to load some certificates (defaults to false)</li>
<li>Certificate File/Directory: Select the file path or directory to load CA Certificates from. If path ends in <code>/</code> it will be interpreted as a directory; otherwise, a file (defaults to "").</li>
</ul>
<h1><a class="anchor" id="PageSampleOpensslClient_SectionPrecaution"></a>
Important Information</h1>
<p>None.</p>
<h1><a class="anchor" id="PageSampleOpensslClient_SectionHowToExecute"></a>
Execution Procedure</h1>
<p>Build the Visual Studio Solution in the desired configuration and run it.</p>
<h1><a class="anchor" id="PageSampleOpensslClient_SectionDetail"></a>
Detail</h1>
<p>Following is the sequence of this sample program.</p>
<ul>
<li>Sends request to use the network connection by the NIFM library.</li>
<li>Initializes the socket library and OpenSSL library.</li>
<li>Parses command line arguments.</li>
<li>Resolves host name.</li>
<li>Creates an OpenSSL context in <code>HttpsClient::SetupSslContext()</code>, which loads in valid certificates from file.</li>
<li>Creates a TCP connection on port 443 in <code>HttpsClient::SetupTcpSocket()</code> to host name.</li>
<li>Creates an OpenSSL connection in <code>HttpsClient::SetupSslConnection()</code> based on the context.</li>
<li>Performs OpenSSL handshake with the server on the TCP connection in <code>HttpsClient::PerformSslHandshake()</code>, with the default command line arguments the client-side verifies will always succeed.</li>
<li>Sends an HTTP GET request to the server over the OpenSSL connection in <code>HttpsClient::Send(...)</code>.</li>
<li>Receives HTTP data sent from the server per the HTTP GET request in <code>HttpsClient::Receive(...)</code> until the connection is completed/disconnected by the server.</li>
<li>Prints received content in <code>PrintProcessBuffer()</code>.</li>
<li>Destroys the OpenSSL connnection, TCP socket in <code>HttpsClient::Finalize()</code> and then cleans up the context in <code>~HttpsClient</code> when it isn't imported.</li>
</ul>
<p>Enable "#define PRINT_SERVER_CERT" to demonstrate how to get the server certificate that is obtained during OpenSSL handshake.</p>
<p>Enable "#define PRINT_POSSIBLE_CIPHER_NAMES" to print out all possible cipher suites that could be used with the selected given cipher config string.</p>
<p>Enable "#define DISABLE_SESSION_CACHE" to disable SSL session cache. <b>Note:</b> This option is not compatible with <code>SESSION_CACHE_TICKET</code>.</p>
<p>Enable "#define SESSION_CACHE_TICKET" to enable SSL session tickets. Note: This option is not compatible <code>with DISABLE_SESSION_CACHE</code>.</p>
<p>Enable "#define FLUSH_SESSION_CACHE" to flush the OpenSSL session cache before destroying the connection.</p>
<p>Please enable "#define PRINT_FULL_PROCESS_BUFFER" to print the full website upon TCP connection completion.</p>
<p>See <code>isNonBlocking</code> in <code>nnMain</code> to demonstrate how to use OpenSSL in non-blocking mode.</p>
<p>Following is the expected output log of this sample program (with default arguments). Note that it will not be printed in the Release build.</p>
<pre class="fragment">OpenSSL context created.
OpenSSL context session cache ticket mode disabled.
OpenSSL context session cache mode: 2.
HttpsClient::Initialize example.com:443 NonBlocking mode
Created a TCP socket.
Set socket mode: NonBlocking.
Trying to establish a TCP connection.
Established a TCP connection.
SSL_do_handshake() success.

#################################################
### Warning: Skipped certificate verification ###
#################################################

PerformSslHandshake success.
HttpsClient::Initialize finished successfully.
Sending http GET request:
GET / HTTP/1.0
Host: example.com


Finished sending https request.
Sent a total of 38 bytes.
Connection closed by the host.
HTTP/1.0 200 OK
HttpsClient finalized.
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
</body>
</html>

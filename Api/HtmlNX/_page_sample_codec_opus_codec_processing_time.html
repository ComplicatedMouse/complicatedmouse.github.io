<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Measuring Opus Encoder and Decoder Processing Times Sample | NintendoSDK API Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<script type="text/javascript" src="searchapi.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   &#160;<span id="projectnumber">14.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="_page_sample.html">Sample Descriptions</a></li><li class="navelem"><a class="el" href="_page_sample_codec.html">Codec Library Samples</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Measuring Opus Encoder and Decoder Processing Times Sample </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#PageSampleCodecOpusCodecProcessingTime_SectionBrief">Overview</a></li>
<li class="level1"><a href="#PageSampleCodecOpusCodecProcessingTime_SectionFileStructure">File Structure</a></li>
<li class="level1"><a href="#PageSampleCodecOpusCodecProcessingTime_SectionNecessaryEnvironment">Required Environment</a></li>
<li class="level1"><a href="#PageSampleCodecOpusCodecProcessingTime_SectionHowToOperate">How to Use</a></li>
<li class="level1"><a href="#PageSampleCodecOpusCodecProcessingTime_SectionPrecaution">Important Information</a></li>
<li class="level1"><a href="#PageSampleCodecOpusCodecProcessingTime_SectionHowToExecute">Execution Procedure</a></li>
<li class="level1"><a href="#PageSampleCodecOpusCodecProcessingTime_SectionDetail">Description</a><ul><li class="level2"><a href="#PageSampleCodecOpusCodecProcessingTime_SectionSampleProgram">Sample Program</a></li>
<li class="level2"><a href="#PageSampleCodecOpusCodecProcessingTime_SectionSampleDetail">Sample Program Description</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>Description for the sample program to measure the Opus encoder and decoder processing times.</p>
<h1><a class="anchor" id="PageSampleCodecOpusCodecProcessingTime_SectionBrief"></a>
Overview</h1>
<p>Sample that measures the Opus encoder and decoder processing times.</p>
<h1><a class="anchor" id="PageSampleCodecOpusCodecProcessingTime_SectionFileStructure"></a>
File Structure</h1>
<p>This sample program is located in <code><a class="el" href="dir_d7b0673f7de8f5bc6c9bcf8a2ec1dc49.html">Samples/Sources/Applications/CodecOpusCodecProcessingTime/ </a> </code>.</p>
<h1><a class="anchor" id="PageSampleCodecOpusCodecProcessingTime_SectionNecessaryEnvironment"></a>
Required Environment</h1>
<p>Audio output must be available to play back decoded results.</p>
<h1><a class="anchor" id="PageSampleCodecOpusCodecProcessingTime_SectionHowToOperate"></a>
How to Use</h1>
<p>Run the sample program to measure Opus encoder and decoder processing times. It terminates automatically after logs are exported for the measurement results for each case.</p>
<h1><a class="anchor" id="PageSampleCodecOpusCodecProcessingTime_SectionPrecaution"></a>
Important Information</h1>
<p>Nintendo anticipates that playing back decoded results will be used for purposes other than measuring processing times, including to check program operations. Processing time measurements might not be correct when the playback of decoded results is enabled.</p>
<h1><a class="anchor" id="PageSampleCodecOpusCodecProcessingTime_SectionHowToExecute"></a>
Execution Procedure</h1>
<p>Build the sample program and then run it.</p>
<h1><a class="anchor" id="PageSampleCodecOpusCodecProcessingTime_SectionDetail"></a>
Description</h1>
<h2><a class="anchor" id="PageSampleCodecOpusCodecProcessingTime_SectionSampleProgram"></a>
Sample Program</h2>
<p>This sample program uses the following source code.</p>
<p><a class="el" href="_codec_opus_codec_processing_time_8cpp.html" title="Sample program for measuring the Opus encoder and decoder processing times.">CodecOpusCodecProcessingTime.cpp</a> </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*--------------------------------------------------------------------------------*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">  Copyright Nintendo.  All rights reserved.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">  These coded instructions, statements, and computer programs contain proprietary</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">  information of Nintendo and/or its licensed developers and are protected by</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">  national and international copyright laws. They may not be disclosed to third</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">  parties or copied or duplicated in any form, in whole or in part, without the</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">  prior written consent of Nintendo.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">  The content herein is highly confidential and should be handled accordingly.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *--------------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span>  <span class="comment">// std::malloc, std::free</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span> <span class="comment">// std::pow</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span> <span class="comment">// std::string</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span> <span class="comment">// std::max, std::min</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="nn___abort_8h.html">nn/nn_Abort.h</a>&gt;</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="nn___assert_8h.html">nn/nn_Assert.h</a>&gt;</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="audio_8h.html">nn/audio.h</a>&gt;</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="codec_8h.html">nn/codec.h</a>&gt;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="codec___opus_encoder_8h.html">nn/codec/codec_OpusEncoder.h</a>&gt;</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="fs_8h.html">nn/fs.h</a>&gt;</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="mem_8h.html">nn/mem.h</a>&gt;</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#include &lt;nn/os.h&gt;</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="util___format_string_8h.html">nn/util/util_FormatString.h</a>&gt;</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#include &lt;nns/audio/audio_WavFormat.h&gt;</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">#include &lt;nns/nns_Log.h&gt;</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">//==============================================================================</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">// Enable USE_HARDWARE_DECODER to switch to HardwareOpusDecoder.</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">// #define USE_HARDWARE_DECODER</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">//==============================================================================</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">//==============================================================================</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">// Enable ENABLE_PLAY to play back decoded results.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">// #define ENABLE_PLAY</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">//==============================================================================</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">#if defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> AudioFrameSampleCount = 240;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">#endif  </span><span class="comment">// defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keyword">enum</span> ProcessingId</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;{</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    ProcessingId_Encoding = 0,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    ProcessingId_Decoding = 1,</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    ProcessingId_Count</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;};</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">// The structure that stores the encoding parameters provided to the measurement program.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keyword">struct </span>CodecParameterSet</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">int</span> frameDuration;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">int</span> bitRate;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="namespacenn_1_1codec.html#a3a2d885fcb1cff929552d0a81ba26872">nn::codec::OpusBitRateControl</a> bitRateControl;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="namespacenn_1_1codec.html#a9b257771e1088b6cba2836bbe3a53ccf">nn::codec::OpusCodingMode</a> codingMode;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;};</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">// Class for handling WAV files.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keyword">class </span>Wav</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;{</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    Wav()</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        : m_SampleRate(0)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        , m_ChannelCount(0)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        , m_IsInitialized(false)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        , m_BufferAddress(nullptr)</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    {};</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    ~Wav()</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        m_PcmDataAddress = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">nullptr</span> != m_BufferAddress)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keyword">delete</span>[] m_BufferAddress;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            m_BufferAddress = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        m_IsInitialized = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    };</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">void</span> Load(<span class="keyword">const</span> <span class="keywordtype">char</span>* filePath)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">// Load WAV data.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="structnn_1_1fs_1_1_file_handle.html">nn::fs::FileHandle</a> handle;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1fs.html#a0f2b5b30657b1ffaf1dec49bfb36462b">nn::fs::OpenFile</a>(&amp;handle, filePath, <a class="code" href="namespacenn_1_1fs.html#a4c97b79cce78a95c2333dbc9053b9393afde4472d2b455879cad02aade386ac0d">nn::fs::OpenMode_Read</a>));</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        int64_t fileSize;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1fs.html#aba29e01d386e809349d60eccdb15ff21">nn::fs::GetFileSize</a>(&amp;fileSize, handle));</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        m_BufferAddress = <span class="keyword">new</span> uint8_t[<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(fileSize)];</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <a class="code" href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a>(m_BufferAddress);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1fs.html#a81801a404563984f8c6cc1483cc6d730">nn::fs::ReadFile</a>(handle, 0, m_BufferAddress, <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(fileSize)));</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <a class="code" href="namespacenn_1_1fs.html#ac8bd9e828751bd4f953acfa765278f84">nn::fs::CloseFile</a>(handle);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="comment">// Get the sample rate and the number of channels from the header.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        nns::audio::WavFormat wavFormat;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <a class="code" href="nn___abort_8h.html#a93be5bd646d8b7f02fb8115c603a00c7">NN_ABORT_UNLESS_EQUAL</a>(nns::audio::WavResult_Success, ParseWavFormat(&amp;wavFormat, m_BufferAddress, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(fileSize)));</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        m_ChannelCount = wavFormat.channelCount;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        m_SampleRate = wavFormat.sampleRate;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        m_SampleCountPerChannel = wavFormat.dataSize / (wavFormat.bitsPerSample &gt;&gt; 3) / wavFormat.channelCount;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        m_PcmDataAddress = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>int16_t*<span class="keyword">&gt;</span>(m_BufferAddress + wavFormat.dataOffset);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        m_IsInitialized = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">int</span> GetSampleRate() const <a class="code" href="nn___macro_8h.html#a0e31cc4dc24d85253a31e48b1a85ab33">NN_NOEXCEPT</a></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(<a class="code" href="namespacenn_1_1htcs.html#a09801c691b6f87a9f2b384310190f89b">IsInitialized</a>());</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordflow">return</span> m_SampleRate;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="namespacenn_1_1image.html#a658c2231fdb404e7fedd5b16b5f59aeb">GetChannelCount</a>() const <a class="code" href="nn___macro_8h.html#a0e31cc4dc24d85253a31e48b1a85ab33">NN_NOEXCEPT</a></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(<a class="code" href="namespacenn_1_1htcs.html#a09801c691b6f87a9f2b384310190f89b">IsInitialized</a>());</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">return</span> m_ChannelCount;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keyword">inline</span> <span class="keyword">const</span> int16_t* GetPcmDataAddress() const <a class="code" href="nn___macro_8h.html#a0e31cc4dc24d85253a31e48b1a85ab33">NN_NOEXCEPT</a></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(<a class="code" href="namespacenn_1_1htcs.html#a09801c691b6f87a9f2b384310190f89b">IsInitialized</a>());</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">return</span> m_PcmDataAddress;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keyword">inline</span> int64_t GetSampleCountPerChannel() const <a class="code" href="nn___macro_8h.html#a0e31cc4dc24d85253a31e48b1a85ab33">NN_NOEXCEPT</a></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(<a class="code" href="namespacenn_1_1htcs.html#a09801c691b6f87a9f2b384310190f89b">IsInitialized</a>());</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">return</span> m_SampleCountPerChannel;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacenn_1_1htcs.html#a09801c691b6f87a9f2b384310190f89b">IsInitialized</a>() const <a class="code" href="nn___macro_8h.html#a0e31cc4dc24d85253a31e48b1a85ab33">NN_NOEXCEPT</a></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">return</span> m_IsInitialized;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">int</span> m_SampleRate;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordtype">int</span> m_ChannelCount;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    int64_t m_SampleCountPerChannel;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordtype">bool</span> m_IsInitialized;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    uint8_t* m_BufferAddress;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keyword">const</span> int16_t* m_PcmDataAddress;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;};</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> BufferCount = 4;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<a class="code" href="nn___macro_8h.html#a1035ab876d08f7beb687ce9c8bbcf4ac">NN_STATIC_ASSERT</a>(BufferCount &lt;= <a class="code" href="structnn_1_1audio_1_1_voice_type.html#a1c60d07e5bdd8967c813e818af35b0aa">nn::audio::VoiceType::WaveBufferCountMax</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">//------------------------------</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">// Define the encoding parameters.</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">//------------------------------</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">// Bit rate.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> BitRates[] =</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;{</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;     10000,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;     20000,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;     40000,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;     64000,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;     96000,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    128000,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    192000</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;};</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">// Frame.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> FrameDurations[] =</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;{</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      2500,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      5000,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;     10000,</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;     20000</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;};</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">// Encryption mode.</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keyword">const</span> <a class="code" href="namespacenn_1_1codec.html#a9b257771e1088b6cba2836bbe3a53ccf">nn::codec::OpusCodingMode</a> CodingModes[] =</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;{</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <a class="code" href="namespacenn_1_1codec.html#a9b257771e1088b6cba2836bbe3a53ccfa1ab64f14137951c75d53c073bbdfaa70">nn::codec::OpusCodingMode_Celt</a>,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <a class="code" href="namespacenn_1_1codec.html#a9b257771e1088b6cba2836bbe3a53ccfabe6634ee1371b268050b40b8abacb259">nn::codec::OpusCodingMode_Silk</a></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;};</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">// Structure that stores the various codec processing time results.</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="keyword">struct </span>ProcessingTime</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;{</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordtype">double</span> total;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordtype">double</span> average;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">double</span> minimum;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">double</span> maximum;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordtype">double</span> standardDeviation;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordtype">int</span> iterationCount;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;};</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;NN_AUDIO_ALIGNAS_MEMORY_POOL_ALIGN int16_t g_PcmBuffer[1024 * 1024];</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="preprocessor">#if defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keywordtype">char</span> g_HeapBuffer[8 * 1024 * 1024];</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keywordtype">char</span>* g_MountRomCacheBuffer = NULL;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keyword">const</span> std::string GetMountPointRom()</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">return</span> std::string(<span class="stringliteral">&quot;asset&quot;</span>);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="keywordtype">void</span> InitializeFileSystem()</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;{</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">size_t</span> cacheSize = 0;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1fs.html#a5df6e3385c795a5bd046790ef7f17f2d">nn::fs::QueryMountRomCacheSize</a>(&amp;cacheSize));</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    g_MountRomCacheBuffer = <span class="keyword">new</span> <span class="keywordtype">char</span>[cacheSize];</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a>(g_MountRomCacheBuffer);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <a class="code" href="namespacenn_1_1fs.html#a2e453fe1fbf8f818dc45bbd2897105cd">nn::fs::MountRom</a>(GetMountPointRom().c_str(), g_MountRomCacheBuffer, cacheSize)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    );</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keywordtype">void</span> FinalizeFileSystem()</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;{</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="namespacenn_1_1fs.html#ac8a95249afd4a87a55d319dfecb0466c">nn::fs::Unmount</a>(GetMountPointRom().c_str());</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keyword">delete</span>[] g_MountRomCacheBuffer;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    g_MountRomCacheBuffer = NULL;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keywordtype">void</span> CollectUpProcessingTime(<span class="keyword">struct</span> ProcessingTime* pProcessingTime, <span class="keyword">const</span> int64_t* pScores, <span class="keywordtype">int</span> count)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;{</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> ScalingFactor = 1.0e+6;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordtype">double</span> sum = 0;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    int64_t maximum = pScores[0];</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    int64_t minimum = pScores[0];</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k = 0; k &lt; count; ++k)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        sum += <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(pScores[k]);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        maximum = std::max(maximum, pScores[k]);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        minimum = std::min(minimum, pScores[k]);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> average = sum / count;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordtype">double</span> sd = 0;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> k = 0; k &lt; count; ++k)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        sd += std::pow(<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(pScores[k]) - average, 2);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    sd /= count;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    pProcessingTime-&gt;average = average / ScalingFactor;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    pProcessingTime-&gt;minimum = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(minimum / ScalingFactor);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    pProcessingTime-&gt;maximum = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(maximum / ScalingFactor);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    pProcessingTime-&gt;standardDeviation = std::sqrt(sd / ScalingFactor);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    pProcessingTime-&gt;iterationCount = count;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    pProcessingTime-&gt;total = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(sum / ScalingFactor);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;}</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="keywordtype">void</span> EvaluateOpusProcessingPerformance(<span class="keyword">struct</span> ProcessingTime processingTime[], <span class="keyword">const</span> Wav&amp; wav, <span class="keyword">const</span> <span class="keyword">struct</span> CodecParameterSet&amp; parameterSet)</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;{</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">#if defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="classnn_1_1mem_1_1_standard_allocator.html">nn::mem::StandardAllocator</a> allocator(g_HeapBuffer, <span class="keyword">sizeof</span>(g_HeapBuffer));</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="classnn_1_1mem_1_1_standard_allocator.html">nn::mem::StandardAllocator</a> pcmBufferAllocator(g_PcmBuffer, <span class="keyword">sizeof</span>(g_PcmBuffer));</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> sampleRate = wav.GetSampleRate();</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> channelCount = wav.GetChannelCount();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// Initialize the Opus encoder.</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="classnn_1_1codec_1_1_opus_encoder.html">nn::codec::OpusEncoder</a> encoder;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordtype">void</span>* workBufferForEncoder = std::malloc(encoder.<a class="code" href="classnn_1_1codec_1_1_opus_encoder.html#a3823391fd8fe523bcd4a38bf64cc32f7">GetWorkBufferSize</a>(sampleRate, channelCount));</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a>(workBufferForEncoder);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="nn___abort_8h.html#a93be5bd646d8b7f02fb8115c603a00c7">NN_ABORT_UNLESS_EQUAL</a>(</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <a class="code" href="namespacenn_1_1codec.html#a375cd42044f1aabca06eba955018b7d5af2becb927546cad0901fbc6ce2815d27">nn::codec::OpusResult_Success</a>,</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        encoder.<a class="code" href="classnn_1_1codec_1_1_opus_encoder.html#adee7bf9f60139e169535f3214bdf2fc7">Initialize</a>(sampleRate, channelCount, workBufferForEncoder, encoder.<a class="code" href="classnn_1_1codec_1_1_opus_encoder.html#a3823391fd8fe523bcd4a38bf64cc32f7">GetWorkBufferSize</a>(sampleRate, channelCount))</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    );</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    encoder.<a class="code" href="classnn_1_1codec_1_1_opus_encoder.html#ad97a6bd5bb9799a718b1bdaba7ac34b8">SetBitRate</a>(parameterSet.bitRate);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    encoder.<a class="code" href="classnn_1_1codec_1_1_opus_encoder.html#ab0b21bd4737f260008ae8dfdadfdd03a">SetBitRateControl</a>(parameterSet.bitRateControl);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    encoder.<a class="code" href="classnn_1_1codec_1_1_opus_encoder.html#a681914112f2a26b502668c5b1a6150c7">BindCodingMode</a>(parameterSet.codingMode);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">// Initialize the Opus decoder.</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor">#ifndef USE_HARDWARE_DECODER</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="classnn_1_1codec_1_1_opus_decoder.html">nn::codec::OpusDecoder</a> decoder;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor">#else  </span><span class="comment">// #ifndef USE_HARDWARE_DECODER</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keyword">const</span> int32_t noOption = 0; <span class="comment">// Currently, there are no options that may be specified.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="classnn_1_1codec_1_1_hardware_opus_decoder.html">nn::codec::HardwareOpusDecoder</a> decoder(noOption);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// #ifndef USE_HARDWARE_DECODER</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordtype">void</span>* workBufferForDecoder = std::malloc(decoder.<a class="code" href="classnn_1_1codec_1_1_opus_decoder.html#ad2fd272c7a8f639c42537528ffe3ac7e">GetWorkBufferSize</a>(sampleRate, channelCount));</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a>(workBufferForDecoder);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <a class="code" href="nn___abort_8h.html#a93be5bd646d8b7f02fb8115c603a00c7">NN_ABORT_UNLESS_EQUAL</a>(</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <a class="code" href="namespacenn_1_1codec.html#a375cd42044f1aabca06eba955018b7d5af2becb927546cad0901fbc6ce2815d27">nn::codec::OpusResult_Success</a>,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        decoder.<a class="code" href="classnn_1_1codec_1_1_opus_decoder.html#a07947768528b08c6c40421c5119c0b6e">Initialize</a>(sampleRate, channelCount, workBufferForDecoder, decoder.<a class="code" href="classnn_1_1codec_1_1_opus_decoder.html#ad2fd272c7a8f639c42537528ffe3ac7e">GetWorkBufferSize</a>(sampleRate, channelCount))</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    );</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> sampleCountPerCodecProcessing = encoder.<a class="code" href="classnn_1_1codec_1_1_opus_encoder.html#a09865c4e5930369a1c9bc78d8974f68b">CalculateFrameSampleCount</a>(parameterSet.frameDuration);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> sampleCountPerAudioProcessing = std::max(sampleRate / 1000 * 5, encoder.<a class="code" href="classnn_1_1codec_1_1_opus_encoder.html#a09865c4e5930369a1c9bc78d8974f68b">CalculateFrameSampleCount</a>(parameterSet.frameDuration));</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> pcmBufferSize = sampleCountPerAudioProcessing * channelCount * <span class="keyword">sizeof</span>(int16_t);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="preprocessor">#if defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">//Build the audio renderer.</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="structnn_1_1audio_1_1_audio_renderer_parameter.html">nn::audio::AudioRendererParameter</a> audioRendererParameter;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <a class="code" href="namespacenn_1_1audio.html#a9eaff763648679c45d3360d717e28618">nn::audio::InitializeAudioRendererParameter</a>(&amp;audioRendererParameter);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    audioRendererParameter.sampleRate = 48000;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    audioRendererParameter.sampleCount = AudioFrameSampleCount;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    audioRendererParameter.mixBufferCount = 2;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    audioRendererParameter.voiceCount = channelCount;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    audioRendererParameter.sinkCount = 1;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <a class="code" href="nn___abort_8h.html#a5c1a90d3a6474658ae0ac5dc5bcb14e4">NN_ABORT_UNLESS</a>(<a class="code" href="namespacenn_1_1audio.html#a42518470ed50c8dd6b1395f3c55efeae">nn::audio::IsValidAudioRendererParameter</a>(audioRendererParameter));</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    std::size_t audioRendererWorkBufferSize = <a class="code" href="namespacenn_1_1audio.html#afcd51fa35997672709890d7274f303d4">nn::audio::GetAudioRendererWorkBufferSize</a>(audioRendererParameter);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordtype">void</span>* audioRendererWorkBuffer = allocator.Allocate(audioRendererWorkBufferSize, <a class="code" href="namespacenn_1_1os.html#ac880b46610757e748d5bd79211af4236">nn::os::MemoryPageSize</a>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a>(audioRendererWorkBuffer);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="structnn_1_1audio_1_1_audio_renderer_handle.html">nn::audio::AudioRendererHandle</a> audioRendererHandle;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="classnn_1_1os_1_1_system_event.html">nn::os::SystemEvent</a> systemEvent;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1audio.html#a855da5a3e7dd33233c653a7dd2db775a">nn::audio::OpenAudioRenderer</a>(&amp;audioRendererHandle, &amp;systemEvent, audioRendererParameter, audioRendererWorkBuffer, audioRendererWorkBufferSize));</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    std::size_t configBufferSize = <a class="code" href="namespacenn_1_1audio.html#a306899c2641a5b13daf5680a6f5d6430">nn::audio::GetAudioRendererConfigWorkBufferSize</a>(audioRendererParameter);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordtype">void</span>* configBuffer = allocator.Allocate(configBufferSize, <a class="code" href="namespacenn_1_1os.html#ac880b46610757e748d5bd79211af4236">nn::os::MemoryPageSize</a>);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a>(configBuffer);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="structnn_1_1audio_1_1_audio_renderer_config.html">nn::audio::AudioRendererConfig</a> config;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="namespacenn_1_1audio.html#a0fc7ed6656395abc8493f13abe2d04d0">nn::audio::InitializeAudioRendererConfig</a>(&amp;config, audioRendererParameter, configBuffer, configBufferSize);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="structnn_1_1audio_1_1_final_mix_type.html">nn::audio::FinalMixType</a> finalMix;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="namespacenn_1_1audio.html#abcc7c4eb06afe0673e8196edc23dd9f0">nn::audio::AcquireFinalMix</a>(&amp;config, &amp;finalMix, 2);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="structnn_1_1audio_1_1_device_sink_type.html">nn::audio::DeviceSinkType</a> sink;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    int8_t bus[2] = { 0, 1 };</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1audio.html#ae8e93a633168c40c9b716c88c49c5e47">nn::audio::AddDeviceSink</a>(&amp;config, &amp;sink, &amp;finalMix, bus, <span class="keyword">sizeof</span>(bus) / <span class="keyword">sizeof</span>(bus[0]), <span class="stringliteral">&quot;MainAudioOut&quot;</span>));</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// Prepare a memory pool to maintain the sample data added to WaveBuffer.</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="structnn_1_1audio_1_1_memory_pool_type.html">nn::audio::MemoryPoolType</a> pcmBufferMemoryPool;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="nn___abort_8h.html#a5c1a90d3a6474658ae0ac5dc5bcb14e4">NN_ABORT_UNLESS</a>(<a class="code" href="namespacenn_1_1audio.html#a8e7b32e31ba3ea6f61c00c752c3a90d0">nn::audio::AcquireMemoryPool</a>(&amp;config, &amp;pcmBufferMemoryPool, g_PcmBuffer, <span class="keyword">sizeof</span>(g_PcmBuffer)));</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="nn___abort_8h.html#a5c1a90d3a6474658ae0ac5dc5bcb14e4">NN_ABORT_UNLESS</a>(<a class="code" href="namespacenn_1_1audio.html#a5f9484edc9f1bae6e41933993fbe09dc">nn::audio::RequestAttachMemoryPool</a>(&amp;pcmBufferMemoryPool));</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="structnn_1_1audio_1_1_voice_type.html">nn::audio::VoiceType</a> voice;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="namespacenn_1_1audio.html#a3cc31617500698ba14f0d1d5e20b7668">nn::audio::AcquireVoiceSlot</a>(&amp;config, &amp;voice, sampleRate, channelCount, <a class="code" href="namespacenn_1_1audio.html#a2edc363ab06840fc2eaf2acb551bf0c1a28ddfdb7464233b0bd4fa406aff3e31a">nn::audio::SampleFormat_PcmInt16</a>, <a class="code" href="structnn_1_1audio_1_1_voice_type.html#a564e9b6aee6dcb119664adc4b9f22149">nn::audio::VoiceType::PriorityHighest</a>, <span class="keyword">nullptr</span>, 0);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="namespacenn_1_1audio.html#a82bfb03f43f4a2680f5ad7eff0967545">nn::audio::SetVoiceDestination</a>(&amp;config, &amp;voice, &amp;finalMix);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="namespacenn_1_1audio.html#a04a09b692d969f08155cf7f0f57d9ace">nn::audio::SetVoicePlayState</a>(&amp;voice, nn::audio::VoiceType::PlayState_Play);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="namespacenn_1_1audio.html#a9a74d5457b16f38d3271eb452dcec395">nn::audio::SetVoiceMixVolume</a>(&amp;voice, &amp;finalMix, 1.0f, 0, 0);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="namespacenn_1_1audio.html#a9a74d5457b16f38d3271eb452dcec395">nn::audio::SetVoiceMixVolume</a>(&amp;voice, &amp;finalMix, 1.0f, channelCount - 1, 1);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// Prepare buffers for streaming playback.</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">// Pass in buffers initialized to 0, which get filled with the results of decoding the Opus data as part of the main loop.</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="structnn_1_1audio_1_1_wave_buffer.html">nn::audio::WaveBuffer</a> waveBuffer[BufferCount];</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordtype">void</span>* pcmBuffer[BufferCount];</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; BufferCount; ++i)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        pcmBuffer[i] = pcmBufferAllocator.Allocate(pcmBufferSize, <a class="code" href="namespacenn_1_1audio.html#a61833f2e2cf0253e3054188e900315af">nn::audio::BufferAlignSize</a>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        std::memset(pcmBuffer[i], 0, pcmBufferSize);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        waveBuffer[i].<a class="code" href="structnn_1_1audio_1_1_wave_buffer.html#ad7ea254b8bcd4cfa996c2187969a1989">buffer</a> = pcmBuffer[i];</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        waveBuffer[i].<a class="code" href="structnn_1_1audio_1_1_wave_buffer.html#a0dd91dcb09e9ee27c717728270c0e3c3">size</a> = pcmBufferSize;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        waveBuffer[i].<a class="code" href="structnn_1_1audio_1_1_wave_buffer.html#af06a8f9b5986c743352b492c3bf5d911">startSampleOffset</a> = 0;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        waveBuffer[i].<a class="code" href="structnn_1_1audio_1_1_wave_buffer.html#a510857dab35b885cc45775d3ca0e2d9c">endSampleOffset</a> = sampleCountPerAudioProcessing;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        waveBuffer[i].<a class="code" href="structnn_1_1audio_1_1_wave_buffer.html#a8998952082859b6ab22549250fad5003">loop</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        waveBuffer[i].<a class="code" href="structnn_1_1audio_1_1_wave_buffer.html#a09535d7c451e0b53d0c1c4acba8af70d">isEndOfStream</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        waveBuffer[i].<a class="code" href="structnn_1_1audio_1_1_wave_buffer.html#a04b836718c60e740f6728d29ca686393">pContext</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        waveBuffer[i].<a class="code" href="structnn_1_1audio_1_1_wave_buffer.html#af5f4159c74e68b2339196b804a1dbbbf">contextSize</a> = 0;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <a class="code" href="namespacenn_1_1audio.html#aa58886eeb3fac72d6e84dcad5d2704df">nn::audio::AppendWaveBuffer</a>(&amp;voice, &amp;waveBuffer[i]);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">// Start the audio renderer.</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1audio.html#a2c0345ad13fb013d06f6cdb812a0a6fd">nn::audio::StartAudioRenderer</a>(audioRendererHandle));</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// #if defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">// Get the starting address for the WAV data and the size of that data.</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keyword">auto</span>* p = wav.GetPcmDataAddress();</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keyword">auto</span> sampleCountRemained = wav.GetSampleCountPerChannel();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordtype">int</span> bufferCount = BufferCount;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordtype">int</span> samplingCount = 0;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> packetCount = <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        (sampleCountRemained + std::max(sampleCountPerCodecProcessing, sampleCountPerAudioProcessing) - 1) / sampleCountPerCodecProcessing );</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keyword">auto</span> pEncodingScores = <span class="keyword">new</span> int64_t[packetCount];</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a>(pEncodingScores);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keyword">auto</span> pDecodingScores = <span class="keyword">new</span> int64_t[packetCount];</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a>(pDecodingScores);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keyword">const</span> std::size_t encodedDataSizeMaximum = <a class="code" href="namespacenn_1_1codec.html#adca7d12653ef7695e8ce6864d58f7011">nn::codec::OpusPacketSizeMaximum</a>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> encodeSampleCountMaximum = encoder.<a class="code" href="classnn_1_1codec_1_1_opus_encoder.html#a09865c4e5930369a1c9bc78d8974f68b">CalculateFrameSampleCount</a>(20000);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keyword">auto</span> encodedDataBuffer = <span class="keyword">new</span> uint8_t[encodedDataSizeMaximum];</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keyword">auto</span> inputDataBuffer = <span class="keyword">new</span> int16_t[encodeSampleCountMaximum * channelCount];</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">for</span> (;;)</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="preprocessor">#if defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        systemEvent.<a class="code" href="classnn_1_1os_1_1_system_event.html#a51c8560630f9760922b6e180b75a45b2">Wait</a>();</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1audio.html#ac555128156197608dfaeeb5e824780a6">nn::audio::RequestUpdateAudioRenderer</a>(audioRendererHandle, &amp;config));</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="comment">// If playback is complete for any buffers, start the Opus decoding process.</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> pReleasedWaveBuffer = <a class="code" href="namespacenn_1_1audio.html#ad4736cbcae273e050d01416a7625b0d8">nn::audio::GetReleasedWaveBuffer</a>(&amp;voice))</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <a class="code" href="structnn_1_1audio_1_1_wave_buffer.html">nn::audio::WaveBuffer</a>* pWaveBuffer = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            int16_t* pPcmBuffer = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; BufferCount; ++i)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                <span class="keywordflow">if</span> (pReleasedWaveBuffer == &amp;waveBuffer[i])</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                    pWaveBuffer = &amp;waveBuffer[i];</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                    pPcmBuffer = <span class="keyword">static_cast&lt;</span>int16_t*<span class="keyword">&gt;</span>(pcmBuffer[i]);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            int16_t* pPcmBuffer = g_PcmBuffer;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="comment">// If any data remains, start the decoding process.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <span class="keywordflow">if</span> (sampleCountRemained &gt; 0)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor">#if defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                <span class="keywordflow">for</span> ( <span class="keyword">auto</span> sampleCount = 0; sampleCount &lt; sampleCountPerAudioProcessing; sampleCount += sampleCountPerCodecProcessing)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    <span class="comment">// Encoding.</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> encodeSampleCount = sampleCountPerCodecProcessing;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                    std::size_t copySampleCount = encodeSampleCount;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                    <span class="comment">// Fractional processing.</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                    <span class="keywordflow">if</span> (sampleCountRemained &lt; encodeSampleCount)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                    {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                        copySampleCount = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(sampleCountRemained);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                        std::memset(inputDataBuffer, 0x0, <span class="keyword">sizeof</span>(int16_t) * channelCount * encodeSampleCount);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                    }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                    std::memcpy(inputDataBuffer, p, <span class="keyword">sizeof</span>(int16_t) * channelCount * copySampleCount);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                    std::size_t encodedDataSize = 0;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                    <span class="keyword">const</span> <span class="keyword">auto</span> perEncodeBase = <a class="code" href="namespacenn_1_1os.html#a79e29821bfb2b0c3a5c222488e90cc89">nn::os::GetSystemTick</a>();</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    <a class="code" href="nn___abort_8h.html#a93be5bd646d8b7f02fb8115c603a00c7">NN_ABORT_UNLESS_EQUAL</a>(</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                        <a class="code" href="namespacenn_1_1codec.html#a375cd42044f1aabca06eba955018b7d5af2becb927546cad0901fbc6ce2815d27">nn::codec::OpusResult_Success</a>,</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                        encoder.<a class="code" href="classnn_1_1codec_1_1_opus_encoder.html#a808ecd9e87c513626b5554b291a17f94">EncodeInterleaved</a>(</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                            &amp;encodedDataSize,</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                            encodedDataBuffer,</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                            encodedDataSizeMaximum,</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                            inputDataBuffer,</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                            encodeSampleCount)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                    );</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                    pEncodingScores[samplingCount] = (<a class="code" href="namespacenn_1_1os.html#a79e29821bfb2b0c3a5c222488e90cc89">nn::os::GetSystemTick</a>() - perEncodeBase).ToTimeSpan().GetNanoSeconds();</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                    p += encodeSampleCount * channelCount;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                    <span class="comment">// Decoding</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                    std::size_t consumed;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    <span class="keywordtype">int</span> outputSampleCount;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                    <span class="keyword">const</span> <span class="keyword">auto</span> perDecodeBase = <a class="code" href="namespacenn_1_1os.html#a79e29821bfb2b0c3a5c222488e90cc89">nn::os::GetSystemTick</a>();</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                    <a class="code" href="nn___abort_8h.html#a93be5bd646d8b7f02fb8115c603a00c7">NN_ABORT_UNLESS_EQUAL</a>(</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                        <a class="code" href="namespacenn_1_1codec.html#a375cd42044f1aabca06eba955018b7d5af2becb927546cad0901fbc6ce2815d27">nn::codec::OpusResult_Success</a>,</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                        decoder.<a class="code" href="classnn_1_1codec_1_1_opus_decoder.html#a63ce85f84facdd3256efc94e50b6ee4a">DecodeInterleaved</a>(&amp;consumed, &amp;outputSampleCount, pPcmBuffer, pcmBufferSize, encodedDataBuffer, encodedDataSize)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    );</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    pDecodingScores[samplingCount] = (<a class="code" href="namespacenn_1_1os.html#a79e29821bfb2b0c3a5c222488e90cc89">nn::os::GetSystemTick</a>() - perDecodeBase).ToTimeSpan().GetNanoSeconds();</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                    samplingCount++;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(consumed == encodedDataSize);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(outputSampleCount == encodeSampleCount);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    sampleCountRemained -= copySampleCount;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="preprocessor">#if defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    pPcmBuffer += outputSampleCount * channelCount;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="preprocessor">#if defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                pWaveBuffer-&gt;<a class="code" href="structnn_1_1audio_1_1_wave_buffer.html#a0dd91dcb09e9ee27c717728270c0e3c3">size</a> = sampleCountPerAudioProcessing * channelCount * <span class="keyword">sizeof</span>(int16_t);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                pWaveBuffer-&gt;<a class="code" href="structnn_1_1audio_1_1_wave_buffer.html#a510857dab35b885cc45775d3ca0e2d9c">endSampleOffset</a> = sampleCountPerAudioProcessing;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                pWaveBuffer-&gt;<a class="code" href="structnn_1_1audio_1_1_wave_buffer.html#a8998952082859b6ab22549250fad5003">loop</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                pWaveBuffer-&gt;<a class="code" href="structnn_1_1audio_1_1_wave_buffer.html#a09535d7c451e0b53d0c1c4acba8af70d">isEndOfStream</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                <a class="code" href="namespacenn_1_1audio.html#aa58886eeb3fac72d6e84dcad5d2704df">nn::audio::AppendWaveBuffer</a>(&amp;voice, pWaveBuffer);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="comment">// If no data remains, wait until playback of all the buffers is complete.</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (--bufferCount == 0)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="preprocessor">#if defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">// End measurement and compile the results.</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    CollectUpProcessingTime(processingTime + ProcessingId_Encoding, pEncodingScores, samplingCount);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    CollectUpProcessingTime(processingTime + ProcessingId_Decoding, pDecodingScores, samplingCount);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keyword">delete</span>[] pEncodingScores;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keyword">delete</span>[] pDecodingScores;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="preprocessor">#if defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">// Issue a request to detach the memory pools that were previously being used.</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="namespacenn_1_1audio.html#a1d5341a5f593894f840b218eb1929a3b">nn::audio::RequestDetachMemoryPool</a>(&amp;pcmBufferMemoryPool);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="comment">// Wait for the memory pools to be detached.</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="namespacenn_1_1audio.html#a84f83d98dfc603829790bb0fbce67549">nn::audio::IsMemoryPoolAttached</a>(&amp;pcmBufferMemoryPool))</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <a class="code" href="namespacenn_1_1audio.html#ad4736cbcae273e050d01416a7625b0d8">nn::audio::GetReleasedWaveBuffer</a>(&amp;voice);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        systemEvent.<a class="code" href="classnn_1_1os_1_1_system_event.html#a51c8560630f9760922b6e180b75a45b2">Wait</a>();</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1audio.html#ac555128156197608dfaeeb5e824780a6">nn::audio::RequestUpdateAudioRenderer</a>(audioRendererHandle, &amp;config));</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">// Release MemoryPool.</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <a class="code" href="namespacenn_1_1audio.html#a2bf0ab532748ef3c8f6d127f1800ec1b">nn::audio::ReleaseMemoryPool</a>(&amp;config, &amp;pcmBufferMemoryPool);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">// Release the buffers.</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; BufferCount; ++i)</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        pcmBufferAllocator.Free(pcmBuffer[i]);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">// Finalize the audio renderer, and free the memory.</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="namespacenn_1_1audio.html#a7590b47d3fcdb9d6b48d1b41184336a6">nn::audio::StopAudioRenderer</a>(audioRendererHandle);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="namespacenn_1_1audio.html#ac008e23e04fb6c5efbb8796dd2aa9f38">nn::audio::CloseAudioRenderer</a>(audioRendererHandle);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <a class="code" href="namespacenn_1_1os.html#a3d924bc362ec80648323428be5182338">nn::os::DestroySystemEvent</a>(systemEvent.<a class="code" href="classnn_1_1os_1_1_system_event.html#a27b971688da923a2eac49061327552fe">GetBase</a>());</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    allocator.Free(audioRendererWorkBuffer);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    allocator.Free(configBuffer);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// #if defined(ENABLE_PLAY)</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="comment">// Terminate the Opus codec and destroy the memory.</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    decoder.<a class="code" href="classnn_1_1codec_1_1_opus_decoder.html#a34d86d9b409776d31c8fbabed79fc40c">Finalize</a>();</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    std::free(workBufferForDecoder);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    encoder.<a class="code" href="classnn_1_1codec_1_1_opus_encoder.html#ae5b663961cc9013798ddaf19748b531e">Finalize</a>();</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    std::free(workBufferForEncoder);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keyword">delete</span>[] encodedDataBuffer;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keyword">delete</span>[] inputDataBuffer;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;}  <span class="comment">// NOLINT(readability/fn_size)</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> nnMain()</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;{</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="preprocessor">#ifdef USE_HARDWARE_DECODER</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    NNS_LOG(<span class="stringliteral">&quot;CodecOpusCodecProcessingTime sample (using nn::codec::HardwareOpusDecoder)\n&quot;</span>);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="preprocessor">#else  </span><span class="comment">// USE_HARDWARE_DECODER</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    NNS_LOG(<span class="stringliteral">&quot;CodecOpusCodecProcessingTime sample (using nn::codec::OpusDecoder)\n&quot;</span>);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="preprocessor">#endif  </span><span class="comment">// USE_HARDWARE_DECODER</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="comment">// Initialize the file system.</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    InitializeFileSystem();</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <a class="code" href="structnn_1_1fs_1_1_directory_handle.html">nn::fs::DirectoryHandle</a> directoryHandle;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1fs.html#acae21d0f79e4d074e120c814a8936a42">nn::fs::OpenDirectory</a>(&amp;directoryHandle, (GetMountPointRom() + <span class="stringliteral">&quot;:/&quot;</span>).c_str(), <a class="code" href="namespacenn_1_1fs.html#a34bc03cdbe641524cab284a7fe7ba705a560a621c8b1cb6f228ea202b9efd7432">nn::fs::OpenDirectoryMode_File</a>));</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    int64_t entryCount;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1fs.html#aa6a54b0d39dfd293b11cd1c0073aafb1">nn::fs::GetDirectoryEntryCount</a>(&amp;entryCount, directoryHandle));</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keyword">auto</span> entries = <span class="keyword">new</span> <a class="code" href="structnn_1_1fs_1_1_directory_entry.html">nn::fs::DirectoryEntry</a>[<span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>(entryCount)];</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a>(entries);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    int64_t tmp;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1fs.html#af1ecb9478fe0f9dee627b65111cdbe29">nn::fs::ReadDirectory</a>(&amp;tmp, entries, directoryHandle, entryCount));</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <a class="code" href="nn___abort_8h.html#a5c1a90d3a6474658ae0ac5dc5bcb14e4">NN_ABORT_UNLESS</a>(tmp == entryCount);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">// Export result labels.</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    NNS_LOG(<span class="stringliteral">&quot;%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s\n&quot;</span>,</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <span class="stringliteral">&quot;SampleRate&quot;</span>,</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="stringliteral">&quot;ChannelCount&quot;</span>,</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="stringliteral">&quot;FrameDuration&quot;</span>,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="stringliteral">&quot;BitRate&quot;</span>,</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <span class="stringliteral">&quot;CodingMode&quot;</span>,</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="stringliteral">&quot;Count&quot;</span>,</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="stringliteral">&quot;Total (Encoder)&quot;</span>,</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <span class="stringliteral">&quot;Average (Encoder)&quot;</span>,</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="stringliteral">&quot;Minimum (Encoder)&quot;</span>,</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="stringliteral">&quot;Maximum (Encoder)&quot;</span>,</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="stringliteral">&quot;StandardDeviation (Encoder)&quot;</span>,</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="stringliteral">&quot;Total (Decoder)&quot;</span>,</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="stringliteral">&quot;Average (Decoder)&quot;</span>,</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="stringliteral">&quot;Minimum (Decoder)&quot;</span>,</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="stringliteral">&quot;Maximum (Decoder)&quot;</span>,</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="stringliteral">&quot;StandardDeviation (Decoder)&quot;</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    );</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; entryCount; ++i)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="comment">// Open input/output files.</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="keyword">struct </span>ProcessingTime processingTime[ProcessingId_Count];</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <a class="code" href="nn___abort_8h.html#a93be5bd646d8b7f02fb8115c603a00c7">NN_ABORT_UNLESS_EQUAL</a>(entries[i].directoryEntryType, <a class="code" href="namespacenn_1_1fs.html#a5fc46cd05067c210b62e96f903a2fe85a194470d850d5968a491fd9ef6145d5a0">nn::fs::DirectoryEntryType_File</a>);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="comment">// Load WAV data.</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        Wav wav;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keyword">const</span> std::string filePath = GetMountPointRom() + <span class="stringliteral">&quot;:/&quot;</span> + entries[i].name;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        wav.Load(filePath.c_str());</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> codingMode : CodingModes)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> bitRate : BitRates)</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> frameDuration : FrameDurations)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                    <span class="keyword">const</span> <span class="keyword">struct </span>CodecParameterSet parameterSet =</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                    {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                        frameDuration,</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                        bitRate,</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                        <a class="code" href="namespacenn_1_1codec.html#a3a2d885fcb1cff929552d0a81ba26872ac5c2fb789093ec4453f359a69b50282d">nn::codec::OpusBitRateControl_Vbr</a>,</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                        codingMode,</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                    };</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                    <span class="comment">// Skip unsupported frames.</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                    <span class="keywordflow">if</span> (codingMode == <a class="code" href="namespacenn_1_1codec.html#a9b257771e1088b6cba2836bbe3a53ccfabe6634ee1371b268050b40b8abacb259">nn::codec::OpusCodingMode_Silk</a> &amp;&amp; frameDuration &lt; 10000)</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                    {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                    }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    EvaluateOpusProcessingPerformance(processingTime, wav, parameterSet);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                    <span class="comment">// Export results for each attempt.</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(ProcessingId_Encoding);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    NNS_LOG(<span class="stringliteral">&quot;%d,%d,%.1f,%d,%s,%d,%.3f,%.3f,%.3f,%.3f,%.3f,%.3f,%.3f,%.3f,%.3f,%.3f\n&quot;</span>,</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                        wav.GetSampleRate(),</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                        wav.GetChannelCount(),</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                        <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(frameDuration) / 1000.0,</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                        bitRate,</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                        codingMode == <a class="code" href="namespacenn_1_1codec.html#a9b257771e1088b6cba2836bbe3a53ccfa1ab64f14137951c75d53c073bbdfaa70">nn::codec::OpusCodingMode_Celt</a> ? <span class="stringliteral">&quot;Celt&quot;</span> : <span class="stringliteral">&quot;Silk&quot;</span>,</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                        processingTime[<span class="keywordtype">id</span>].iterationCount,</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                        processingTime[<span class="keywordtype">id</span>].total,</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                        processingTime[<span class="keywordtype">id</span>].average,</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                        processingTime[<span class="keywordtype">id</span>].minimum,</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                        processingTime[<span class="keywordtype">id</span>].maximum,</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                        processingTime[<span class="keywordtype">id</span>].standardDeviation,</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                        processingTime[<span class="keywordtype">id</span> + 1].total,</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                        processingTime[<span class="keywordtype">id</span> + 1].average,</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                        processingTime[<span class="keywordtype">id</span> + 1].minimum,</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                        processingTime[<span class="keywordtype">id</span> + 1].maximum,</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                        processingTime[<span class="keywordtype">id</span> + 1].standardDeviation</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                    );</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            }</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keyword">delete</span>[] entries;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="namespacenn_1_1fs.html#af8d0fa5050c0f77a0a6f14a0b78f9b58">nn::fs::CloseDirectory</a>(directoryHandle);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">// Finalize the file system.</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    FinalizeFileSystem();</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;}</div>
<div class="ttc" id="aaudio_8h_html"><div class="ttname"><a href="audio_8h.html">audio.h</a></div><div class="ttdoc">Declarations for the audio library API.</div></div>
<div class="ttc" id="aclassnn_1_1codec_1_1_hardware_opus_decoder_html"><div class="ttname"><a href="classnn_1_1codec_1_1_hardware_opus_decoder.html">nn::codec::HardwareOpusDecoder</a></div><div class="ttdoc">The Opus decoder class for hardware use.</div><div class="ttdef"><b>Definition:</b> codec_HardwareOpusDecoder.h:39</div></div>
<div class="ttc" id="aclassnn_1_1codec_1_1_opus_decoder_html"><div class="ttname"><a href="classnn_1_1codec_1_1_opus_decoder.html">nn::codec::OpusDecoder</a></div><div class="ttdoc">The OPUS decoder class.</div><div class="ttdef"><b>Definition:</b> codec_OpusDecoder.h:39</div></div>
<div class="ttc" id="aclassnn_1_1codec_1_1_opus_decoder_html_a07947768528b08c6c40421c5119c0b6e"><div class="ttname"><a href="classnn_1_1codec_1_1_opus_decoder.html#a07947768528b08c6c40421c5119c0b6e">nn::codec::OpusDecoder::Initialize</a></div><div class="ttdeci">virtual OpusResult Initialize(int sampleRate, int channelCount, void *buffer, size_t size) noexcept NN_OVERRIDE</div><div class="ttdoc">Initializes the decoder.</div></div>
<div class="ttc" id="aclassnn_1_1codec_1_1_opus_decoder_html_a34d86d9b409776d31c8fbabed79fc40c"><div class="ttname"><a href="classnn_1_1codec_1_1_opus_decoder.html#a34d86d9b409776d31c8fbabed79fc40c">nn::codec::OpusDecoder::Finalize</a></div><div class="ttdeci">virtual void Finalize() noexcept NN_OVERRIDE</div><div class="ttdoc">Finalizes.</div></div>
<div class="ttc" id="aclassnn_1_1codec_1_1_opus_decoder_html_a63ce85f84facdd3256efc94e50b6ee4a"><div class="ttname"><a href="classnn_1_1codec_1_1_opus_decoder.html#a63ce85f84facdd3256efc94e50b6ee4a">nn::codec::OpusDecoder::DecodeInterleaved</a></div><div class="ttdeci">virtual OpusResult DecodeInterleaved(size_t *pOutConsumed, int *pOutSampleCount, int16_t *outputBuffer, size_t outputSize, const void *inputBuffer, size_t inputSize) noexcept NN_OVERRIDE</div><div class="ttdoc">Decodes one frame of data, and gets interleaved PCM data.</div><div class="ttdef"><b>Definition:</b> codec_OpusDecoder.h:126</div></div>
<div class="ttc" id="aclassnn_1_1codec_1_1_opus_decoder_html_ad2fd272c7a8f639c42537528ffe3ac7e"><div class="ttname"><a href="classnn_1_1codec_1_1_opus_decoder.html#ad2fd272c7a8f639c42537528ffe3ac7e">nn::codec::OpusDecoder::GetWorkBufferSize</a></div><div class="ttdeci">virtual size_t GetWorkBufferSize(int sampleRate, int channelCount) const noexcept NN_OVERRIDE</div><div class="ttdoc">Gets the required working buffer size.</div><div class="ttdef"><b>Definition:</b> codec_OpusDecoder.h:59</div></div>
<div class="ttc" id="aclassnn_1_1codec_1_1_opus_encoder_html"><div class="ttname"><a href="classnn_1_1codec_1_1_opus_encoder.html">nn::codec::OpusEncoder</a></div><div class="ttdoc">The Opus encoder class.</div><div class="ttdef"><b>Definition:</b> codec_OpusEncoder.h:39</div></div>
<div class="ttc" id="aclassnn_1_1codec_1_1_opus_encoder_html_a09865c4e5930369a1c9bc78d8974f68b"><div class="ttname"><a href="classnn_1_1codec_1_1_opus_encoder.html#a09865c4e5930369a1c9bc78d8974f68b">nn::codec::OpusEncoder::CalculateFrameSampleCount</a></div><div class="ttdeci">virtual int CalculateFrameSampleCount(int frame) const noexcept NN_OVERRIDE</div><div class="ttdoc">Calculates the number of samples from frames.</div><div class="ttdef"><b>Definition:</b> codec_OpusEncoder.h:255</div></div>
<div class="ttc" id="aclassnn_1_1codec_1_1_opus_encoder_html_a3823391fd8fe523bcd4a38bf64cc32f7"><div class="ttname"><a href="classnn_1_1codec_1_1_opus_encoder.html#a3823391fd8fe523bcd4a38bf64cc32f7">nn::codec::OpusEncoder::GetWorkBufferSize</a></div><div class="ttdeci">size_t GetWorkBufferSize(int sampleRate, int channelCount) const noexcept NN_OVERRIDE</div><div class="ttdoc">Gets the required working buffer size.</div><div class="ttdef"><b>Definition:</b> codec_OpusEncoder.h:60</div></div>
<div class="ttc" id="aclassnn_1_1codec_1_1_opus_encoder_html_a681914112f2a26b502668c5b1a6150c7"><div class="ttname"><a href="classnn_1_1codec_1_1_opus_encoder.html#a681914112f2a26b502668c5b1a6150c7">nn::codec::OpusEncoder::BindCodingMode</a></div><div class="ttdeci">virtual void BindCodingMode(OpusCodingMode codingMode) noexcept NN_OVERRIDE</div><div class="ttdoc">Sets the encryption mode.</div><div class="ttdef"><b>Definition:</b> codec_OpusEncoder.h:232</div></div>
<div class="ttc" id="aclassnn_1_1codec_1_1_opus_encoder_html_a808ecd9e87c513626b5554b291a17f94"><div class="ttname"><a href="classnn_1_1codec_1_1_opus_encoder.html#a808ecd9e87c513626b5554b291a17f94">nn::codec::OpusEncoder::EncodeInterleaved</a></div><div class="ttdeci">virtual OpusResult EncodeInterleaved(size_t *pOutputSize, void *outputBuffer, size_t outputBufferSize, const int16_t *inputBuffer, int inputSampleCountPerChannel) noexcept NN_OVERRIDE</div><div class="ttdoc">Encodes one frame of interleaved PCM data and gets the Opus data.</div><div class="ttdef"><b>Definition:</b> codec_OpusEncoder.h:153</div></div>
<div class="ttc" id="aclassnn_1_1codec_1_1_opus_encoder_html_ab0b21bd4737f260008ae8dfdadfdd03a"><div class="ttname"><a href="classnn_1_1codec_1_1_opus_encoder.html#ab0b21bd4737f260008ae8dfdadfdd03a">nn::codec::OpusEncoder::SetBitRateControl</a></div><div class="ttdeci">virtual void SetBitRateControl(OpusBitRateControl bitRateControl) noexcept NN_OVERRIDE</div><div class="ttdoc">Sets the bit rate control.</div><div class="ttdef"><b>Definition:</b> codec_OpusEncoder.h:186</div></div>
<div class="ttc" id="aclassnn_1_1codec_1_1_opus_encoder_html_ad97a6bd5bb9799a718b1bdaba7ac34b8"><div class="ttname"><a href="classnn_1_1codec_1_1_opus_encoder.html#ad97a6bd5bb9799a718b1bdaba7ac34b8">nn::codec::OpusEncoder::SetBitRate</a></div><div class="ttdeci">virtual void SetBitRate(int bitRate) noexcept NN_OVERRIDE</div><div class="ttdoc">Sets the bit rate.</div><div class="ttdef"><b>Definition:</b> codec_OpusEncoder.h:164</div></div>
<div class="ttc" id="aclassnn_1_1codec_1_1_opus_encoder_html_adee7bf9f60139e169535f3214bdf2fc7"><div class="ttname"><a href="classnn_1_1codec_1_1_opus_encoder.html#adee7bf9f60139e169535f3214bdf2fc7">nn::codec::OpusEncoder::Initialize</a></div><div class="ttdeci">virtual OpusResult Initialize(int sampleRate, int channelCount, void *buffer, size_t size) noexcept NN_OVERRIDE</div><div class="ttdoc">Initializes the encoder.</div></div>
<div class="ttc" id="aclassnn_1_1codec_1_1_opus_encoder_html_ae5b663961cc9013798ddaf19748b531e"><div class="ttname"><a href="classnn_1_1codec_1_1_opus_encoder.html#ae5b663961cc9013798ddaf19748b531e">nn::codec::OpusEncoder::Finalize</a></div><div class="ttdeci">virtual void Finalize() noexcept NN_OVERRIDE</div><div class="ttdoc">Finalizes.</div><div class="ttdef"><b>Definition:</b> codec_OpusEncoder.h:105</div></div>
<div class="ttc" id="aclassnn_1_1mem_1_1_standard_allocator_html"><div class="ttname"><a href="classnn_1_1mem_1_1_standard_allocator.html">nn::mem::StandardAllocator</a></div><div class="ttdoc">Class for managing memory.</div><div class="ttdef"><b>Definition:</b> mem_StandardAllocator.h:35</div></div>
<div class="ttc" id="aclassnn_1_1os_1_1_system_event_html"><div class="ttname"><a href="classnn_1_1os_1_1_system_event.html">nn::os::SystemEvent</a></div><div class="ttdoc">Class for handling system events.</div><div class="ttdef"><b>Definition:</b> os_SystemEvent.h:46</div></div>
<div class="ttc" id="aclassnn_1_1os_1_1_system_event_html_a27b971688da923a2eac49061327552fe"><div class="ttname"><a href="classnn_1_1os_1_1_system_event.html#a27b971688da923a2eac49061327552fe">nn::os::SystemEvent::GetBase</a></div><div class="ttdeci">SystemEventType * GetBase() NN_NOEXCEPT</div><div class="ttdoc">Gets a pointer to this instance's SystemEventType object.</div><div class="ttdef"><b>Definition:</b> os_SystemEvent.h:389</div></div>
<div class="ttc" id="aclassnn_1_1os_1_1_system_event_html_a51c8560630f9760922b6e180b75a45b2"><div class="ttname"><a href="classnn_1_1os_1_1_system_event.html#a51c8560630f9760922b6e180b75a45b2">nn::os::SystemEvent::Wait</a></div><div class="ttdeci">void Wait() NN_NOEXCEPT</div><div class="ttdoc">Waits for a system event to enter a signaled state.</div><div class="ttdef"><b>Definition:</b> os_SystemEvent.h:244</div></div>
<div class="ttc" id="acodec_8h_html"><div class="ttname"><a href="codec_8h.html">codec.h</a></div><div class="ttdoc">Declarations for the codec library API for audio and video compression.</div></div>
<div class="ttc" id="acodec___opus_encoder_8h_html"><div class="ttname"><a href="codec___opus_encoder_8h.html">codec_OpusEncoder.h</a></div><div class="ttdoc">Defines API resources for encoding Opus data.</div></div>
<div class="ttc" id="afs_8h_html"><div class="ttname"><a href="fs_8h.html">fs.h</a></div><div class="ttdoc">Declarations of API resources for the file system.</div></div>
<div class="ttc" id="amem_8h_html"><div class="ttname"><a href="mem_8h.html">mem.h</a></div><div class="ttdoc">Header to include the dynamic memory allocation library for fast allocation and deallocation.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a04a09b692d969f08155cf7f0f57d9ace"><div class="ttname"><a href="namespacenn_1_1audio.html#a04a09b692d969f08155cf7f0f57d9ace">nn::audio::SetVoicePlayState</a></div><div class="ttdeci">void SetVoicePlayState(VoiceType *pVoice, VoiceType::PlayState playState) noexcept</div><div class="ttdoc">Sets the play state for the VoiceType object.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a0fc7ed6656395abc8493f13abe2d04d0"><div class="ttname"><a href="namespacenn_1_1audio.html#a0fc7ed6656395abc8493f13abe2d04d0">nn::audio::InitializeAudioRendererConfig</a></div><div class="ttdeci">void InitializeAudioRendererConfig(AudioRendererConfig *pOutConfig, const AudioRendererParameter &amp;parameter, void *buffer, size_t size) noexcept</div><div class="ttdoc">Initialize AudioRendererConfig.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a1d5341a5f593894f840b218eb1929a3b"><div class="ttname"><a href="namespacenn_1_1audio.html#a1d5341a5f593894f840b218eb1929a3b">nn::audio::RequestDetachMemoryPool</a></div><div class="ttdeci">bool RequestDetachMemoryPool(MemoryPoolType *pPool) noexcept</div><div class="ttdoc">Detaches a memory pool from an audio renderer.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a2bf0ab532748ef3c8f6d127f1800ec1b"><div class="ttname"><a href="namespacenn_1_1audio.html#a2bf0ab532748ef3c8f6d127f1800ec1b">nn::audio::ReleaseMemoryPool</a></div><div class="ttdeci">void ReleaseMemoryPool(AudioRendererConfig *pOutConfig, MemoryPoolType *pPool) noexcept</div><div class="ttdoc">Deletes a memory pool that was created for an audio renderer.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a2c0345ad13fb013d06f6cdb812a0a6fd"><div class="ttname"><a href="namespacenn_1_1audio.html#a2c0345ad13fb013d06f6cdb812a0a6fd">nn::audio::StartAudioRenderer</a></div><div class="ttdeci">nn::Result StartAudioRenderer(AudioRendererHandle handle) noexcept</div><div class="ttdoc">Starts rendering with the audio renderer.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a2edc363ab06840fc2eaf2acb551bf0c1a28ddfdb7464233b0bd4fa406aff3e31a"><div class="ttname"><a href="namespacenn_1_1audio.html#a2edc363ab06840fc2eaf2acb551bf0c1a28ddfdb7464233b0bd4fa406aff3e31a">nn::audio::SampleFormat_PcmInt16</a></div><div class="ttdeci">@ SampleFormat_PcmInt16</div><div class="ttdoc">16-bit signed integer PCM format.</div><div class="ttdef"><b>Definition:</b> audio_SampleFormat.h:34</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a306899c2641a5b13daf5680a6f5d6430"><div class="ttname"><a href="namespacenn_1_1audio.html#a306899c2641a5b13daf5680a6f5d6430">nn::audio::GetAudioRendererConfigWorkBufferSize</a></div><div class="ttdeci">size_t GetAudioRendererConfigWorkBufferSize(const AudioRendererParameter &amp;parameter) noexcept</div><div class="ttdoc">Gets the size of the work buffer required to initialize AudioRendererConfig.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a3cc31617500698ba14f0d1d5e20b7668"><div class="ttname"><a href="namespacenn_1_1audio.html#a3cc31617500698ba14f0d1d5e20b7668">nn::audio::AcquireVoiceSlot</a></div><div class="ttdeci">bool AcquireVoiceSlot(AudioRendererConfig *pOutConfig, VoiceType *pOutVoice, int sampleRate, int channelCount, SampleFormat sampleFormat, int priority, const void *pParameter, size_t size, const VoiceType::BehaviorOptions *pBehaviorOptions) noexcept</div><div class="ttdoc">Initializes VoiceType with options that specify its behavior and adds it to AudioRendererConfig.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a42518470ed50c8dd6b1395f3c55efeae"><div class="ttname"><a href="namespacenn_1_1audio.html#a42518470ed50c8dd6b1395f3c55efeae">nn::audio::IsValidAudioRendererParameter</a></div><div class="ttdeci">bool IsValidAudioRendererParameter(const AudioRendererParameter &amp;parameter) noexcept</div><div class="ttdoc">Determines whether the audio renderer parameter is valid.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a5f9484edc9f1bae6e41933993fbe09dc"><div class="ttname"><a href="namespacenn_1_1audio.html#a5f9484edc9f1bae6e41933993fbe09dc">nn::audio::RequestAttachMemoryPool</a></div><div class="ttdeci">bool RequestAttachMemoryPool(MemoryPoolType *pPool) noexcept</div><div class="ttdoc">Attaches a memory pool to an audio renderer.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a61833f2e2cf0253e3054188e900315af"><div class="ttname"><a href="namespacenn_1_1audio.html#a61833f2e2cf0253e3054188e900315af">nn::audio::BufferAlignSize</a></div><div class="ttdeci">constexpr int BufferAlignSize</div><div class="ttdoc">The alignment size for audio buffers.</div><div class="ttdef"><b>Definition:</b> audio_Common.h:28</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a7590b47d3fcdb9d6b48d1b41184336a6"><div class="ttname"><a href="namespacenn_1_1audio.html#a7590b47d3fcdb9d6b48d1b41184336a6">nn::audio::StopAudioRenderer</a></div><div class="ttdeci">void StopAudioRenderer(AudioRendererHandle handle) noexcept</div><div class="ttdoc">Stops rendering with the audio renderer.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a82bfb03f43f4a2680f5ad7eff0967545"><div class="ttname"><a href="namespacenn_1_1audio.html#a82bfb03f43f4a2680f5ad7eff0967545">nn::audio::SetVoiceDestination</a></div><div class="ttdeci">void SetVoiceDestination(AudioRendererConfig *pOutConfig, VoiceType *pSource, FinalMixType *pDestination) noexcept</div><div class="ttdoc">Sets the FinalMix that is the output destination of the VoiceType.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a84f83d98dfc603829790bb0fbce67549"><div class="ttname"><a href="namespacenn_1_1audio.html#a84f83d98dfc603829790bb0fbce67549">nn::audio::IsMemoryPoolAttached</a></div><div class="ttdeci">bool IsMemoryPoolAttached(const MemoryPoolType *pPool) noexcept</div><div class="ttdoc">Determines whether a memory pool is currently attached.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a855da5a3e7dd33233c653a7dd2db775a"><div class="ttname"><a href="namespacenn_1_1audio.html#a855da5a3e7dd33233c653a7dd2db775a">nn::audio::OpenAudioRenderer</a></div><div class="ttdeci">nn::Result OpenAudioRenderer(AudioRendererHandle *outHandle, const AudioRendererParameter &amp;parameter, void *workBuffer, size_t workBufferSize) noexcept</div><div class="ttdoc">Gets the audio renderer.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a8e7b32e31ba3ea6f61c00c752c3a90d0"><div class="ttname"><a href="namespacenn_1_1audio.html#a8e7b32e31ba3ea6f61c00c752c3a90d0">nn::audio::AcquireMemoryPool</a></div><div class="ttdeci">bool AcquireMemoryPool(AudioRendererConfig *pOutConfig, MemoryPoolType *pOutPool, void *address, size_t size) noexcept</div><div class="ttdoc">Gets a memory pool for an audio renderer.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a9a74d5457b16f38d3271eb452dcec395"><div class="ttname"><a href="namespacenn_1_1audio.html#a9a74d5457b16f38d3271eb452dcec395">nn::audio::SetVoiceMixVolume</a></div><div class="ttdeci">void SetVoiceMixVolume(VoiceType *pSource, FinalMixType *pDestination, float volume, int sourceIndex, int destinationIndex) noexcept</div><div class="ttdoc">Sets the mix volume for the VoiceType object.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_a9eaff763648679c45d3360d717e28618"><div class="ttname"><a href="namespacenn_1_1audio.html#a9eaff763648679c45d3360d717e28618">nn::audio::InitializeAudioRendererParameter</a></div><div class="ttdeci">void InitializeAudioRendererParameter(AudioRendererParameter *pOutParameter) noexcept</div><div class="ttdoc">Initializes the audio renderer parameters.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_aa58886eeb3fac72d6e84dcad5d2704df"><div class="ttname"><a href="namespacenn_1_1audio.html#aa58886eeb3fac72d6e84dcad5d2704df">nn::audio::AppendWaveBuffer</a></div><div class="ttdeci">bool AppendWaveBuffer(VoiceType *pVoice, const WaveBuffer *pWaveBuffer) noexcept</div><div class="ttdoc">Adds a WaveBuffer object to VoiceType.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_abcc7c4eb06afe0673e8196edc23dd9f0"><div class="ttname"><a href="namespacenn_1_1audio.html#abcc7c4eb06afe0673e8196edc23dd9f0">nn::audio::AcquireFinalMix</a></div><div class="ttdeci">bool AcquireFinalMix(AudioRendererConfig *pOutConfig, FinalMixType *pOutFinalMix, int bufferCount) noexcept</div><div class="ttdoc">Initializes FinalMixType and adds it to the AudioRendererConfig.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_ac008e23e04fb6c5efbb8796dd2aa9f38"><div class="ttname"><a href="namespacenn_1_1audio.html#ac008e23e04fb6c5efbb8796dd2aa9f38">nn::audio::CloseAudioRenderer</a></div><div class="ttdeci">void CloseAudioRenderer(AudioRendererHandle handle) noexcept</div><div class="ttdoc">Frees the audio renderer.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_ac555128156197608dfaeeb5e824780a6"><div class="ttname"><a href="namespacenn_1_1audio.html#ac555128156197608dfaeeb5e824780a6">nn::audio::RequestUpdateAudioRenderer</a></div><div class="ttdeci">nn::Result RequestUpdateAudioRenderer(AudioRendererHandle handle, const AudioRendererConfig *pConfig) noexcept</div><div class="ttdoc">Updates the parameters for Voice objects bound to the audio renderer.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_ad4736cbcae273e050d01416a7625b0d8"><div class="ttname"><a href="namespacenn_1_1audio.html#ad4736cbcae273e050d01416a7625b0d8">nn::audio::GetReleasedWaveBuffer</a></div><div class="ttdeci">const WaveBuffer * GetReleasedWaveBuffer(VoiceType *pVoice) noexcept</div><div class="ttdoc">Get the WaveBuffer object that VoiceType has finished playing.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_ae8e93a633168c40c9b716c88c49c5e47"><div class="ttname"><a href="namespacenn_1_1audio.html#ae8e93a633168c40c9b716c88c49c5e47">nn::audio::AddDeviceSink</a></div><div class="ttdeci">Result AddDeviceSink(AudioRendererConfig *pOutConfig, DeviceSinkType *pOutSink, FinalMixType *pFinalMix, const int8_t *input, int inputCount, const char *name) noexcept</div><div class="ttdoc">Initializes a sink for the audio output device.</div></div>
<div class="ttc" id="anamespacenn_1_1audio_html_afcd51fa35997672709890d7274f303d4"><div class="ttname"><a href="namespacenn_1_1audio.html#afcd51fa35997672709890d7274f303d4">nn::audio::GetAudioRendererWorkBufferSize</a></div><div class="ttdeci">size_t GetAudioRendererWorkBufferSize(const AudioRendererParameter &amp;parameter) noexcept</div><div class="ttdoc">Gets the size of the working buffer required to open an audio renderer.</div></div>
<div class="ttc" id="anamespacenn_1_1codec_html_a375cd42044f1aabca06eba955018b7d5af2becb927546cad0901fbc6ce2815d27"><div class="ttname"><a href="namespacenn_1_1codec.html#a375cd42044f1aabca06eba955018b7d5af2becb927546cad0901fbc6ce2815d27">nn::codec::OpusResult_Success</a></div><div class="ttdeci">@ OpusResult_Success</div><div class="ttdoc">Success.</div><div class="ttdef"><b>Definition:</b> codec_OpusCommonTypes.h:52</div></div>
<div class="ttc" id="anamespacenn_1_1codec_html_a3a2d885fcb1cff929552d0a81ba26872"><div class="ttname"><a href="namespacenn_1_1codec.html#a3a2d885fcb1cff929552d0a81ba26872">nn::codec::OpusBitRateControl</a></div><div class="ttdeci">OpusBitRateControl</div><div class="ttdoc">Enumerated type representing the bitrate controls used by the Opus encoder.</div><div class="ttdef"><b>Definition:</b> codec_OpusEncoderTypes.h:63</div></div>
<div class="ttc" id="anamespacenn_1_1codec_html_a3a2d885fcb1cff929552d0a81ba26872ac5c2fb789093ec4453f359a69b50282d"><div class="ttname"><a href="namespacenn_1_1codec.html#a3a2d885fcb1cff929552d0a81ba26872ac5c2fb789093ec4453f359a69b50282d">nn::codec::OpusBitRateControl_Vbr</a></div><div class="ttdeci">@ OpusBitRateControl_Vbr</div><div class="ttdoc">Variable bit rate.</div><div class="ttdef"><b>Definition:</b> codec_OpusEncoderTypes.h:64</div></div>
<div class="ttc" id="anamespacenn_1_1codec_html_a9b257771e1088b6cba2836bbe3a53ccf"><div class="ttname"><a href="namespacenn_1_1codec.html#a9b257771e1088b6cba2836bbe3a53ccf">nn::codec::OpusCodingMode</a></div><div class="ttdeci">OpusCodingMode</div><div class="ttdoc">Enumerated type representing the encryption mode handled by the Opus encoder.</div><div class="ttdef"><b>Definition:</b> codec_OpusEncoderTypes.h:74</div></div>
<div class="ttc" id="anamespacenn_1_1codec_html_a9b257771e1088b6cba2836bbe3a53ccfa1ab64f14137951c75d53c073bbdfaa70"><div class="ttname"><a href="namespacenn_1_1codec.html#a9b257771e1088b6cba2836bbe3a53ccfa1ab64f14137951c75d53c073bbdfaa70">nn::codec::OpusCodingMode_Celt</a></div><div class="ttdeci">@ OpusCodingMode_Celt</div><div class="ttdoc">Celt.</div><div class="ttdef"><b>Definition:</b> codec_OpusEncoderTypes.h:76</div></div>
<div class="ttc" id="anamespacenn_1_1codec_html_a9b257771e1088b6cba2836bbe3a53ccfabe6634ee1371b268050b40b8abacb259"><div class="ttname"><a href="namespacenn_1_1codec.html#a9b257771e1088b6cba2836bbe3a53ccfabe6634ee1371b268050b40b8abacb259">nn::codec::OpusCodingMode_Silk</a></div><div class="ttdeci">@ OpusCodingMode_Silk</div><div class="ttdoc">Silk.</div><div class="ttdef"><b>Definition:</b> codec_OpusEncoderTypes.h:77</div></div>
<div class="ttc" id="anamespacenn_1_1codec_html_adca7d12653ef7695e8ce6864d58f7011"><div class="ttname"><a href="namespacenn_1_1codec.html#adca7d12653ef7695e8ce6864d58f7011">nn::codec::OpusPacketSizeMaximum</a></div><div class="ttdeci">const std::size_t OpusPacketSizeMaximum</div><div class="ttdoc">The maximum size for Opus packets.</div><div class="ttdef"><b>Definition:</b> codec_OpusCommonTypes.h:27</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a0f2b5b30657b1ffaf1dec49bfb36462b"><div class="ttname"><a href="namespacenn_1_1fs.html#a0f2b5b30657b1ffaf1dec49bfb36462b">nn::fs::OpenFile</a></div><div class="ttdeci">Result OpenFile(FileHandle *outValue, const char *path, int mode) NN_NOEXCEPT</div><div class="ttdoc">Opens a file.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a2e453fe1fbf8f818dc45bbd2897105cd"><div class="ttname"><a href="namespacenn_1_1fs.html#a2e453fe1fbf8f818dc45bbd2897105cd">nn::fs::MountRom</a></div><div class="ttdeci">Result MountRom(const char *name, void *pFileSystemCacheBuffer, size_t fileSystemCacheBufferSize) NN_NOEXCEPT</div><div class="ttdoc">Mounts ROM resource data.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a34bc03cdbe641524cab284a7fe7ba705a560a621c8b1cb6f228ea202b9efd7432"><div class="ttname"><a href="namespacenn_1_1fs.html#a34bc03cdbe641524cab284a7fe7ba705a560a621c8b1cb6f228ea202b9efd7432">nn::fs::OpenDirectoryMode_File</a></div><div class="ttdeci">@ OpenDirectoryMode_File</div><div class="ttdoc">Only list the files in this directory.</div><div class="ttdef"><b>Definition:</b> fs_FileSystem.h:56</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a4c97b79cce78a95c2333dbc9053b9393afde4472d2b455879cad02aade386ac0d"><div class="ttname"><a href="namespacenn_1_1fs.html#a4c97b79cce78a95c2333dbc9053b9393afde4472d2b455879cad02aade386ac0d">nn::fs::OpenMode_Read</a></div><div class="ttdeci">@ OpenMode_Read</div><div class="ttdoc">Specifies read mode.</div><div class="ttdef"><b>Definition:</b> fs_FileSystem.h:39</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a5df6e3385c795a5bd046790ef7f17f2d"><div class="ttname"><a href="namespacenn_1_1fs.html#a5df6e3385c795a5bd046790ef7f17f2d">nn::fs::QueryMountRomCacheSize</a></div><div class="ttdeci">Result QueryMountRomCacheSize(size_t *pOutValue) NN_NOEXCEPT</div><div class="ttdoc">Get the size needed for the nn::fs::MountRom file system cache.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a5fc46cd05067c210b62e96f903a2fe85a194470d850d5968a491fd9ef6145d5a0"><div class="ttname"><a href="namespacenn_1_1fs.html#a5fc46cd05067c210b62e96f903a2fe85a194470d850d5968a491fd9ef6145d5a0">nn::fs::DirectoryEntryType_File</a></div><div class="ttdeci">@ DirectoryEntryType_File</div><div class="ttdoc">File.</div><div class="ttdef"><b>Definition:</b> fs_FileSystem.h:70</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a81801a404563984f8c6cc1483cc6d730"><div class="ttname"><a href="namespacenn_1_1fs.html#a81801a404563984f8c6cc1483cc6d730">nn::fs::ReadFile</a></div><div class="ttdeci">Result ReadFile(FileHandle handle, int64_t offset, void *buffer, size_t size, const ReadOption &amp;option) NN_NOEXCEPT</div><div class="ttdoc">Loads the content of the file into the specified memory.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_aa6a54b0d39dfd293b11cd1c0073aafb1"><div class="ttname"><a href="namespacenn_1_1fs.html#aa6a54b0d39dfd293b11cd1c0073aafb1">nn::fs::GetDirectoryEntryCount</a></div><div class="ttdeci">Result GetDirectoryEntryCount(int64_t *outValue, DirectoryHandle handle) NN_NOEXCEPT</div><div class="ttdoc">Gets the number of child entries in a directory.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_aba29e01d386e809349d60eccdb15ff21"><div class="ttname"><a href="namespacenn_1_1fs.html#aba29e01d386e809349d60eccdb15ff21">nn::fs::GetFileSize</a></div><div class="ttdeci">Result GetFileSize(int64_t *outValue, FileHandle handle) NN_NOEXCEPT</div><div class="ttdoc">Gets the size of a file.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_ac8a95249afd4a87a55d319dfecb0466c"><div class="ttname"><a href="namespacenn_1_1fs.html#ac8a95249afd4a87a55d319dfecb0466c">nn::fs::Unmount</a></div><div class="ttdeci">void Unmount(const char *name) NN_NOEXCEPT</div><div class="ttdoc">Unmounts a mounted file system and frees the resources.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_ac8bd9e828751bd4f953acfa765278f84"><div class="ttname"><a href="namespacenn_1_1fs.html#ac8bd9e828751bd4f953acfa765278f84">nn::fs::CloseFile</a></div><div class="ttdeci">void CloseFile(FileHandle handle) NN_NOEXCEPT</div><div class="ttdoc">Closes a file.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_acae21d0f79e4d074e120c814a8936a42"><div class="ttname"><a href="namespacenn_1_1fs.html#acae21d0f79e4d074e120c814a8936a42">nn::fs::OpenDirectory</a></div><div class="ttdeci">Result OpenDirectory(DirectoryHandle *outValue, const char *path, int mode) NN_NOEXCEPT</div><div class="ttdoc">Opens a directory.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_af1ecb9478fe0f9dee627b65111cdbe29"><div class="ttname"><a href="namespacenn_1_1fs.html#af1ecb9478fe0f9dee627b65111cdbe29">nn::fs::ReadDirectory</a></div><div class="ttdeci">Result ReadDirectory(int64_t *outValue, DirectoryEntry *entryBuffer, DirectoryHandle handle, int64_t entryBufferCount) NN_NOEXCEPT</div><div class="ttdoc">Lists the child entries of a directory.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_af8d0fa5050c0f77a0a6f14a0b78f9b58"><div class="ttname"><a href="namespacenn_1_1fs.html#af8d0fa5050c0f77a0a6f14a0b78f9b58">nn::fs::CloseDirectory</a></div><div class="ttdeci">void CloseDirectory(DirectoryHandle handle) NN_NOEXCEPT</div><div class="ttdoc">Closes a directory.</div></div>
<div class="ttc" id="anamespacenn_1_1htcs_html_a09801c691b6f87a9f2b384310190f89b"><div class="ttname"><a href="namespacenn_1_1htcs.html#a09801c691b6f87a9f2b384310190f89b">nn::htcs::IsInitialized</a></div><div class="ttdeci">bool IsInitialized() NN_NOEXCEPT</div><div class="ttdoc">Returns whether the host-target socket communication has been initialized.</div></div>
<div class="ttc" id="anamespacenn_1_1image_html_a658c2231fdb404e7fedd5b16b5f59aeb"><div class="ttname"><a href="namespacenn_1_1image.html#a658c2231fdb404e7fedd5b16b5f59aeb">nn::image::GetChannelCount</a></div><div class="ttdeci">int GetChannelCount(PixelFormat pixelFormat) NN_NOEXCEPT</div><div class="ttdoc">Gets the number of channels from the pixel format.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a3d924bc362ec80648323428be5182338"><div class="ttname"><a href="namespacenn_1_1os.html#a3d924bc362ec80648323428be5182338">nn::os::DestroySystemEvent</a></div><div class="ttdeci">void DestroySystemEvent(SystemEventType *event) NN_NOEXCEPT</div><div class="ttdoc">Destroys a SystemEventType object.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a79e29821bfb2b0c3a5c222488e90cc89"><div class="ttname"><a href="namespacenn_1_1os.html#a79e29821bfb2b0c3a5c222488e90cc89">nn::os::GetSystemTick</a></div><div class="ttdeci">Tick GetSystemTick() NN_NOEXCEPT</div><div class="ttdoc">Gets the system tick value.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_ac880b46610757e748d5bd79211af4236"><div class="ttname"><a href="namespacenn_1_1os.html#ac880b46610757e748d5bd79211af4236">nn::os::MemoryPageSize</a></div><div class="ttdeci">const size_t MemoryPageSize</div><div class="ttdoc">This constant stores the minimum unit for memory operations.</div><div class="ttdef"><b>Definition:</b> os_MemoryHeapCommon.h:45</div></div>
<div class="ttc" id="ann___abort_8h_html"><div class="ttname"><a href="nn___abort_8h.html">nn_Abort.h</a></div><div class="ttdoc">Declarations for API resources to abort execution when conditions are not satisfied.</div></div>
<div class="ttc" id="ann___abort_8h_html_a1e657a678a588533a020c2e947df7772"><div class="ttname"><a href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a></div><div class="ttdeci">#define NN_ABORT_UNLESS_RESULT_SUCCESS(result)</div><div class="ttdoc">Tests whether the specified nn::Result is successful or not, and stops if it is not.</div><div class="ttdef"><b>Definition:</b> nn_Abort.h:188</div></div>
<div class="ttc" id="ann___abort_8h_html_a5c1a90d3a6474658ae0ac5dc5bcb14e4"><div class="ttname"><a href="nn___abort_8h.html#a5c1a90d3a6474658ae0ac5dc5bcb14e4">NN_ABORT_UNLESS</a></div><div class="ttdeci">#define NN_ABORT_UNLESS(condition,...)</div><div class="ttdoc">Tests whether a condition has been satisfied and stops execution if it has not.</div><div class="ttdef"><b>Definition:</b> nn_Abort.h:38</div></div>
<div class="ttc" id="ann___abort_8h_html_a93be5bd646d8b7f02fb8115c603a00c7"><div class="ttname"><a href="nn___abort_8h.html#a93be5bd646d8b7f02fb8115c603a00c7">NN_ABORT_UNLESS_EQUAL</a></div><div class="ttdeci">#define NN_ABORT_UNLESS_EQUAL(lhs, rhs)</div><div class="ttdoc">Tests whether the values are equal and stops execution if they are not.</div><div class="ttdef"><b>Definition:</b> nn_Abort.h:80</div></div>
<div class="ttc" id="ann___abort_8h_html_ae872300a22548da2b586ef68d2c048a3"><div class="ttname"><a href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a></div><div class="ttdeci">#define NN_ABORT_UNLESS_NOT_NULL(pointer)</div><div class="ttdoc">Tests whether the pointer is a null pointer and stops execution if it is.</div><div class="ttdef"><b>Definition:</b> nn_Abort.h:56</div></div>
<div class="ttc" id="ann___assert_8h_html"><div class="ttname"><a href="nn___assert_8h.html">nn_Assert.h</a></div><div class="ttdoc">Declarations for API resources to test whether conditions are satisfied.</div></div>
<div class="ttc" id="ann___assert_8h_html_ade59d1d911907a16c0241f8fe3b31542"><div class="ttname"><a href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a></div><div class="ttdeci">#define NN_ASSERT(condition,...)</div><div class="ttdoc">Tests whether a condition is satisfied.</div><div class="ttdef"><b>Definition:</b> nn_Assert.h:124</div></div>
<div class="ttc" id="ann___macro_8h_html_a0e31cc4dc24d85253a31e48b1a85ab33"><div class="ttname"><a href="nn___macro_8h.html#a0e31cc4dc24d85253a31e48b1a85ab33">NN_NOEXCEPT</a></div><div class="ttdeci">#define NN_NOEXCEPT</div><div class="ttdoc">Declares that the function does not throw exceptions.</div><div class="ttdef"><b>Definition:</b> nn_Macro.h:196</div></div>
<div class="ttc" id="ann___macro_8h_html_a1035ab876d08f7beb687ce9c8bbcf4ac"><div class="ttname"><a href="nn___macro_8h.html#a1035ab876d08f7beb687ce9c8bbcf4ac">NN_STATIC_ASSERT</a></div><div class="ttdeci">#define NN_STATIC_ASSERT(condition)</div><div class="ttdoc">Tests whether a conditional expression is true at compile time.</div><div class="ttdef"><b>Definition:</b> nn_Macro.h:141</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_audio_renderer_config_html"><div class="ttname"><a href="structnn_1_1audio_1_1_audio_renderer_config.html">nn::audio::AudioRendererConfig</a></div><div class="ttdoc">Structure that manages audio renderer settings.</div><div class="ttdef"><b>Definition:</b> audio_AudioRendererTypes.h:240</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_audio_renderer_handle_html"><div class="ttname"><a href="structnn_1_1audio_1_1_audio_renderer_handle.html">nn::audio::AudioRendererHandle</a></div><div class="ttdoc">The audio renderer handle.</div><div class="ttdef"><b>Definition:</b> audio_AudioRendererTypes.h:79</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_audio_renderer_parameter_html"><div class="ttname"><a href="structnn_1_1audio_1_1_audio_renderer_parameter.html">nn::audio::AudioRendererParameter</a></div><div class="ttdoc">The audio renderer parameters.</div><div class="ttdef"><b>Definition:</b> audio_AudioRendererTypes.h:127</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_device_sink_type_html"><div class="ttname"><a href="structnn_1_1audio_1_1_device_sink_type.html">nn::audio::DeviceSinkType</a></div><div class="ttdoc">Sink to output the rendering results to the audio output device.</div><div class="ttdef"><b>Definition:</b> audio_SinkTypes.h:36</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_final_mix_type_html"><div class="ttname"><a href="structnn_1_1audio_1_1_final_mix_type.html">nn::audio::FinalMixType</a></div><div class="ttdoc">Structure representing FinalMix.</div><div class="ttdef"><b>Definition:</b> audio_FinalMixTypes.h:70</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_memory_pool_type_html"><div class="ttname"><a href="structnn_1_1audio_1_1_memory_pool_type.html">nn::audio::MemoryPoolType</a></div><div class="ttdoc">Structure for representing memory regions used by an audio renderer.</div><div class="ttdef"><b>Definition:</b> audio_MemoryPoolTypes.h:70</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_voice_type_html"><div class="ttname"><a href="structnn_1_1audio_1_1_voice_type.html">nn::audio::VoiceType</a></div><div class="ttdoc">Structure that controls waveform input to the renderer.</div><div class="ttdef"><b>Definition:</b> audio_VoiceTypes.h:82</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_voice_type_html_a1c60d07e5bdd8967c813e818af35b0aa"><div class="ttname"><a href="structnn_1_1audio_1_1_voice_type.html#a1c60d07e5bdd8967c813e818af35b0aa">nn::audio::VoiceType::WaveBufferCountMax</a></div><div class="ttdeci">static constexpr int WaveBufferCountMax</div><div class="ttdoc">The maximum number of WaveBuffer objects that can be added to a VoiceType.</div><div class="ttdef"><b>Definition:</b> audio_VoiceTypes.h:118</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_voice_type_html_a564e9b6aee6dcb119664adc4b9f22149"><div class="ttname"><a href="structnn_1_1audio_1_1_voice_type.html#a564e9b6aee6dcb119664adc4b9f22149">nn::audio::VoiceType::PriorityHighest</a></div><div class="ttdeci">static constexpr int PriorityHighest</div><div class="ttdoc">Highest priority.</div><div class="ttdef"><b>Definition:</b> audio_VoiceTypes.h:108</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_wave_buffer_html"><div class="ttname"><a href="structnn_1_1audio_1_1_wave_buffer.html">nn::audio::WaveBuffer</a></div><div class="ttdoc">Structure for handling waveform input provided to a VoiceType.</div><div class="ttdef"><b>Definition:</b> audio_WaveBuffer.h:67</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_wave_buffer_html_a04b836718c60e740f6728d29ca686393"><div class="ttname"><a href="structnn_1_1audio_1_1_wave_buffer.html#a04b836718c60e740f6728d29ca686393">nn::audio::WaveBuffer::pContext</a></div><div class="ttdeci">const void * pContext</div><div class="ttdoc">Context data.</div><div class="ttdef"><b>Definition:</b> audio_WaveBuffer.h:75</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_wave_buffer_html_a09535d7c451e0b53d0c1c4acba8af70d"><div class="ttname"><a href="structnn_1_1audio_1_1_wave_buffer.html#a09535d7c451e0b53d0c1c4acba8af70d">nn::audio::WaveBuffer::isEndOfStream</a></div><div class="ttdeci">bool isEndOfStream</div><div class="ttdoc">Flag for clearing the number of playback samples for VoiceType after playback has ended.</div><div class="ttdef"><b>Definition:</b> audio_WaveBuffer.h:73</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_wave_buffer_html_a0dd91dcb09e9ee27c717728270c0e3c3"><div class="ttname"><a href="structnn_1_1audio_1_1_wave_buffer.html#a0dd91dcb09e9ee27c717728270c0e3c3">nn::audio::WaveBuffer::size</a></div><div class="ttdeci">size_t size</div><div class="ttdoc">Size of the buffer specified for buffer, in bytes.</div><div class="ttdef"><b>Definition:</b> audio_WaveBuffer.h:69</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_wave_buffer_html_a510857dab35b885cc45775d3ca0e2d9c"><div class="ttname"><a href="structnn_1_1audio_1_1_wave_buffer.html#a510857dab35b885cc45775d3ca0e2d9c">nn::audio::WaveBuffer::endSampleOffset</a></div><div class="ttdeci">int32_t endSampleOffset</div><div class="ttdoc">Offset location for ending playback, in samples.</div><div class="ttdef"><b>Definition:</b> audio_WaveBuffer.h:71</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_wave_buffer_html_a8998952082859b6ab22549250fad5003"><div class="ttname"><a href="structnn_1_1audio_1_1_wave_buffer.html#a8998952082859b6ab22549250fad5003">nn::audio::WaveBuffer::loop</a></div><div class="ttdeci">bool loop</div><div class="ttdoc">Loop playback flag.</div><div class="ttdef"><b>Definition:</b> audio_WaveBuffer.h:72</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_wave_buffer_html_ad7ea254b8bcd4cfa996c2187969a1989"><div class="ttname"><a href="structnn_1_1audio_1_1_wave_buffer.html#ad7ea254b8bcd4cfa996c2187969a1989">nn::audio::WaveBuffer::buffer</a></div><div class="ttdeci">const void * buffer</div><div class="ttdoc">Buffer address that maintains the waveform data to play back.</div><div class="ttdef"><b>Definition:</b> audio_WaveBuffer.h:68</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_wave_buffer_html_af06a8f9b5986c743352b492c3bf5d911"><div class="ttname"><a href="structnn_1_1audio_1_1_wave_buffer.html#af06a8f9b5986c743352b492c3bf5d911">nn::audio::WaveBuffer::startSampleOffset</a></div><div class="ttdeci">int32_t startSampleOffset</div><div class="ttdoc">Offset location for starting playback, in samples.</div><div class="ttdef"><b>Definition:</b> audio_WaveBuffer.h:70</div></div>
<div class="ttc" id="astructnn_1_1audio_1_1_wave_buffer_html_af5f4159c74e68b2339196b804a1dbbbf"><div class="ttname"><a href="structnn_1_1audio_1_1_wave_buffer.html#af5f4159c74e68b2339196b804a1dbbbf">nn::audio::WaveBuffer::contextSize</a></div><div class="ttdeci">size_t contextSize</div><div class="ttdoc">The size of the data specified for pContext.</div><div class="ttdef"><b>Definition:</b> audio_WaveBuffer.h:76</div></div>
<div class="ttc" id="astructnn_1_1fs_1_1_directory_entry_html"><div class="ttname"><a href="structnn_1_1fs_1_1_directory_entry.html">nn::fs::DirectoryEntry</a></div><div class="ttdoc">Structure representing directory entries.</div><div class="ttdef"><b>Definition:</b> fs_Directory.h:45</div></div>
<div class="ttc" id="astructnn_1_1fs_1_1_directory_handle_html"><div class="ttname"><a href="structnn_1_1fs_1_1_directory_handle.html">nn::fs::DirectoryHandle</a></div><div class="ttdoc">Handle for working with a directory.</div><div class="ttdef"><b>Definition:</b> fs_Directory.h:29</div></div>
<div class="ttc" id="astructnn_1_1fs_1_1_file_handle_html"><div class="ttname"><a href="structnn_1_1fs_1_1_file_handle.html">nn::fs::FileHandle</a></div><div class="ttdoc">Handle for working with a file.</div><div class="ttdef"><b>Definition:</b> fs_File.h:90</div></div>
<div class="ttc" id="autil___format_string_8h_html"><div class="ttname"><a href="util___format_string_8h.html">util_FormatString.h</a></div><div class="ttdoc">API declarations for handling string formatting.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="PageSampleCodecOpusCodecProcessingTime_SectionSampleDetail"></a>
Sample Program Description</h2>
<p>This sample program measures the processing times for encoding audio source data and for decoding Opus data. The encoding parameters are as follows.</p>
<ul>
<li>Bit rate (10, 29, 40, 64, 96, 128, or 192 kbps)</li>
<li>Frames (2.5, 5.0, 10.0, or 20.0 milliseconds)</li>
<li>Encryption mode (Silk or Celt)</li>
</ul>
<p>This sample program has the following flow.</p>
<ul>
<li>Initialize the file system.</li>
<li>Load audio data.</li>
<li>Initialize the Opus codec.</li>
<li>Initialize and start the audio renderer, for playback only.</li>
<li>Run the Opus encoder.</li>
<li>Run the Opus decoder.</li>
<li>Play back decoded results, only at playback.</li>
<li>Finalize the audio renderer, for playback only.</li>
<li>Finalize the Opus codec.</li>
<li>Display the Opus encoding and decoding processing times.</li>
</ul>
<p>The following is a description of measuring the Opus encoding and decoding processing times. For more information about using the Opus decoder, see the <code><a class="el" href="dir_a1d31b7cfdf6aa8f73e60f3e6714d43f.html">Samples/Sources/Applications/CodecOpusDecoder/ </a> </code> sample.</p>
<p>If you define the <code>USE_HARDWARE_DECODER</code> macro and build it, the <code><a class="el" href="classnn_1_1codec_1_1_hardware_opus_decoder.html" title="The Opus decoder class for hardware use.">nn::codec::HardwareOpusDecoder</a></code> will be used. The following description uses <code><a class="el" href="classnn_1_1codec_1_1_opus_decoder.html" title="The OPUS decoder class.">nn::codec::OpusDecoder</a></code> as a representative example. If you are using <code></code>, read the document with <code>HardwareOpusDecoder</code> replaced for <code>OpusDecoder</code>.</p>
<p>Opus decoding results will be played back if you build with the <code>ENABLE_PLAY</code> macro defined, but audio output must be available. Also use for purposes other than measuring processing times, including to check codec operations. Disable the playback of Opus decoding results to make the measurement as accurate as possible when measuring processing times.</p>
<p>Encodes audio data loaded from a file in frame units. Decodes an Opus packet exported by the encoder immediately after encoding. This sample measures processing times every time the codec runs. Processing times are calculated from the difference in <code><a class="el" href="classnn_1_1os_1_1_tick.html" title="Class for handling system ticks.">nn::os::Tick</a></code> values when the <code><a class="el" href="classnn_1_1codec_1_1_opus_encoder.html#a808ecd9e87c513626b5554b291a17f94" title="Encodes one frame of interleaved PCM data and gets the Opus data.">nn::codec::OpusEncoder::EncodeInterleaved()</a></code> and <code><a class="el" href="classnn_1_1codec_1_1_opus_decoder.html#a63ce85f84facdd3256efc94e50b6ee4a" title="Decodes one frame of data, and gets interleaved PCM data.">nn::codec::OpusDecoder::DecodeInterleaved()</a></code> functions are called.</p>
<p>The average, minimum, maximum, and standard deviation for the codec processing times are calculated and displayed when all encoding and decoding of audio data ends. Processing is run for all encoding parameters.</p>
<p>The program exits automatically after measurements for all audio files end. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
</body>
</html>

<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Benchmark Demo for Individual File Data Caching | NintendoSDK API Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<script type="text/javascript" src="searchapi.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   &#160;<span id="projectnumber">14.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="_page_sample.html">Sample Descriptions</a></li><li class="navelem"><a class="el" href="_page_sample_fs.html">File System Library Samples</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Benchmark Demo for Individual File Data Caching </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#PageSampleFsIndividualFileDataCache_SectionBrief">Overview</a></li>
<li class="level1"><a href="#PageSampleFsIndividualFileDataCache_SectionFileStructure">File Structure</a></li>
<li class="level1"><a href="#PageSampleFsIndividualFileDataCache_SectionNecessaryEnvironment">Required Environment</a></li>
<li class="level1"><a href="#PageSampleFsIndividualFileDataCache_SectionHowToOperate">How to Use</a></li>
<li class="level1"><a href="#PageSampleFsIndividualFileDataCache_SectionPrecaution">Important Information</a></li>
<li class="level1"><a href="#PageSampleFsIndividualFileDataCache_SectionHowToExecute">Execution Procedure</a></li>
<li class="level1"><a href="#PageSampleFsIndividualFileDataCache_SectionDetail">Description</a><ul><li class="level2"><a href="#PageSampleFsIndividualFileDataCache_SectionSampleProgram">Sample Program</a></li>
<li class="level2"><a href="#PageSampleFsIndividualFileDataCache_SectionSampleDetail">Sample Program Description</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>This section describes a sample program that uses individual file data caching.</p>
<h1><a class="anchor" id="PageSampleFsIndividualFileDataCache_SectionBrief"></a>
Overview</h1>
<p>This sample program uses individual file data caching. It provides simple benchmarking to show how file access performance changes with and without individual file data caching.</p>
<p>For more information about using individual file data caching, see the <a class="el" href="namespacenn_1_1fs.html">File System Library API Reference</a>.</p>
<h1><a class="anchor" id="PageSampleFsIndividualFileDataCache_SectionFileStructure"></a>
File Structure</h1>
<p>This sample program is located in <code><a class="el" href="dir_fb2599e8d41bf4feb7776095aead739f.html">Samples/Sources/Applications/FsFileDataCache/FsIndividualFileDataCache/ </a> </code>.</p>
<h1><a class="anchor" id="PageSampleFsIndividualFileDataCache_SectionNecessaryEnvironment"></a>
Required Environment</h1>
<p>The NX development hardware is required for running this sample program.</p>
<h1><a class="anchor" id="PageSampleFsIndividualFileDataCache_SectionHowToOperate"></a>
How to Use</h1>
<p>Nothing specific.</p>
<h1><a class="anchor" id="PageSampleFsIndividualFileDataCache_SectionPrecaution"></a>
Important Information</h1>
<p>This sample program does not display anything on the screen. The execution results are output to a log.</p>
<p>You must create at least one user account in advance on the development hardware that will run this demo.</p>
<p>This sample program assumes that it is started from an NSP format application image. If the result of running this program differs widely from expectation, confirm that the application was built in NSP format.</p>
<h1><a class="anchor" id="PageSampleFsIndividualFileDataCache_SectionHowToExecute"></a>
Execution Procedure</h1>
<p>Build the sample program and then run it.</p>
<h1><a class="anchor" id="PageSampleFsIndividualFileDataCache_SectionDetail"></a>
Description</h1>
<h2><a class="anchor" id="PageSampleFsIndividualFileDataCache_SectionSampleProgram"></a>
Sample Program</h2>
<p>This sample program uses the following source code.</p>
<p><a class="el" href="_fs_individual_file_data_cache_8cpp.html" title="Benchmark Demo for Individual File Data Caching.">FsIndividualFileDataCache.cpp</a> </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*--------------------------------------------------------------------------------*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">  Copyright Nintendo.  All rights reserved.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">  These coded instructions, statements, and computer programs contain proprietary</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">  information of Nintendo and/or its licensed developers and are protected by</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">  national and international copyright laws. They may not be disclosed to third</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">  parties or copied or duplicated in any form, in whole or in part, without the</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">  prior written consent of Nintendo.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">  The content herein is highly confidential and should be handled accordingly.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *--------------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#include &lt;cinttypes&gt;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="nn___abort_8h.html">nn/nn_Abort.h</a>&gt;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#include &lt;nn/nn_Common.h&gt;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="nn___log_8h.html">nn/nn_Log.h</a>&gt;</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="nn___time_span_8h.html">nn/nn_TimeSpan.h</a>&gt;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="fs_8h.html">nn/fs.h</a>&gt;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="init_8h.html">nn/init.h</a>&gt;</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#include &lt;nn/os.h&gt;</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="account___api_8h.html">nn/account/account_Api.h</a>&gt;</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="account___api_for_applications_8h.html">nn/account/account_ApiForApplications.h</a>&gt;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="util___bit_util_8h.html">nn/util/util_BitUtil.h</a>&gt;</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="util___scope_exit_8h.html">nn/util/util_ScopeExit.h</a>&gt;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#include &quot;Common.h&quot;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keyword">namespace</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keywordtype">void</span> RomFile()</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// The mount name of the resource data and the file path of the test target.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* mountName = <span class="stringliteral">&quot;rom&quot;</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* testTargetPath = <span class="stringliteral">&quot;rom:/dummy.bmp&quot;</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// The buffer size when reading.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> readBufferSize = 4 * 1024;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// Allocate 32 MB of cache memory for file data cache.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// The optimal size of cache memory differs, depending on the application. For a normal application, consider allocating even more than</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// this amount of cache memory.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> fileDataCacheSize = 32 * 1024 * 1024;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">void</span>* fileDataCache = std::malloc(fileDataCacheSize);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a>(fileDataCache);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// Allocate file system cache memory and mount the file system for the resource data.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">// (This allocated cache memory is used to store file system management information. It has nothing to do with file data cache.)</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordtype">size_t</span> fileSystemCacheSize;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1fs.html#a5df6e3385c795a5bd046790ef7f17f2d">nn::fs::QueryMountRomCacheSize</a>(&amp;fileSystemCacheSize));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordtype">void</span>* fileSystemCache = std::malloc(fileSystemCacheSize);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a>(fileSystemCache);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1fs.html#a2e453fe1fbf8f818dc45bbd2897105cd">nn::fs::MountRom</a>(mountName, fileSystemCache, fileSystemCacheSize));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// Begin the sequential read benchmarking process.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;ROM sequential reading test\n&quot;</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// Enable individual file data cache and read sequentially.</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <a class="code" href="namespacenn_1_1fs.html#a2d72712742fd49f26a5bd36cce94d481">nn::fs::EnableIndividualFileDataCache</a>(testTargetPath, fileDataCache, fileDataCacheSize);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <a class="code" href="classnn_1_1_time_span.html">nn::TimeSpan</a> elapsed = MeasureExecutionTime([=]() {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            RunSequentialRead(testTargetPath, readBufferSize);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        });</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; Individual cache enabled = %&quot;</span> PRId64 <span class="stringliteral">&quot; ms.\n&quot;</span>, elapsed.<a class="code" href="classnn_1_1_time_span.html#a8e5f7ef9ad4a61bf545644d0cce467a0">GetMilliSeconds</a>());</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <a class="code" href="namespacenn_1_1fs.html#a774744bdd98a6a252de1262ce56f4ef6">nn::fs::DisableIndividualFileDataCache</a>(testTargetPath);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// Read sequentially without enabling file data cache.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <a class="code" href="classnn_1_1_time_span.html">nn::TimeSpan</a> elapsed = MeasureExecutionTime([=]() {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            RunSequentialRead(testTargetPath, readBufferSize);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        });</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; Cache disabled = %&quot;</span> PRId64 <span class="stringliteral">&quot; ms.\n&quot;</span>, elapsed.<a class="code" href="classnn_1_1_time_span.html#a8e5f7ef9ad4a61bf545644d0cce467a0">GetMilliSeconds</a>());</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// Begin the random read benchmarking process.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;ROM random reading test\n&quot;</span>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// Enable individual file data cache and read randomly.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="namespacenn_1_1fs.html#a2d72712742fd49f26a5bd36cce94d481">nn::fs::EnableIndividualFileDataCache</a>(testTargetPath, fileDataCache, fileDataCacheSize);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <a class="code" href="classnn_1_1_time_span.html">nn::TimeSpan</a> elapsed = MeasureExecutionTime([=]() {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            RunRandomRead(testTargetPath, readBufferSize);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        });</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; Individual cache enabled = %&quot;</span> PRId64 <span class="stringliteral">&quot; ms.\n&quot;</span>, elapsed.<a class="code" href="classnn_1_1_time_span.html#a8e5f7ef9ad4a61bf545644d0cce467a0">GetMilliSeconds</a>());</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <a class="code" href="namespacenn_1_1fs.html#a774744bdd98a6a252de1262ce56f4ef6">nn::fs::DisableIndividualFileDataCache</a>(testTargetPath);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// Read randomly without enabling file data cache.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <a class="code" href="classnn_1_1_time_span.html">nn::TimeSpan</a> elapsed = MeasureExecutionTime([=]() {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            RunRandomRead(testTargetPath, readBufferSize);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        });</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; Cache disabled = %&quot;</span> PRId64 <span class="stringliteral">&quot; ms.\n&quot;</span>, elapsed.<a class="code" href="classnn_1_1_time_span.html#a8e5f7ef9ad4a61bf545644d0cce467a0">GetMilliSeconds</a>());</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// Unmount the file system and free the various memory.</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="namespacenn_1_1fs.html#ac8a95249afd4a87a55d319dfecb0466c">nn::fs::Unmount</a>(mountName);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    std::free(fileSystemCache);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    std::free(fileDataCache);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keywordtype">void</span> SaveDataFile()</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="classnn_1_1_result.html">nn::Result</a> result;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// The read/write buffer size.</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> readBufferSize = 4 * 1024;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> writeBufferSize = 4 * 1024;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// Allocate 32 MB of cache memory for file data cache.</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// The optimal size of cache memory differs, depending on the application. For a normal application, consider allocating even more than</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// this amount of cache memory.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> fileDataCacheSize = 32 * 1024 * 1024;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">void</span>* fileDataCache = std::malloc(fileDataCacheSize);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a>(fileDataCache);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// Initialize the account library.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="namespacenn_1_1account.html#ac5870470963c9923c63f76e03c8c024e">nn::account::Initialize</a>();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// Get the user account at the beginning.</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">// Aborts if there are no user accounts.</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="structnn_1_1account_1_1_uid.html">nn::account::Uid</a> user;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">int</span> userCount = 0;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    result = <a class="code" href="namespacenn_1_1account.html#a456d8bfd2e6389402878af77bc7ecf95">nn::account::ListAllUsers</a>(&amp;userCount, &amp;user, 1);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="nn___abort_8h.html#a5c1a90d3a6474658ae0ac5dc5bcb14e4">NN_ABORT_UNLESS</a>(result.IsSuccess() &amp;&amp; userCount &gt; 0);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// Open the user selected at application startup.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// Keep it open for the duration of user operations.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="structnn_1_1account_1_1_user_handle.html">nn::account::UserHandle</a> userHandle;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1account.html#a06fd27c776fbc31c918ea0a84ddb1f41">nn::account::OpenUser</a>(&amp;userHandle, user));</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="util___scope_exit_8h.html#a674e2d673758265abe6e8e17426489ea">NN_UTIL_SCOPE_EXIT</a></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <a class="code" href="namespacenn_1_1account.html#aaf1a6e0b8cbcef6f62eae042bca5b7cb">nn::account::CloseUser</a>(userHandle);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    };</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> testTargetSize = 4 * 1024 * 1024;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* mountName = <span class="stringliteral">&quot;save&quot;</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* testTargetPath = <span class="stringliteral">&quot;save:/file&quot;</span>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// Mount the save data and create the file.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Mount save data as \&quot;%s\&quot;.\n&quot;</span>, mountName);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="comment">// Create the selected user save data.</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="comment">// If data already exists, does nothing and returns nn::ResultSuccess.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        result = <a class="code" href="namespacenn_1_1fs.html#ae5f48fe542ce22263e1399e3b50190e8">nn::fs::EnsureSaveData</a>(user);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">if</span> (nn::fs::ResultUsableSpaceNotEnough::Includes(result))</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="comment">// Error handling when the application does not have enough memory is required for the nn::fs::EnsureSaveData() function.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="comment">// The system automatically displays a message indicating that there was not enough capacity to create save data in the error viewer.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="comment">// The application must offer options to cancel account selection and to return to the prior scene.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <a class="code" href="nn___abort_8h.html#a205eaac89c47d49cb982bf136e113de2">NN_ABORT</a>(<span class="stringliteral">&quot;Usable space not enough.\n&quot;</span>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="comment">// No further error handling is necessary because</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="comment">// the process is aborted in the library if it fails for any other reason.</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="comment">// Mount the save data as &quot;save.&quot;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        result = <a class="code" href="namespacenn_1_1fs.html#afdbda9f24e47b02bb74da4558bbd0760">nn::fs::MountSaveData</a>(mountName, user);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="comment">// Always abort when a failure occurs.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(result);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <a class="code" href="namespacenn_1_1fs.html#a5fc46cd05067c210b62e96f903a2fe85">nn::fs::DirectoryEntryType</a> directoryEntryType;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        result = <a class="code" href="namespacenn_1_1fs.html#a5cf6e2f2c5a0c4e404ba3dd782cc98bc">nn::fs::GetEntryType</a>(&amp;directoryEntryType, testTargetPath);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">if</span> (result.IsSuccess())</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <a class="code" href="namespacenn_1_1fs.html#a812ac4964fb5564467c5475c1b9fb16b">nn::fs::DeleteFile</a>(testTargetPath);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        result = <a class="code" href="namespacenn_1_1fs.html#a3e89c4d57cc8379265894ff7f3e98b2c">nn::fs::CreateFile</a>(testTargetPath, testTargetSize);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(result);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// Start the sequential write benchmark.</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Save data sequential writing test\n&quot;</span>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">// Enable individual file data cache and perform sequential write.</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <a class="code" href="namespacenn_1_1fs.html#a2d72712742fd49f26a5bd36cce94d481">nn::fs::EnableIndividualFileDataCache</a>(testTargetPath, fileDataCache, fileDataCacheSize);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <a class="code" href="classnn_1_1_time_span.html">nn::TimeSpan</a> elapsed = MeasureExecutionTime([=]() {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            RunSequentialWrite(mountName, testTargetPath, writeBufferSize);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        });</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; Individual cache enabled = %&quot;</span> PRId64 <span class="stringliteral">&quot; ms.\n&quot;</span>, elapsed.<a class="code" href="classnn_1_1_time_span.html#a8e5f7ef9ad4a61bf545644d0cce467a0">GetMilliSeconds</a>());</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <a class="code" href="namespacenn_1_1fs.html#a774744bdd98a6a252de1262ce56f4ef6">nn::fs::DisableIndividualFileDataCache</a>(testTargetPath);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">// Perform sequential write without enabling file data cache.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <a class="code" href="classnn_1_1_time_span.html">nn::TimeSpan</a> elapsed = MeasureExecutionTime([=]() {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            RunSequentialWrite(mountName, testTargetPath, writeBufferSize);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        });</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; Cache disabled = %&quot;</span> PRId64 <span class="stringliteral">&quot; ms.\n&quot;</span>, elapsed.<a class="code" href="classnn_1_1_time_span.html#a8e5f7ef9ad4a61bf545644d0cce467a0">GetMilliSeconds</a>());</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// Begin the sequential read benchmarking process.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Save data sequential reading test\n&quot;</span>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">// Enable individual file data cache and read sequentially.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <a class="code" href="namespacenn_1_1fs.html#a2d72712742fd49f26a5bd36cce94d481">nn::fs::EnableIndividualFileDataCache</a>(testTargetPath, fileDataCache, fileDataCacheSize);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="classnn_1_1_time_span.html">nn::TimeSpan</a> elapsed = MeasureExecutionTime([=]() {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            RunSequentialRead(testTargetPath, readBufferSize);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        });</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; Individual cache enabled = %&quot;</span> PRId64 <span class="stringliteral">&quot; ms.\n&quot;</span>, elapsed.<a class="code" href="classnn_1_1_time_span.html#a8e5f7ef9ad4a61bf545644d0cce467a0">GetMilliSeconds</a>());</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="namespacenn_1_1fs.html#a774744bdd98a6a252de1262ce56f4ef6">nn::fs::DisableIndividualFileDataCache</a>(testTargetPath);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// Read sequentially without enabling file data cache.</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="classnn_1_1_time_span.html">nn::TimeSpan</a> elapsed = MeasureExecutionTime([=]() {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            RunSequentialRead(testTargetPath, readBufferSize);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        });</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; Cache disabled = %&quot;</span> PRId64 <span class="stringliteral">&quot; ms.\n&quot;</span>, elapsed.<a class="code" href="classnn_1_1_time_span.html#a8e5f7ef9ad4a61bf545644d0cce467a0">GetMilliSeconds</a>());</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">// Start the random write benchmark.</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Save data random writing test\n&quot;</span>);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// Enable individual file data cache and perform random write.</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <a class="code" href="namespacenn_1_1fs.html#a2d72712742fd49f26a5bd36cce94d481">nn::fs::EnableIndividualFileDataCache</a>(testTargetPath, fileDataCache, fileDataCacheSize);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <a class="code" href="classnn_1_1_time_span.html">nn::TimeSpan</a> elapsed = MeasureExecutionTime([=]() {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            RunRandomWrite(mountName, testTargetPath, writeBufferSize);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        });</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; Individual cache enabled = %&quot;</span> PRId64 <span class="stringliteral">&quot; ms.\n&quot;</span>, elapsed.<a class="code" href="classnn_1_1_time_span.html#a8e5f7ef9ad4a61bf545644d0cce467a0">GetMilliSeconds</a>());</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <a class="code" href="namespacenn_1_1fs.html#a774744bdd98a6a252de1262ce56f4ef6">nn::fs::DisableIndividualFileDataCache</a>(testTargetPath);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// Perform random write without enabling file data cache.</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <a class="code" href="classnn_1_1_time_span.html">nn::TimeSpan</a> elapsed = MeasureExecutionTime([=]() {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            RunRandomWrite(mountName, testTargetPath, writeBufferSize);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        });</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; Cache disabled = %&quot;</span> PRId64 <span class="stringliteral">&quot; ms.\n&quot;</span>, elapsed.<a class="code" href="classnn_1_1_time_span.html#a8e5f7ef9ad4a61bf545644d0cce467a0">GetMilliSeconds</a>());</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">// Begin the random read benchmarking process.</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Save data random reading test\n&quot;</span>);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">// Enable individual file data cache and read randomly.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <a class="code" href="namespacenn_1_1fs.html#a2d72712742fd49f26a5bd36cce94d481">nn::fs::EnableIndividualFileDataCache</a>(testTargetPath, fileDataCache, fileDataCacheSize);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <a class="code" href="classnn_1_1_time_span.html">nn::TimeSpan</a> elapsed = MeasureExecutionTime([=]() {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            RunRandomRead(testTargetPath, readBufferSize);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        });</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; Individual cache enabled = %&quot;</span> PRId64 <span class="stringliteral">&quot; ms.\n&quot;</span>, elapsed.<a class="code" href="classnn_1_1_time_span.html#a8e5f7ef9ad4a61bf545644d0cce467a0">GetMilliSeconds</a>());</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <a class="code" href="namespacenn_1_1fs.html#a774744bdd98a6a252de1262ce56f4ef6">nn::fs::DisableIndividualFileDataCache</a>(testTargetPath);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// Read randomly without enabling file data cache.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <a class="code" href="classnn_1_1_time_span.html">nn::TimeSpan</a> elapsed = MeasureExecutionTime([=]() {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            RunRandomRead(testTargetPath, readBufferSize);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        });</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; Cache disabled = %&quot;</span> PRId64 <span class="stringliteral">&quot; ms.\n&quot;</span>, elapsed.<a class="code" href="classnn_1_1_time_span.html#a8e5f7ef9ad4a61bf545644d0cce467a0">GetMilliSeconds</a>());</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// Mount the file system and free the memory.</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="namespacenn_1_1fs.html#ac8a95249afd4a87a55d319dfecb0466c">nn::fs::Unmount</a>(mountName);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    std::free(fileDataCache);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;} <span class="comment">// NOLINT(impl/function_size)</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}  <span class="comment">// namespace unnamed</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">*  This is the definition for nninitStartup(), which initializes the memory management functionality of the application.</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">*  Normally, global file data caching is automatically enabled when starting the application.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">*  To accurately measure the individual file data caching benchmark, this sample overwrites the</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">*  definition of nninitStartup() so that global file data caching is automatically enabled.</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">// Global file data caching is not automatically enabled in the Windows environment.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">// nninitStartup() is only defined when the application operating environment is the operating system of the NX development hardware.</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#if defined(NN_BUILD_TARGET_PLATFORM_OS_NN)</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> <a class="code" href="init___startup_8h.html#ac781c07f35d3d9e7a71d21ad25e25f8f">nninitStartup</a>()</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;{</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// Gets the information for the memory available to the application.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="structnn_1_1os_1_1_memory_info.html">nn::os::MemoryInfo</a> memInfo;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="namespacenn_1_1os.html#a79f2a489da0a124ebdc8130595c70b94">nn::os::QueryMemoryInfo</a>(&amp;memInfo);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordtype">size_t</span> size = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(memInfo.<a class="code" href="structnn_1_1os_1_1_memory_info.html#a456fd92870975fcf020ad08f8bf7f908">totalAvailableMemorySize</a>) - memInfo.<a class="code" href="structnn_1_1os_1_1_memory_info.html#a179fcdecd518686555036d0db3a5014c">totalUsedMemorySize</a>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">// Along with the preconditions for nn::os::SetMemoryHeapSize(), rounds down size as an integer multiplier of nn::os::MemoryBlockUnitSize.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    size = <a class="code" href="namespacenn_1_1util.html#ac7655ccdb1f67a75ae553c06dec485b3">nn::util::align_down</a>(size, <a class="code" href="namespacenn_1_1os.html#ade84ad9f438e76820510ca0623c5a823">nn::os::MemoryBlockUnitSize</a>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">// Sets the memory heap size.</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1os.html#a2be8bac50d8d37a91f866d9e0c55886e">nn::os::SetMemoryHeapSize</a>(size));</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// From the memory heap, allocates the memory region to be used by malloc().</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    uintptr_t p;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(<a class="code" href="namespacenn_1_1os.html#a875bf6b3129f06654e641513c63017dd">nn::os::AllocateMemoryBlock</a>(&amp;p, size));</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">// Sets a memory region for malloc() use.</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="namespacenn_1_1init.html#a216ae7a5ca53a1c1e6dc0514f7283974">nn::init::InitializeAllocator</a>(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(p), size, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">// Registers the memory allocator to use by implementation of the thread_local specifier.</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="namespacenn_1_1os.html#a347a69381452967e4a51b3c18aae7807">nn::os::SetMemoryAllocatorForThreadLocal</a>(</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        [](<span class="keywordtype">size_t</span> size, <span class="keywordtype">size_t</span>) { <span class="keywordflow">return</span> std::malloc(size); },</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        [](<span class="keywordtype">void</span>* ptr, size_t) { std::free(ptr); }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    );</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="preprocessor">#endif  </span><span class="comment">// defined(NN_BUILD_TARGET_PLATFORM_OS_NN)</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">*  The application entry point.</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> nnMain()</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;{</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    RomFile();</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    SaveDataFile();</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;}</div>
<div class="ttc" id="aaccount___api_8h_html"><div class="ttname"><a href="account___api_8h.html">account_Api.h</a></div><div class="ttdoc">This file declares API resources an ordinary application and the console system will likely use.</div></div>
<div class="ttc" id="aaccount___api_for_applications_8h_html"><div class="ttname"><a href="account___api_for_applications_8h.html">account_ApiForApplications.h</a></div><div class="ttdoc">This file declares API resources an ordinary application will likely use.</div></div>
<div class="ttc" id="aclassnn_1_1_result_html"><div class="ttname"><a href="classnn_1_1_result.html">nn::Result</a></div><div class="ttdoc">Represents the generic result of an operation.</div><div class="ttdef"><b>Definition:</b> nn_Result.h:32</div></div>
<div class="ttc" id="aclassnn_1_1_time_span_html"><div class="ttname"><a href="classnn_1_1_time_span.html">nn::TimeSpan</a></div><div class="ttdoc">This class represents a length of time.</div><div class="ttdef"><b>Definition:</b> nn_TimeSpan.h:456</div></div>
<div class="ttc" id="aclassnn_1_1_time_span_html_a8e5f7ef9ad4a61bf545644d0cce467a0"><div class="ttname"><a href="classnn_1_1_time_span.html#a8e5f7ef9ad4a61bf545644d0cce467a0">nn::TimeSpan::GetMilliSeconds</a></div><div class="ttdeci">constexpr int64_t GetMilliSeconds() const NN_NOEXCEPT</div><div class="ttdoc">Gets the time in milliseconds.</div><div class="ttdef"><b>Definition:</b> nn_TimeSpan.h:667</div></div>
<div class="ttc" id="afs_8h_html"><div class="ttname"><a href="fs_8h.html">fs.h</a></div><div class="ttdoc">Declarations of API resources for the file system.</div></div>
<div class="ttc" id="ainit_8h_html"><div class="ttname"><a href="init_8h.html">init.h</a></div><div class="ttdoc">Declaration of API resources for the initialization library.</div></div>
<div class="ttc" id="ainit___startup_8h_html_ac781c07f35d3d9e7a71d21ad25e25f8f"><div class="ttname"><a href="init___startup_8h.html#ac781c07f35d3d9e7a71d21ad25e25f8f">nninitStartup</a></div><div class="ttdeci">void nninitStartup(void)</div><div class="ttdoc">Startup initialization routine.</div></div>
<div class="ttc" id="anamespacenn_1_1account_html_a06fd27c776fbc31c918ea0a84ddb1f41"><div class="ttname"><a href="namespacenn_1_1account.html#a06fd27c776fbc31c918ea0a84ddb1f41">nn::account::OpenUser</a></div><div class="ttdeci">Result OpenUser(UserHandle *pOutHandle, const Uid &amp;user) NN_NOEXCEPT</div><div class="ttdoc">Changes a user to an open state and gets the appropriate handle.</div></div>
<div class="ttc" id="anamespacenn_1_1account_html_a456d8bfd2e6389402878af77bc7ecf95"><div class="ttname"><a href="namespacenn_1_1account.html#a456d8bfd2e6389402878af77bc7ecf95">nn::account::ListAllUsers</a></div><div class="ttdeci">Result ListAllUsers(int *pOutActualLength, Uid *outUsers, int arrayLength) NN_NOEXCEPT</div><div class="ttdoc">Gets a list of users added to the account system.</div></div>
<div class="ttc" id="anamespacenn_1_1account_html_aaf1a6e0b8cbcef6f62eae042bca5b7cb"><div class="ttname"><a href="namespacenn_1_1account.html#aaf1a6e0b8cbcef6f62eae042bca5b7cb">nn::account::CloseUser</a></div><div class="ttdeci">void CloseUser(const UserHandle &amp;handle) NN_NOEXCEPT</div><div class="ttdoc">Changes the state of the user indicated by the specified handle to Closed.</div></div>
<div class="ttc" id="anamespacenn_1_1account_html_ac5870470963c9923c63f76e03c8c024e"><div class="ttname"><a href="namespacenn_1_1account.html#ac5870470963c9923c63f76e03c8c024e">nn::account::Initialize</a></div><div class="ttdeci">void Initialize() NN_NOEXCEPT</div><div class="ttdoc">Begins using the account system.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a2d72712742fd49f26a5bd36cce94d481"><div class="ttname"><a href="namespacenn_1_1fs.html#a2d72712742fd49f26a5bd36cce94d481">nn::fs::EnableIndividualFileDataCache</a></div><div class="ttdeci">Result EnableIndividualFileDataCache(const char *path, void *pBuffer, size_t bufferSize) NN_NOEXCEPT</div><div class="ttdoc">Enables individual file data caching.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a2e453fe1fbf8f818dc45bbd2897105cd"><div class="ttname"><a href="namespacenn_1_1fs.html#a2e453fe1fbf8f818dc45bbd2897105cd">nn::fs::MountRom</a></div><div class="ttdeci">Result MountRom(const char *name, void *pFileSystemCacheBuffer, size_t fileSystemCacheBufferSize) NN_NOEXCEPT</div><div class="ttdoc">Mounts ROM resource data.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a3e89c4d57cc8379265894ff7f3e98b2c"><div class="ttname"><a href="namespacenn_1_1fs.html#a3e89c4d57cc8379265894ff7f3e98b2c">nn::fs::CreateFile</a></div><div class="ttdeci">Result CreateFile(const char *path, int64_t size) NN_NOEXCEPT</div><div class="ttdoc">Creates a file.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a5cf6e2f2c5a0c4e404ba3dd782cc98bc"><div class="ttname"><a href="namespacenn_1_1fs.html#a5cf6e2f2c5a0c4e404ba3dd782cc98bc">nn::fs::GetEntryType</a></div><div class="ttdeci">Result GetEntryType(DirectoryEntryType *outValue, const char *path) NN_NOEXCEPT</div><div class="ttdoc">Gets the type of the entry.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a5df6e3385c795a5bd046790ef7f17f2d"><div class="ttname"><a href="namespacenn_1_1fs.html#a5df6e3385c795a5bd046790ef7f17f2d">nn::fs::QueryMountRomCacheSize</a></div><div class="ttdeci">Result QueryMountRomCacheSize(size_t *pOutValue) NN_NOEXCEPT</div><div class="ttdoc">Get the size needed for the nn::fs::MountRom file system cache.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a5fc46cd05067c210b62e96f903a2fe85"><div class="ttname"><a href="namespacenn_1_1fs.html#a5fc46cd05067c210b62e96f903a2fe85">nn::fs::DirectoryEntryType</a></div><div class="ttdeci">DirectoryEntryType</div><div class="ttdoc">Enumerated type representing directory entry types.</div><div class="ttdef"><b>Definition:</b> fs_FileSystem.h:68</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a774744bdd98a6a252de1262ce56f4ef6"><div class="ttname"><a href="namespacenn_1_1fs.html#a774744bdd98a6a252de1262ce56f4ef6">nn::fs::DisableIndividualFileDataCache</a></div><div class="ttdeci">void DisableIndividualFileDataCache(const char *path) NN_NOEXCEPT</div><div class="ttdoc">Disables individual file data caching.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a812ac4964fb5564467c5475c1b9fb16b"><div class="ttname"><a href="namespacenn_1_1fs.html#a812ac4964fb5564467c5475c1b9fb16b">nn::fs::DeleteFile</a></div><div class="ttdeci">Result DeleteFile(const char *path) NN_NOEXCEPT</div><div class="ttdoc">Deletes a file.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_ac8a95249afd4a87a55d319dfecb0466c"><div class="ttname"><a href="namespacenn_1_1fs.html#ac8a95249afd4a87a55d319dfecb0466c">nn::fs::Unmount</a></div><div class="ttdeci">void Unmount(const char *name) NN_NOEXCEPT</div><div class="ttdoc">Unmounts a mounted file system and frees the resources.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_ae5f48fe542ce22263e1399e3b50190e8"><div class="ttname"><a href="namespacenn_1_1fs.html#ae5f48fe542ce22263e1399e3b50190e8">nn::fs::EnsureSaveData</a></div><div class="ttdeci">Result EnsureSaveData(const nn::account::Uid &amp;user) NN_NOEXCEPT</div><div class="ttdoc">Creates save data.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_afdbda9f24e47b02bb74da4558bbd0760"><div class="ttname"><a href="namespacenn_1_1fs.html#afdbda9f24e47b02bb74da4558bbd0760">nn::fs::MountSaveData</a></div><div class="ttdeci">Result MountSaveData(const char *name, const nn::account::Uid &amp;user) NN_NOEXCEPT</div><div class="ttdoc">Mounts save data after specifying a user.</div></div>
<div class="ttc" id="anamespacenn_1_1init_html_a216ae7a5ca53a1c1e6dc0514f7283974"><div class="ttname"><a href="namespacenn_1_1init.html#a216ae7a5ca53a1c1e6dc0514f7283974">nn::init::InitializeAllocator</a></div><div class="ttdeci">void InitializeAllocator(void *address, size_t size) NN_NOEXCEPT</div><div class="ttdoc">Initializes a memory allocator.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a2be8bac50d8d37a91f866d9e0c55886e"><div class="ttname"><a href="namespacenn_1_1os.html#a2be8bac50d8d37a91f866d9e0c55886e">nn::os::SetMemoryHeapSize</a></div><div class="ttdeci">nn::Result SetMemoryHeapSize(size_t size) NN_NOEXCEPT</div><div class="ttdoc">Changes the size of the memory heap region.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a347a69381452967e4a51b3c18aae7807"><div class="ttname"><a href="namespacenn_1_1os.html#a347a69381452967e4a51b3c18aae7807">nn::os::SetMemoryAllocatorForThreadLocal</a></div><div class="ttdeci">void SetMemoryAllocatorForThreadLocal(nn::AlignedAllocateFunction allocator, nn::DeallocateFunction deallocator) NN_NOEXCEPT</div><div class="ttdoc">Registers the compiler thread local implementation memory allocator and memory deallocator.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a79f2a489da0a124ebdc8130595c70b94"><div class="ttname"><a href="namespacenn_1_1os.html#a79f2a489da0a124ebdc8130595c70b94">nn::os::QueryMemoryInfo</a></div><div class="ttdeci">void QueryMemoryInfo(MemoryInfo *info) NN_NOEXCEPT</div><div class="ttdoc">Gets information including the amount of memory currently being used by this program.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a875bf6b3129f06654e641513c63017dd"><div class="ttname"><a href="namespacenn_1_1os.html#a875bf6b3129f06654e641513c63017dd">nn::os::AllocateMemoryBlock</a></div><div class="ttdeci">nn::Result AllocateMemoryBlock(uintptr_t *address, size_t size) NN_NOEXCEPT</div><div class="ttdoc">Allocates a memory block from the memory heap.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_ade84ad9f438e76820510ca0623c5a823"><div class="ttname"><a href="namespacenn_1_1os.html#ade84ad9f438e76820510ca0623c5a823">nn::os::MemoryBlockUnitSize</a></div><div class="ttdeci">const size_t MemoryBlockUnitSize</div><div class="ttdoc">This constant stores the minimum unit of a memory block.</div><div class="ttdef"><b>Definition:</b> os_MemoryHeapCommon.h:39</div></div>
<div class="ttc" id="anamespacenn_1_1util_html_ac7655ccdb1f67a75ae553c06dec485b3"><div class="ttname"><a href="namespacenn_1_1util.html#ac7655ccdb1f67a75ae553c06dec485b3">nn::util::align_down</a></div><div class="ttdeci">constexpr T align_down(T x, size_t align) NN_NOEXCEPT</div><div class="ttdoc">Rounds down a value so that it fits the specified alignment.</div><div class="ttdef"><b>Definition:</b> util_BitUtil.h:126</div></div>
<div class="ttc" id="ann___abort_8h_html"><div class="ttname"><a href="nn___abort_8h.html">nn_Abort.h</a></div><div class="ttdoc">Declarations for API resources to abort execution when conditions are not satisfied.</div></div>
<div class="ttc" id="ann___abort_8h_html_a1e657a678a588533a020c2e947df7772"><div class="ttname"><a href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a></div><div class="ttdeci">#define NN_ABORT_UNLESS_RESULT_SUCCESS(result)</div><div class="ttdoc">Tests whether the specified nn::Result is successful or not, and stops if it is not.</div><div class="ttdef"><b>Definition:</b> nn_Abort.h:188</div></div>
<div class="ttc" id="ann___abort_8h_html_a205eaac89c47d49cb982bf136e113de2"><div class="ttname"><a href="nn___abort_8h.html#a205eaac89c47d49cb982bf136e113de2">NN_ABORT</a></div><div class="ttdeci">#define NN_ABORT(...)</div><div class="ttdoc">Stops execution.</div><div class="ttdef"><b>Definition:</b> nn_Abort.h:29</div></div>
<div class="ttc" id="ann___abort_8h_html_a5c1a90d3a6474658ae0ac5dc5bcb14e4"><div class="ttname"><a href="nn___abort_8h.html#a5c1a90d3a6474658ae0ac5dc5bcb14e4">NN_ABORT_UNLESS</a></div><div class="ttdeci">#define NN_ABORT_UNLESS(condition,...)</div><div class="ttdoc">Tests whether a condition has been satisfied and stops execution if it has not.</div><div class="ttdef"><b>Definition:</b> nn_Abort.h:38</div></div>
<div class="ttc" id="ann___abort_8h_html_ae872300a22548da2b586ef68d2c048a3"><div class="ttname"><a href="nn___abort_8h.html#ae872300a22548da2b586ef68d2c048a3">NN_ABORT_UNLESS_NOT_NULL</a></div><div class="ttdeci">#define NN_ABORT_UNLESS_NOT_NULL(pointer)</div><div class="ttdoc">Tests whether the pointer is a null pointer and stops execution if it is.</div><div class="ttdef"><b>Definition:</b> nn_Abort.h:56</div></div>
<div class="ttc" id="ann___log_8h_html"><div class="ttname"><a href="nn___log_8h.html">nn_Log.h</a></div><div class="ttdoc">Declarations for the logging API.</div></div>
<div class="ttc" id="ann___log_8h_html_a2d720c8bc6b733bce63879350d134a84"><div class="ttname"><a href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a></div><div class="ttdeci">#define NN_LOG(...)</div><div class="ttdoc">Adds the string specified in the parameter as a log entry.</div><div class="ttdef"><b>Definition:</b> nn_Log.h:33</div></div>
<div class="ttc" id="ann___time_span_8h_html"><div class="ttname"><a href="nn___time_span_8h.html">nn_TimeSpan.h</a></div><div class="ttdoc">TimeSpan class declarations.</div></div>
<div class="ttc" id="astructnn_1_1account_1_1_uid_html"><div class="ttname"><a href="structnn_1_1account_1_1_uid.html">nn::account::Uid</a></div><div class="ttdoc">User identifiers added to the account system.</div><div class="ttdef"><b>Definition:</b> account_Types.h:37</div></div>
<div class="ttc" id="astructnn_1_1account_1_1_user_handle_html"><div class="ttname"><a href="structnn_1_1account_1_1_user_handle.html">nn::account::UserHandle</a></div><div class="ttdoc">The handle for dealing with a user in the Open state.</div><div class="ttdef"><b>Definition:</b> account_Types.h:93</div></div>
<div class="ttc" id="astructnn_1_1os_1_1_memory_info_html"><div class="ttname"><a href="structnn_1_1os_1_1_memory_info.html">nn::os::MemoryInfo</a></div><div class="ttdoc">The structure for storing the obtained memory information.</div><div class="ttdef"><b>Definition:</b> os_DebugTypes.h:52</div></div>
<div class="ttc" id="astructnn_1_1os_1_1_memory_info_html_a179fcdecd518686555036d0db3a5014c"><div class="ttname"><a href="structnn_1_1os_1_1_memory_info.html#a179fcdecd518686555036d0db3a5014c">nn::os::MemoryInfo::totalUsedMemorySize</a></div><div class="ttdeci">size_t totalUsedMemorySize</div><div class="ttdoc">The total amount of memory being used.</div><div class="ttdef"><b>Definition:</b> os_DebugTypes.h:54</div></div>
<div class="ttc" id="astructnn_1_1os_1_1_memory_info_html_a456fd92870975fcf020ad08f8bf7f908"><div class="ttname"><a href="structnn_1_1os_1_1_memory_info.html#a456fd92870975fcf020ad08f8bf7f908">nn::os::MemoryInfo::totalAvailableMemorySize</a></div><div class="ttdeci">uint64_t totalAvailableMemorySize</div><div class="ttdoc">The total amount of available memory.</div><div class="ttdef"><b>Definition:</b> os_DebugTypes.h:53</div></div>
<div class="ttc" id="autil___bit_util_8h_html"><div class="ttname"><a href="util___bit_util_8h.html">util_BitUtil.h</a></div><div class="ttdoc">API declarations for handling bit operations.</div></div>
<div class="ttc" id="autil___scope_exit_8h_html"><div class="ttname"><a href="util___scope_exit_8h.html">util_ScopeExit.h</a></div><div class="ttdoc">Defines the macro that writes the code to run when an object goes out of scope.</div></div>
<div class="ttc" id="autil___scope_exit_8h_html_a674e2d673758265abe6e8e17426489ea"><div class="ttname"><a href="util___scope_exit_8h.html#a674e2d673758265abe6e8e17426489ea">NN_UTIL_SCOPE_EXIT</a></div><div class="ttdeci">#define NN_UTIL_SCOPE_EXIT</div><div class="ttdoc">Macro that writes the process when an object goes out of scope.</div><div class="ttdef"><b>Definition:</b> util_ScopeExit.h:101</div></div>
</div><!-- fragment --><h2><a class="anchor" id="PageSampleFsIndividualFileDataCache_SectionSampleDetail"></a>
Sample Program Description</h2>
<p>This sample program uses a file of approximately 4 MB in the resource sample data (ROM), in addition to 4 MB of save data created by the sample, to perform the following simple benchmarks.</p>
<ul>
<li>Sequential read of all files in the resource data (ROM), using a 4-KB file buffer</li>
<li>Random read of files in the resource data (ROM), with a combined total size of 4 MB, using a 4-KB file buffer</li>
<li>Sequential read/write of all of the save data files, using a 4-KB file buffer</li>
<li>Random read/write of save data files, with a combined total size of 4 MB, using a 4-KB file buffer</li>
</ul>
<p>The sample then measures the running time for each of these access patterns, and saves the results to a log.</p>
<ul>
<li>When using individual file data for reading resource data (ROM)</li>
<li>When not using the file data cache for reading resource data (ROM)</li>
<li>When using individual file data for writing save data</li>
<li>When not using the file data cache for writing save data</li>
<li>When using individual file data for reading save data</li>
<li>When not using the file data cache for reading save data</li>
</ul>
<p>The following example shows the execution results of this sample program. The results vary a little each time the sample program is run.</p>
<pre class="fragment">rom sequential reading test
  individual cache enabled  = 2 ms.
  cache disabled = 1077 ms.

rom random reading test
  individual cache enabled  = 2 ms.
  cache disabled = 3704 ms.

Mount save data as "save"
save data sequential writing test
  individual cache enabled  = 502 ms.
  cache disabled = 515 ms.

save data sequential reading test
  individual cache enabled  = 2 ms.
  cache disabled = 211 ms.

save data random writing test
  individual cache enabled  = 1566 ms.
  cache disabled = 1631 ms.

save data random reading test
  individual cache enabled  = 3 ms.
  cache disabled = 540 ms.
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
</body>
</html>

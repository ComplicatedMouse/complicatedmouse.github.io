<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SocketStatisticsOverlay/SocketStatisticsOverlay.cpp | NintendoSDK API Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<script type="text/javascript" src="searchapi.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   &#160;<span id="projectnumber">14.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">SocketStatisticsOverlay/SocketStatisticsOverlay.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>For an explanation of the source code, see <a class="el" href="_page_sample_socket_statistics_overlay.html">Socket Statistics Overlay</a> and <tt>SocketStatisticsOverlay/SocketStatisticsOverlay.cpp</tt>.</p>
<div class="fragment"><div class="line"><span class="comment">/*--------------------------------------------------------------------------------*</span></div>
<div class="line"><span class="comment">  Copyright Nintendo.  All rights reserved.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  These coded instructions, statements, and computer programs contain proprietary</span></div>
<div class="line"><span class="comment">  information of Nintendo and/or its licensed developers and are protected by</span></div>
<div class="line"><span class="comment">  national and international copyright laws. They may not be disclosed to third</span></div>
<div class="line"><span class="comment">  parties or copied or duplicated in any form, in whole or in part, without the</span></div>
<div class="line"><span class="comment">  prior written consent of Nintendo.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  The content herein is highly confidential and should be handled accordingly.</span></div>
<div class="line"><span class="comment"> *--------------------------------------------------------------------------------*/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nn___log_8h.html">nn/nn_Log.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;nn/nn_SignedSize.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;nn/nifm.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;nn/nifm/nifm_ApiIpAddress.h&gt;</span> <span class="comment">// nn::socket::GetCurrentPrimaryIpAddress</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="socket_8h.html">nn/socket.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cstring&gt;</span> <span class="comment">// strstr</span></div>
<div class="line"><span class="preprocessor">#include &lt;cstdio&gt;</span>  <span class="comment">// sscanf</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace</span></div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> KB                  = 1024;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> MessageBufferSize   = 8 * KB;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> IpAddressBufferSize = 16;       <span class="comment">// Includes the null terminator (&quot;xxx.xxx.xxx.xxx&quot;).</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> PortBufferSize      = 6;        <span class="comment">// Includes the null terminator (&quot;xxxxx&quot;).</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> ThreadStackSize     = 128 * KB;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> ServerThreadCount   = 2;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> TcpThreadIndex      = 0;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> UdpThreadIndex      = 1;</div>
<div class="line"> </div>
<div class="line"><a name="_a0"></a><a class="code" href="structnn_1_1os_1_1_thread_type.html">nn::os::ThreadType</a> g_threads[ServerThreadCount];</div>
<div class="line"><a name="a1"></a><a class="code" href="os___thread_common_8h.html#a5ce0c3c0aaceb976178a60a18d90f470">NN_OS_ALIGNAS_THREAD_STACK</a> uint8_t g_threadStacks[ServerThreadCount][ThreadStackSize];</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Socket configuration and memory pool.</span></div>
<div class="line"><a name="_a2"></a><a class="code" href="classnn_1_1socket_1_1_config_with_memory.html">nn::socket::ConfigWithMemory</a>&lt;2,3,</div>
<div class="line">                             10 * KB, 10 * KB,  <span class="comment">// TCP send/recv msgBuffer (default)</span></div>
<div class="line">                             5  * KB, 5  * KB,  <span class="comment">// TCP send/recv msgBuffer auto-msgBuffer</span></div>
<div class="line">                             10 * KB, 10 * KB,  <span class="comment">// UDP send/recv (default)</span></div>
<div class="line">                             2,                 <span class="comment">// Efficiency factor (memory multiplier for fragmentation).</span></div>
<div class="line">                             16 * KB&gt;           <span class="comment">// DNS resolver memory.</span></div>
<div class="line">g_SocketConfigWithMemory(nn::socket::DefaultConcurrencyLimit);</div>
<div class="line"><a name="_a3"></a><a class="code" href="structnn_1_1socket_1_1_statistics_memory.html">nn::socket::StatisticsMemory</a> g_statsMem;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">char</span> g_TcpServerBuffer[MessageBufferSize] = { 0 };</div>
<div class="line"><span class="keywordtype">char</span> g_UdpServerBuffer[MessageBufferSize] = { 0 };</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MSG_HelloServer &quot;-----HelloServer-----&quot;</span></div>
<div class="line"><span class="preprocessor">#define MSG_HelloClient &quot;-----HelloClient-----&quot;</span></div>
<div class="line"><span class="preprocessor">#define MSG_BurstSend   &quot;-----DoBurstSend-----&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> Msg_HelloServer[] = MSG_HelloServer;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> Msg_HelloClient[] = MSG_HelloClient;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> Msg_BurstSend[]   = MSG_BurstSend;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> BurstSendSizeKB = 192;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Create a BurstSendMessage with a specified send and receive period.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">int</span> BurstSendMessageCreate(<span class="keywordtype">char</span>* buffer, uint32_t bufferlen, uint32_t sendPeriodMs, uint32_t recvPeriodMs)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Message layout (#BurstSendMessage)</span></div>
<div class="line">    <span class="comment">// &quot;msg_BurstSend&quot; &quot;send:###&quot; &quot;recv:###&quot; &quot;\0&quot;</span></div>
<div class="line">    <span class="keywordtype">int</span> len = snprintf(buffer, bufferlen,</div>
<div class="line">             <span class="stringliteral">&quot;%s&quot;</span>          <span class="stringliteral">&quot;send:%u&quot;</span>   <span class="stringliteral">&quot;recv:%u&quot;</span>,</div>
<div class="line">             Msg_BurstSend, sendPeriodMs, recvPeriodMs);</div>
<div class="line">    <span class="keywordflow">return</span> len + 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Parse msgBuffer to extract BurstSendMessage&#39;s requested send and receive periods.</span></div>
<div class="line"><span class="comment">// success == true, failure == false.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">bool</span> BurstSendMessageGetPeriods(<span class="keyword">const</span> <span class="keywordtype">char</span>* msgBuffer, uint32_t* sendPeriod, uint32_t* recvPeriod)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Message layout (#BurstSendMessage)</span></div>
<div class="line">    <span class="comment">// &quot;msg_BurstSend&quot; &quot;send:###&quot; &quot;recv:###&quot; &quot;\0&quot;</span></div>
<div class="line">    uint32_t snd;</div>
<div class="line">    uint32_t rcv;</div>
<div class="line">    <span class="keywordflow">if</span>(sscanf (msgBuffer, MSG_BurstSend <span class="stringliteral">&quot;send:%urecv:%u&quot;</span>, &amp;snd, &amp;rcv) == 2)</div>
<div class="line">    {</div>
<div class="line">        *sendPeriod = snd;</div>
<div class="line">        *recvPeriod = rcv;</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <a name="a4"></a><a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;BurstSendMessageGetPeriods failed.\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Resize the specified socket file descriptor (fd) to have the size of its send and receive</span></div>
<div class="line"><span class="comment">// buffers changed to sendSize and recvSize.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">void</span> ResizeSocketSendRecvBuff(<span class="keywordtype">int</span> fd, uint32_t sendSize, uint32_t recvSize)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Resize the socket send/recv msgBuffer to 8 KB.</span></div>
<div class="line">    <a name="a5"></a><a class="code" href="nn___abort_8h.html#a5c1a90d3a6474658ae0ac5dc5bcb14e4">NN_ABORT_UNLESS</a>(</div>
<div class="line">        <a name="a6"></a><a class="code" href="namespacenn_1_1socket.html#afaa7ccade3133a9884ab0b8e44ac18fc">nn::socket::SetSockOpt</a>(fd, <a name="a7"></a><a class="code" href="namespacenn_1_1socket.html#a8f9b7859b60d1ee546e472a7e2a9beaaa4418133767fb2aecc740f56abdda0a07">nn::socket::Level::Sol_Socket</a>, <a name="a8"></a><a class="code" href="namespacenn_1_1socket.html#a9706518d71ec37371e9aa3ae9a2fa92ca4078c1b605c4c29f21a0bf25944c0cd4">nn::socket::Option::So_SndBuf</a>, &amp;sendSize, <span class="keyword">sizeof</span>(sendSize)) == 0,</div>
<div class="line">        <span class="stringliteral">&quot;Failed to set socket&#39;s send buffer size to %u bytes on socket fd %d (errno: %u)!\n&quot;</span>, sendSize, fd, <a name="a9"></a><a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="nn___abort_8h.html#a5c1a90d3a6474658ae0ac5dc5bcb14e4">NN_ABORT_UNLESS</a>(</div>
<div class="line">        <a class="code" href="namespacenn_1_1socket.html#afaa7ccade3133a9884ab0b8e44ac18fc">nn::socket::SetSockOpt</a>(fd, <a class="code" href="namespacenn_1_1socket.html#a8f9b7859b60d1ee546e472a7e2a9beaaa4418133767fb2aecc740f56abdda0a07">nn::socket::Level::Sol_Socket</a>, <a name="a10"></a><a class="code" href="namespacenn_1_1socket.html#a9706518d71ec37371e9aa3ae9a2fa92ca1600030ecdfa4988343a0182c2716781">nn::socket::Option::So_RcvBuf</a>, &amp;recvSize, <span class="keyword">sizeof</span>(recvSize)) == 0,</div>
<div class="line">        <span class="stringliteral">&quot;Failed to set socket&#39;s receive buffer size to %u bytes on socket fd %d (errno: %u)!\n&quot;</span>, recvSize, fd, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> RunTcpServerProcess(<span class="keywordtype">void</span> * data)</div>
<div class="line">{</div>
<div class="line">    <a name="a11"></a><a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(data);</div>
<div class="line">    <a name="_a12"></a><a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html">nn::socket::SockAddrIn</a> saServer = { 0 };</div>
<div class="line">    <span class="keywordtype">int</span> socketDescriptor            = -1;</div>
<div class="line">    <span class="keywordtype">int</span> clientSocketDescriptor      = -1;</div>
<div class="line">    <a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html">nn::socket::SockAddrIn</a> sa       = { 0 };</div>
<div class="line">    <a class="code" href="namespacenn_1_1socket.html#a0da164bafc83a64e6a51068805e5df52">nn::socket::SockLenT</a> saLen      = <span class="keyword">sizeof</span>(sa);</div>
<div class="line">    <a name="_a13"></a><a class="code" href="structnn_1_1socket_1_1_in_addr.html">nn::socket::InAddr</a> outIpAddress = { 0 };</div>
<div class="line">    <a name="_a14"></a><a class="code" href="classnn_1_1_result.html">nn::Result</a> result               = <a class="code" href="classnn_1_1_result.html">nn::Result</a>();</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;-- Tcp Server startup --\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((socketDescriptor = <a name="a15"></a><a class="code" href="namespacenn_1_1socket.html#a9afeb564bac1d0c04af2fec1f00c739f">nn::socket::Socket</a>(<a name="a16"></a><a class="code" href="namespacenn_1_1socket.html#a057d985148e23267303e6d00d7ed205daa4d833d8c15a76105639ddd11bcb614e">nn::socket::Family::Af_Inet</a>, <a name="a17"></a><a class="code" href="namespacenn_1_1socket.html#a1db675083dcccec6500d1435c5dfeaeaae703319723c99d2d3a7ba1ad0dc8f572">nn::socket::Type::Sock_Stream</a>, <a name="a18"></a><a class="code" href="namespacenn_1_1socket.html#a46347de69614965469ac8f3c8056468eaf07a075529789e7d91eefbce84c55d90">nn::socket::Protocol::IpProto_Tcp</a>)) &lt; 0 )</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Server: Socket failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    saServer.<a name="a19"></a><a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html#a7fe5afa2fe039b8bbf5a23fae30fe755">sin_addr</a>.<a name="a20"></a><a class="code" href="structnn_1_1socket_1_1_in_addr.html#a4bf7f3c8a8061edacb8f884b61c49a2e">S_addr</a> = <a name="a21"></a><a class="code" href="namespacenn_1_1socket.html#a24652de2bb3beca4cd692b4c3f7141db">nn::socket::InetHtonl</a>(<a name="a22"></a><a class="code" href="namespacenn_1_1socket.html#a0bc37587294a2f6b385cf080b6fafa40">nn::socket::InAddr_Any</a>);</div>
<div class="line">    saServer.<a name="a23"></a><a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html#ae37d378c458d394a0646d7bfcf72bc4d">sin_port</a>        = <a name="a24"></a><a class="code" href="namespacenn_1_1socket.html#a1b6e15ce629648357cf10cc8ada6b8d1">nn::socket::InetHtons</a>(0);</div>
<div class="line">    saServer.<a name="a25"></a><a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html#ac8e09f776d8331345ee1870f3aed4535">sin_family</a>      = <a class="code" href="namespacenn_1_1socket.html#a057d985148e23267303e6d00d7ed205daa4d833d8c15a76105639ddd11bcb614e">nn::socket::Family::Af_Inet</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a26"></a><a class="code" href="namespacenn_1_1socket.html#a09255737b952ba3ad3a647607fc2af0a">nn::socket::Bind</a>(socketDescriptor, <span class="keyword">reinterpret_cast&lt;</span><a name="_a27"></a><a class="code" href="structnn_1_1socket_1_1_sock_addr.html">nn::socket::SockAddr</a> *<span class="keyword">&gt;</span>(&amp;saServer), <span class="keyword">sizeof</span>(saServer)) &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Server: Bind failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">        <span class="keywordflow">goto</span> EXIT;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a28"></a><a class="code" href="namespacenn_1_1socket.html#adb89c6a0abfc8befcdc1ce05bf49e0ce">nn::socket::GetSockName</a>(socketDescriptor, <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="structnn_1_1socket_1_1_sock_addr.html">nn::socket::SockAddr</a> *<span class="keyword">&gt;</span>(&amp;sa), &amp;saLen) &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Server: GetSockName failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">        <span class="keywordflow">goto</span> EXIT;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Resize the socket send/recv msgBuffer to 24 KB.</span></div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Server: Resizing the listen socket send and receive buffers to 24 KB.\n&quot;</span>);</div>
<div class="line">    ResizeSocketSendRecvBuff(socketDescriptor, 24 * KB, 24 * KB);</div>
<div class="line"> </div>
<div class="line">    result = <a name="a29"></a><a class="code" href="namespacenn_1_1nifm.html#a0e8decfaa75a91d659edc2d1aec0af91">nn::nifm::GetCurrentPrimaryIpAddress</a>(&amp;outIpAddress);</div>
<div class="line">    <span class="keywordflow">if</span> (result.IsSuccess())</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Server: Listening for incoming messages on fd %d at: %s:%d.\n&quot;</span>,</div>
<div class="line">            socketDescriptor,</div>
<div class="line">            <a name="a30"></a><a class="code" href="namespacenn_1_1socket.html#af90b8239ae0f5fbd70f12f9980fdac76">nn::socket::InetNtoa</a>(outIpAddress),</div>
<div class="line">            <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a name="a31"></a><a class="code" href="namespacenn_1_1socket.html#aa8de3f19aaf80d2233a668fc7ebe6f38">nn::socket::InetNtohs</a>(sa.<a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html#ae37d378c458d394a0646d7bfcf72bc4d">sin_port</a>)));</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Server: GetCurrentIpAddress failed (error %d)\n&quot;</span>, result.GetDescription());</div>
<div class="line">        <span class="keywordflow">goto</span> EXIT;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a name="a32"></a><a class="code" href="namespacenn_1_1socket.html#ad6c2c6b2d1cd467bfdbfb4bf4057338b">nn::socket::Listen</a>(socketDescriptor, 4);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (<a name="a33"></a><a class="code" href="nn___macro_8h.html#a71c0f58f6d49fe1392380eed4509ab9a">NN_STATIC_CONDITION</a>(<span class="keyword">true</span>))</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Serve one client at a time.</span></div>
<div class="line">        <span class="keywordflow">if</span> (clientSocketDescriptor == -1)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html">nn::socket::SockAddrIn</a> saClientAddress = { 0 };</div>
<div class="line">            <a class="code" href="namespacenn_1_1socket.html#a0da164bafc83a64e6a51068805e5df52">nn::socket::SockLenT</a> clientAddressSize = <span class="keyword">sizeof</span>(saClientAddress);</div>
<div class="line">            <span class="keywordflow">if</span> ((clientSocketDescriptor = <a name="a34"></a><a class="code" href="namespacenn_1_1socket.html#a56b1fbede96c61d4c94ba51a3cc563b3">nn::socket::Accept</a>(socketDescriptor, <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="structnn_1_1socket_1_1_sock_addr.html">nn::socket::SockAddr</a> *<span class="keyword">&gt;</span>(&amp;saClientAddress), &amp;clientAddressSize)) &lt; 0)</div>
<div class="line">            {</div>
<div class="line">                <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Server: Accept failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">                <span class="keywordflow">goto</span> EXIT;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Server: Connection accepted from %s:%d creating fd: %d.\n&quot;</span>,</div>
<div class="line">                <a class="code" href="namespacenn_1_1socket.html#af90b8239ae0f5fbd70f12f9980fdac76">nn::socket::InetNtoa</a>(saClientAddress.<a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html#a7fe5afa2fe039b8bbf5a23fae30fe755">sin_addr</a>),</div>
<div class="line">                <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacenn_1_1socket.html#aa8de3f19aaf80d2233a668fc7ebe6f38">nn::socket::InetNtohs</a>(saClientAddress.<a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html#ae37d378c458d394a0646d7bfcf72bc4d">sin_port</a>)),</div>
<div class="line">                clientSocketDescriptor);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Resize the socket send/recv msgBuffer to 24 KB.</span></div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Server: Resizing the client socket send and receive buffers to 24 KB.\n&quot;</span>);</div>
<div class="line">            ResizeSocketSendRecvBuff(clientSocketDescriptor, 24 * KB, 24 * KB);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        nn::SignedSize readBytes = 0;</div>
<div class="line">        <span class="keywordflow">if</span> ((readBytes = <a name="a35"></a><a class="code" href="namespacenn_1_1socket.html#aab976ffcd7654964700d4188df861647">nn::socket::Recv</a>(clientSocketDescriptor, g_TcpServerBuffer, <span class="keyword">sizeof</span>(g_TcpServerBuffer) - 1, <a name="a36"></a><a class="code" href="namespacenn_1_1socket.html#a821ac1738bb13dce9aa9d83fe5950e52a7a99ac706c1462eb6f473b328821257e">nn::socket::MsgFlag::Msg_None</a>)) &gt; 0)</div>
<div class="line">        {</div>
<div class="line">            g_TcpServerBuffer[readBytes] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Server: Received: %s\n&quot;</span>, g_TcpServerBuffer);</div>
<div class="line">            <span class="comment">// ~~~ Process Requests ~~~</span></div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Process: Burst Send Request</span></div>
<div class="line">            <span class="keywordflow">if</span> (memcmp(g_TcpServerBuffer, Msg_BurstSend, <span class="keyword">sizeof</span>(Msg_BurstSend) - 1) == 0)</div>
<div class="line">            {</div>
<div class="line">                uint32_t sendPeriodMs = 100;</div>
<div class="line">                uint32_t recvPeriodMs = 100;</div>
<div class="line">                BurstSendMessageGetPeriods(g_TcpServerBuffer, &amp;sendPeriodMs, &amp;recvPeriodMs);</div>
<div class="line"> </div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordtype">float</span> sendRate = (1000.0f / sendPeriodMs); <span class="comment">// in KB/sec</span></div>
<div class="line">                    <span class="keywordtype">float</span> recvRate = (1000.0f / recvPeriodMs); <span class="comment">// in KB/sec</span></div>
<div class="line">                    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Server: Burst send request.\n&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;  Tcp Server send at %.2f KB/sec\n&quot;</span></div>
<div class="line">                           <span class="stringliteral">&quot;  Tcp Client recv at %.2f KB/sec\n&quot;</span>,</div>
<div class="line">                           sendRate,</div>
<div class="line">                           recvRate);</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// Send a bunch to the client.</span></div>
<div class="line">                <span class="keyword">const</span> <span class="keywordtype">char</span> sendBuffer[1 * KB] = {};</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; BurstSendSizeKB; ++i)</div>
<div class="line">                {</div>
<div class="line">                    <a name="a37"></a><a class="code" href="namespacenn_1_1os.html#a96b335e87af44c60a0d6dca75f11c9d2">nn::os::SleepThread</a>(<a name="a38"></a><a class="code" href="classnn_1_1_time_span.html#a2441d3c84cc24b901342ce11f87cd39c">nn::TimeSpan::FromMilliSeconds</a>(sendPeriodMs));</div>
<div class="line">                    nn::SignedSize sentBytes = 0;</div>
<div class="line">                    <span class="keywordflow">while</span> (sentBytes != <span class="keyword">sizeof</span>(sendBuffer))</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">if</span> ((sentBytes += <a name="a39"></a><a class="code" href="namespacenn_1_1socket.html#a27f36d8472582558c3cb4a31464f50a0">nn::socket::Send</a>(clientSocketDescriptor, sendBuffer + sentBytes, <span class="keyword">sizeof</span>(sendBuffer) - sentBytes, <a class="code" href="namespacenn_1_1socket.html#a821ac1738bb13dce9aa9d83fe5950e52a7a99ac706c1462eb6f473b328821257e">nn::socket::MsgFlag::Msg_None</a>)) &lt; 0)</div>
<div class="line">                        {</div>
<div class="line">                            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Server: Send failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">                            <a name="a40"></a><a class="code" href="namespacenn_1_1socket.html#ae01110d228e2148d830b1ecfb9aaa425">nn::socket::Close</a>(clientSocketDescriptor);</div>
<div class="line">                            <span class="keywordflow">goto</span> EXIT;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (readBytes == 0)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacenn_1_1socket.html#ae01110d228e2148d830b1ecfb9aaa425">nn::socket::Close</a>(clientSocketDescriptor);</div>
<div class="line">            clientSocketDescriptor = -1;</div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Server: Client disconnected.\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacenn_1_1socket.html#ae01110d228e2148d830b1ecfb9aaa425">nn::socket::Close</a>(clientSocketDescriptor);</div>
<div class="line">            clientSocketDescriptor = -1;</div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Server: Receive failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">EXIT:</div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Terminating the TCP server.\n&quot;</span>);</div>
<div class="line">    <a class="code" href="namespacenn_1_1socket.html#ae01110d228e2148d830b1ecfb9aaa425">nn::socket::Close</a>(socketDescriptor);</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">} <span class="comment">// NOLINT(impl/function_size)</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> RunUdpServerProcess(<span class="keywordtype">void</span> * data)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(data);</div>
<div class="line">    <a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html">nn::socket::SockAddrIn</a>  saServer = { 0 };</div>
<div class="line">    <span class="keywordtype">int</span>                     socketDescriptor = -1;</div>
<div class="line">    <a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html">nn::socket::SockAddrIn</a>  sa = { 0 };</div>
<div class="line">    <a class="code" href="namespacenn_1_1socket.html#a0da164bafc83a64e6a51068805e5df52">nn::socket::SockLenT</a>    saLen = <span class="keyword">sizeof</span>(sa);</div>
<div class="line">    <a class="code" href="structnn_1_1socket_1_1_in_addr.html">nn::socket::InAddr</a>      outIpAddress = { 0 };</div>
<div class="line">    <a class="code" href="classnn_1_1_result.html">nn::Result</a>              result = <a class="code" href="classnn_1_1_result.html">nn::Result</a>();</div>
<div class="line">    <span class="keywordtype">int</span> pollRes = 0;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;-- UDP Server Startup --\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((socketDescriptor = <a class="code" href="namespacenn_1_1socket.html#a9afeb564bac1d0c04af2fec1f00c739f">nn::socket::Socket</a>(<a class="code" href="namespacenn_1_1socket.html#a057d985148e23267303e6d00d7ed205daa4d833d8c15a76105639ddd11bcb614e">nn::socket::Family::Af_Inet</a>, <a name="a41"></a><a class="code" href="namespacenn_1_1socket.html#a1db675083dcccec6500d1435c5dfeaeaa4cc079142a1be58955eb22bed651ebba">nn::socket::Type::Sock_Dgram</a>, <a name="a42"></a><a class="code" href="namespacenn_1_1socket.html#a46347de69614965469ac8f3c8056468ea48e0b0b8eaaf71a2c2c0ebfa0e802b1a">nn::socket::Protocol::IpProto_Udp</a>)) &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Server: Socket failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    saServer.<a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html#a7fe5afa2fe039b8bbf5a23fae30fe755">sin_addr</a>.<a class="code" href="structnn_1_1socket_1_1_in_addr.html#a4bf7f3c8a8061edacb8f884b61c49a2e">S_addr</a> = <a class="code" href="namespacenn_1_1socket.html#a24652de2bb3beca4cd692b4c3f7141db">nn::socket::InetHtonl</a>(<a class="code" href="namespacenn_1_1socket.html#a0bc37587294a2f6b385cf080b6fafa40">nn::socket::InAddr_Any</a>);</div>
<div class="line">    saServer.<a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html#ae37d378c458d394a0646d7bfcf72bc4d">sin_port</a>        = <a class="code" href="namespacenn_1_1socket.html#a1b6e15ce629648357cf10cc8ada6b8d1">nn::socket::InetHtons</a>(0);</div>
<div class="line">    saServer.<a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html#ac8e09f776d8331345ee1870f3aed4535">sin_family</a>      = <a class="code" href="namespacenn_1_1socket.html#a057d985148e23267303e6d00d7ed205daa4d833d8c15a76105639ddd11bcb614e">nn::socket::Family::Af_Inet</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="namespacenn_1_1socket.html#a09255737b952ba3ad3a647607fc2af0a">nn::socket::Bind</a>(socketDescriptor, <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="structnn_1_1socket_1_1_sock_addr.html">nn::socket::SockAddr</a> *<span class="keyword">&gt;</span>(&amp;saServer), <span class="keyword">sizeof</span>(saServer)) &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Server: Bind failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">        <span class="keywordflow">goto</span> EXIT;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="namespacenn_1_1socket.html#adb89c6a0abfc8befcdc1ce05bf49e0ce">nn::socket::GetSockName</a>(socketDescriptor, <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="structnn_1_1socket_1_1_sock_addr.html">nn::socket::SockAddr</a> *<span class="keyword">&gt;</span>(&amp;sa), &amp;saLen) &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Server: GetSockName failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">        <span class="keywordflow">goto</span> EXIT;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Resize the socket send/recv msgBuffer to 24 KB.</span></div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Server: Resizing the send and receive buffers to 24 KB.\n&quot;</span>);</div>
<div class="line">    ResizeSocketSendRecvBuff(socketDescriptor, 24 * KB, 24 * KB);</div>
<div class="line"> </div>
<div class="line">    result = <a class="code" href="namespacenn_1_1nifm.html#a0e8decfaa75a91d659edc2d1aec0af91">nn::nifm::GetCurrentPrimaryIpAddress</a>(&amp;outIpAddress);</div>
<div class="line">    <span class="keywordflow">if</span> (result.IsSuccess())</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Server: Listening for incoming messages on fd %d at: %s:%d.\n&quot;</span>,</div>
<div class="line">            socketDescriptor,</div>
<div class="line">            <a class="code" href="namespacenn_1_1socket.html#af90b8239ae0f5fbd70f12f9980fdac76">nn::socket::InetNtoa</a>(outIpAddress),</div>
<div class="line">            <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacenn_1_1socket.html#aa8de3f19aaf80d2233a668fc7ebe6f38">nn::socket::InetNtohs</a>(sa.<a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html#ae37d378c458d394a0646d7bfcf72bc4d">sin_port</a>)));</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Server: GetCurrentIpAddress failed (error %d)\n&quot;</span>, result.GetDescription());</div>
<div class="line">        <span class="keywordflow">goto</span> EXIT;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a name="_a43"></a><a class="code" href="structnn_1_1socket_1_1_poll_fd.html">nn::socket::PollFd</a> pollFd;</div>
<div class="line">    pollFd.<a name="a44"></a><a class="code" href="structnn_1_1socket_1_1_poll_fd.html#a778aa060c42157a250cf459f7cfea273">fd</a> = socketDescriptor;</div>
<div class="line">    pollFd.<a name="a45"></a><a class="code" href="structnn_1_1socket_1_1_poll_fd.html#ab5c064cf340ae80e805a84e927dcdb9f">events</a> = <a name="a46"></a><a class="code" href="namespacenn_1_1socket.html#a2b8c53cba8a2be170c93a76742b092c9a1b0bed7d85ba6b2cbe91629776e3ee6d">nn::socket::PollEvent::PollIn</a>;</div>
<div class="line">    pollFd.<a name="a47"></a><a class="code" href="structnn_1_1socket_1_1_poll_fd.html#aca13d3c2b88fcd0292ecbcbbbc5f85dc">revents</a> = nn::socket::PollEvent::PollNone;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> ((pollRes = <a name="a48"></a><a class="code" href="namespacenn_1_1socket.html#ad9e109d18fb43f275742d74d74d06cde">nn::socket::Poll</a>(&amp;pollFd, 1, <a name="a49"></a><a class="code" href="namespacenn_1_1socket.html#ac63165d8f4ab675489cda23034aa9eeb">nn::socket::InfTim</a>)) != 0)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (pollRes == -1)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Server: Poll (error %d)\n&quot;</span>, result.GetDescription());</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html">nn::socket::SockAddrIn</a> clientAddr = {};</div>
<div class="line">        <a class="code" href="namespacenn_1_1socket.html#a0da164bafc83a64e6a51068805e5df52">nn::socket::SockLenT</a> clientAddrLen = <span class="keyword">sizeof</span>(clientAddr);</div>
<div class="line">        nn::SignedSize bytesRead = 0;</div>
<div class="line"> </div>
<div class="line">        bytesRead = <a name="a50"></a><a class="code" href="namespacenn_1_1socket.html#ab6cd7b0b7c70edbe79d0d6adb110fc61">nn::socket::RecvFrom</a>(socketDescriptor, g_UdpServerBuffer, <span class="keyword">sizeof</span>(g_UdpServerBuffer) - 1, <a class="code" href="namespacenn_1_1socket.html#a821ac1738bb13dce9aa9d83fe5950e52a7a99ac706c1462eb6f473b328821257e">nn::socket::MsgFlag::Msg_None</a>, <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="structnn_1_1socket_1_1_sock_addr.html">nn::socket::SockAddr</a> *<span class="keyword">&gt;</span>(&amp;clientAddr), &amp;clientAddrLen);</div>
<div class="line">        g_UdpServerBuffer[bytesRead] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Server: Received \&quot;%s\&quot;.\n&quot;</span>, g_UdpServerBuffer);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// ~~~ Process Message ~~~</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Process: Hello Server</span></div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(g_UdpServerBuffer, Msg_HelloServer, <span class="keyword">sizeof</span>(Msg_HelloServer)) == 0)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Server: Processing Hello Server.\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (<a name="a51"></a><a class="code" href="namespacenn_1_1socket.html#a5b46436474c9d07a48fe4bd7786abc0c">nn::socket::SendTo</a>(socketDescriptor, Msg_HelloClient, <span class="keyword">sizeof</span>(Msg_HelloClient), <a class="code" href="namespacenn_1_1socket.html#a821ac1738bb13dce9aa9d83fe5950e52a7a99ac706c1462eb6f473b328821257e">nn::socket::MsgFlag::Msg_None</a>, <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="structnn_1_1socket_1_1_sock_addr.html">nn::socket::SockAddr</a> *<span class="keyword">&gt;</span>(&amp;clientAddr), clientAddrLen) &lt; 0)</div>
<div class="line">            {</div>
<div class="line">                <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Server: Failed to send Hello Client message.\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">goto</span> EXIT;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Process: Burst Send Request</span></div>
<div class="line">        <span class="keywordflow">if</span> (memcmp(g_UdpServerBuffer, Msg_BurstSend, <span class="keyword">sizeof</span>(Msg_BurstSend) - 1) == 0)</div>
<div class="line">        {</div>
<div class="line">            uint32_t sendPeriodMs = 100;</div>
<div class="line">            uint32_t recvPeriodMs = 100;</div>
<div class="line">            BurstSendMessageGetPeriods(g_UdpServerBuffer, &amp;sendPeriodMs, &amp;recvPeriodMs);</div>
<div class="line"> </div>
<div class="line">            {</div>
<div class="line">                <span class="keywordtype">float</span> sendRate = (1000.0f / sendPeriodMs); <span class="comment">// in KB/sec</span></div>
<div class="line">                <span class="keywordtype">float</span> recvRate = (1000.0f / recvPeriodMs); <span class="comment">// in KB/sec</span></div>
<div class="line">                <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Server: Burst send request.\n&quot;</span></div>
<div class="line">                       <span class="stringliteral">&quot;  Udp Server send at %.2f KB/sec\n&quot;</span></div>
<div class="line">                       <span class="stringliteral">&quot;  Udp Client recv at %.2f KB/sec\n&quot;</span>,</div>
<div class="line">                       sendRate,</div>
<div class="line">                       recvRate);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Send a bunch to the client.</span></div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">char</span> sendBuffer[1 * KB] = {};</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; BurstSendSizeKB; ++i)</div>
<div class="line">            {</div>
<div class="line">                <a class="code" href="namespacenn_1_1os.html#a96b335e87af44c60a0d6dca75f11c9d2">nn::os::SleepThread</a>(<a class="code" href="classnn_1_1_time_span.html#a2441d3c84cc24b901342ce11f87cd39c">nn::TimeSpan::FromMilliSeconds</a>(sendPeriodMs));</div>
<div class="line">                nn::SignedSize bytesSent = 0;</div>
<div class="line">                <span class="keywordflow">while</span> (bytesSent != <span class="keyword">sizeof</span>(sendBuffer))</div>
<div class="line">                {</div>
<div class="line">                    nn::SignedSize res = <a class="code" href="namespacenn_1_1socket.html#a5b46436474c9d07a48fe4bd7786abc0c">nn::socket::SendTo</a>(socketDescriptor, sendBuffer + bytesSent, <span class="keyword">sizeof</span>(sendBuffer) - bytesSent, <a class="code" href="namespacenn_1_1socket.html#a821ac1738bb13dce9aa9d83fe5950e52a7a99ac706c1462eb6f473b328821257e">nn::socket::MsgFlag::Msg_None</a>, <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="structnn_1_1socket_1_1_sock_addr.html">nn::socket::SockAddr</a> *<span class="keyword">&gt;</span>(&amp;clientAddr), clientAddrLen);</div>
<div class="line">                    <span class="keywordflow">if</span> (res == -1)</div>
<div class="line">                    {</div>
<div class="line">                        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Server: Failed to send UDP (error %d)\n&quot;</span>, result.GetDescription());</div>
<div class="line">                        <span class="keywordflow">goto</span> EXIT;</div>
<div class="line">                    }</div>
<div class="line">                    bytesSent += res;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">EXIT:</div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Terminating the UDP server.\n&quot;</span>);</div>
<div class="line">    <a class="code" href="namespacenn_1_1socket.html#ae01110d228e2148d830b1ecfb9aaa425">nn::socket::Close</a>(socketDescriptor);</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">} <span class="comment">// NOLINT(impl/function_size)</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> DoClientReceiveBurst(<span class="keywordtype">bool</span> isTcp, <span class="keywordtype">int</span> socketDescriptor, uint32_t sendPeriodMs, uint32_t recvPeriodMs)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Receive msgBuffer buildup.</span></div>
<div class="line">    <span class="keywordflow">if</span> (isTcp)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">char</span> burstMessage[256] = {};</div>
<div class="line">        <span class="keywordtype">int</span> len = BurstSendMessageCreate(burstMessage, <span class="keyword">sizeof</span>(burstMessage) - 1, sendPeriodMs, recvPeriodMs);</div>
<div class="line">        <span class="comment">// Send request.</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="namespacenn_1_1socket.html#a27f36d8472582558c3cb4a31464f50a0">nn::socket::Send</a>(socketDescriptor, burstMessage, len, <a class="code" href="namespacenn_1_1socket.html#a821ac1738bb13dce9aa9d83fe5950e52a7a99ac706c1462eb6f473b328821257e">nn::socket::MsgFlag::Msg_None</a>) &lt; 0)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Client: Failed to send the burst receive request. (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">char</span> recvBuffer[1 * KB] = {};</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; BurstSendSizeKB; ++i)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a96b335e87af44c60a0d6dca75f11c9d2">nn::os::SleepThread</a>(<a class="code" href="classnn_1_1_time_span.html#a2441d3c84cc24b901342ce11f87cd39c">nn::TimeSpan::FromMilliSeconds</a>(recvPeriodMs));</div>
<div class="line">            nn::SignedSize bytesRead = 0;</div>
<div class="line">            <span class="keywordflow">while</span> (bytesRead != <span class="keyword">sizeof</span>(recvBuffer))</div>
<div class="line">            {</div>
<div class="line">                nn::SignedSize res = 0;</div>
<div class="line">                res = <a class="code" href="namespacenn_1_1socket.html#aab976ffcd7654964700d4188df861647">nn::socket::Recv</a>(socketDescriptor, recvBuffer + bytesRead, <span class="keyword">sizeof</span>(recvBuffer) - bytesRead, <a class="code" href="namespacenn_1_1socket.html#a821ac1738bb13dce9aa9d83fe5950e52a7a99ac706c1462eb6f473b328821257e">nn::socket::MsgFlag::Msg_None</a>);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span>(res == -1)</div>
<div class="line">                {</div>
<div class="line">                    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Client: TCP receive failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line">                bytesRead += res;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="comment">// UDP.</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">char</span> burstMessage[256] = {};</div>
<div class="line">        <span class="keywordtype">int</span> len = BurstSendMessageCreate(burstMessage, <span class="keyword">sizeof</span>(burstMessage) - 1, sendPeriodMs, recvPeriodMs);</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="namespacenn_1_1socket.html#a27f36d8472582558c3cb4a31464f50a0">nn::socket::Send</a>(socketDescriptor, burstMessage, len, <a class="code" href="namespacenn_1_1socket.html#a821ac1738bb13dce9aa9d83fe5950e52a7a99ac706c1462eb6f473b328821257e">nn::socket::MsgFlag::Msg_None</a>) &lt; 0)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Client: SendTo failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">char</span> recvBuffer[1 * KB] = {};</div>
<div class="line">        <span class="keywordtype">int</span> receiveAttempts = 0;</div>
<div class="line">        <span class="comment">// Some UDP packets in the sample are usually dropped, so read until there is nothing more to get.</span></div>
<div class="line">        <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacenn_1_1os.html#a96b335e87af44c60a0d6dca75f11c9d2">nn::os::SleepThread</a>(<a class="code" href="classnn_1_1_time_span.html#a2441d3c84cc24b901342ce11f87cd39c">nn::TimeSpan::FromMilliSeconds</a>(recvPeriodMs));</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="namespacenn_1_1socket.html#aab976ffcd7654964700d4188df861647">nn::socket::Recv</a>(socketDescriptor, recvBuffer, <span class="keyword">sizeof</span>(recvBuffer), <a name="a52"></a><a class="code" href="namespacenn_1_1socket.html#a821ac1738bb13dce9aa9d83fe5950e52a7fba2ade674c746aff1d987a7c23498d">nn::socket::MsgFlag::Msg_DontWait</a>) &lt; 0)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>() != <a name="a53"></a><a class="code" href="namespacenn_1_1socket.html#ad1ade4838b158c7aaf9c9a78338e06aea54cafc2ec81f6d1fe8ba661ade3931cb">nn::socket::Errno::EAgain</a>)</div>
<div class="line">                {</div>
<div class="line">                    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Client: RecvFrom failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span> <span class="comment">// EAgain</span></div>
<div class="line">                {</div>
<div class="line">                    ++receiveAttempts;</div>
<div class="line">                    <span class="keywordflow">if</span> (receiveAttempts &gt; 10) <span class="comment">// Finished receiving?</span></div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            receiveAttempts = 0;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> RunClientProcess(<span class="keywordtype">char</span> *serverIp, <span class="keywordtype">char</span> *serverPort, <span class="keywordtype">bool</span> isTcp)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html">nn::socket::SockAddrIn</a> saServer = { 0 };</div>
<div class="line">    <span class="keywordtype">int</span>         socketDescriptor = -1;</div>
<div class="line">    <a class="code" href="structnn_1_1socket_1_1_in_addr.html">nn::socket::InAddr</a> outAddr = { 0 };</div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a54"></a><a class="code" href="namespacenn_1_1socket.html#a85ef2c54d6090d3c03393f8ab7cad49e">nn::socket::InetAton</a>(serverIp, &amp;outAddr) != 1)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Client: ASCII network address failed to convert to network address.\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    saServer.<a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html#a7fe5afa2fe039b8bbf5a23fae30fe755">sin_addr</a>.<a class="code" href="structnn_1_1socket_1_1_in_addr.html#a4bf7f3c8a8061edacb8f884b61c49a2e">S_addr</a> = outAddr.<a class="code" href="structnn_1_1socket_1_1_in_addr.html#a4bf7f3c8a8061edacb8f884b61c49a2e">S_addr</a>;</div>
<div class="line">    saServer.<a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html#ae37d378c458d394a0646d7bfcf72bc4d">sin_port</a>        = <a class="code" href="namespacenn_1_1socket.html#a1b6e15ce629648357cf10cc8ada6b8d1">nn::socket::InetHtons</a>(<span class="keyword">static_cast&lt;</span>uint16_t<span class="keyword">&gt;</span>(atoi(serverPort)));</div>
<div class="line">    saServer.<a class="code" href="structnn_1_1socket_1_1_sock_addr_in.html#ac8e09f776d8331345ee1870f3aed4535">sin_family</a>      = <a class="code" href="namespacenn_1_1socket.html#a057d985148e23267303e6d00d7ed205daa4d833d8c15a76105639ddd11bcb614e">nn::socket::Family::Af_Inet</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (isTcp)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;-- TCP client startup --\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> ((socketDescriptor = <a class="code" href="namespacenn_1_1socket.html#a9afeb564bac1d0c04af2fec1f00c739f">nn::socket::Socket</a>(<a class="code" href="namespacenn_1_1socket.html#a057d985148e23267303e6d00d7ed205daa4d833d8c15a76105639ddd11bcb614e">nn::socket::Family::Af_Inet</a>, <a class="code" href="namespacenn_1_1socket.html#a1db675083dcccec6500d1435c5dfeaeaae703319723c99d2d3a7ba1ad0dc8f572">nn::socket::Type::Sock_Stream</a>, <a class="code" href="namespacenn_1_1socket.html#a46347de69614965469ac8f3c8056468eaf07a075529789e7d91eefbce84c55d90">nn::socket::Protocol::IpProto_Tcp</a>)) &lt; 0)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Client: Socket failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Client: Connecting to %s:%s.\n&quot;</span>, serverIp, serverPort);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="comment">// UDP</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;-- UDP client startup --\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> ((socketDescriptor = <a class="code" href="namespacenn_1_1socket.html#a9afeb564bac1d0c04af2fec1f00c739f">nn::socket::Socket</a>(<a class="code" href="namespacenn_1_1socket.html#a057d985148e23267303e6d00d7ed205daa4d833d8c15a76105639ddd11bcb614e">nn::socket::Family::Af_Inet</a>, <a class="code" href="namespacenn_1_1socket.html#a1db675083dcccec6500d1435c5dfeaeaa4cc079142a1be58955eb22bed651ebba">nn::socket::Type::Sock_Dgram</a>, <a class="code" href="namespacenn_1_1socket.html#a46347de69614965469ac8f3c8056468ea48e0b0b8eaaf71a2c2c0ebfa0e802b1a">nn::socket::Protocol::IpProto_Udp</a>)) &lt; 0)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Client: Socket failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a55"></a><a class="code" href="namespacenn_1_1socket.html#a3aded7f0c8c072c7beb68a670d03d36f">nn::socket::Connect</a>(socketDescriptor, <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="structnn_1_1socket_1_1_sock_addr.html">nn::socket::SockAddr</a>*<span class="keyword">&gt;</span>(&amp;saServer), <span class="keyword">sizeof</span>(saServer)) == -1)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Client: Connection failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">            <a class="code" href="namespacenn_1_1socket.html#ae01110d228e2148d830b1ecfb9aaa425">nn::socket::Close</a>(socketDescriptor);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (isTcp)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="namespacenn_1_1socket.html#a3aded7f0c8c072c7beb68a670d03d36f">nn::socket::Connect</a>(socketDescriptor, <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="structnn_1_1socket_1_1_sock_addr.html">nn::socket::SockAddr</a> *<span class="keyword">&gt;</span>(&amp;saServer), <span class="keyword">sizeof</span>(saServer)) &lt; 0)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Client: Connection failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">            <span class="keywordflow">goto</span> EXIT;</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Client: Established a TCP connection to the server.\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="comment">// UDP, await hello server response</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="structnn_1_1socket_1_1_poll_fd.html">nn::socket::PollFd</a> pollFd;</div>
<div class="line">        pollFd.<a class="code" href="structnn_1_1socket_1_1_poll_fd.html#ab5c064cf340ae80e805a84e927dcdb9f">events</a> = <a class="code" href="namespacenn_1_1socket.html#a2b8c53cba8a2be170c93a76742b092c9a1b0bed7d85ba6b2cbe91629776e3ee6d">nn::socket::PollEvent::PollIn</a>;</div>
<div class="line">        pollFd.<a class="code" href="structnn_1_1socket_1_1_poll_fd.html#a778aa060c42157a250cf459f7cfea273">fd</a> = socketDescriptor;</div>
<div class="line">        pollFd.<a class="code" href="structnn_1_1socket_1_1_poll_fd.html#aca13d3c2b88fcd0292ecbcbbbc5f85dc">revents</a> = nn::socket::PollEvent::PollNone;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Send hello and wait.</span></div>
<div class="line">        <span class="keywordflow">while</span> (<a class="code" href="nn___macro_8h.html#a71c0f58f6d49fe1392380eed4509ab9a">NN_STATIC_CONDITION</a>(<span class="keyword">true</span>))</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Client: Sending \&quot;HelloServer\&quot;: \&quot;%s\&quot;\n&quot;</span>, Msg_HelloServer);</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="namespacenn_1_1socket.html#a27f36d8472582558c3cb4a31464f50a0">nn::socket::Send</a>(socketDescriptor, Msg_HelloServer, <span class="keyword">sizeof</span>(Msg_HelloServer), <a class="code" href="namespacenn_1_1socket.html#a821ac1738bb13dce9aa9d83fe5950e52a7a99ac706c1462eb6f473b328821257e">nn::socket::MsgFlag::Msg_None</a>) &lt; 0)</div>
<div class="line">            {</div>
<div class="line">                <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Client: Send failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">                <span class="keywordflow">goto</span> EXIT;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Wait 1.25 seconds for the response.</span></div>
<div class="line">            <span class="keywordtype">int</span> res = <a class="code" href="namespacenn_1_1socket.html#ad9e109d18fb43f275742d74d74d06cde">nn::socket::Poll</a>(&amp;pollFd, 1, 1250);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (res == 1) <span class="comment">// Read to read.</span></div>
<div class="line">            {</div>
<div class="line">                <span class="comment">// UDP socket is readable.</span></div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (res == -1)</div>
<div class="line">            {</div>
<div class="line">                <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Client: Poll failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">                <span class="keywordflow">goto</span> EXIT;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Receive hello.</span></div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">char</span> buffer[256 + 1] = {};</div>
<div class="line">            nn::SignedSize bytesRead = 0;</div>
<div class="line">            <span class="keywordflow">if</span> ((bytesRead = <a class="code" href="namespacenn_1_1socket.html#aab976ffcd7654964700d4188df861647">nn::socket::Recv</a>(socketDescriptor, buffer, <span class="keyword">sizeof</span>(buffer) - 1, <a class="code" href="namespacenn_1_1socket.html#a821ac1738bb13dce9aa9d83fe5950e52a7a99ac706c1462eb6f473b328821257e">nn::socket::MsgFlag::Msg_None</a>)) == 0)</div>
<div class="line">            {</div>
<div class="line">                <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Client: Receiving \&quot;HelloClient\&quot; failed (error %d)\n&quot;</span>, <a class="code" href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a>());</div>
<div class="line">                <span class="keywordflow">goto</span> EXIT;</div>
<div class="line">            }</div>
<div class="line">            buffer[bytesRead] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (memcmp(buffer, Msg_HelloClient, <span class="keyword">sizeof</span>(Msg_HelloClient)) != 0)</div>
<div class="line">            {</div>
<div class="line">                <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Client: Received a bad \&quot;HelloClient\&quot; message from the server.\n&quot;</span>);</div>
<div class="line">                <span class="keywordflow">goto</span> EXIT;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;UDP Client: Reached the UDP server.\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Resize the socket send/recv msgBuffer to 16 KB.</span></div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Client: Resizing the send and receive buffers to 16 KB.\n&quot;</span>);</div>
<div class="line">    ResizeSocketSendRecvBuff(socketDescriptor, 16 * KB, 16 * KB);</div>
<div class="line">    <span class="comment">// This sleep is done to show the change in the statistics graph and is not needed for the size change.</span></div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a96b335e87af44c60a0d6dca75f11c9d2">nn::os::SleepThread</a>(<a name="a56"></a><a class="code" href="classnn_1_1_time_span.html#a8e74f5ceb64fc02aa614eed3cc148e82">nn::TimeSpan::FromSeconds</a>(1));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Receive the msgBuffer build-up over time.</span></div>
<div class="line">    <span class="keywordflow">if</span> (isTcp)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>( <span class="stringliteral">&quot;TCP Client: Receive the buffer build-up over time, performance degradation.\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  This will show the client&#39;s tcp socket gradually filling up until\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  either mb_used reaches mb_pool or sb_data reaches sb_size at which point\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  the server will slow its send rate to accommodate the client&#39;s window size.\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  The server app may not see any extra delay on a blocking send call as long as\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  the tcp&#39;s send buffer mb_used does not reach mb_pool and sb_data does not\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  reach sb_size. If the server&#39;s send buffer does become full any blocking send\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  calls will block until there is room to store the tcp sequence as needed.\n\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>( <span class="stringliteral">&quot;UDP Client: Receive the buffer build-up over time, dropped packets.\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  This will show the client&#39;s udp socket gradually filling up until\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  either mb_used reaches mb_pool or sb_data reaches sb_size at which point\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  all future received packets by the client packets are dropped. In a\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  healthy udp connection the receive buffer should not be full or close to\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  full at any time to ensure low latency and room to accommodate unexpected\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  burst udp sends.\n\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (DoClientReceiveBurst(isTcp, socketDescriptor, 100, 125) == -1)</div>
<div class="line">        <span class="keywordflow">goto</span> EXIT;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Resize the socket send/recv msgBuffer to 10 KB.</span></div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Client: Resizing the send and receive buffers to 10 KB.\n&quot;</span>);</div>
<div class="line">    ResizeSocketSendRecvBuff(socketDescriptor, 10 * KB, 10 * KB);</div>
<div class="line">    <span class="comment">// This sleep is done to show the change in the statistics graph and is not needed for the size change.</span></div>
<div class="line">    <a class="code" href="namespacenn_1_1os.html#a96b335e87af44c60a0d6dca75f11c9d2">nn::os::SleepThread</a>(<a class="code" href="classnn_1_1_time_span.html#a8e74f5ceb64fc02aa614eed3cc148e82">nn::TimeSpan::FromSeconds</a>(1));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Receive the msgBuffer healthy.</span></div>
<div class="line">    <span class="keywordflow">if</span> (isTcp)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;TCP Client: Healthy receive buffer.\n&quot;</span></div>
<div class="line">               <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">               <span class="stringliteral">&quot;  As long as we read from the receive socket buffer faster than the server\n&quot;</span></div>
<div class="line">               <span class="stringliteral">&quot;  is sending we will not slow down the stream. If you have a large burst that\n&quot;</span></div>
<div class="line">               <span class="stringliteral">&quot;  are unpredictable, it may be useful to increase the receive buffer size.\n\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>( <span class="stringliteral">&quot;UDP Client: Healthy receive buffer.\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  As long as we read from the receive socket buffer faster than server\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  sends we should have room to store any unexpected small bursts or build-up.\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  Additionally, increasing the receive socket buffer size can help to accommodate\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  any short large bursts if the network encounters a large amount of jitter.\n\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (DoClientReceiveBurst(isTcp, socketDescriptor, 100, 95) == -1)</div>
<div class="line">        <span class="keywordflow">goto</span> EXIT;</div>
<div class="line"> </div>
<div class="line">EXIT:</div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Client: Terminating the connection.\n&quot;</span>);</div>
<div class="line">    <a class="code" href="namespacenn_1_1socket.html#ae01110d228e2148d830b1ecfb9aaa425">nn::socket::Close</a>(socketDescriptor);</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">} <span class="comment">// NOLINT(impl/function_size)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Parse command-line arguments.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">bool</span> ParseArgs(<span class="keywordtype">bool</span>* pTcp, <span class="keywordtype">bool</span> *pServer, <span class="keywordtype">char</span> *serverIp, <span class="keywordtype">char</span> *serverPort, <span class="keywordtype">int</span>* pReceiveCount)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a57"></a><a class="code" href="namespacenn_1_1os.html#acf2fa6b7b7074a51d0b2de1664cc7bb5">nn::os::GetHostArgc</a>() &gt; 1)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *ModeServer = <span class="stringliteral">&quot;-server&quot;</span>;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *ModeTcpClient = <span class="stringliteral">&quot;-tcpClient&quot;</span>;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *ModeUdpClient = <span class="stringliteral">&quot;-udpClient&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">char</span> *mode = <a name="a58"></a><a class="code" href="namespacenn_1_1os.html#abd77e6bf19be140867869cc759fa492c">nn::os::GetHostArgv</a>()[1];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (strstr(mode, ModeTcpClient) != 0)</div>
<div class="line">        {</div>
<div class="line">            *pTcp = <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strstr(mode, ModeUdpClient) != 0)</div>
<div class="line">        {</div>
<div class="line">            *pTcp = <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strstr(mode, ModeServer) != 0)</div>
<div class="line">        {</div>
<div class="line">            *pServer = <span class="keyword">true</span>;</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="namespacenn_1_1os.html#acf2fa6b7b7074a51d0b2de1664cc7bb5">nn::os::GetHostArgc</a>() &gt; 2)</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">char</span> *ServerToken = <span class="stringliteral">&quot;server=&quot;</span>;</div>
<div class="line">            std::string strIpArg = <a class="code" href="namespacenn_1_1os.html#abd77e6bf19be140867869cc759fa492c">nn::os::GetHostArgv</a>()[2];</div>
<div class="line">            <span class="keywordflow">if</span> (strIpArg.compare(0, strlen(ServerToken), ServerToken) == 0 )</div>
<div class="line">            {</div>
<div class="line">                strIpArg.erase(0, strlen(ServerToken));</div>
<div class="line">                <span class="keywordtype">size_t</span> ipLength = strIpArg.find(<span class="charliteral">&#39;:&#39;</span>, 0);</div>
<div class="line">                <span class="keywordflow">if</span> (ipLength != std::string::npos)</div>
<div class="line">                {</div>
<div class="line">                    strncpy(serverIp, strIpArg.substr(0, ipLength).c_str(), IpAddressBufferSize);</div>
<div class="line">                    strncpy(serverPort, strIpArg.substr(ipLength + 1).c_str(), PortBufferSize);</div>
<div class="line"> </div>
<div class="line">                    *pServer = <span class="keyword">false</span>;</div>
<div class="line">                    <span class="keywordflow">if</span> (<a class="code" href="namespacenn_1_1os.html#acf2fa6b7b7074a51d0b2de1664cc7bb5">nn::os::GetHostArgc</a>() == 3)</div>
<div class="line">                    {</div>
<div class="line">                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Optional</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="namespacenn_1_1os.html#acf2fa6b7b7074a51d0b2de1664cc7bb5">nn::os::GetHostArgc</a>() &gt; 3)</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">char</span> *CountToken = <span class="stringliteral">&quot;-ct=&quot;</span>;</div>
<div class="line">            std::string strIpArg = <a class="code" href="namespacenn_1_1os.html#abd77e6bf19be140867869cc759fa492c">nn::os::GetHostArgv</a>()[3];</div>
<div class="line">            <span class="keywordflow">if</span> (strIpArg.compare(0, strlen(CountToken), CountToken) == 0 )</div>
<div class="line">            {</div>
<div class="line">                strIpArg.erase(0, strlen(CountToken));</div>
<div class="line">                <span class="keywordflow">if</span> (strIpArg.size() &gt; 0)</div>
<div class="line">                {</div>
<div class="line">                    std::string::size_type sz;   <span class="comment">// alias of size_t</span></div>
<div class="line">                    *pReceiveCount = std::stoi(strIpArg, &amp;sz);</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// Namespace.</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//  Startup Functions</span></div>
<div class="line"><span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> <a name="a59"></a><a class="code" href="_socket_statistics_overlay_8cpp.html#ae79180f8ae90e05743b47a872f305a52">nnMain</a>()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="classnn_1_1_result.html">nn::Result</a> result = <a class="code" href="classnn_1_1_result.html">nn::Result</a>();</div>
<div class="line">    <span class="keywordtype">bool</span> bServer = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">bool</span> bIsTcp = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordtype">char</span> serverPort[PortBufferSize] = { 0 };</div>
<div class="line">    <span class="keywordtype">char</span> serverIp[IpAddressBufferSize] = { 0 };</div>
<div class="line">    <span class="keywordtype">int</span> receiveCount = 1;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;-- Socket Statistics --\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!ParseArgs(&amp;bIsTcp, &amp;bServer, serverIp, serverPort, &amp;receiveCount))</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;\nError: Invalid arguments.\n&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;\nUsage:\n&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; -The server runs as the server for both the TCP\n&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; or UDP client.\n&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; -udpClient server=&lt;ip_addr&gt;:&lt;port&gt; -ct=## Run as a UDP client and receive \n&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; data ct number of times.\n&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; -tcpClient server=&lt;ip_addr&gt;:&lt;port&gt; -ct=## Run as a TCP client and receive\n&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot; data ct number of times.\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Starting %s %s socket statistics sample program.\n&quot;</span>,</div>
<div class="line">            bIsTcp ? <span class="stringliteral">&quot;Tcp&quot;</span> : <span class="stringliteral">&quot;Udp&quot;</span>,</div>
<div class="line">            bServer ? <span class="stringliteral">&quot;Server&quot;</span> : <span class="stringliteral">&quot;Client&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (!bServer)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Client targeting server: %s:%s\n&quot;</span>, serverIp, serverPort);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// If the socket library is used to communicate with external nodes, you must initialize</span></div>
<div class="line">    <span class="comment">// the network interface manager (NIFM) first.</span></div>
<div class="line">    result = <a name="a60"></a><a class="code" href="namespacenn_1_1nifm.html#a0e3aaf3209696149ec22613e1d3d6705">nn::nifm::Initialize</a>();</div>
<div class="line">    <span class="keywordflow">if</span> (result.IsFailure())</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;\nError: nn::nifm::Initialize() failed. (mod:%d desc:%d)\n&quot;</span>,</div>
<div class="line">            result.GetModule(), result.GetDescription());</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// This application is now requesting to use the network interface.</span></div>
<div class="line">    <a name="a61"></a><a class="code" href="namespacenn_1_1nifm.html#ac42c271bffbeb6324e5a41ae779d6575">nn::nifm::SubmitNetworkRequestAndWait</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!<a name="a62"></a><a class="code" href="namespacenn_1_1nifm.html#a933a28d229a56e800703d95d4830fc6a">nn::nifm::IsNetworkAvailable</a>())</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;\nError: The network is not available.\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> CLEANUP_NIFM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Initialize the socket library, while supplying the configuration and memory pool.</span></div>
<div class="line">    result = <a name="a63"></a><a class="code" href="namespacenn_1_1socket.html#adacc3405184e8f28fb630745b9f43db0">nn::socket::Initialize</a>(g_SocketConfigWithMemory);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Register to have the process show up in the</span></div>
<div class="line">    <span class="comment">// DevMenuOverlay as a selectable process.</span></div>
<div class="line">    <span class="keywordflow">if</span> (bServer)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> processName[] = <span class="stringliteral">&quot;Stats Server&quot;</span>;</div>
<div class="line">        <a name="a64"></a><a class="code" href="namespacenn_1_1socket.html#ab7cfb63b9f078a668a1522f98948f64b">nn::socket::RegisterForStatistics</a>(processName, <span class="keyword">sizeof</span>(processName), &amp;g_statsMem);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> processName[] = <span class="stringliteral">&quot;Stats Client&quot;</span>;</div>
<div class="line">        <a class="code" href="namespacenn_1_1socket.html#ab7cfb63b9f078a668a1522f98948f64b">nn::socket::RegisterForStatistics</a>(processName, <span class="keyword">sizeof</span>(processName), &amp;g_statsMem);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (result.IsFailure())</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;\nError: nn::socket::Initialize() failed (error %d).\n\n&quot;</span>, result.GetDescription());</div>
<div class="line">        <span class="keywordflow">goto</span> CLEANUP_NIFM;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (bServer)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Create the TCP and UDP server and print the ip_addr:port.</span></div>
<div class="line">        <a name="a65"></a><a class="code" href="namespacenn_1_1os.html#a75f43e1d3c194c0d2173ef5d95785933">nn::os::CreateThread</a>(&amp;g_threads[TcpThreadIndex], RunTcpServerProcess, <span class="keyword">nullptr</span>, &amp;g_threadStacks[TcpThreadIndex], ThreadStackSize, <a name="a66"></a><a class="code" href="namespacenn_1_1os.html#a5985811d04e64c0823ed758fd420591d">nn::os::DefaultThreadPriority</a>);</div>
<div class="line">        <a class="code" href="namespacenn_1_1os.html#a75f43e1d3c194c0d2173ef5d95785933">nn::os::CreateThread</a>(&amp;g_threads[UdpThreadIndex], RunUdpServerProcess, <span class="keyword">nullptr</span>, &amp;g_threadStacks[UdpThreadIndex], ThreadStackSize, <a class="code" href="namespacenn_1_1os.html#a5985811d04e64c0823ed758fd420591d">nn::os::DefaultThreadPriority</a>);</div>
<div class="line"> </div>
<div class="line">        <a name="a67"></a><a class="code" href="namespacenn_1_1os.html#a18eec7c4c4c298f7abaa9ef41d6de76b">nn::os::StartThread</a>(&amp;g_threads[TcpThreadIndex]);</div>
<div class="line">        <a class="code" href="namespacenn_1_1os.html#a18eec7c4c4c298f7abaa9ef41d6de76b">nn::os::StartThread</a>(&amp;g_threads[UdpThreadIndex]);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Wait for the TCP and UDP server to terminate.</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ServerThreadCount; ++i)</div>
<div class="line">        {</div>
<div class="line">            <a name="a68"></a><a class="code" href="namespacenn_1_1os.html#a8070c91be85c5ccb36b56e9ff3a75b26">nn::os::WaitThread</a>(&amp;g_threads[i]);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Run the TCP or UDP client on the main thread.</span></div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; receiveCount; ++i)</div>
<div class="line">        {</div>
<div class="line">            RunClientProcess(serverIp, serverPort, bIsTcp);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a name="a69"></a><a class="code" href="namespacenn_1_1socket.html#a28a801f086aadf0b731a721567f3e4b2">nn::socket::Finalize</a>();</div>
<div class="line"> </div>
<div class="line">CLEANUP_NIFM:</div>
<div class="line">    <span class="comment">// This application no longer requires the network interface.</span></div>
<div class="line">    <a name="a70"></a><a class="code" href="namespacenn_1_1nifm.html#a7704800c5ddaa16c5f0f89f6fa42174b">nn::nifm::CancelNetworkRequest</a>();</div>
<div class="line">}</div>
<div class="ttc" id="a_socket_statistics_overlay_8cpp_html_ae79180f8ae90e05743b47a872f305a52"><div class="ttname"><a href="_socket_statistics_overlay_8cpp.html#ae79180f8ae90e05743b47a872f305a52">nnMain</a></div><div class="ttdeci">void nnMain()</div><div class="ttdoc">nnMain.</div><div class="ttdef"><b>Definition:</b> SocketStatisticsOverlay.cpp:810</div></div>
<div class="ttc" id="aclassnn_1_1_result_html"><div class="ttname"><a href="classnn_1_1_result.html">nn::Result</a></div><div class="ttdoc">Represents the generic result of an operation.</div><div class="ttdef"><b>Definition:</b> nn_Result.h:32</div></div>
<div class="ttc" id="aclassnn_1_1_time_span_html_a2441d3c84cc24b901342ce11f87cd39c"><div class="ttname"><a href="classnn_1_1_time_span.html#a2441d3c84cc24b901342ce11f87cd39c">nn::TimeSpan::FromMilliSeconds</a></div><div class="ttdeci">static constexpr TimeSpan FromMilliSeconds(int64_t milliSeconds) NN_NOEXCEPT</div><div class="ttdoc">Generates a TimeSpan object from a milliseconds value.</div><div class="ttdef"><b>Definition:</b> nn_TimeSpan.h:550</div></div>
<div class="ttc" id="aclassnn_1_1_time_span_html_a8e74f5ceb64fc02aa614eed3cc148e82"><div class="ttname"><a href="classnn_1_1_time_span.html#a8e74f5ceb64fc02aa614eed3cc148e82">nn::TimeSpan::FromSeconds</a></div><div class="ttdeci">static constexpr TimeSpan FromSeconds(int64_t seconds) NN_NOEXCEPT</div><div class="ttdoc">Generates a TimeSpan object from a value specified in seconds.</div><div class="ttdef"><b>Definition:</b> nn_TimeSpan.h:563</div></div>
<div class="ttc" id="aclassnn_1_1socket_1_1_config_with_memory_html"><div class="ttname"><a href="classnn_1_1socket_1_1_config_with_memory.html">nn::socket::ConfigWithMemory</a></div><div class="ttdoc">Class allowing for full manual configuration of the socket library.</div><div class="ttdef"><b>Definition:</b> socket_Config.h:388</div></div>
<div class="ttc" id="anamespacenn_1_1nifm_html_a0e3aaf3209696149ec22613e1d3d6705"><div class="ttname"><a href="namespacenn_1_1nifm.html#a0e3aaf3209696149ec22613e1d3d6705">nn::nifm::Initialize</a></div><div class="ttdeci">nn::Result Initialize() NN_NOEXCEPT</div><div class="ttdoc">Initializes the network connection management library and makes its functionality available.</div></div>
<div class="ttc" id="anamespacenn_1_1nifm_html_a0e8decfaa75a91d659edc2d1aec0af91"><div class="ttname"><a href="namespacenn_1_1nifm.html#a0e8decfaa75a91d659edc2d1aec0af91">nn::nifm::GetCurrentPrimaryIpAddress</a></div><div class="ttdeci">nn::Result GetCurrentPrimaryIpAddress(nn::socket::InAddr *pOutInAddr) NN_NOEXCEPT</div><div class="ttdoc">Gets the IP address that is currently in use.</div></div>
<div class="ttc" id="anamespacenn_1_1nifm_html_a7704800c5ddaa16c5f0f89f6fa42174b"><div class="ttname"><a href="namespacenn_1_1nifm.html#a7704800c5ddaa16c5f0f89f6fa42174b">nn::nifm::CancelNetworkRequest</a></div><div class="ttdeci">void CancelNetworkRequest() NN_NOEXCEPT</div><div class="ttdoc">Withdraws a network connection request.</div></div>
<div class="ttc" id="anamespacenn_1_1nifm_html_a933a28d229a56e800703d95d4830fc6a"><div class="ttname"><a href="namespacenn_1_1nifm.html#a933a28d229a56e800703d95d4830fc6a">nn::nifm::IsNetworkAvailable</a></div><div class="ttdeci">bool IsNetworkAvailable() NN_NOEXCEPT</div><div class="ttdoc">Determines whether a network connection is available.</div></div>
<div class="ttc" id="anamespacenn_1_1nifm_html_ac42c271bffbeb6324e5a41ae779d6575"><div class="ttname"><a href="namespacenn_1_1nifm.html#ac42c271bffbeb6324e5a41ae779d6575">nn::nifm::SubmitNetworkRequestAndWait</a></div><div class="ttdeci">void SubmitNetworkRequestAndWait() NN_NOEXCEPT</div><div class="ttdoc">Makes a request to the system for a network connection, and blocks until the request is accepted or d...</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a18eec7c4c4c298f7abaa9ef41d6de76b"><div class="ttname"><a href="namespacenn_1_1os.html#a18eec7c4c4c298f7abaa9ef41d6de76b">nn::os::StartThread</a></div><div class="ttdeci">void StartThread(ThreadType *thread) NN_NOEXCEPT</div><div class="ttdoc">Starts execution on a thread.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a5985811d04e64c0823ed758fd420591d"><div class="ttname"><a href="namespacenn_1_1os.html#a5985811d04e64c0823ed758fd420591d">nn::os::DefaultThreadPriority</a></div><div class="ttdeci">const int DefaultThreadPriority</div><div class="ttdoc">Constant indicating the default value of thread priority.</div><div class="ttdef"><b>Definition:</b> os_ThreadCommon.h:47</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a75f43e1d3c194c0d2173ef5d95785933"><div class="ttname"><a href="namespacenn_1_1os.html#a75f43e1d3c194c0d2173ef5d95785933">nn::os::CreateThread</a></div><div class="ttdeci">nn::Result CreateThread(ThreadType *thread, ThreadFunction function, void *argument, void *stack, size_t stackSize, int priority, int idealCoreNumber) NN_NOEXCEPT</div><div class="ttdoc">Generates a thread.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a8070c91be85c5ccb36b56e9ff3a75b26"><div class="ttname"><a href="namespacenn_1_1os.html#a8070c91be85c5ccb36b56e9ff3a75b26">nn::os::WaitThread</a></div><div class="ttdeci">void WaitThread(ThreadType *thread) NN_NOEXCEPT</div><div class="ttdoc">Waits for the specified thread to stop.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a96b335e87af44c60a0d6dca75f11c9d2"><div class="ttname"><a href="namespacenn_1_1os.html#a96b335e87af44c60a0d6dca75f11c9d2">nn::os::SleepThread</a></div><div class="ttdeci">void SleepThread(TimeSpan time) NN_NOEXCEPT</div><div class="ttdoc">Puts the current thread to sleep for the specified amount of time.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_abd77e6bf19be140867869cc759fa492c"><div class="ttname"><a href="namespacenn_1_1os.html#abd77e6bf19be140867869cc759fa492c">nn::os::GetHostArgv</a></div><div class="ttdeci">char ** GetHostArgv() NN_NOEXCEPT</div><div class="ttdoc">Gets the array of pointers (argc) to the strings for the host-specified command-line arguments.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_acf2fa6b7b7074a51d0b2de1664cc7bb5"><div class="ttname"><a href="namespacenn_1_1os.html#acf2fa6b7b7074a51d0b2de1664cc7bb5">nn::os::GetHostArgc</a></div><div class="ttdeci">int GetHostArgc() NN_NOEXCEPT</div><div class="ttdoc">Gets the number of host-specified command-line arguments (argc).</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a057d985148e23267303e6d00d7ed205daa4d833d8c15a76105639ddd11bcb614e"><div class="ttname"><a href="namespacenn_1_1socket.html#a057d985148e23267303e6d00d7ed205daa4d833d8c15a76105639ddd11bcb614e">nn::socket::Family::Af_Inet</a></div><div class="ttdeci">@ Af_Inet</div><div class="ttdoc">Internet Version 4.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a09255737b952ba3ad3a647607fc2af0a"><div class="ttname"><a href="namespacenn_1_1socket.html#a09255737b952ba3ad3a647607fc2af0a">nn::socket::Bind</a></div><div class="ttdeci">int Bind(int socket, const SockAddr *pAddress, SockLenT addressLength) NN_NOEXCEPT</div><div class="ttdoc">Assign a local protocol address to a socket.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a0bc37587294a2f6b385cf080b6fafa40"><div class="ttname"><a href="namespacenn_1_1socket.html#a0bc37587294a2f6b385cf080b6fafa40">nn::socket::InAddr_Any</a></div><div class="ttdeci">const InAddrT InAddr_Any</div><div class="ttdoc">0.0.0.0.</div><div class="ttdef"><b>Definition:</b> socket_Types.h:41</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a0da164bafc83a64e6a51068805e5df52"><div class="ttname"><a href="namespacenn_1_1socket.html#a0da164bafc83a64e6a51068805e5df52">nn::socket::SockLenT</a></div><div class="ttdeci">unsigned int SockLenT</div><div class="ttdoc">Used for length and size values for socket-related parameters.</div><div class="ttdef"><b>Definition:</b> socket_Types.h:35</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a1b6e15ce629648357cf10cc8ada6b8d1"><div class="ttname"><a href="namespacenn_1_1socket.html#a1b6e15ce629648357cf10cc8ada6b8d1">nn::socket::InetHtons</a></div><div class="ttdeci">uint16_t InetHtons(uint16_t hostValue) NN_NOEXCEPT</div><div class="ttdoc">Convert 16-bit integer from host to network byte order.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a1db675083dcccec6500d1435c5dfeaeaa4cc079142a1be58955eb22bed651ebba"><div class="ttname"><a href="namespacenn_1_1socket.html#a1db675083dcccec6500d1435c5dfeaeaa4cc079142a1be58955eb22bed651ebba">nn::socket::Type::Sock_Dgram</a></div><div class="ttdeci">@ Sock_Dgram</div><div class="ttdoc">Datagram socket.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a1db675083dcccec6500d1435c5dfeaeaae703319723c99d2d3a7ba1ad0dc8f572"><div class="ttname"><a href="namespacenn_1_1socket.html#a1db675083dcccec6500d1435c5dfeaeaae703319723c99d2d3a7ba1ad0dc8f572">nn::socket::Type::Sock_Stream</a></div><div class="ttdeci">@ Sock_Stream</div><div class="ttdoc">Stream socket.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a24652de2bb3beca4cd692b4c3f7141db"><div class="ttname"><a href="namespacenn_1_1socket.html#a24652de2bb3beca4cd692b4c3f7141db">nn::socket::InetHtonl</a></div><div class="ttdeci">uint32_t InetHtonl(uint32_t hostValue) NN_NOEXCEPT</div><div class="ttdoc">Convert 32-bit integer from host to network byte order.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a27f36d8472582558c3cb4a31464f50a0"><div class="ttname"><a href="namespacenn_1_1socket.html#a27f36d8472582558c3cb4a31464f50a0">nn::socket::Send</a></div><div class="ttdeci">nn::SignedSize Send(int socket, const void *buffer, size_t bufferLength, MsgFlag flags) NN_NOEXCEPT</div><div class="ttdoc">Send a message from a socket.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a28a801f086aadf0b731a721567f3e4b2"><div class="ttname"><a href="namespacenn_1_1socket.html#a28a801f086aadf0b731a721567f3e4b2">nn::socket::Finalize</a></div><div class="ttdeci">Result Finalize() NN_NOEXCEPT</div><div class="ttdoc">Finalize socket library.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a2b8c53cba8a2be170c93a76742b092c9a1b0bed7d85ba6b2cbe91629776e3ee6d"><div class="ttname"><a href="namespacenn_1_1socket.html#a2b8c53cba8a2be170c93a76742b092c9a1b0bed7d85ba6b2cbe91629776e3ee6d">nn::socket::PollEvent::PollIn</a></div><div class="ttdeci">@ PollIn</div><div class="ttdoc">Data other than high priority data may be read without blocking.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a3aded7f0c8c072c7beb68a670d03d36f"><div class="ttname"><a href="namespacenn_1_1socket.html#a3aded7f0c8c072c7beb68a670d03d36f">nn::socket::Connect</a></div><div class="ttdeci">int Connect(int socket, const SockAddr *pAddress, SockLenT addressLength) NN_NOEXCEPT</div><div class="ttdoc">Initiate a connection on a socket.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a46347de69614965469ac8f3c8056468ea48e0b0b8eaaf71a2c2c0ebfa0e802b1a"><div class="ttname"><a href="namespacenn_1_1socket.html#a46347de69614965469ac8f3c8056468ea48e0b0b8eaaf71a2c2c0ebfa0e802b1a">nn::socket::Protocol::IpProto_Udp</a></div><div class="ttdeci">@ IpProto_Udp</div><div class="ttdoc">User datagram protocol.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a46347de69614965469ac8f3c8056468eaf07a075529789e7d91eefbce84c55d90"><div class="ttname"><a href="namespacenn_1_1socket.html#a46347de69614965469ac8f3c8056468eaf07a075529789e7d91eefbce84c55d90">nn::socket::Protocol::IpProto_Tcp</a></div><div class="ttdeci">@ IpProto_Tcp</div><div class="ttdoc">Transmission control protocol.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a56b1fbede96c61d4c94ba51a3cc563b3"><div class="ttname"><a href="namespacenn_1_1socket.html#a56b1fbede96c61d4c94ba51a3cc563b3">nn::socket::Accept</a></div><div class="ttdeci">int Accept(int socket, SockAddr *pOutAddress, SockLenT *pOutAddressLength) NN_NOEXCEPT</div><div class="ttdoc">Accept connection on a socket.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a5b46436474c9d07a48fe4bd7786abc0c"><div class="ttname"><a href="namespacenn_1_1socket.html#a5b46436474c9d07a48fe4bd7786abc0c">nn::socket::SendTo</a></div><div class="ttdeci">nn::SignedSize SendTo(int socket, const void *buffer, size_t bufferLength, MsgFlag flags, const SockAddr *pAddress, SockLenT addressLength) NN_NOEXCEPT</div><div class="ttdoc">Send a message from a socket.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a6db6951cb084f74f4c17d655ce798890"><div class="ttname"><a href="namespacenn_1_1socket.html#a6db6951cb084f74f4c17d655ce798890">nn::socket::GetLastError</a></div><div class="ttdeci">Errno GetLastError() NN_NOEXCEPT</div><div class="ttdoc">Read the global variable errno.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a821ac1738bb13dce9aa9d83fe5950e52a7a99ac706c1462eb6f473b328821257e"><div class="ttname"><a href="namespacenn_1_1socket.html#a821ac1738bb13dce9aa9d83fe5950e52a7a99ac706c1462eb6f473b328821257e">nn::socket::MsgFlag::Msg_None</a></div><div class="ttdeci">@ Msg_None</div><div class="ttdoc">No flags set.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a821ac1738bb13dce9aa9d83fe5950e52a7fba2ade674c746aff1d987a7c23498d"><div class="ttname"><a href="namespacenn_1_1socket.html#a821ac1738bb13dce9aa9d83fe5950e52a7fba2ade674c746aff1d987a7c23498d">nn::socket::MsgFlag::Msg_DontWait</a></div><div class="ttdeci">@ Msg_DontWait</div><div class="ttdoc">This message should be nonblocking.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a85ef2c54d6090d3c03393f8ab7cad49e"><div class="ttname"><a href="namespacenn_1_1socket.html#a85ef2c54d6090d3c03393f8ab7cad49e">nn::socket::InetAton</a></div><div class="ttdeci">int InetAton(const char *addressStringBuffer, InAddr *pOutNetworkAddress) NN_NOEXCEPT</div><div class="ttdoc">Convert string to network address.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a8f9b7859b60d1ee546e472a7e2a9beaaa4418133767fb2aecc740f56abdda0a07"><div class="ttname"><a href="namespacenn_1_1socket.html#a8f9b7859b60d1ee546e472a7e2a9beaaa4418133767fb2aecc740f56abdda0a07">nn::socket::Level::Sol_Socket</a></div><div class="ttdeci">@ Sol_Socket</div><div class="ttdoc">Socket level.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a9706518d71ec37371e9aa3ae9a2fa92ca1600030ecdfa4988343a0182c2716781"><div class="ttname"><a href="namespacenn_1_1socket.html#a9706518d71ec37371e9aa3ae9a2fa92ca1600030ecdfa4988343a0182c2716781">nn::socket::Option::So_RcvBuf</a></div><div class="ttdeci">@ So_RcvBuf</div><div class="ttdoc">Receive buffer size.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a9706518d71ec37371e9aa3ae9a2fa92ca4078c1b605c4c29f21a0bf25944c0cd4"><div class="ttname"><a href="namespacenn_1_1socket.html#a9706518d71ec37371e9aa3ae9a2fa92ca4078c1b605c4c29f21a0bf25944c0cd4">nn::socket::Option::So_SndBuf</a></div><div class="ttdeci">@ So_SndBuf</div><div class="ttdoc">Send buffer size.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_a9afeb564bac1d0c04af2fec1f00c739f"><div class="ttname"><a href="namespacenn_1_1socket.html#a9afeb564bac1d0c04af2fec1f00c739f">nn::socket::Socket</a></div><div class="ttdeci">int Socket(Family domain, Type type, Protocol protocol) NN_NOEXCEPT</div><div class="ttdoc">Create endpoint for communication.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_aa8de3f19aaf80d2233a668fc7ebe6f38"><div class="ttname"><a href="namespacenn_1_1socket.html#aa8de3f19aaf80d2233a668fc7ebe6f38">nn::socket::InetNtohs</a></div><div class="ttdeci">uint16_t InetNtohs(uint16_t networkValue) NN_NOEXCEPT</div><div class="ttdoc">Convert 16-bit ineger from network to host byte order.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_aab976ffcd7654964700d4188df861647"><div class="ttname"><a href="namespacenn_1_1socket.html#aab976ffcd7654964700d4188df861647">nn::socket::Recv</a></div><div class="ttdeci">nn::SignedSize Recv(int socket, void *outBuffer, size_t outBufferLength, MsgFlag flags) NN_NOEXCEPT</div><div class="ttdoc">Receives a message from a connection-mode or connectionless-mode socket.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_ab6cd7b0b7c70edbe79d0d6adb110fc61"><div class="ttname"><a href="namespacenn_1_1socket.html#ab6cd7b0b7c70edbe79d0d6adb110fc61">nn::socket::RecvFrom</a></div><div class="ttdeci">nn::SignedSize RecvFrom(int socket, void *outBuffer, size_t outBufferLength, MsgFlag flags, SockAddr *pOutAddress, SockLenT *pOutAddressLength) NN_NOEXCEPT</div><div class="ttdoc">Receives a message from a connection-oriented or connectionless-oriented socket.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_ab7cfb63b9f078a668a1522f98948f64b"><div class="ttname"><a href="namespacenn_1_1socket.html#ab7cfb63b9f078a668a1522f98948f64b">nn::socket::RegisterForStatistics</a></div><div class="ttdeci">int RegisterForStatistics(const char *nameBuffer, size_t nameBufferSize, StatisticsMemory *statsMemory) NN_NOEXCEPT</div><div class="ttdoc">Register process with socket resource statistics.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_ac63165d8f4ab675489cda23034aa9eeb"><div class="ttname"><a href="namespacenn_1_1socket.html#ac63165d8f4ab675489cda23034aa9eeb">nn::socket::InfTim</a></div><div class="ttdeci">const int InfTim</div><div class="ttdoc">If poll timeout is InfTim (-1), the poll blocks indefinitely.</div><div class="ttdef"><b>Definition:</b> socket_Constants.h:99</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_ad1ade4838b158c7aaf9c9a78338e06aea54cafc2ec81f6d1fe8ba661ade3931cb"><div class="ttname"><a href="namespacenn_1_1socket.html#ad1ade4838b158c7aaf9c9a78338e06aea54cafc2ec81f6d1fe8ba661ade3931cb">nn::socket::Errno::EAgain</a></div><div class="ttdeci">@ EAgain</div><div class="ttdoc">11</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_ad6c2c6b2d1cd467bfdbfb4bf4057338b"><div class="ttname"><a href="namespacenn_1_1socket.html#ad6c2c6b2d1cd467bfdbfb4bf4057338b">nn::socket::Listen</a></div><div class="ttdeci">int Listen(int socket, int backlog) NN_NOEXCEPT</div><div class="ttdoc">Listen for connections on a socket.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_ad9e109d18fb43f275742d74d74d06cde"><div class="ttname"><a href="namespacenn_1_1socket.html#ad9e109d18fb43f275742d74d74d06cde">nn::socket::Poll</a></div><div class="ttdeci">int Poll(PollFd *pSocketDescriptors, NfdsT numberOfDescriptors, int timeoutMilliseconds) NN_NOEXCEPT</div><div class="ttdoc">Synchronous I/O multiplexing.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_adacc3405184e8f28fb630745b9f43db0"><div class="ttname"><a href="namespacenn_1_1socket.html#adacc3405184e8f28fb630745b9f43db0">nn::socket::Initialize</a></div><div class="ttdeci">Result Initialize(const Config &amp;config) NN_NOEXCEPT</div><div class="ttdoc">Initialize socket library.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_adb89c6a0abfc8befcdc1ce05bf49e0ce"><div class="ttname"><a href="namespacenn_1_1socket.html#adb89c6a0abfc8befcdc1ce05bf49e0ce">nn::socket::GetSockName</a></div><div class="ttdeci">int GetSockName(int socket, SockAddr *pOutAddress, SockLenT *pOutAddressLength) NN_NOEXCEPT</div><div class="ttdoc">Get socket name.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_ae01110d228e2148d830b1ecfb9aaa425"><div class="ttname"><a href="namespacenn_1_1socket.html#ae01110d228e2148d830b1ecfb9aaa425">nn::socket::Close</a></div><div class="ttdeci">int Close(int socket) NN_NOEXCEPT</div><div class="ttdoc">Delete a descriptor.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_af90b8239ae0f5fbd70f12f9980fdac76"><div class="ttname"><a href="namespacenn_1_1socket.html#af90b8239ae0f5fbd70f12f9980fdac76">nn::socket::InetNtoa</a></div><div class="ttdeci">char * InetNtoa(InAddr networkAddress) NN_NOEXCEPT</div><div class="ttdoc">Convert Internet address into ASCII string.</div></div>
<div class="ttc" id="anamespacenn_1_1socket_html_afaa7ccade3133a9884ab0b8e44ac18fc"><div class="ttname"><a href="namespacenn_1_1socket.html#afaa7ccade3133a9884ab0b8e44ac18fc">nn::socket::SetSockOpt</a></div><div class="ttdeci">int SetSockOpt(int socket, Level level, Option optionName, const void *pOptionValue, SockLenT optionLength) NN_NOEXCEPT</div><div class="ttdoc">Set options on a socket.</div></div>
<div class="ttc" id="ann___abort_8h_html_a5c1a90d3a6474658ae0ac5dc5bcb14e4"><div class="ttname"><a href="nn___abort_8h.html#a5c1a90d3a6474658ae0ac5dc5bcb14e4">NN_ABORT_UNLESS</a></div><div class="ttdeci">#define NN_ABORT_UNLESS(condition,...)</div><div class="ttdoc">Tests whether a condition has been satisfied and stops execution if it has not.</div><div class="ttdef"><b>Definition:</b> nn_Abort.h:38</div></div>
<div class="ttc" id="ann___log_8h_html"><div class="ttname"><a href="nn___log_8h.html">nn_Log.h</a></div><div class="ttdoc">Declarations for the logging API.</div></div>
<div class="ttc" id="ann___log_8h_html_a2d720c8bc6b733bce63879350d134a84"><div class="ttname"><a href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a></div><div class="ttdeci">#define NN_LOG(...)</div><div class="ttdoc">Adds the string specified in the parameter as a log entry.</div><div class="ttdef"><b>Definition:</b> nn_Log.h:33</div></div>
<div class="ttc" id="ann___macro_8h_html_a71c0f58f6d49fe1392380eed4509ab9a"><div class="ttname"><a href="nn___macro_8h.html#a71c0f58f6d49fe1392380eed4509ab9a">NN_STATIC_CONDITION</a></div><div class="ttdeci">#define NN_STATIC_CONDITION(condition)</div><div class="ttdoc">Suppresses compiler warnings on intentional, explicitly specified conditional constants.</div><div class="ttdef"><b>Definition:</b> nn_Macro.h:626</div></div>
<div class="ttc" id="ann___macro_8h_html_af2d1673769927c5eae977d8dde3ce106"><div class="ttname"><a href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a></div><div class="ttdeci">#define NN_UNUSED(variable)</div><div class="ttdoc">Suppresses compiler warnings on intentionally unused variables.</div><div class="ttdef"><b>Definition:</b> nn_Macro.h:610</div></div>
<div class="ttc" id="aos___thread_common_8h_html_a5ce0c3c0aaceb976178a60a18d90f470"><div class="ttname"><a href="os___thread_common_8h.html#a5ce0c3c0aaceb976178a60a18d90f470">NN_OS_ALIGNAS_THREAD_STACK</a></div><div class="ttdeci">#define NN_OS_ALIGNAS_THREAD_STACK</div><div class="ttdoc">Macro to specify the stack space alignment.</div><div class="ttdef"><b>Definition:</b> os_ThreadCommon.h:108</div></div>
<div class="ttc" id="asocket_8h_html"><div class="ttname"><a href="socket_8h.html">socket.h</a></div><div class="ttdoc">Top level header defining the socket library API.</div></div>
<div class="ttc" id="astructnn_1_1os_1_1_thread_type_html"><div class="ttname"><a href="structnn_1_1os_1_1_thread_type.html">nn::os::ThreadType</a></div><div class="ttdoc">This structure defines a thread object.</div><div class="ttdef"><b>Definition:</b> os_ThreadTypes.h:92</div></div>
<div class="ttc" id="astructnn_1_1socket_1_1_in_addr_html"><div class="ttname"><a href="structnn_1_1socket_1_1_in_addr.html">nn::socket::InAddr</a></div><div class="ttdoc">Structure for storing Internet address in network format.</div><div class="ttdef"><b>Definition:</b> socket_Types.h:358</div></div>
<div class="ttc" id="astructnn_1_1socket_1_1_in_addr_html_a4bf7f3c8a8061edacb8f884b61c49a2e"><div class="ttname"><a href="structnn_1_1socket_1_1_in_addr.html#a4bf7f3c8a8061edacb8f884b61c49a2e">nn::socket::InAddr::S_addr</a></div><div class="ttdeci">InAddrT S_addr</div><div class="ttdoc">Internet address in network format.</div><div class="ttdef"><b>Definition:</b> socket_Types.h:359</div></div>
<div class="ttc" id="astructnn_1_1socket_1_1_poll_fd_html"><div class="ttname"><a href="structnn_1_1socket_1_1_poll_fd.html">nn::socket::PollFd</a></div><div class="ttdoc">Structure used for Poll().</div><div class="ttdef"><b>Definition:</b> socket_Types.h:534</div></div>
<div class="ttc" id="astructnn_1_1socket_1_1_poll_fd_html_a778aa060c42157a250cf459f7cfea273"><div class="ttname"><a href="structnn_1_1socket_1_1_poll_fd.html#a778aa060c42157a250cf459f7cfea273">nn::socket::PollFd::fd</a></div><div class="ttdeci">int fd</div><div class="ttdoc">File descriptor to poll.</div><div class="ttdef"><b>Definition:</b> socket_Types.h:539</div></div>
<div class="ttc" id="astructnn_1_1socket_1_1_poll_fd_html_ab5c064cf340ae80e805a84e927dcdb9f"><div class="ttname"><a href="structnn_1_1socket_1_1_poll_fd.html#ab5c064cf340ae80e805a84e927dcdb9f">nn::socket::PollFd::events</a></div><div class="ttdeci">PollEvent events</div><div class="ttdoc">Events to poll for.</div><div class="ttdef"><b>Definition:</b> socket_Types.h:542</div></div>
<div class="ttc" id="astructnn_1_1socket_1_1_poll_fd_html_aca13d3c2b88fcd0292ecbcbbbc5f85dc"><div class="ttname"><a href="structnn_1_1socket_1_1_poll_fd.html#aca13d3c2b88fcd0292ecbcbbbc5f85dc">nn::socket::PollFd::revents</a></div><div class="ttdeci">PollEvent revents</div><div class="ttdoc">Events which may occur.</div><div class="ttdef"><b>Definition:</b> socket_Types.h:545</div></div>
<div class="ttc" id="astructnn_1_1socket_1_1_sock_addr_html"><div class="ttname"><a href="structnn_1_1socket_1_1_sock_addr.html">nn::socket::SockAddr</a></div><div class="ttdoc">Structure used to store most addresses.</div><div class="ttdef"><b>Definition:</b> socket_Types.h:366</div></div>
<div class="ttc" id="astructnn_1_1socket_1_1_sock_addr_in_html"><div class="ttname"><a href="structnn_1_1socket_1_1_sock_addr_in.html">nn::socket::SockAddrIn</a></div><div class="ttdoc">Structure used to specify a local or remote endpoint address to which to connect a socket.</div><div class="ttdef"><b>Definition:</b> socket_Types.h:377</div></div>
<div class="ttc" id="astructnn_1_1socket_1_1_sock_addr_in_html_a7fe5afa2fe039b8bbf5a23fae30fe755"><div class="ttname"><a href="structnn_1_1socket_1_1_sock_addr_in.html#a7fe5afa2fe039b8bbf5a23fae30fe755">nn::socket::SockAddrIn::sin_addr</a></div><div class="ttdeci">InAddr sin_addr</div><div class="ttdoc">IP address.</div><div class="ttdef"><b>Definition:</b> socket_Types.h:381</div></div>
<div class="ttc" id="astructnn_1_1socket_1_1_sock_addr_in_html_ac8e09f776d8331345ee1870f3aed4535"><div class="ttname"><a href="structnn_1_1socket_1_1_sock_addr_in.html#ac8e09f776d8331345ee1870f3aed4535">nn::socket::SockAddrIn::sin_family</a></div><div class="ttdeci">Family sin_family</div><div class="ttdoc">Socket address family.</div><div class="ttdef"><b>Definition:</b> socket_Types.h:379</div></div>
<div class="ttc" id="astructnn_1_1socket_1_1_sock_addr_in_html_ae37d378c458d394a0646d7bfcf72bc4d"><div class="ttname"><a href="structnn_1_1socket_1_1_sock_addr_in.html#ae37d378c458d394a0646d7bfcf72bc4d">nn::socket::SockAddrIn::sin_port</a></div><div class="ttdeci">InPortT sin_port</div><div class="ttdoc">IP port.</div><div class="ttdef"><b>Definition:</b> socket_Types.h:380</div></div>
<div class="ttc" id="astructnn_1_1socket_1_1_statistics_memory_html"><div class="ttname"><a href="structnn_1_1socket_1_1_statistics_memory.html">nn::socket::StatisticsMemory</a></div><div class="ttdoc">Memory passed to socket library in order to register the process for statistics.</div><div class="ttdef"><b>Definition:</b> socket_Types.h:410</div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
</body>
</html>

<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NvnTutorial12DeferredRenderer/NvnTutorial12.cpp | NintendoSDK API Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<script type="text/javascript" src="searchapi.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   &#160;<span id="projectnumber">14.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">NvnTutorial12DeferredRenderer/NvnTutorial12.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>For an explanation of the source code, see <a class="el" href="_page_sample_nvn_tutorial12.html">NVN Tutorial 12: Deferred Renderer</a> and <tt>NvnTutorial12DeferredRenderer/NvnTutorial12.cpp</tt>.</p>
<div class="fragment"><div class="line"><span class="comment">/*--------------------------------------------------------------------------------*</span></div>
<div class="line"><span class="comment">  Copyright (C)Nintendo All rights reserved.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  These coded instructions, statements, and computer programs contain proprietary</span></div>
<div class="line"><span class="comment">  information of Nintendo and/or its licensed developers and are protected by</span></div>
<div class="line"><span class="comment">  national and international copyright laws. They may not be disclosed to third</span></div>
<div class="line"><span class="comment">  parties or copied or duplicated in any form, in whole or in part, without the</span></div>
<div class="line"><span class="comment">  prior written consent of Nintendo.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  The content herein is highly confidential and should be handled accordingly.</span></div>
<div class="line"><span class="comment"> *--------------------------------------------------------------------------------*/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nn___log_8h.html">nn/nn_Log.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nn___assert_8h.html">nn/nn_Assert.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_nvn_tutorial12_8h.html">NvnTutorial12.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fs_8h.html">nn/fs.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_aligned_allocator_8h.html">nvntutorial/AlignedAllocator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_load_scene_8h.html">nvntutorial/LoadScene.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;array&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef NN_BUILD_TARGET_PLATFORM_OS_WIN</span></div>
<div class="line"><span class="comment">//#define USE_WIN_NVNGD</span></div>
<div class="line"><span class="preprocessor">#ifdef USE_WIN_NVNGD</span></div>
<div class="line"><span class="preprocessor">    #include &lt;windows.h&gt;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Scene file to load:</span></div>
<div class="line"><span class="comment">     * Scene.xml: Main scene. Two offices plus a hallway</span></div>
<div class="line"><span class="comment">     * TestScene.xml: Test scene with varying roughness metallic/dielectric spheres.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* g_SceneFileName = <span class="stringliteral">&quot;Scene.xml&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define DEBUGTEXT</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * DeferredRenderer Constructor</span></div>
<div class="line"><span class="comment"> * ----------------------------</span></div>
<div class="line"><span class="comment"> * Sets up default member data values</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">DeferredRenderer::DeferredRenderer() : m_pQueueMemory(nullptr),</div>
<div class="line">                                       m_pShaderScratchMemoryPool(nullptr),</div>
<div class="line">                                       m_Near(0.1f),</div>
<div class="line">                                       m_Far(1000.0f),</div>
<div class="line">                                       m_GlobalAmbient(0.1f),</div>
<div class="line">                                       m_ScreenWidth(1920),</div>
<div class="line">                                       m_ScreenHeight(1080),</div>
<div class="line">                                       m_pRenderTargetMemoryPool(nullptr),</div>
<div class="line">                                       m_pTextureIDManager(nullptr),</div>
<div class="line">                                       m_pAssetLoader(nullptr),</div>
<div class="line">                                       m_pUniformBufferManager(nullptr),</div>
<div class="line">                                       m_pStaticUniformBufferManager(nullptr),</div>
<div class="line">                                       m_BackBufferCommandBuffer(nullptr),</div>
<div class="line">                                       m_GBufferCommandBuffer(nullptr),</div>
<div class="line">                                       m_ShadowMapPassCommandBuffer(nullptr),</div>
<div class="line">                                       m_LightingPassCommandBuffer(nullptr),</div>
<div class="line">                                       m_SkyBoxCommandBuffer(nullptr),</div>
<div class="line">                                       m_pScreenSpaceQuadPass(nullptr),</div>
<div class="line">                                       m_pScreenSpaceQuadDepthPass(nullptr),</div>
<div class="line">                                       m_pDirectionalLightPass(nullptr),</div>
<div class="line">                                       m_pSkyBox(nullptr),</div>
<div class="line">                                       m_pFrameBufferedSyncManager(nullptr),</div>
<div class="line">                                       m_pDebugTextRenderer(nullptr),</div>
<div class="line">                                       m_pPresentHandle(nullptr),</div>
<div class="line">                                       m_pPresentPass(nullptr),</div>
<div class="line">                                       m_pShadowMapDisplaySampler(nullptr),</div>
<div class="line">                                       m_PointLightDebugDraw(false),</div>
<div class="line">                                       m_GenerateShadows(true),</div>
<div class="line">                                       m_PrevFrameTime(0),</div>
<div class="line">                                       m_CPUTime(0),</div>
<div class="line">                                       m_CurrentBeginFrameTime(0),</div>
<div class="line">                                       m_PrevGPUTime(0),</div>
<div class="line">                                       m_CurrentTimeStamp(0)</div>
<div class="line"> </div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; g_NumBackBuffers; ++i)</div>
<div class="line">    {</div>
<div class="line">        m_ScreenRenderTargets[i] = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    AlignedAllocator::GetInstance()-&gt;Resize(320 * 1024 * 1024);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef NN_BUILD_TARGET_PLATFORM_OS_WIN</span></div>
<div class="line">    m_Camera.Init(&amp;m_InputManager, .125f, .25f);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    m_Camera.Init(&amp;m_InputManager, .125f, 2.0f);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    nn::util::MatrixIdentity(&amp;m_ProjMat44);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * DeferredRenderer Destructor</span></div>
<div class="line"><span class="comment"> * ---------------------------</span></div>
<div class="line"><span class="comment"> * Empty Destructor</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">DeferredRenderer::~DeferredRenderer()</div>
<div class="line">{</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * DeferredRenderer::Init</span></div>
<div class="line"><span class="comment"> * ----------------------</span></div>
<div class="line"><span class="comment"> * Initialize NVN, load asset files, and create objects needed for the</span></div>
<div class="line"><span class="comment"> * application to run.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> DeferredRenderer::Init(PFNNVNBOOTSTRAPLOADERPROC pLoader, <a class="code" href="group__nvn__c__api__typedefs.html#ga05b6b3dd5b965bd81efe2d03cee0bbbd">NVNnativeWindow</a> nativeWindow)</div>
<div class="line">{</div>
<div class="line">    <a name="a0"></a><a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(pLoader != NULL, <span class="stringliteral">&quot;Bootstrap loader function pointer is NULL\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef USE_WIN_NVNGD</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::string interceptionLibrary = <span class="stringliteral">&quot;NV_TargetGLInterceptor.dll&quot;</span>;</div>
<div class="line">    std::string interceptionLibraryPath;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Try in the directory for the application</span></div>
<div class="line">    std::array&lt;char, MAX_PATH&gt; exePath;</div>
<div class="line">    GetModuleFileNameA(<span class="keyword">nullptr</span>, exePath.data(), DWORD(exePath.size()));</div>
<div class="line">    interceptionLibraryPath = exePath.data();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Strip the exe name from the path and create the interception library path</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">size_t</span> lastSlashPos = interceptionLibraryPath.find_last_of(<span class="charliteral">&#39;\\&#39;</span>);</div>
<div class="line">    interceptionLibraryPath = interceptionLibraryPath.substr(0, lastSlashPos + 1) + interceptionLibrary;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Attempt to load interception library</span></div>
<div class="line">    HMODULE hGraphicsDebugger = LoadLibraryA(interceptionLibraryPath.c_str());</div>
<div class="line">    <span class="keywordflow">if</span> (!hGraphicsDebugger)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Failed in the application directory, try in the SDK path</span></div>
<div class="line">        LPCTSTR pathSDKVar = L<span class="stringliteral">&quot;NINTENDO_SDK_ROOT&quot;</span>;</div>
<div class="line">        DWORD pathSDKLen = <a class="code" href="namespacenn_1_1htc.html#a370e114a42a12b384ef2b2246618168e">GetEnvironmentVariable</a>(pathSDKVar, <span class="keyword">nullptr</span>, 0);</div>
<div class="line">        <span class="keywordflow">if</span> (pathSDKLen)</div>
<div class="line">        {</div>
<div class="line">            std::vector&lt;char&gt; pathSDKBuffer(pathSDKLen);</div>
<div class="line">            <a class="code" href="namespacenn_1_1htc.html#a370e114a42a12b384ef2b2246618168e">GetEnvironmentVariable</a>(pathSDKVar, (LPTSTR)pathSDKBuffer.data(), pathSDKLen);</div>
<div class="line"> </div>
<div class="line">            interceptionLibraryPath = pathSDKBuffer.data();</div>
<div class="line">            interceptionLibraryPath += <span class="stringliteral">&quot;\\..\\NvnGraphicsDebugger\\target\\windows-desktop-nvn-x64\\&quot;</span> + interceptionLibrary;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        hGraphicsDebugger = LoadLibraryA(interceptionLibraryPath.c_str());</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (hGraphicsDebugger)</div>
<div class="line">    {</div>
<div class="line">        pfnc_nvnDeviceGetProcAddress = (<a class="code" href="group__nvn__c__entryfuncptrs.html#ga9557d931192cd70c7d2810a6425326eb">PFNNVNDEVICEGETPROCADDRESSPROC</a>)GetProcAddress(hGraphicsDebugger, <span class="stringliteral">&quot;nvnDeviceGetProcAddress&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Load the function pointer to get other nvn function pointers. */</span></div>
<div class="line">        pfnc_nvnDeviceGetProcAddress = (<a class="code" href="group__nvn__c__entryfuncptrs.html#ga9557d931192cd70c7d2810a6425326eb">PFNNVNDEVICEGETPROCADDRESSPROC</a>)(*pLoader)(<span class="stringliteral">&quot;nvnDeviceGetProcAddress&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (pfnc_nvnDeviceGetProcAddress == NULL)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">/* This can happen if an NVN driver is not installed on a Windows PC. */</span></div>
<div class="line">            <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;BootstrapLoader failed to find nvnDeviceGetProcAddress&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Load function pointers for creating nvn device</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">    nvnLoadCProcs(NULL, pfnc_nvnDeviceGetProcAddress);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Check the API version. */</span></div>
<div class="line">    <span class="keywordtype">int</span> majorVersion, minorVersion;</div>
<div class="line">    nvnDeviceGetInteger(NULL, NVN_DEVICE_INFO_API_MAJOR_VERSION, &amp;majorVersion);</div>
<div class="line">    nvnDeviceGetInteger(NULL, NVN_DEVICE_INFO_API_MINOR_VERSION, &amp;minorVersion);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (majorVersion != <a name="a1"></a><a class="code" href="group__nvn__c__defines.html#ga4eb83fe713146d844b1ac7f8e9c3dada">NVN_API_MAJOR_VERSION</a> || minorVersion &lt; <a name="a2"></a><a class="code" href="group__nvn__c__defines.html#gaa8b4a49a0c4f852b73be3b50bb3f270e">NVN_API_MINOR_VERSION</a>)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>( 0, <span class="stringliteral">&quot;NVN SDK not supported by current driver.&quot;</span> );</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* If debug or develop is enabled, turn on NVN&#39;s debug layer. */</span></div>
<div class="line">    <span class="keywordtype">int</span> deviceFlags = 0;</div>
<div class="line"><span class="preprocessor">#if defined(NN_SDK_BUILD_DEBUG) || defined(NN_SDK_BUILD_DEVELOP)</span></div>
<div class="line">    deviceFlags = <a class="code" href="group__nvn__c__enum.html#gga9c68350bf64f2e7a90a23290c26872d3a12928b2591c67a2a61cf67c5b1d4c5e9">NVN_DEVICE_FLAG_DEBUG_ENABLE_LEVEL_4_BIT</a>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <a name="_a3"></a><a class="code" href="struct_n_v_ndevice_builder.html">NVNdeviceBuilder</a> deviceBuilder;</div>
<div class="line">    nvnDeviceBuilderSetDefaults(&amp;deviceBuilder);</div>
<div class="line">    nvnDeviceBuilderSetFlags(&amp;deviceBuilder, deviceFlags);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nvnDeviceInitialize(&amp;m_Device, &amp;deviceBuilder) == <span class="keyword">false</span>)</div>
<div class="line">    {</div>
<div class="line">            <span class="comment">/*</span></div>
<div class="line"><span class="comment">             * This can fail for a few reasons; the most likely on Horizon is</span></div>
<div class="line"><span class="comment">             * insufficent device memory.</span></div>
<div class="line"><span class="comment">             */</span></div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;nvnDeviceInitialize&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Ensure function pointers are all loaded properly</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">    nvnLoadCProcs(&amp;m_Device, pfnc_nvnDeviceGetProcAddress);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Setup the debug callback for the debug layer. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (deviceFlags &amp; NVN_DEVICE_FLAG_DEBUG_ENABLE_LEVEL_4_BIT)</div>
<div class="line">    {</div>
<div class="line">        nvnDeviceInstallDebugCallback(</div>
<div class="line">            &amp;m_Device,</div>
<div class="line">            <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="group__nvn__c__funcptrs.html#gab106acc34961bf1c3a43514686dbfc4b">PFNNVNDEBUGCALLBACKPROC</a><span class="keyword">&gt;</span>(&amp;DebugLayerCallback),</div>
<div class="line">            NULL, <span class="comment">// For testing purposes; any pointer is OK here.</span></div>
<div class="line">            <a name="a4"></a><a class="code" href="group__nvn__c__defines.html#ga48151b7e768a13685d77d1a4c464a33b">NVN_TRUE</a> <span class="comment">// NVN_TRUE = Enable the callback.</span></div>
<div class="line">            );</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Initialize the queue. */</span></div>
<div class="line">    <a name="_a5"></a><a class="code" href="struct_n_v_nqueue_builder.html">NVNqueueBuilder</a> queueBuilder;</div>
<div class="line">    nvnQueueBuilderSetDevice(&amp;queueBuilder, &amp;m_Device);</div>
<div class="line">    nvnQueueBuilderSetDefaults(&amp;queueBuilder);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set the queue control memory size */</span></div>
<div class="line">    <span class="keywordtype">int</span> defaultQueueControlMemorySize = 0;</div>
<div class="line">    nvnDeviceGetInteger(&amp;m_Device, NVN_DEVICE_INFO_QUEUE_CONTROL_MEMORY_DEFAULT_SIZE, &amp;defaultQueueControlMemorySize);</div>
<div class="line">    nvnQueueBuilderSetControlMemorySize(&amp;queueBuilder, defaultQueueControlMemorySize * 2);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set the queue command memory size */</span></div>
<div class="line">    <span class="keywordtype">int</span> minQueueCommandMemorySize = 0;</div>
<div class="line">    nvnDeviceGetInteger(&amp;m_Device, NVN_DEVICE_INFO_QUEUE_COMMAND_MEMORY_MIN_SIZE, &amp;minQueueCommandMemorySize);</div>
<div class="line">    nvnQueueBuilderSetCommandMemorySize(&amp;queueBuilder, minQueueCommandMemorySize);</div>
<div class="line">    nvnQueueBuilderSetCommandFlushThreshold(&amp;queueBuilder, minQueueCommandMemorySize);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> neededQueueMemorySize = nvnQueueBuilderGetQueueMemorySize(&amp;queueBuilder);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((neededQueueMemorySize % <a name="a6"></a><a class="code" href="group__nvn__c__defines.html#gadfd69601d2d9f953c55808127ba60853">NVN_MEMORY_POOL_STORAGE_GRANULARITY</a>) != 0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;Memory size reported for queue is not the proper granularity&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#if defined( NN_BUILD_TARGET_PLATFORM_OS_WIN )</span></div>
<div class="line">    m_pQueueMemory = NULL;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    m_pQueueMemory = AlignedAllocate(neededQueueMemorySize, <a name="a7"></a><a class="code" href="group__nvn__c__defines.html#gace820e752b400cf7aa36e9684a7f45cb">NVN_MEMORY_POOL_STORAGE_ALIGNMENT</a>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    nvnQueueBuilderSetQueueMemory(&amp;queueBuilder, m_pQueueMemory, neededQueueMemorySize);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nvnQueueInitialize(&amp;m_Queue, &amp;queueBuilder) == <span class="keyword">false</span>)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(0, <span class="stringliteral">&quot;nvnQueueInitialize failed&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set up command buffers*/</span></div>
<div class="line">    m_BackBufferCommandBuffer = <span class="keyword">new</span> ManagedCommandBuffer(&amp;m_Device, g_CommandMemoryChunkSize, g_ControlMemoryChunkSize, g_NumBackBuffers);</div>
<div class="line">    m_GBufferCommandBuffer = <span class="keyword">new</span> ManagedCommandBuffer(&amp;m_Device, 64 * g_CommandMemoryChunkSize, 96 * g_ControlMemoryChunkSize, g_NumBackBuffers);</div>
<div class="line">    m_ShadowMapPassCommandBuffer = <span class="keyword">new</span> ManagedCommandBuffer(&amp;m_Device, 64 * g_CommandMemoryChunkSize, 96 * g_ControlMemoryChunkSize, g_NumBackBuffers);</div>
<div class="line">    m_LightingPassCommandBuffer = <span class="keyword">new</span> ManagedCommandBuffer(&amp;m_Device, 16 * g_CommandMemoryChunkSize, 16 * g_ControlMemoryChunkSize, g_NumBackBuffers);</div>
<div class="line">    m_SkyBoxCommandBuffer = <span class="keyword">new</span> ManagedCommandBuffer(&amp;m_Device, g_CommandMemoryChunkSize, g_ControlMemoryChunkSize, g_NumBackBuffers);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set up builders */</span></div>
<div class="line">    nvnSamplerBuilderSetDevice(&amp;m_SamplerBuilder, &amp;m_Device);</div>
<div class="line">    nvnSamplerBuilderSetDefaults(&amp;m_SamplerBuilder);</div>
<div class="line"> </div>
<div class="line">    nvnBufferBuilderSetDevice(&amp;m_BufferBuilder, &amp;m_Device);</div>
<div class="line">    nvnBufferBuilderSetDefaults(&amp;m_BufferBuilder);</div>
<div class="line"> </div>
<div class="line">    nvnTextureBuilderSetDevice(&amp;m_RenderTargetBuilder, &amp;m_Device);</div>
<div class="line">    nvnTextureBuilderSetDefaults(&amp;m_RenderTargetBuilder);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Create texture ID manager and asset loader */</span></div>
<div class="line">    m_pTextureIDManager = <span class="keyword">new</span> TextureIDManager(&amp;m_Device);</div>
<div class="line">    m_pAssetLoader = <span class="keyword">new</span> AssetFileLoadingHelper(&amp;m_Device, m_pTextureIDManager);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Create uniform buffer managers */</span></div>
<div class="line">    m_pUniformBufferManager = <span class="keyword">new</span> UniformBufferManager(&amp;m_Device, 8 * 1024 * 1024, g_NumBackBuffers);</div>
<div class="line">    m_pStaticUniformBufferManager = <span class="keyword">new</span> UniformBufferManager(&amp;m_Device, 16 * 1024 * 1024, 1);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Register memory managers with the sync manager */</span></div>
<div class="line">    m_pFrameBufferedSyncManager = <span class="keyword">new</span> FrameBufferedSyncManager(&amp;m_Device, &amp;m_Queue, g_NumBackBuffers);</div>
<div class="line">    m_pFrameBufferedSyncManager-&gt;RegisterMemoryManager(m_pUniformBufferManager);</div>
<div class="line">    m_pFrameBufferedSyncManager-&gt;RegisterMemoryManager(m_BackBufferCommandBuffer);</div>
<div class="line">    m_pFrameBufferedSyncManager-&gt;RegisterMemoryManager(m_GBufferCommandBuffer);</div>
<div class="line">    m_pFrameBufferedSyncManager-&gt;RegisterMemoryManager(m_LightingPassCommandBuffer);</div>
<div class="line">    m_pFrameBufferedSyncManager-&gt;RegisterMemoryManager(m_SkyBoxCommandBuffer);</div>
<div class="line">    m_pFrameBufferedSyncManager-&gt;RegisterMemoryManager(m_ShadowMapPassCommandBuffer);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> cacheSize;</div>
<div class="line">    <a name="_a8"></a><a class="code" href="classnn_1_1_result.html">nn::Result</a> result = <a name="a9"></a><a class="code" href="namespacenn_1_1fs.html#a5df6e3385c795a5bd046790ef7f17f2d">nn::fs::QueryMountRomCacheSize</a>(&amp;cacheSize);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(result.IsSuccess());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">char</span>* mountRomCacheBuffer = <span class="keyword">new</span>(std::nothrow) <span class="keywordtype">char</span>[cacheSize];</div>
<div class="line">    <a name="a10"></a><a class="code" href="nn___assert_8h.html#a0473ebccccc250efd6100a9bbfec406b">NN_ASSERT_NOT_NULL</a>(mountRomCacheBuffer);</div>
<div class="line"> </div>
<div class="line">    result = <a name="a11"></a><a class="code" href="namespacenn_1_1fs.html#a2e453fe1fbf8f818dc45bbd2897105cd">nn::fs::MountRom</a>(<span class="stringliteral">&quot;rom&quot;</span>, (<span class="keywordtype">void</span>*)mountRomCacheBuffer, cacheSize);</div>
<div class="line">    <a name="a12"></a><a class="code" href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a>(result);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Load scene */</span></div>
<div class="line">    SetupSceneFromFile(g_SceneFileName);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set up the screen space quad pass */</span></div>
<div class="line">    <span class="keywordtype">void</span>* place = AlignedAllocate(<span class="keyword">sizeof</span>(ScreenSpaceQuadPass), <a name="a13"></a><a class="code" href="nn___macro_8h.html#ac6f80ca2ebf15f619391e35806e9635f">NN_ALIGNOF</a>(ScreenSpaceQuadPass));</div>
<div class="line">    m_pScreenSpaceQuadPass = <span class="keyword">new</span>(place) ScreenSpaceQuadPass;</div>
<div class="line">    m_pScreenSpaceQuadPass-&gt;Init(m_Shaders[<span class="stringliteral">&quot;ScreenSpaceQuad.out&quot;</span>]);</div>
<div class="line">    m_pScreenSpaceQuadPass-&gt;SetupUniforms(m_pUniformBufferManager);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set up the depth visualization pass */</span></div>
<div class="line">    place = AlignedAllocate(<span class="keyword">sizeof</span>(ScreenSpaceQuadDepthPass), <a class="code" href="nn___macro_8h.html#ac6f80ca2ebf15f619391e35806e9635f">NN_ALIGNOF</a>(ScreenSpaceQuadDepthPass));</div>
<div class="line">    m_pScreenSpaceQuadDepthPass = <span class="keyword">new</span>(place) ScreenSpaceQuadDepthPass;</div>
<div class="line">    m_pScreenSpaceQuadDepthPass-&gt;Init(m_Shaders[<span class="stringliteral">&quot;ScreenSpaceQuadDepth.out&quot;</span>]);</div>
<div class="line">    m_pScreenSpaceQuadDepthPass-&gt;SetupUniforms(m_pUniformBufferManager);</div>
<div class="line">    m_pScreenSpaceQuadDepthPass-&gt;SetNearFar(m_Near, m_Far);</div>
<div class="line"> </div>
<div class="line">    nvnSamplerBuilderSetDefaults(&amp;m_SamplerBuilder);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef DEBUGTEXT</span></div>
<div class="line">        <span class="comment">/* Setup the debug text renderer */</span></div>
<div class="line">    m_pDebugTextRenderer = DebugTextRenderer::GetInstance();</div>
<div class="line">    m_pDebugTextRenderer-&gt;Init(&amp;m_Device, &amp;m_Queue, m_pTextureIDManager, m_pFrameBufferedSyncManager, g_NumBackBuffers);</div>
<div class="line">    m_pDebugTextRenderer-&gt;SetDrawEnable(<span class="keyword">true</span>);</div>
<div class="line">    m_pDebugTextRenderer-&gt;SetSpacing(<span class="keyword">false</span>);</div>
<div class="line">    m_pDebugTextRenderer-&gt;SetGridSize(120.0f, 36.0f);</div>
<div class="line">    m_pDebugTextRenderer-&gt;SetColor(1.0f, 0.0f, 0.0f, 1.0f);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <a name="a14"></a><a class="code" href="namespacenn_1_1fs.html#ac8a95249afd4a87a55d319dfecb0466c">nn::fs::Unmount</a>(<span class="stringliteral">&quot;rom&quot;</span>);</div>
<div class="line">    <span class="keyword">delete</span>[] mountRomCacheBuffer;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Setup the window builder */</span></div>
<div class="line">    nvnWindowBuilderSetDefaults(&amp;m_WindowBuilder);</div>
<div class="line">    nvnWindowBuilderSetDevice(&amp;m_WindowBuilder, &amp;m_Device);</div>
<div class="line">    nvnWindowBuilderSetNativeWindow(&amp;m_WindowBuilder, nativeWindow);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Blend State */</span></div>
<div class="line">    nvnBlendStateSetDefaults(&amp;m_BlendState);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Channel Mask State */</span></div>
<div class="line">    nvnChannelMaskStateSetDefaults(&amp;m_ChannelMaskState);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Color State */</span></div>
<div class="line">    nvnColorStateSetDefaults(&amp;m_ColorState);</div>
<div class="line">    nvnColorStateSetBlendEnable(&amp;m_ColorState, 0, <a class="code" href="group__nvn__c__defines.html#ga48151b7e768a13685d77d1a4c464a33b">NVN_TRUE</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Depth Stencil State */</span></div>
<div class="line">    nvnDepthStencilStateSetDefaults(&amp;m_DepthStencilState);</div>
<div class="line">    nvnDepthStencilStateSetDepthTestEnable(&amp;m_DepthStencilState, <a class="code" href="group__nvn__c__defines.html#ga48151b7e768a13685d77d1a4c464a33b">NVN_TRUE</a>);</div>
<div class="line">    nvnDepthStencilStateSetDepthWriteEnable(&amp;m_DepthStencilState, <a class="code" href="group__nvn__c__defines.html#ga48151b7e768a13685d77d1a4c464a33b">NVN_TRUE</a>);</div>
<div class="line">    nvnDepthStencilStateSetDepthFunc(&amp;m_DepthStencilState, NVN_DEPTH_FUNC_LESS);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Multisample state */</span></div>
<div class="line">    nvnMultisampleStateSetDefaults(&amp;m_MultisampleState);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Initialize the input manager */</span></div>
<div class="line">    m_InputManager.Init();</div>
<div class="line"> </div>
<div class="line">    nvnSyncInitialize(&amp;m_WindowSync, &amp;m_Device);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Setup the default target to present*/</span></div>
<div class="line">    m_pPresentHandle = &amp;m_FinalTarget.m_TextureHandle;</div>
<div class="line">    m_PresentTargetName = <span class="stringliteral">&quot;Final Image&quot;</span>;</div>
<div class="line">    m_pPresentPass = m_pScreenSpaceQuadPass;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Create a sampler for visualizing the directional shadow map */</span></div>
<div class="line">    nvnSamplerBuilderSetWrapMode(&amp;m_SamplerBuilder, NVN_WRAP_MODE_CLAMP_TO_EDGE, NVN_WRAP_MODE_CLAMP_TO_EDGE, NVN_WRAP_MODE_CLAMP_TO_EDGE);</div>
<div class="line">    m_pShadowMapDisplaySampler = <span class="keyword">new</span> <a name="_a15"></a><a class="code" href="struct_n_v_nsampler.html">NVNsampler</a>();</div>
<div class="line">    nvnSamplerInitialize(m_pShadowMapDisplaySampler, &amp;m_SamplerBuilder);</div>
<div class="line">    m_ShadowMapDisplaySamplerID = m_pTextureIDManager-&gt;RegisterSampler(m_pShadowMapDisplaySampler);</div>
<div class="line"> </div>
<div class="line">    AssetFileDataHolder* shaderData = m_Shaders[<span class="stringliteral">&quot;PointShadowMap.out&quot;</span>];</div>
<div class="line">    std::string programName = shaderData-&gt;GetSpecializedProgramData()[0]-&gt;m_pProgramName;</div>
<div class="line">    <a name="_a16"></a><a class="code" href="struct_n_v_ncommand_buffer.html">NVNcommandBuffer</a>* pCommandBuffer = m_ShadowMapPassCommandBuffer-&gt;GetCommandBuffer();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Point Light Shadows */</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_DeferredPointLightObjects.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (m_DeferredPointLightObjects[i]-&gt;IsShadowCaster())</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">for</span> (uint32_t mapIdx = 0; mapIdx &lt; 6; ++mapIdx)</div>
<div class="line">            {</div>
<div class="line">                RenderPointLightShadowFace(m_DeferredPointLightObjects[i], pCommandBuffer, mapIdx, shaderData);</div>
<div class="line"> </div>
<div class="line">                    <span class="comment">/*</span></div>
<div class="line"><span class="comment">                     * Because the same command buffer is being used for each face, the memory</span></div>
<div class="line"><span class="comment">                     * needs to be swapped. If this was being done at run time instead of on</span></div>
<div class="line"><span class="comment">                     * load, this kind of syncing and flushing should be avoided.</span></div>
<div class="line"><span class="comment">                     */</span></div>
<div class="line">                m_pFrameBufferedSyncManager-&gt;InsertFence();</div>
<div class="line">                m_pFrameBufferedSyncManager-&gt;SwapPools();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Setup buffer for GPU times measurement */</span></div>
<div class="line">    m_TimeStampPool.Init(<span class="keyword">nullptr</span>, g_NumBackBuffers * <span class="keyword">sizeof</span>( int64_t ) * 4, NVN_MEMORY_POOL_FLAGS_CPU_UNCACHED_BIT | NVN_MEMORY_POOL_FLAGS_GPU_UNCACHED_BIT, &amp;m_Device );</div>
<div class="line"> </div>
<div class="line">    <a name="_a17"></a><a class="code" href="struct_n_v_nbuffer_builder.html">NVNbufferBuilder</a> timeStampBuilder;</div>
<div class="line">    nvnBufferBuilderSetDefaults( &amp;timeStampBuilder );</div>
<div class="line">    nvnBufferBuilderSetDevice( &amp;timeStampBuilder, &amp;m_Device );</div>
<div class="line"> </div>
<div class="line">    nvnBufferBuilderSetStorage( &amp;timeStampBuilder, m_TimeStampPool.GetMemoryPool(), 0, g_NumBackBuffers * <span class="keyword">sizeof</span>( int64_t ) * 4 );</div>
<div class="line">    nvnBufferInitialize( &amp;m_TimeStampBuffer, &amp;timeStampBuilder );</div>
<div class="line">}<span class="comment">//NOLINT(impl/function_size)</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> DeferredRenderer::Resize(<span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height)</div>
<div class="line">{</div>
<div class="line">        <span class="comment">/* Make sure nothing is currently in use */</span></div>
<div class="line">    nvnQueueFinish(&amp;m_Queue);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Save the new width and height */</span></div>
<div class="line">    m_ScreenWidth = width;</div>
<div class="line">    m_ScreenHeight = height;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Get the size of each type of texture to create */</span></div>
<div class="line">    <span class="keywordtype">size_t</span> colorTargetSize =   TextureUtil::GetTextureSize(NVN_TEXTURE_FLAGS_DISPLAY_BIT |</div>
<div class="line">                                                           NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT,</div>
<div class="line">                                                           m_ScreenWidth,</div>
<div class="line">                                                           m_ScreenHeight,</div>
<div class="line">                                                           NVN_TEXTURE_TARGET_2D,</div>
<div class="line">                                                           NVN_FORMAT_RGBA8_SRGB,</div>
<div class="line">                                                           m_RenderTargetBuilder);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> dataTargetSize =    TextureUtil::GetTextureSize(NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT,</div>
<div class="line">                                                           m_ScreenWidth,</div>
<div class="line">                                                           m_ScreenHeight,</div>
<div class="line">                                                           NVN_TEXTURE_TARGET_2D,</div>
<div class="line">                                                           NVN_FORMAT_R11G11B10F,</div>
<div class="line">                                                           m_RenderTargetBuilder);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> depthTargetSize =   TextureUtil::GetTextureSize(NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT,</div>
<div class="line">                                                           m_ScreenWidth,</div>
<div class="line">                                                           m_ScreenHeight,</div>
<div class="line">                                                           NVN_TEXTURE_TARGET_2D,</div>
<div class="line">                                                           NVN_FORMAT_DEPTH24_STENCIL8,</div>
<div class="line">                                                           m_RenderTargetBuilder);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> diffuseTargetSize = TextureUtil::GetTextureSize(NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT,</div>
<div class="line">                                                           m_ScreenWidth,</div>
<div class="line">                                                           m_ScreenHeight,</div>
<div class="line">                                                           NVN_TEXTURE_TARGET_2D,</div>
<div class="line">                                                           NVN_FORMAT_RGBA8,</div>
<div class="line">                                                           m_RenderTargetBuilder);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> specularTargetSize = TextureUtil::GetTextureSize(NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT,</div>
<div class="line">                                                            m_ScreenWidth,</div>
<div class="line">                                                            m_ScreenHeight,</div>
<div class="line">                                                            NVN_TEXTURE_TARGET_2D,</div>
<div class="line">                                                            NVN_FORMAT_RGBA8,</div>
<div class="line">                                                            m_RenderTargetBuilder);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> shadowTargetSize =  TextureUtil::GetTextureSize(NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT,</div>
<div class="line">                                                           m_pDirectionalLightPass-&gt;GetShadowMapWidth(),</div>
<div class="line">                                                           m_pDirectionalLightPass-&gt;GetShadowMapHeight(),</div>
<div class="line">                                                           NVN_TEXTURE_TARGET_2D,</div>
<div class="line">                                                           NVN_FORMAT_DEPTH32F,</div>
<div class="line">                                                           m_RenderTargetBuilder);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * If this pool already exists, finalize the window, finalize all</span></div>
<div class="line"><span class="comment">         * textures allocated from it, and shutdown the pool.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">    <span class="keywordflow">if</span> (m_pRenderTargetMemoryPool)</div>
<div class="line">    {</div>
<div class="line">        nvnWindowFinalize(&amp;m_Window);</div>
<div class="line"> </div>
<div class="line">        nvnTextureFinalize(&amp;m_DepthBuffer.m_Texture);</div>
<div class="line">        nvnTextureFinalize(&amp;m_DiffuseTarget.m_Texture);</div>
<div class="line">        nvnTextureFinalize(&amp;m_SpecularTarget.m_Texture);</div>
<div class="line">        nvnTextureFinalize(&amp;m_NormalTarget.m_Texture);</div>
<div class="line">        nvnTextureFinalize(&amp;m_DirectionalShadowMap.m_Texture);</div>
<div class="line">        nvnTextureFinalize(&amp;m_FinalTarget.m_Texture);</div>
<div class="line"> </div>
<div class="line">        m_pRenderTargetMemoryPool-&gt;Shutdown();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        m_pRenderTargetMemoryPool = <span class="keyword">new</span> <a class="code" href="namespacenn_1_1gfx.html#ad620d8208dd309eb7c4dd5973a6aeee5">MemoryPool</a>();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Create the render target memory pool with the appropriate size */</span></div>
<div class="line">    m_pRenderTargetMemoryPool-&gt;Init(NULL,</div>
<div class="line">                                    colorTargetSize * g_NumBackBuffers +</div>
<div class="line">                                    shadowTargetSize +</div>
<div class="line">                                    depthTargetSize +</div>
<div class="line">                                    dataTargetSize +</div>
<div class="line">                                    2 * diffuseTargetSize +</div>
<div class="line">                                    specularTargetSize,</div>
<div class="line">                                    NVN_MEMORY_POOL_FLAGS_CPU_NO_ACCESS_BIT |</div>
<div class="line">                                    NVN_MEMORY_POOL_FLAGS_GPU_CACHED_BIT |</div>
<div class="line">                                    NVN_MEMORY_POOL_FLAGS_COMPRESSIBLE_BIT,</div>
<div class="line">                                    &amp;m_Device);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Create each texture at the proper offset in the render target pool */</span></div>
<div class="line">    ptrdiff_t currentOffset = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; g_NumBackBuffers; ++i)</div>
<div class="line">    {</div>
<div class="line">        m_ScreenRenderTargets[i] = <span class="keyword">new</span> <a name="_a18"></a><a class="code" href="struct_n_v_ntexture.html">NVNtexture</a>;</div>
<div class="line"> </div>
<div class="line">        TextureUtil::CreateTexture(NVN_TEXTURE_FLAGS_DISPLAY_BIT |</div>
<div class="line">                                   NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT,</div>
<div class="line">                                   m_ScreenWidth,</div>
<div class="line">                                   m_ScreenHeight,</div>
<div class="line">                                   NVN_TEXTURE_TARGET_2D,</div>
<div class="line">                                   NVN_FORMAT_RGBA8_SRGB,</div>
<div class="line">                                   m_pRenderTargetMemoryPool,</div>
<div class="line">                                   currentOffset,</div>
<div class="line">                                   m_RenderTargetBuilder,</div>
<div class="line">                                   m_ScreenRenderTargets[i]);</div>
<div class="line"> </div>
<div class="line">        currentOffset += colorTargetSize;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    TextureUtil::CreateRenderTarget(NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT,</div>
<div class="line">                                    m_ScreenWidth,</div>
<div class="line">                                    m_ScreenHeight,</div>
<div class="line">                                    NVN_TEXTURE_TARGET_2D,</div>
<div class="line">                                    NVN_FORMAT_DEPTH24_STENCIL8,</div>
<div class="line">                                    m_pRenderTargetMemoryPool,</div>
<div class="line">                                    currentOffset,</div>
<div class="line">                                    m_RenderTargetBuilder,</div>
<div class="line">                                    m_SamplerBuilder,</div>
<div class="line">                                    m_pTextureIDManager,</div>
<div class="line">                                    &amp;m_Device,</div>
<div class="line">                                    &amp;m_DepthBuffer);</div>
<div class="line"> </div>
<div class="line">    currentOffset += depthTargetSize;</div>
<div class="line"> </div>
<div class="line">    TextureUtil::CreateRenderTarget(NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT,</div>
<div class="line">                                    m_ScreenWidth,</div>
<div class="line">                                    m_ScreenHeight,</div>
<div class="line">                                    NVN_TEXTURE_TARGET_2D,</div>
<div class="line">                                    NVN_FORMAT_R11G11B10F,</div>
<div class="line">                                    m_pRenderTargetMemoryPool,</div>
<div class="line">                                    currentOffset,</div>
<div class="line">                                    m_RenderTargetBuilder,</div>
<div class="line">                                    m_SamplerBuilder,</div>
<div class="line">                                    m_pTextureIDManager,</div>
<div class="line">                                    &amp;m_Device,</div>
<div class="line">                                    &amp;m_NormalTarget);</div>
<div class="line"> </div>
<div class="line">    currentOffset += dataTargetSize;</div>
<div class="line"> </div>
<div class="line">    TextureUtil::CreateRenderTarget(NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT,</div>
<div class="line">                                    m_ScreenWidth,</div>
<div class="line">                                    m_ScreenHeight,</div>
<div class="line">                                    NVN_TEXTURE_TARGET_2D,</div>
<div class="line">                                    NVN_FORMAT_RGBA8,</div>
<div class="line">                                    m_pRenderTargetMemoryPool,</div>
<div class="line">                                    currentOffset,</div>
<div class="line">                                    m_RenderTargetBuilder,</div>
<div class="line">                                    m_SamplerBuilder,</div>
<div class="line">                                    m_pTextureIDManager,</div>
<div class="line">                                    &amp;m_Device,</div>
<div class="line">                                    &amp;m_DiffuseTarget);</div>
<div class="line"> </div>
<div class="line">    currentOffset += diffuseTargetSize;</div>
<div class="line"> </div>
<div class="line">    TextureUtil::CreateRenderTarget(NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT,</div>
<div class="line">                                    m_ScreenWidth,</div>
<div class="line">                                    m_ScreenHeight,</div>
<div class="line">                                    NVN_TEXTURE_TARGET_2D,</div>
<div class="line">                                    NVN_FORMAT_RGBA8_SRGB,</div>
<div class="line">                                    m_pRenderTargetMemoryPool,</div>
<div class="line">                                    currentOffset,</div>
<div class="line">                                    m_RenderTargetBuilder,</div>
<div class="line">                                    m_SamplerBuilder,</div>
<div class="line">                                    m_pTextureIDManager,</div>
<div class="line">                                    &amp;m_Device,</div>
<div class="line">                                    &amp;m_FinalTarget);</div>
<div class="line"> </div>
<div class="line">    currentOffset += diffuseTargetSize;</div>
<div class="line"> </div>
<div class="line">    TextureUtil::CreateRenderTarget(NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT,</div>
<div class="line">                                    m_pDirectionalLightPass-&gt;GetShadowMapWidth(),</div>
<div class="line">                                    m_pDirectionalLightPass-&gt;GetShadowMapHeight(),</div>
<div class="line">                                    NVN_TEXTURE_TARGET_2D,</div>
<div class="line">                                    NVN_FORMAT_DEPTH32F,</div>
<div class="line">                                    m_pRenderTargetMemoryPool,</div>
<div class="line">                                    currentOffset,</div>
<div class="line">                                    m_RenderTargetBuilder,</div>
<div class="line">                                    m_SamplerBuilder,</div>
<div class="line">                                    m_pTextureIDManager,</div>
<div class="line">                                    &amp;m_Device,</div>
<div class="line">                                    &amp;m_DirectionalShadowMap,</div>
<div class="line">                                    <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    currentOffset += shadowTargetSize;</div>
<div class="line"> </div>
<div class="line">    TextureUtil::CreateRenderTarget(NVN_TEXTURE_FLAGS_COMPRESSIBLE_BIT,</div>
<div class="line">                                    m_ScreenWidth,</div>
<div class="line">                                    m_ScreenHeight,</div>
<div class="line">                                    NVN_TEXTURE_TARGET_2D,</div>
<div class="line">                                    NVN_FORMAT_RGBA8,</div>
<div class="line">                                    m_pRenderTargetMemoryPool,</div>
<div class="line">                                    currentOffset,</div>
<div class="line">                                    m_RenderTargetBuilder,</div>
<div class="line">                                    m_SamplerBuilder,</div>
<div class="line">                                    m_pTextureIDManager,</div>
<div class="line">                                    &amp;m_Device,</div>
<div class="line">                                    &amp;m_SpecularTarget);</div>
<div class="line"> </div>
<div class="line">    currentOffset += specularTargetSize;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Setup the projection matrix */</span></div>
<div class="line">    nn::util::MatrixPerspectiveFieldOfViewRightHanded(&amp;m_ProjMat44, 45.0f * DEG_TO_RAD, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(m_ScreenWidth) / <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(m_ScreenHeight), m_Near, m_Far);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pSkyBox)</div>
<div class="line">    {</div>
<div class="line">        m_pSkyBox-&gt;SetProjectionMatrix(m_ProjMat44);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set the back buffers and create the window */</span></div>
<div class="line">    nvnWindowBuilderSetTextures(&amp;m_WindowBuilder, g_NumBackBuffers, m_ScreenRenderTargets);</div>
<div class="line">    nvnWindowInitialize(&amp;m_Window, &amp;m_WindowBuilder);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Reset the point light static uniforms witht the new texture handles */</span></div>
<div class="line">    DeferredPointLightObject::SetTextureHandles(m_DiffuseTarget.m_TextureHandle,</div>
<div class="line">                                                m_SpecularTarget.m_TextureHandle,</div>
<div class="line">                                                m_NormalTarget.m_TextureHandle,</div>
<div class="line">                                                m_DepthBuffer.m_TextureHandle);</div>
<div class="line"> </div>
<div class="line">    DeferredPointLightObject::SetupStaticUniforms(m_pStaticUniformBufferManager, m_pUniformBufferManager);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set the new screen size */</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_DeferredPointLightObjects.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        m_DeferredPointLightObjects[i]-&gt;SetScreenSize(m_ScreenWidth, m_ScreenHeight);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Regen the shadows and get a new shadow map display texture handle */</span></div>
<div class="line">    m_GenerateShadows = <span class="keyword">true</span>;</div>
<div class="line">    m_ShadowMapDisplayHandle = nvnDeviceGetTextureHandle(&amp;m_Device, m_DirectionalShadowMap.m_TextureID, m_ShadowMapDisplaySamplerID);</div>
<div class="line">} <span class="comment">//NOLINT(impl/function_size)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * DeferredRenderer::RenderPointLightShadowFace</span></div>
<div class="line"><span class="comment"> * --------------------------------------------</span></div>
<div class="line"><span class="comment"> * Records and submits a command buffer to render one of the cubemap</span></div>
<div class="line"><span class="comment"> * faces for a point light shadow map.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> DeferredRenderer::RenderPointLightShadowFace(DeferredPointLightObject* pPointLight,</div>
<div class="line">                                                  <a class="code" href="struct_n_v_ncommand_buffer.html">NVNcommandBuffer</a>* pCommandBuffer,</div>
<div class="line">                                                  uint32_t mapIdx,</div>
<div class="line">                                                  AssetFileDataHolder* shaderData)</div>
<div class="line">{</div>
<div class="line">    std::string programName = shaderData-&gt;GetSpecializedProgramData()[0]-&gt;m_pProgramName;</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferBeginRecording(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferBindBlendState(pCommandBuffer, &amp;m_BlendState);</div>
<div class="line">    nvnCommandBufferBindChannelMaskState(pCommandBuffer, &amp;m_ChannelMaskState);</div>
<div class="line">    nvnCommandBufferBindColorState(pCommandBuffer, &amp;m_ColorState);</div>
<div class="line">    nvnCommandBufferBindDepthStencilState(pCommandBuffer, &amp;m_DepthStencilState);</div>
<div class="line">    nvnCommandBufferBindMultisampleState(pCommandBuffer, &amp;m_MultisampleState);</div>
<div class="line"> </div>
<div class="line">    m_pTextureIDManager-&gt;SetSamplerPool(pCommandBuffer);</div>
<div class="line">    m_pTextureIDManager-&gt;SetTexturePool(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Update the model uniforms for the scene objects */</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> objIdx = 0; objIdx &lt; m_SceneObjects.size(); ++objIdx)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (pPointLight-&gt;IsIgnoreShadow(m_SceneObjects[objIdx].GetName()))</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Set the shadow camera and projection matrices for the face */</span></div>
<div class="line">        m_SceneObjects[objIdx].SetCameraMatrix(pPointLight-&gt;GetShadowCameraMatrices()[mapIdx]);</div>
<div class="line">        m_SceneObjects[objIdx].SetProjectionMatrix(pPointLight-&gt;GetShadowProjMatrix());</div>
<div class="line">        m_SceneObjects[objIdx].UpdateModelUniforms(programName);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Update and bind the point light shadow mapping uniform */</span></div>
<div class="line">    pPointLight-&gt;UpdateShadowMapUniforms();</div>
<div class="line">    pPointLight-&gt;BindShadowMapUniforms(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="struct_n_v_ntexture.html">NVNtexture</a>* target = &amp;pPointLight-&gt;GetShadowMapTarget()-&gt;m_Texture;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set the depth target to the shadow cubemap and set the view for the appropriate face */</span></div>
<div class="line">    nvnCommandBufferSetRenderTargets(pCommandBuffer, 0, NULL, NULL, target, &amp;(pPointLight-&gt;GetShadowViews()[mapIdx]));</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferSetScissor(pCommandBuffer, 0, 0, pPointLight-&gt;GetShadowMapWidth(), pPointLight-&gt;GetShadowMapHeight());</div>
<div class="line">    nvnCommandBufferSetViewport(pCommandBuffer, 0, 0, pPointLight-&gt;GetShadowMapWidth(), pPointLight-&gt;GetShadowMapHeight());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pShaderScratchMemoryPool)</div>
<div class="line">    {</div>
<div class="line">        nvnCommandBufferSetShaderScratchMemory(pCommandBuffer, m_pShaderScratchMemoryPool-&gt;GetMemoryPool(), 0, m_ShaderScratchSize);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferClearDepthStencil(pCommandBuffer, 1.0, <a class="code" href="group__nvn__c__defines.html#ga48151b7e768a13685d77d1a4c464a33b">NVN_TRUE</a>, 0, 0);</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferBarrier(pCommandBuffer, NVNbarrierBits::NVN_BARRIER_INVALIDATE_SHADER_BIT);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set the shadow state on and draw each object */</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> objIdx = 0; objIdx &lt; m_SceneObjects.size(); ++objIdx)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (pPointLight-&gt;IsIgnoreShadow(m_SceneObjects[objIdx].GetName()))</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        m_SceneObjects[objIdx].SetShadowState();</div>
<div class="line">        m_SceneObjects[objIdx].Draw(pCommandBuffer, programName, m_Models, shaderData);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__nvn__c__handle.html#gab7f10945ffe1f6161c87238c75ae411d">NVNcommandHandle</a> handle = nvnCommandBufferEndRecording(pCommandBuffer);</div>
<div class="line">    nvnQueueSubmitCommands(&amp;m_Queue, 1, &amp;handle);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * DeferredRenderer::Shutdown</span></div>
<div class="line"><span class="comment"> * --------------------------</span></div>
<div class="line"><span class="comment"> * Cleans up all dynamically allocated memory and NVN objects.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> DeferredRenderer::Shutdown()</div>
<div class="line">{</div>
<div class="line">    nvnQueueFinish(&amp;m_Queue);</div>
<div class="line"> </div>
<div class="line">    nvnBufferFinalize(&amp;m_TimeStampBuffer);</div>
<div class="line">    m_TimeStampPool.Shutdown();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_BackBufferCommandBuffer)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> m_BackBufferCommandBuffer;</div>
<div class="line">        m_BackBufferCommandBuffer = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_GBufferCommandBuffer)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> m_GBufferCommandBuffer;</div>
<div class="line">        m_GBufferCommandBuffer = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_ShadowMapPassCommandBuffer)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> m_ShadowMapPassCommandBuffer;</div>
<div class="line">        m_ShadowMapPassCommandBuffer = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_LightingPassCommandBuffer)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> m_LightingPassCommandBuffer;</div>
<div class="line">        m_LightingPassCommandBuffer = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_SkyBoxCommandBuffer)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> m_SkyBoxCommandBuffer;</div>
<div class="line">        m_SkyBoxCommandBuffer = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    nvnWindowFinalize(&amp;m_Window);</div>
<div class="line">    nvnSyncFinalize(&amp;m_WindowSync);</div>
<div class="line"> </div>
<div class="line">    nvnTextureFinalize(&amp;m_DepthBuffer.m_Texture);</div>
<div class="line">    nvnTextureFinalize(&amp;m_DiffuseTarget.m_Texture);</div>
<div class="line">    nvnTextureFinalize(&amp;m_SpecularTarget.m_Texture);</div>
<div class="line">    nvnTextureFinalize(&amp;m_NormalTarget.m_Texture);</div>
<div class="line">    nvnTextureFinalize(&amp;m_DirectionalShadowMap.m_Texture);</div>
<div class="line">    nvnTextureFinalize(&amp;m_FinalTarget.m_Texture);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; g_NumBackBuffers; ++i)</div>
<div class="line">    {</div>
<div class="line">        nvnTextureFinalize(m_ScreenRenderTargets[i]);</div>
<div class="line">        <span class="keyword">delete</span> m_ScreenRenderTargets[i];</div>
<div class="line">        m_ScreenRenderTargets[i] = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (std::map&lt;std::string, AssetFileDataHolder*&gt;::iterator itr = m_Shaders.begin(); itr != m_Shaders.end(); ++itr)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> itr-&gt;second;</div>
<div class="line">    }</div>
<div class="line">    m_Shaders.clear();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (std::map&lt;std::string, AssetFileDataHolder*&gt;::iterator itr = m_Textures.begin(); itr != m_Textures.end(); ++itr)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> itr-&gt;second;</div>
<div class="line">    }</div>
<div class="line">    m_Textures.clear();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pShadowMapDisplaySampler)</div>
<div class="line">    {</div>
<div class="line">        nvnSamplerFinalize(m_pShadowMapDisplaySampler);</div>
<div class="line">        <span class="keyword">delete</span> m_pShadowMapDisplaySampler;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pSkyBox)</div>
<div class="line">    {</div>
<div class="line">        AlignedDeallocate(m_pSkyBox);</div>
<div class="line">        m_pSkyBox = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pDirectionalLightPass)</div>
<div class="line">    {</div>
<div class="line">        AlignedDeallocate(m_pDirectionalLightPass);</div>
<div class="line">        m_pDirectionalLightPass = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_DeferredPointLightObjects.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        m_DeferredPointLightObjects[i]-&gt;Shutdown();</div>
<div class="line">        AlignedDeallocate(m_DeferredPointLightObjects[i]);</div>
<div class="line">    }</div>
<div class="line">    m_DeferredPointLightObjects.clear();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pScreenSpaceQuadDepthPass)</div>
<div class="line">    {</div>
<div class="line">        AlignedDeallocate(m_pScreenSpaceQuadDepthPass);</div>
<div class="line">        m_pScreenSpaceQuadDepthPass = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pScreenSpaceQuadPass)</div>
<div class="line">    {</div>
<div class="line">        AlignedDeallocate(m_pScreenSpaceQuadPass);</div>
<div class="line">        m_pScreenSpaceQuadPass = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pAssetLoader != NULL)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> m_pAssetLoader;</div>
<div class="line">        m_pAssetLoader = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pTextureIDManager != NULL)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> m_pTextureIDManager;</div>
<div class="line">        m_pTextureIDManager = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    m_SceneObjects.clear();</div>
<div class="line">    m_Models.clear();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pDebugTextRenderer != NULL)</div>
<div class="line">    {</div>
<div class="line">        m_pDebugTextRenderer-&gt;CleanUp();</div>
<div class="line">        m_pDebugTextRenderer = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pRenderTargetMemoryPool)</div>
<div class="line">    {</div>
<div class="line">        m_pRenderTargetMemoryPool-&gt;Shutdown();</div>
<div class="line">        <span class="keyword">delete</span> m_pRenderTargetMemoryPool;</div>
<div class="line">        m_pRenderTargetMemoryPool = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pShaderScratchMemoryPool)</div>
<div class="line">    {</div>
<div class="line">        m_pShaderScratchMemoryPool-&gt;Shutdown();</div>
<div class="line">        <span class="keyword">delete</span> m_pShaderScratchMemoryPool;</div>
<div class="line">        m_pShaderScratchMemoryPool = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pUniformBufferManager)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> m_pUniformBufferManager;</div>
<div class="line">        m_pUniformBufferManager = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pStaticUniformBufferManager)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> m_pStaticUniformBufferManager;</div>
<div class="line">        m_pStaticUniformBufferManager = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pFrameBufferedSyncManager != NULL)</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">delete</span> m_pFrameBufferedSyncManager;</div>
<div class="line">        m_pFrameBufferedSyncManager = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    nvnQueueFinalize(&amp;m_Queue);</div>
<div class="line">    <span class="keywordflow">if</span> (m_pQueueMemory)</div>
<div class="line">    {</div>
<div class="line">        AlignedDeallocate(m_pQueueMemory);</div>
<div class="line">        m_pQueueMemory = NULL;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    nvnDeviceFinalize(&amp;m_Device);</div>
<div class="line">}<span class="comment">//NOLINT(impl/function_size)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * DeferredRenderer::Draw</span></div>
<div class="line"><span class="comment"> * ----------------------</span></div>
<div class="line"><span class="comment"> * Runs each pass needed to draw the scene.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> DeferredRenderer::Draw(uint64_t millisec)</div>
<div class="line">{</div>
<div class="line">    <a name="a19"></a><a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(millisec);</div>
<div class="line"> </div>
<div class="line">    m_CurrentBeginFrameTime = <a name="a20"></a><a class="code" href="namespacenn_1_1os.html#a79e29821bfb2b0c3a5c222488e90cc89">nn::os::GetSystemTick</a>().<a name="a21"></a><a class="code" href="classnn_1_1os_1_1_tick.html#aae2542ec136248db4dc662cbdf95f3ad">ToTimeSpan</a>().<a name="a22"></a><a class="code" href="classnn_1_1_time_span.html#a03c119fa6c678e9b251f14f7ca8431c5">GetNanoSeconds</a>();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Update the input manager and the camera. */</span></div>
<div class="line">    UpdateScene();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Render the G-buffer */</span></div>
<div class="line">    GBufferPass();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Generate the directional shadows as needed. Currently once per resize */</span></div>
<div class="line">    <span class="keywordflow">if</span> (m_GenerateShadows)</div>
<div class="line">    {</div>
<div class="line">        DirectionalShadowPass();</div>
<div class="line">        m_GenerateShadows = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Apply the directional and point light contributions */</span></div>
<div class="line">    LightingPass();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Render the skybox anywhere geometry hasn&#39;t already been rendered */</span></div>
<div class="line">    RenderSkyBox();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Choos which target to show on screen (for debugging) */</span></div>
<div class="line">    GetTargetToPresent();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Present the chosen texture */</span></div>
<div class="line">    PresentTexture(*m_pPresentHandle, m_pPresentPass);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Swap the buffered memory objects */</span></div>
<div class="line">    m_pFrameBufferedSyncManager-&gt;InsertFence();</div>
<div class="line">    m_pFrameBufferedSyncManager-&gt;SwapPools();</div>
<div class="line"> </div>
<div class="line">    m_PrevFrameTime = <a class="code" href="namespacenn_1_1os.html#a79e29821bfb2b0c3a5c222488e90cc89">nn::os::GetSystemTick</a>().<a class="code" href="classnn_1_1os_1_1_tick.html#aae2542ec136248db4dc662cbdf95f3ad">ToTimeSpan</a>().<a class="code" href="classnn_1_1_time_span.html#a03c119fa6c678e9b251f14f7ca8431c5">GetNanoSeconds</a>() - m_CurrentBeginFrameTime;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef NN_BUILD_TARGET_PLATFORM_OS_WIN</span></div>
<div class="line">    uint64_t before = <span class="keyword">reinterpret_cast&lt;</span><a name="_a23"></a><a class="code" href="struct_n_v_ncounter_data.html">NVNcounterData</a>*<span class="keyword">&gt;</span>((<span class="keywordtype">char</span>*)nvnBufferMap(&amp;m_TimeStampBuffer) + 32 * ((m_CurrentTimeStamp + 1) % g_NumBackBuffers)     )-&gt;timestamp;</div>
<div class="line">    uint64_t after  = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_n_v_ncounter_data.html">NVNcounterData</a>*<span class="keyword">&gt;</span>((<span class="keywordtype">char</span>*)nvnBufferMap(&amp;m_TimeStampBuffer) + 32 * ((m_CurrentTimeStamp + 1) % g_NumBackBuffers) + 16)-&gt;timestamp;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    uint64_t before = nvnDeviceGetTimestampInNanoseconds(&amp;m_Device, <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_n_v_ncounter_data.html">NVNcounterData</a>*<span class="keyword">&gt;</span>((<span class="keywordtype">char</span>*)nvnBufferMap(&amp;m_TimeStampBuffer) + 32 * ((m_CurrentTimeStamp + 1) % g_NumBackBuffers)     ));</div>
<div class="line">    uint64_t after  = nvnDeviceGetTimestampInNanoseconds(&amp;m_Device, <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_n_v_ncounter_data.html">NVNcounterData</a>*<span class="keyword">&gt;</span>((<span class="keywordtype">char</span>*)nvnBufferMap(&amp;m_TimeStampBuffer) + 32 * ((m_CurrentTimeStamp + 1) % g_NumBackBuffers) + 16));</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    m_CurrentTimeStamp++;</div>
<div class="line"> </div>
<div class="line">    m_PrevGPUTime = (after - before);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * DeferredRenderer::SetupSceneFromFile</span></div>
<div class="line"><span class="comment"> * ------------------------------------</span></div>
<div class="line"><span class="comment"> * Loads the scene from a given input scene file.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> DeferredRenderer::SetupSceneFromFile(std::string fileName)</div>
<div class="line">{</div>
<div class="line">    nvnSamplerBuilderSetDefaults(&amp;m_SamplerBuilder);</div>
<div class="line">    nvnSamplerBuilderSetMinMagFilter(&amp;m_SamplerBuilder, NVNminFilter::NVN_MIN_FILTER_LINEAR_MIPMAP_NEAREST, NVNmagFilter::NVN_MAG_FILTER_LINEAR);</div>
<div class="line"> </div>
<div class="line">    rapidxml::xml_document&lt;&gt; xmlDoc;</div>
<div class="line"> </div>
<div class="line">    std::pair&lt;rapidxml::xml_node&lt;&gt;*, <span class="keywordtype">char</span>*&gt; xmlLoad = SceneFileLoad::LoadAndParseXMLFile(fileName, xmlDoc);</div>
<div class="line"> </div>
<div class="line">    rapidxml::xml_node&lt;&gt;* rootNode = xmlLoad.first;</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(rootNode);</div>
<div class="line"> </div>
<div class="line">    SceneFileLoad::LoadGlobalData(rootNode, m_Near, m_Far, m_GlobalAmbient);</div>
<div class="line"> </div>
<div class="line">    SceneFileLoad::LoadCameraInfo(rootNode, &amp;m_Camera);</div>
<div class="line"> </div>
<div class="line">    SceneFileLoad::LoadShaders(rootNode, m_Shaders, m_pAssetLoader);</div>
<div class="line"> </div>
<div class="line">    SceneFileLoad::LoadTextures(rootNode,</div>
<div class="line">                                m_pAssetLoader,</div>
<div class="line">                                &amp;m_Device,</div>
<div class="line">                                &amp;m_SamplerBuilder,</div>
<div class="line">                                m_pTextureIDManager,</div>
<div class="line">                                m_Textures);</div>
<div class="line"> </div>
<div class="line">    SceneFileLoad::LoadPBRObjects(rootNode,</div>
<div class="line">                                  &amp;m_Device,</div>
<div class="line">                                  m_pUniformBufferManager,</div>
<div class="line">                                  m_pStaticUniformBufferManager,</div>
<div class="line">                                  m_Shaders,</div>
<div class="line">                                  m_Textures,</div>
<div class="line">                                  m_Models,</div>
<div class="line">                                  m_SceneObjects);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    SceneFileLoad::LoadDirectionalLight(rootNode,</div>
<div class="line">                                        m_Shaders,</div>
<div class="line">                                        m_pUniformBufferManager,</div>
<div class="line">                                        &amp;m_Camera,</div>
<div class="line">                                        m_GlobalAmbient,</div>
<div class="line">                                        &amp;m_pDirectionalLightPass);</div>
<div class="line"> </div>
<div class="line">    SceneFileLoad::LoadPointLights(rootNode,</div>
<div class="line">                                   &amp;m_Device,</div>
<div class="line">                                   m_ScreenWidth,</div>
<div class="line">                                   m_ScreenHeight,</div>
<div class="line">                                   m_Shaders,</div>
<div class="line">                                   m_Models,</div>
<div class="line">                                   &amp;m_Camera,</div>
<div class="line">                                   m_pUniformBufferManager,</div>
<div class="line">                                   m_pTextureIDManager,</div>
<div class="line">                                   m_DeferredPointLightObjects);</div>
<div class="line"> </div>
<div class="line">    SceneFileLoad::LoadSkyBox(rootNode,</div>
<div class="line">                              &amp;m_Device,</div>
<div class="line">                              m_pUniformBufferManager,</div>
<div class="line">                              m_Textures,</div>
<div class="line">                              m_Shaders,</div>
<div class="line">                              m_Models,</div>
<div class="line">                              m_Far,</div>
<div class="line">                              &amp;m_pSkyBox);</div>
<div class="line"> </div>
<div class="line">    AlignedDeallocate(xmlLoad.second);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * DeferredRenderer::UpdateScene</span></div>
<div class="line"><span class="comment"> * -----------------------------</span></div>
<div class="line"><span class="comment"> * Updates the input manager and the camera.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> DeferredRenderer::UpdateScene()</div>
<div class="line">{</div>
<div class="line">    m_InputManager.Update();</div>
<div class="line">    m_Camera.Update();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Update objects with the new camera info */</span></div>
<div class="line">    <span class="keywordflow">if</span> (m_pDirectionalLightPass)</div>
<div class="line">    {</div>
<div class="line">        m_pDirectionalLightPass-&gt;SetEyePos(<a name="_a24"></a><a class="code" href="classnn_1_1util_1_1_vector4f.html">nn::util::Vector4f</a>(m_Camera.GetPosition(), 1.0f));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pSkyBox)</div>
<div class="line">    {</div>
<div class="line">        m_pSkyBox-&gt;SetCameraRotation(m_Camera.GetXRotationAsRadian(), m_Camera.GetYRotationAsRadian());</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef NN_BUILD_TARGET_PLATFORM_OS_WIN</span></div>
<div class="line">    InputManager::ButtonState pointLightDebugState = m_InputManager.GetKeyboardButtonState(<span class="charliteral">&#39;X&#39;</span>);</div>
<div class="line">    InputManager::ButtonState debugState = m_InputManager.GetKeyboardButtonState(<span class="charliteral">&#39;C&#39;</span>);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    InputManager::ButtonState pointLightDebugState = m_InputManager.GetGamepadButtonState(InputManagerNX::GamepadButton_X);</div>
<div class="line">    InputManager::ButtonState debugState = m_InputManager.GetGamepadButtonState(InputManagerNX::GamepadButton_B);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Toggle point light debug draw */</span></div>
<div class="line">    <span class="keywordflow">if</span> (pointLightDebugState == InputManager::ButtonState_Triggered)</div>
<div class="line">    {</div>
<div class="line">        m_PointLightDebugDraw = !m_PointLightDebugDraw;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (debugState == InputManager::ButtonState_Triggered)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_SceneObjects.size(); ++i)</div>
<div class="line">        {</div>
<div class="line">            m_SceneObjects[i].TogglePolygonMode();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * DeferredRenderer::GetTargetToPresent</span></div>
<div class="line"><span class="comment"> * ------------------------------------</span></div>
<div class="line"><span class="comment"> * Chooses which render target to display on screen for debug purposes.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> DeferredRenderer::GetTargetToPresent()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">int</span> index = 0;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Target handles */</span></div>
<div class="line">    <span class="keyword">static</span> <a class="code" href="group__nvn__c__handle.html#gaa1a1fc7a9e690ce93870bcd71ea6b446">NVNtextureHandle</a>* targets[] = { &amp;m_FinalTarget.m_TextureHandle,</div>
<div class="line">                                           &amp;m_DiffuseTarget.m_TextureHandle,</div>
<div class="line">                                           &amp;m_SpecularTarget.m_TextureHandle,</div>
<div class="line">                                           &amp;m_NormalTarget.m_TextureHandle,</div>
<div class="line">                                           &amp;m_ShadowMapDisplayHandle,</div>
<div class="line">                                           &amp;m_DepthBuffer.m_TextureHandle };</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Target names */</span></div>
<div class="line">    <span class="keyword">static</span> std::pair&lt;std::string, int&gt; targetNames[] = { std::pair&lt;std::string, int&gt;(<span class="stringliteral">&quot;Final Image&quot;</span>, 0),</div>
<div class="line">                                                         std::pair&lt;std::string, int&gt;(<span class="stringliteral">&quot;G-Buffer Diffuse&quot;</span>, 0),</div>
<div class="line">                                                         std::pair&lt;std::string, int&gt;(<span class="stringliteral">&quot;G-Buffer Specular R, Metallic G, Lit B&quot;</span>, 0),</div>
<div class="line">                                                         std::pair&lt;std::string, int&gt;(<span class="stringliteral">&quot;G-Buffer Normal&quot;</span>, 0),</div>
<div class="line">                                                         std::pair&lt;std::string, int&gt;(<span class="stringliteral">&quot;Directional Shadow Map&quot;</span>, 0),</div>
<div class="line">                                                         std::pair&lt;std::string, int&gt;(<span class="stringliteral">&quot;Depth&quot;</span>, 1) };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> ScreenSpaceQuadPass* presentPasses[] = { m_pScreenSpaceQuadPass, m_pScreenSpaceQuadDepthPass };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">int</span> total = <span class="keyword">sizeof</span>(targets) / <span class="keyword">sizeof</span>(targets[0]);</div>
<div class="line"> </div>
<div class="line">    InputManager::ButtonState stateL;</div>
<div class="line">    InputManager::ButtonState stateR;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef NN_BUILD_TARGET_PLATFORM_OS_WIN</span></div>
<div class="line">    stateL = m_InputManager.GetKeyboardButtonState(<span class="charliteral">&#39;L&#39;</span>);</div>
<div class="line">    stateR = m_InputManager.GetKeyboardButtonState(<span class="charliteral">&#39;R&#39;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    stateL = m_InputManager.GetGamepadButtonState(InputManagerNX::GamepadButton_L);</div>
<div class="line">    stateR = m_InputManager.GetGamepadButtonState(InputManagerNX::GamepadButton_R);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (stateL == InputManager::ButtonState_Triggered)</div>
<div class="line">    {</div>
<div class="line">        index -= 1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stateR == InputManager::ButtonState_Triggered)</div>
<div class="line">    {</div>
<div class="line">        index += 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (index &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        index = total + index;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (index &gt;= total)</div>
<div class="line">    {</div>
<div class="line">        index = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Hold onto the handle, name, and pass to use when presenting */</span></div>
<div class="line">    m_pPresentHandle = targets[index];</div>
<div class="line">    m_PresentTargetName = targetNames[index].first;</div>
<div class="line">    m_pPresentPass = presentPasses[targetNames[index].second];</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * DeferredRenderer::GBufferPass</span></div>
<div class="line"><span class="comment"> * -----------------------------</span></div>
<div class="line"><span class="comment"> * Records and submits a command buffer to render all of the scene</span></div>
<div class="line"><span class="comment"> * geometry to the three target of the G-buffer. These are:</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * 1. Diffuse RGB, Roughness A</span></div>
<div class="line"><span class="comment"> * 2. Normal RGB</span></div>
<div class="line"><span class="comment"> * 3. Specular R, Metallic G, Lit B, Drawn A</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Note: Target 3 is the only one that is cleared per frame as the</span></div>
<div class="line"><span class="comment"> * alpha channel controls whether that fragment is ignored is later</span></div>
<div class="line"><span class="comment"> * passes.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> DeferredRenderer::GBufferPass()</div>
<div class="line">{</div>
<div class="line">    AssetFileDataHolder* shaderData = m_Shaders[<span class="stringliteral">&quot;DeferredGBuffer.out&quot;</span>];</div>
<div class="line">    std::string programName = shaderData-&gt;GetSpecializedProgramData()[0]-&gt;m_pProgramName;</div>
<div class="line"> </div>
<div class="line">    <a name="_a25"></a><a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a> camMat;</div>
<div class="line">    nn::util::MatrixConvert(&amp;camMat, m_Camera.GetCameraMatrix());</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Update the scene objects&#39; model uniforms */</span></div>
<div class="line">    <span class="keywordflow">for</span> (std::vector&lt;PBRObject::Object&gt;::iterator itr = m_SceneObjects.begin(); itr != m_SceneObjects.end(); ++itr)</div>
<div class="line">    {</div>
<div class="line">        itr-&gt;SetProjectionMatrix(m_ProjMat44);</div>
<div class="line">        itr-&gt;SetCameraMatrix(camMat);</div>
<div class="line">        itr-&gt;UpdateModelUniforms(programName);</div>
<div class="line"> </div>
<div class="line">        itr-&gt;UpdateLodInfo(programName, m_Camera.GetPosition());</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="struct_n_v_ncommand_buffer.html">NVNcommandBuffer</a>* pCommandBuffer = m_GBufferCommandBuffer-&gt;GetCommandBuffer();</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferBeginRecording(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferReportCounter( pCommandBuffer, NVN_COUNTER_TYPE_TIMESTAMP, nvnBufferGetAddress( &amp;m_TimeStampBuffer ) + 32 * (m_CurrentTimeStamp % g_NumBackBuffers) );</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferBindBlendState(pCommandBuffer, &amp;m_BlendState);</div>
<div class="line">    nvnCommandBufferBindChannelMaskState(pCommandBuffer, &amp;m_ChannelMaskState);</div>
<div class="line">    nvnCommandBufferBindColorState(pCommandBuffer, &amp;m_ColorState);</div>
<div class="line">    nvnCommandBufferBindDepthStencilState(pCommandBuffer, &amp;m_DepthStencilState);</div>
<div class="line">    nvnCommandBufferBindMultisampleState(pCommandBuffer, &amp;m_MultisampleState);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="struct_n_v_ntexture.html">NVNtexture</a>* buffers[3];</div>
<div class="line">    buffers[0] = &amp;m_DiffuseTarget.m_Texture;</div>
<div class="line">    buffers[1] = &amp;m_NormalTarget.m_Texture;</div>
<div class="line">    buffers[2] = &amp;m_SpecularTarget.m_Texture;</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferSetRenderTargets(pCommandBuffer, 3, buffers, NULL, &amp;m_DepthBuffer.m_Texture, NULL);</div>
<div class="line"> </div>
<div class="line">    m_pTextureIDManager-&gt;SetSamplerPool(pCommandBuffer);</div>
<div class="line">    m_pTextureIDManager-&gt;SetTexturePool(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferSetScissor(pCommandBuffer, 0, 0, m_ScreenWidth, m_ScreenHeight);</div>
<div class="line">    nvnCommandBufferSetViewport(pCommandBuffer, 0, 0, m_ScreenWidth, m_ScreenHeight);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pShaderScratchMemoryPool)</div>
<div class="line">    {</div>
<div class="line">        nvnCommandBufferSetShaderScratchMemory(pCommandBuffer, m_pShaderScratchMemoryPool-&gt;GetMemoryPool(), 0, m_ShaderScratchSize);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Clear specular target, alpha value used to discard during lighting */</span></div>
<div class="line">    <span class="keywordtype">float</span> clear_color[4] = { 0.0f, 0.0f, 0.0f, 0.0f };</div>
<div class="line">    nvnCommandBufferClearColor(pCommandBuffer, 2, clear_color, NVN_CLEAR_COLOR_MASK_RGBA);</div>
<div class="line">    nvnCommandBufferClearDepthStencil(pCommandBuffer, 1.0f, <a class="code" href="group__nvn__c__defines.html#ga48151b7e768a13685d77d1a4c464a33b">NVN_TRUE</a>, 0, 0xFF);</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferBarrier(pCommandBuffer, NVNbarrierBits::NVN_BARRIER_INVALIDATE_SHADER_BIT);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set the state for and draw each object. All objects are drawn via call commands */</span></div>
<div class="line">    <span class="keywordflow">for</span> (std::vector&lt;PBRObject::Object&gt;::iterator itr = m_SceneObjects.begin(); itr != m_SceneObjects.end(); ++itr)</div>
<div class="line">    {</div>
<div class="line">        itr-&gt;SetDefaultState();</div>
<div class="line">        itr-&gt;Draw(pCommandBuffer, programName, m_Models, shaderData);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__nvn__c__handle.html#gab7f10945ffe1f6161c87238c75ae411d">NVNcommandHandle</a> commandHandle = nvnCommandBufferEndRecording(pCommandBuffer);</div>
<div class="line">    nvnQueueSubmitCommands(&amp;m_Queue, 1, &amp;commandHandle);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * DeferredRenderer::DirectionalShadowPass</span></div>
<div class="line"><span class="comment"> * ---------------------------------------</span></div>
<div class="line"><span class="comment"> * This pass renders the shadow map for the scene&#39;s directional</span></div>
<div class="line"><span class="comment"> * light. AS the scene is static, this currently happens once at</span></div>
<div class="line"><span class="comment"> * load time and whenever DeferredRenderer::Resize is called.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> DeferredRenderer::DirectionalShadowPass()</div>
<div class="line">{</div>
<div class="line">    AssetFileDataHolder* shaderData = m_Shaders[<span class="stringliteral">&quot;ShadowMap.out&quot;</span>];</div>
<div class="line">    std::string programName = shaderData-&gt;GetSpecializedProgramData()[0]-&gt;m_pProgramName;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Update the model uniforms with the shadow matrices */</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_SceneObjects.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        m_SceneObjects[i].SetCameraMatrix(m_pDirectionalLightPass-&gt;GetLightViewMatrix());</div>
<div class="line">        m_SceneObjects[i].SetProjectionMatrix(m_pDirectionalLightPass-&gt;GetLightProjectionMatrix());</div>
<div class="line">        m_SceneObjects[i].UpdateModelUniforms(programName);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="struct_n_v_ncommand_buffer.html">NVNcommandBuffer</a>* pCommandBuffer = m_ShadowMapPassCommandBuffer-&gt;GetCommandBuffer();</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferBeginRecording(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferBindBlendState(pCommandBuffer, &amp;m_BlendState);</div>
<div class="line">    nvnCommandBufferBindChannelMaskState(pCommandBuffer, &amp;m_ChannelMaskState);</div>
<div class="line">    nvnCommandBufferBindColorState(pCommandBuffer, &amp;m_ColorState);</div>
<div class="line">    nvnCommandBufferBindDepthStencilState(pCommandBuffer, &amp;m_DepthStencilState);</div>
<div class="line">    nvnCommandBufferBindMultisampleState(pCommandBuffer, &amp;m_MultisampleState);</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferSetRenderTargets(pCommandBuffer, 0, NULL, NULL, &amp;m_DirectionalShadowMap.m_Texture, NULL);</div>
<div class="line"> </div>
<div class="line">    m_pTextureIDManager-&gt;SetSamplerPool(pCommandBuffer);</div>
<div class="line">    m_pTextureIDManager-&gt;SetTexturePool(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferSetScissor(pCommandBuffer, 0, 0, m_pDirectionalLightPass-&gt;GetShadowMapWidth(), m_pDirectionalLightPass-&gt;GetShadowMapHeight());</div>
<div class="line">    nvnCommandBufferSetViewport(pCommandBuffer, 0, 0, m_pDirectionalLightPass-&gt;GetShadowMapWidth(), m_pDirectionalLightPass-&gt;GetShadowMapHeight());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pShaderScratchMemoryPool)</div>
<div class="line">    {</div>
<div class="line">        nvnCommandBufferSetShaderScratchMemory(pCommandBuffer, m_pShaderScratchMemoryPool-&gt;GetMemoryPool(), 0, m_ShaderScratchSize);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferClearDepthStencil(pCommandBuffer, 1.0, <a class="code" href="group__nvn__c__defines.html#ga48151b7e768a13685d77d1a4c464a33b">NVN_TRUE</a>, 0, 0);</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferBarrier(pCommandBuffer, NVNbarrierBits::NVN_BARRIER_INVALIDATE_SHADER_BIT);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Set the shadow state and draw the objects */</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_SceneObjects.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        m_SceneObjects[i].SetShadowState();</div>
<div class="line">        m_SceneObjects[i].Draw(pCommandBuffer, programName, m_Models, shaderData);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__nvn__c__handle.html#gab7f10945ffe1f6161c87238c75ae411d">NVNcommandHandle</a> commandHandle = nvnCommandBufferEndRecording(pCommandBuffer);</div>
<div class="line">    nvnQueueSubmitCommands(&amp;m_Queue, 1, &amp;commandHandle);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * DeferredRenderer::LightingPass</span></div>
<div class="line"><span class="comment"> * ------------------------------</span></div>
<div class="line"><span class="comment"> * This pass performs lighting for the directional light and each</span></div>
<div class="line"><span class="comment"> * point light in the scene. The directional light is drawn as a</span></div>
<div class="line"><span class="comment"> * screen space quad and the point lights are drawn using a front</span></div>
<div class="line"><span class="comment"> * face culled sphere.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> DeferredRenderer::LightingPass()</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct_n_v_ncommand_buffer.html">NVNcommandBuffer</a>* pCommandBuffer = m_LightingPassCommandBuffer-&gt;GetCommandBuffer();</div>
<div class="line">    <a class="code" href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::Matrix4x4fType</a> camMat;</div>
<div class="line">    nn::util::MatrixConvert(&amp;camMat, m_Camera.GetCameraMatrix());</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Update the directional light uniforms */</span></div>
<div class="line">    <span class="keywordflow">if</span> (m_pDirectionalLightPass)</div>
<div class="line">    {</div>
<div class="line">        m_pDirectionalLightPass-&gt;SetLightTextureHandles(m_DiffuseTarget.m_TextureHandle,</div>
<div class="line">                                                        m_SpecularTarget.m_TextureHandle,</div>
<div class="line">                                                        m_NormalTarget.m_TextureHandle,</div>
<div class="line">                                                        m_DirectionalShadowMap.m_TextureHandle,</div>
<div class="line">                                                        m_DepthBuffer.m_TextureHandle);</div>
<div class="line"> </div>
<div class="line">        m_pDirectionalLightPass-&gt;SetScreenSize(m_ScreenWidth, m_ScreenHeight);</div>
<div class="line">        m_pDirectionalLightPass-&gt;SetMatrices(camMat, m_ProjMat44);</div>
<div class="line">        m_pDirectionalLightPass-&gt;UpdateUniforms();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Update the camera matrix for the point lights */</span></div>
<div class="line">    DeferredPointLightObject::SetMatrices(camMat, m_ProjMat44);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Update the point light uniforms */</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_DeferredPointLightObjects.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        m_DeferredPointLightObjects[i]-&gt;SetEyePos(m_Camera.GetPosition());</div>
<div class="line">        m_DeferredPointLightObjects[i]-&gt;UpdateUniforms();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferBeginRecording(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="struct_n_v_ntexture.html">NVNtexture</a>* targets[] = { &amp;m_FinalTarget.m_Texture };</div>
<div class="line">    nvnCommandBufferSetRenderTargets(pCommandBuffer, 1, targets, NULL, NULL, NULL);</div>
<div class="line"> </div>
<div class="line">    m_pTextureIDManager-&gt;SetSamplerPool(pCommandBuffer);</div>
<div class="line">    m_pTextureIDManager-&gt;SetTexturePool(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferSetScissor(pCommandBuffer, 0, 0, m_ScreenWidth, m_ScreenHeight);</div>
<div class="line">    nvnCommandBufferSetViewport(pCommandBuffer, 0, 0, m_ScreenWidth, m_ScreenHeight);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (m_pShaderScratchMemoryPool)</div>
<div class="line">    {</div>
<div class="line">        nvnCommandBufferSetShaderScratchMemory(pCommandBuffer, m_pShaderScratchMemoryPool-&gt;GetMemoryPool(), 0, m_ShaderScratchSize);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferBarrier(pCommandBuffer, NVNbarrierBits::NVN_BARRIER_ORDER_FRAGMENTS_BIT |</div>
<div class="line">                                            NVNbarrierBits::NVN_BARRIER_INVALIDATE_TEXTURE_BIT |</div>
<div class="line">                                            NVNbarrierBits::NVN_BARRIER_INVALIDATE_SHADER_BIT);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Draw the directional light pass. Draws a screen space quad and</span></div>
<div class="line"><span class="comment">         * calculates the lighting contribution per fragment.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">    <span class="keywordflow">if</span> (m_pDirectionalLightPass)</div>
<div class="line">    {</div>
<div class="line">        m_pDirectionalLightPass-&gt;BindState(pCommandBuffer);</div>
<div class="line">        m_pDirectionalLightPass-&gt;Draw(pCommandBuffer);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferSetRenderTargets(pCommandBuffer, 1, targets, NULL, &amp;m_DepthBuffer.m_Texture, NULL);</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferBarrier(pCommandBuffer, NVNbarrierBits::NVN_BARRIER_ORDER_FRAGMENTS_BIT |</div>
<div class="line">                                            NVNbarrierBits::NVN_BARRIER_INVALIDATE_TEXTURE_BIT |</div>
<div class="line">                                            NVNbarrierBits::NVN_BARRIER_INVALIDATE_SHADER_BIT);</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferSetStencilRef(pCommandBuffer, NVNface::NVN_FACE_FRONT_AND_BACK, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; m_DeferredPointLightObjects.size(); ++i)</div>
<div class="line">    {</div>
<div class="line">        m_DeferredPointLightObjects[i]-&gt;SetStencilBufferState();</div>
<div class="line">        m_DeferredPointLightObjects[i]-&gt;BindState(pCommandBuffer);</div>
<div class="line">        m_DeferredPointLightObjects[i]-&gt;DrawStencil(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/*</span></div>
<div class="line"><span class="comment">             * Draw the point light. Draws a front face culled sphere and</span></div>
<div class="line"><span class="comment">             * calculates the lighting contribution for each fragment that</span></div>
<div class="line"><span class="comment">             * falls within that sphere.</span></div>
<div class="line"><span class="comment">             */</span></div>
<div class="line">        m_DeferredPointLightObjects[i]-&gt;SetPointLightState();</div>
<div class="line">        m_DeferredPointLightObjects[i]-&gt;BindState(pCommandBuffer);</div>
<div class="line">        m_DeferredPointLightObjects[i]-&gt;Draw(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Draw the light as a wire frame sphere if debug draw is enabled */</span></div>
<div class="line">        <span class="keywordflow">if</span> (m_PointLightDebugDraw)</div>
<div class="line">        {</div>
<div class="line">            m_DeferredPointLightObjects[i]-&gt;SetDebugDrawState();</div>
<div class="line">            m_DeferredPointLightObjects[i]-&gt;BindState(pCommandBuffer);</div>
<div class="line">            m_DeferredPointLightObjects[i]-&gt;DebugDraw(pCommandBuffer);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__nvn__c__handle.html#gab7f10945ffe1f6161c87238c75ae411d">NVNcommandHandle</a> lightingHandle = nvnCommandBufferEndRecording(pCommandBuffer);</div>
<div class="line">    nvnQueueSubmitCommands(&amp;m_Queue, 1, &amp;lightingHandle);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * DeferredRenderer::RenderSkyBox</span></div>
<div class="line"><span class="comment"> * ------------------------------</span></div>
<div class="line"><span class="comment"> * This pass draws the skybox after the rest of the scene has</span></div>
<div class="line"><span class="comment"> * been rendered. It is drawn as a large sphere with a radius</span></div>
<div class="line"><span class="comment"> * close to the value of the far plane distance and with the</span></div>
<div class="line"><span class="comment"> * depth test on. This is to avoid the overdraw that would</span></div>
<div class="line"><span class="comment"> * happen if it was drawn first.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> DeferredRenderer::RenderSkyBox()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (m_pSkyBox)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="struct_n_v_ncommand_buffer.html">NVNcommandBuffer</a>* pCommandBuffer = m_SkyBoxCommandBuffer-&gt;GetCommandBuffer();</div>
<div class="line"> </div>
<div class="line">        m_pSkyBox-&gt;UpdateUniforms();</div>
<div class="line"> </div>
<div class="line">        nvnCommandBufferBeginRecording(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="struct_n_v_ntexture.html">NVNtexture</a>* targets[] = { &amp;m_FinalTarget.m_Texture };</div>
<div class="line">        nvnCommandBufferSetRenderTargets(pCommandBuffer, 1, targets, NULL, &amp;m_DepthBuffer.m_Texture, NULL);</div>
<div class="line"> </div>
<div class="line">        m_pTextureIDManager-&gt;SetSamplerPool(pCommandBuffer);</div>
<div class="line">        m_pTextureIDManager-&gt;SetTexturePool(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">        nvnCommandBufferSetScissor(pCommandBuffer, 0, 0, m_ScreenWidth, m_ScreenHeight);</div>
<div class="line">        nvnCommandBufferSetViewport(pCommandBuffer, 0, 0, m_ScreenWidth, m_ScreenHeight);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (m_pShaderScratchMemoryPool)</div>
<div class="line">        {</div>
<div class="line">            nvnCommandBufferSetShaderScratchMemory(pCommandBuffer, m_pShaderScratchMemoryPool-&gt;GetMemoryPool(), 0, m_ShaderScratchSize);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        nvnCommandBufferBarrier(pCommandBuffer, NVNbarrierBits::NVN_BARRIER_INVALIDATE_SHADER_BIT);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Bind state and draw */</span></div>
<div class="line">        m_pSkyBox-&gt;BindState(pCommandBuffer);</div>
<div class="line">        m_pSkyBox-&gt;Draw(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="group__nvn__c__handle.html#gab7f10945ffe1f6161c87238c75ae411d">NVNcommandHandle</a> skyBoxHandle = nvnCommandBufferEndRecording(pCommandBuffer);</div>
<div class="line">        nvnQueueSubmitCommands(&amp;m_Queue, 1, &amp;skyBoxHandle);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * DeferredRenderer::PresentTexture</span></div>
<div class="line"><span class="comment"> * --------------------------------</span></div>
<div class="line"><span class="comment"> * Draws the given texture to a screen space quad and</span></div>
<div class="line"><span class="comment"> * presents it to the screen. Depth targets can choose</span></div>
<div class="line"><span class="comment"> * to use a special pass that will linearize the displayed</span></div>
<div class="line"><span class="comment"> * values.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> DeferredRenderer::PresentTexture(<a class="code" href="group__nvn__c__handle.html#gaa1a1fc7a9e690ce93870bcd71ea6b446">NVNtextureHandle</a> textureHandle, ScreenSpaceQuadPass* pPass)</div>
<div class="line">{</div>
<div class="line">        <span class="comment">/* Get next render target to be used */</span></div>
<div class="line">    <span class="keywordtype">int</span> bufferIndex;</div>
<div class="line">    <a class="code" href="group__nvn__c__enum.html#ga58e9b155d7f2272b95044eed1f40415e">NVNwindowAcquireTextureResult</a> result = nvnWindowAcquireTexture(&amp;m_Window, &amp;m_WindowSync, &amp;bufferIndex);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(result == NVN_WINDOW_ACQUIRE_TEXTURE_RESULT_SUCCESS);</div>
<div class="line">    <a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(result);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="struct_n_v_ncommand_buffer.html">NVNcommandBuffer</a>* pCommandBuffer = m_BackBufferCommandBuffer-&gt;GetCommandBuffer();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Update the uniforms */</span></div>
<div class="line">    pPass-&gt;SetTextureHandle(textureHandle);</div>
<div class="line">    pPass-&gt;SetInvScreenSize(1.0f / m_ScreenWidth, 1.0f / m_ScreenHeight);</div>
<div class="line">    pPass-&gt;UpdateUniforms();</div>
<div class="line"> </div>
<div class="line">    nvnCommandBufferBeginRecording(pCommandBuffer);</div>
<div class="line">    {</div>
<div class="line">        nvnCommandBufferSetRenderTargets(pCommandBuffer, 1, &amp;m_ScreenRenderTargets[bufferIndex], NULL, NULL, NULL);</div>
<div class="line"> </div>
<div class="line">        m_pTextureIDManager-&gt;SetSamplerPool(pCommandBuffer);</div>
<div class="line">        m_pTextureIDManager-&gt;SetTexturePool(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">        nvnCommandBufferSetScissor(pCommandBuffer, 0, 0, m_ScreenWidth, m_ScreenHeight);</div>
<div class="line">        nvnCommandBufferSetViewport(pCommandBuffer, 0, 0, m_ScreenWidth, m_ScreenHeight);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (m_pShaderScratchMemoryPool)</div>
<div class="line">        {</div>
<div class="line">            nvnCommandBufferSetShaderScratchMemory(pCommandBuffer, m_pShaderScratchMemoryPool-&gt;GetMemoryPool(), 0, m_ShaderScratchSize);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        nvnCommandBufferBarrier(pCommandBuffer, NVNbarrierBits::NVN_BARRIER_ORDER_FRAGMENTS_BIT | NVNbarrierBits::NVN_BARRIER_INVALIDATE_TEXTURE_BIT | NVNbarrierBits::NVN_BARRIER_INVALIDATE_SHADER_BIT);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">/* Bind state and draw the screen space quad */</span></div>
<div class="line">        pPass-&gt;BindState(pCommandBuffer);</div>
<div class="line">        pPass-&gt;Draw(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">        nvnCommandBufferReportCounter( pCommandBuffer, NVN_COUNTER_TYPE_TIMESTAMP, nvnBufferGetAddress( &amp;m_TimeStampBuffer ) + 32 * (m_CurrentTimeStamp % g_NumBackBuffers) + 16 );</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__nvn__c__handle.html#gab7f10945ffe1f6161c87238c75ae411d">NVNcommandHandle</a> presentHandle = nvnCommandBufferEndRecording(pCommandBuffer);</div>
<div class="line"> </div>
<div class="line">    m_CPUTime = <a class="code" href="namespacenn_1_1os.html#a79e29821bfb2b0c3a5c222488e90cc89">nn::os::GetSystemTick</a>().<a class="code" href="classnn_1_1os_1_1_tick.html#aae2542ec136248db4dc662cbdf95f3ad">ToTimeSpan</a>().<a class="code" href="classnn_1_1_time_span.html#a03c119fa6c678e9b251f14f7ca8431c5">GetNanoSeconds</a>() - m_CurrentBeginFrameTime;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Wait for the window texture to be available */</span></div>
<div class="line">    nvnSyncWait(&amp;m_WindowSync, <a name="a26"></a><a class="code" href="group__nvn__c__defines.html#ga6c3444e501307a094f1d57abf1059aed">NVN_WAIT_TIMEOUT_MAXIMUM</a>);</div>
<div class="line"> </div>
<div class="line">    nvnQueueSubmitCommands(&amp;m_Queue, 1, &amp;presentHandle);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef DEBUGTEXT</span></div>
<div class="line">    m_pDebugTextRenderer-&gt;Printf(0, 0, m_PresentTargetName.c_str());</div>
<div class="line">    m_pDebugTextRenderer-&gt;Printf(1, 1, <span class="stringliteral">&quot;Frame Time: %f&quot;</span>, m_PrevFrameTime / 1000000.0f);</div>
<div class="line">    m_pDebugTextRenderer-&gt;Printf(1, 2, <span class="stringliteral">&quot;CPU Time: %f&quot;</span>, m_CPUTime / 1000000.0f);</div>
<div class="line">    m_pDebugTextRenderer-&gt;Printf(1, 3, <span class="stringliteral">&quot;GPU Time: %f&quot;</span>, m_PrevGPUTime / 1000000.0f);</div>
<div class="line">    m_pDebugTextRenderer-&gt;Draw(m_ScreenRenderTargets[bufferIndex], m_ScreenWidth, m_ScreenHeight);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    nvnQueuePresentTexture(&amp;m_Queue, &amp;m_Window, bufferIndex);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> NVNAPIENTRY DeferredRenderer::DebugLayerCallback(<a class="code" href="group__nvn__c__enum.html#ga70a49f98019e4832818240297bee7eb3">NVNdebugCallbackSource</a> source,</div>
<div class="line">                                                      <a class="code" href="group__nvn__c__enum.html#ga661d03f0e1c886c81d5ccc67935df182">NVNdebugCallbackType</a> type,</div>
<div class="line">                                                      <span class="keywordtype">int</span> <span class="keywordtype">id</span>,</div>
<div class="line">                                                      <a class="code" href="group__nvn__c__enum.html#ga6d72003c068d7795201e77d27bf8c7ac">NVNdebugCallbackSeverity</a> severity,</div>
<div class="line">                                                      <span class="keyword">const</span> <span class="keywordtype">char</span>* message,</div>
<div class="line">                                                      <span class="keywordtype">void</span>* pUser)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(pUser == NULL);</div>
<div class="line">    <a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(pUser);</div>
<div class="line"> </div>
<div class="line">    <a name="a27"></a><a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;NVN Debug Layer Callback:\n&quot;</span>);</div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;  source:       0x%08x\n&quot;</span>, source);</div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;  type:         0x%08x\n&quot;</span>, type);</div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;  id:           0x%08x\n&quot;</span>, <span class="keywordtype">id</span>);</div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;  severity:     0x%08x\n&quot;</span>, severity);</div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;  message:      %s\n&quot;</span>, message);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(<span class="keyword">false</span>, <span class="stringliteral">&quot;NVN debug layer hit\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">TutorialBaseClass* t()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> DeferredRenderer tut;</div>
<div class="line">    <span class="keywordflow">return</span> (&amp;tut);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> nnMain()</div>
<div class="line">{</div>
<div class="line">    TutorialRun();</div>
<div class="line">}</div>
<div class="ttc" id="a_aligned_allocator_8h_html"><div class="ttname"><a href="_aligned_allocator_8h.html">AlignedAllocator.h</a></div><div class="ttdoc">This file defines a simple aligned allocator that takes care of keeping track of the original allocat...</div></div>
<div class="ttc" id="a_load_scene_8h_html"><div class="ttname"><a href="_load_scene_8h.html">LoadScene.h</a></div><div class="ttdoc">This file defines some helper functions for loading the various objects, textures,...</div></div>
<div class="ttc" id="a_nvn_tutorial12_8h_html"><div class="ttname"><a href="_nvn_tutorial12_8h.html">NvnTutorial12.h</a></div><div class="ttdoc">This tutorial demonstrates how to setup a deferred renderer with NVN including scene loading,...</div></div>
<div class="ttc" id="aclassnn_1_1_result_html"><div class="ttname"><a href="classnn_1_1_result.html">nn::Result</a></div><div class="ttdoc">Represents the generic result of an operation.</div><div class="ttdef"><b>Definition:</b> nn_Result.h:32</div></div>
<div class="ttc" id="aclassnn_1_1_time_span_html_a03c119fa6c678e9b251f14f7ca8431c5"><div class="ttname"><a href="classnn_1_1_time_span.html#a03c119fa6c678e9b251f14f7ca8431c5">nn::TimeSpan::GetNanoSeconds</a></div><div class="ttdeci">constexpr int64_t GetNanoSeconds() const NN_NOEXCEPT</div><div class="ttdoc">Gets the time in nanoseconds.</div><div class="ttdef"><b>Definition:</b> nn_TimeSpan.h:691</div></div>
<div class="ttc" id="aclassnn_1_1os_1_1_tick_html_aae2542ec136248db4dc662cbdf95f3ad"><div class="ttname"><a href="classnn_1_1os_1_1_tick.html#aae2542ec136248db4dc662cbdf95f3ad">nn::os::Tick::ToTimeSpan</a></div><div class="ttdeci">nn::TimeSpan ToTimeSpan() const NN_NOEXCEPT</div><div class="ttdoc">Converts to a nn::TimeSpan value.</div><div class="ttdef"><b>Definition:</b> os_TickTypes.h:121</div></div>
<div class="ttc" id="aclassnn_1_1util_1_1_vector4f_html"><div class="ttname"><a href="classnn_1_1util_1_1_vector4f.html">nn::util::Vector4f</a></div><div class="ttdoc">Class that expresses four-dimensional vectors using a single precision floating number type.</div><div class="ttdef"><b>Definition:</b> util_Vector.h:573</div></div>
<div class="ttc" id="afs_8h_html"><div class="ttname"><a href="fs_8h.html">fs.h</a></div><div class="ttdoc">Declarations of API resources for the file system.</div></div>
<div class="ttc" id="agroup__nvn__c__api__typedefs_html_ga05b6b3dd5b965bd81efe2d03cee0bbbd"><div class="ttname"><a href="group__nvn__c__api__typedefs.html#ga05b6b3dd5b965bd81efe2d03cee0bbbd">NVNnativeWindow</a></div><div class="ttdeci">void * NVNnativeWindow</div><div class="ttdoc">Platform native window type.</div><div class="ttdef"><b>Definition:</b> nvn.h:159</div></div>
<div class="ttc" id="agroup__nvn__c__defines_html_ga48151b7e768a13685d77d1a4c464a33b"><div class="ttname"><a href="group__nvn__c__defines.html#ga48151b7e768a13685d77d1a4c464a33b">NVN_TRUE</a></div><div class="ttdeci">#define NVN_TRUE</div><div class="ttdoc">Boolean condition with a value of true.</div><div class="ttdef"><b>Definition:</b> nvn.h:4566</div></div>
<div class="ttc" id="agroup__nvn__c__defines_html_ga4eb83fe713146d844b1ac7f8e9c3dada"><div class="ttname"><a href="group__nvn__c__defines.html#ga4eb83fe713146d844b1ac7f8e9c3dada">NVN_API_MAJOR_VERSION</a></div><div class="ttdeci">#define NVN_API_MAJOR_VERSION</div><div class="ttdoc">Major version of the NVN API.</div><div class="ttdef"><b>Definition:</b> nvn.h:59</div></div>
<div class="ttc" id="agroup__nvn__c__defines_html_ga6c3444e501307a094f1d57abf1059aed"><div class="ttname"><a href="group__nvn__c__defines.html#ga6c3444e501307a094f1d57abf1059aed">NVN_WAIT_TIMEOUT_MAXIMUM</a></div><div class="ttdeci">#define NVN_WAIT_TIMEOUT_MAXIMUM</div><div class="ttdoc">When waiting on NVNsync objects, wait indefinitely until the sync object is signaled.</div><div class="ttdef"><b>Definition:</b> nvn.h:4574</div></div>
<div class="ttc" id="agroup__nvn__c__defines_html_gaa8b4a49a0c4f852b73be3b50bb3f270e"><div class="ttname"><a href="group__nvn__c__defines.html#gaa8b4a49a0c4f852b73be3b50bb3f270e">NVN_API_MINOR_VERSION</a></div><div class="ttdeci">#define NVN_API_MINOR_VERSION</div><div class="ttdoc">Minor version of the NVN API.</div><div class="ttdef"><b>Definition:</b> nvn.h:62</div></div>
<div class="ttc" id="agroup__nvn__c__defines_html_gace820e752b400cf7aa36e9684a7f45cb"><div class="ttname"><a href="group__nvn__c__defines.html#gace820e752b400cf7aa36e9684a7f45cb">NVN_MEMORY_POOL_STORAGE_ALIGNMENT</a></div><div class="ttdeci">#define NVN_MEMORY_POOL_STORAGE_ALIGNMENT</div><div class="ttdoc">Required base address alignment for app-specified memory used to back memory pools.</div><div class="ttdef"><b>Definition:</b> nvn.h:4578</div></div>
<div class="ttc" id="agroup__nvn__c__defines_html_gadfd69601d2d9f953c55808127ba60853"><div class="ttname"><a href="group__nvn__c__defines.html#gadfd69601d2d9f953c55808127ba60853">NVN_MEMORY_POOL_STORAGE_GRANULARITY</a></div><div class="ttdeci">#define NVN_MEMORY_POOL_STORAGE_GRANULARITY</div><div class="ttdoc">Required size alignment for app-specified memory used to back memory pools.</div><div class="ttdef"><b>Definition:</b> nvn.h:4582</div></div>
<div class="ttc" id="agroup__nvn__c__entryfuncptrs_html_ga9557d931192cd70c7d2810a6425326eb"><div class="ttname"><a href="group__nvn__c__entryfuncptrs.html#ga9557d931192cd70c7d2810a6425326eb">PFNNVNDEVICEGETPROCADDRESSPROC</a></div><div class="ttdeci">PFNNVNGENERICFUNCPTRPROC(* PFNNVNDEVICEGETPROCADDRESSPROC)(const NVNdevice *device, const char *name)</div><div class="ttdoc">Function pointer type to call nvnDeviceGetProcAddress().</div><div class="ttdef"><b>Definition:</b> nvn.h:15922</div></div>
<div class="ttc" id="agroup__nvn__c__enum_html_ga58e9b155d7f2272b95044eed1f40415e"><div class="ttname"><a href="group__nvn__c__enum.html#ga58e9b155d7f2272b95044eed1f40415e">NVNwindowAcquireTextureResult</a></div><div class="ttdeci">NVNwindowAcquireTextureResult</div><div class="ttdoc">Specifies the result of acquiring a texture from a window.</div><div class="ttdef"><b>Definition:</b> nvn.h:2673</div></div>
<div class="ttc" id="agroup__nvn__c__enum_html_ga661d03f0e1c886c81d5ccc67935df182"><div class="ttname"><a href="group__nvn__c__enum.html#ga661d03f0e1c886c81d5ccc67935df182">NVNdebugCallbackType</a></div><div class="ttdeci">NVNdebugCallbackType</div><div class="ttdoc">Specifies the type of event triggering a debug callback.</div><div class="ttdef"><b>Definition:</b> nvn.h:2924</div></div>
<div class="ttc" id="agroup__nvn__c__enum_html_ga6d72003c068d7795201e77d27bf8c7ac"><div class="ttname"><a href="group__nvn__c__enum.html#ga6d72003c068d7795201e77d27bf8c7ac">NVNdebugCallbackSeverity</a></div><div class="ttdeci">NVNdebugCallbackSeverity</div><div class="ttdoc">Specifies the severity of the event triggering a debug callback.</div><div class="ttdef"><b>Definition:</b> nvn.h:2954</div></div>
<div class="ttc" id="agroup__nvn__c__enum_html_ga70a49f98019e4832818240297bee7eb3"><div class="ttname"><a href="group__nvn__c__enum.html#ga70a49f98019e4832818240297bee7eb3">NVNdebugCallbackSource</a></div><div class="ttdeci">NVNdebugCallbackSource</div><div class="ttdoc">Specifies the type of operation being performed when a debug callback is made.</div><div class="ttdef"><b>Definition:</b> nvn.h:2902</div></div>
<div class="ttc" id="agroup__nvn__c__enum_html_gga9c68350bf64f2e7a90a23290c26872d3a12928b2591c67a2a61cf67c5b1d4c5e9"><div class="ttname"><a href="group__nvn__c__enum.html#gga9c68350bf64f2e7a90a23290c26872d3a12928b2591c67a2a61cf67c5b1d4c5e9">NVN_DEVICE_FLAG_DEBUG_ENABLE_LEVEL_4_BIT</a></div><div class="ttdeci">@ NVN_DEVICE_FLAG_DEBUG_ENABLE_LEVEL_4_BIT</div><div class="ttdoc">Enable (TRUE) or disable (FALSE) level 4 debug layer for the device.</div><div class="ttdef"><b>Definition:</b> nvn.h:2849</div></div>
<div class="ttc" id="agroup__nvn__c__funcptrs_html_gab106acc34961bf1c3a43514686dbfc4b"><div class="ttname"><a href="group__nvn__c__funcptrs.html#gab106acc34961bf1c3a43514686dbfc4b">PFNNVNDEBUGCALLBACKPROC</a></div><div class="ttdeci">void(* PFNNVNDEBUGCALLBACKPROC)(NVNdebugCallbackSource source, NVNdebugCallbackType type, int id, NVNdebugCallbackSeverity severity, const char *message, void *userParam)</div><div class="ttdoc">Function pointer type used to specify a function to call for debug callbacks.</div><div class="ttdef"><b>Definition:</b> nvn.h:4674</div></div>
<div class="ttc" id="agroup__nvn__c__handle_html_gaa1a1fc7a9e690ce93870bcd71ea6b446"><div class="ttname"><a href="group__nvn__c__handle.html#gaa1a1fc7a9e690ce93870bcd71ea6b446">NVNtextureHandle</a></div><div class="ttdeci">uint64_t NVNtextureHandle</div><div class="ttdoc">GPU handle used to refer to a texture object for texture mapping operations.</div><div class="ttdef"><b>Definition:</b> nvn.h:441</div></div>
<div class="ttc" id="agroup__nvn__c__handle_html_gab7f10945ffe1f6161c87238c75ae411d"><div class="ttname"><a href="group__nvn__c__handle.html#gab7f10945ffe1f6161c87238c75ae411d">NVNcommandHandle</a></div><div class="ttdeci">uint64_t NVNcommandHandle</div><div class="ttdoc">GPU handle used to refer to a command buffer object.</div><div class="ttdef"><b>Definition:</b> nvn.h:437</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a2e453fe1fbf8f818dc45bbd2897105cd"><div class="ttname"><a href="namespacenn_1_1fs.html#a2e453fe1fbf8f818dc45bbd2897105cd">nn::fs::MountRom</a></div><div class="ttdeci">Result MountRom(const char *name, void *pFileSystemCacheBuffer, size_t fileSystemCacheBufferSize) NN_NOEXCEPT</div><div class="ttdoc">Mounts ROM resource data.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a5df6e3385c795a5bd046790ef7f17f2d"><div class="ttname"><a href="namespacenn_1_1fs.html#a5df6e3385c795a5bd046790ef7f17f2d">nn::fs::QueryMountRomCacheSize</a></div><div class="ttdeci">Result QueryMountRomCacheSize(size_t *pOutValue) NN_NOEXCEPT</div><div class="ttdoc">Get the size needed for the nn::fs::MountRom file system cache.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_ac8a95249afd4a87a55d319dfecb0466c"><div class="ttname"><a href="namespacenn_1_1fs.html#ac8a95249afd4a87a55d319dfecb0466c">nn::fs::Unmount</a></div><div class="ttdeci">void Unmount(const char *name) NN_NOEXCEPT</div><div class="ttdoc">Unmounts a mounted file system and frees the resources.</div></div>
<div class="ttc" id="anamespacenn_1_1gfx_html_ad620d8208dd309eb7c4dd5973a6aeee5"><div class="ttname"><a href="namespacenn_1_1gfx.html#ad620d8208dd309eb7c4dd5973a6aeee5">nn::gfx::MemoryPool</a></div><div class="ttdeci">TMemoryPool&lt; TargetConfig::Variation &gt; MemoryPool</div><div class="ttdoc">The type definition representing a memory pool.</div><div class="ttdef"><b>Definition:</b> gfx_Types.h:116</div></div>
<div class="ttc" id="anamespacenn_1_1htc_html_a370e114a42a12b384ef2b2246618168e"><div class="ttname"><a href="namespacenn_1_1htc.html#a370e114a42a12b384ef2b2246618168e">nn::htc::GetEnvironmentVariable</a></div><div class="ttdeci">Result GetEnvironmentVariable(size_t *pOutSize, char *outBuffer, size_t bufferSize, const char *variableName) NN_NOEXCEPT</div><div class="ttdoc">Gets the value of the specified environment variable as a UTF-8 string from the host.</div></div>
<div class="ttc" id="anamespacenn_1_1os_html_a79e29821bfb2b0c3a5c222488e90cc89"><div class="ttname"><a href="namespacenn_1_1os.html#a79e29821bfb2b0c3a5c222488e90cc89">nn::os::GetSystemTick</a></div><div class="ttdeci">Tick GetSystemTick() NN_NOEXCEPT</div><div class="ttdoc">Gets the system tick value.</div></div>
<div class="ttc" id="ann___abort_8h_html_a1e657a678a588533a020c2e947df7772"><div class="ttname"><a href="nn___abort_8h.html#a1e657a678a588533a020c2e947df7772">NN_ABORT_UNLESS_RESULT_SUCCESS</a></div><div class="ttdeci">#define NN_ABORT_UNLESS_RESULT_SUCCESS(result)</div><div class="ttdoc">Tests whether the specified nn::Result is successful or not, and stops if it is not.</div><div class="ttdef"><b>Definition:</b> nn_Abort.h:188</div></div>
<div class="ttc" id="ann___assert_8h_html"><div class="ttname"><a href="nn___assert_8h.html">nn_Assert.h</a></div><div class="ttdoc">Declarations for API resources to test whether conditions are satisfied.</div></div>
<div class="ttc" id="ann___assert_8h_html_a0473ebccccc250efd6100a9bbfec406b"><div class="ttname"><a href="nn___assert_8h.html#a0473ebccccc250efd6100a9bbfec406b">NN_ASSERT_NOT_NULL</a></div><div class="ttdeci">#define NN_ASSERT_NOT_NULL(pointer)</div><div class="ttdoc">Tests whether the pointer is not a null pointer.</div><div class="ttdef"><b>Definition:</b> nn_Assert.h:140</div></div>
<div class="ttc" id="ann___assert_8h_html_ade59d1d911907a16c0241f8fe3b31542"><div class="ttname"><a href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a></div><div class="ttdeci">#define NN_ASSERT(condition,...)</div><div class="ttdoc">Tests whether a condition is satisfied.</div><div class="ttdef"><b>Definition:</b> nn_Assert.h:124</div></div>
<div class="ttc" id="ann___log_8h_html"><div class="ttname"><a href="nn___log_8h.html">nn_Log.h</a></div><div class="ttdoc">Declarations for the logging API.</div></div>
<div class="ttc" id="ann___log_8h_html_a2d720c8bc6b733bce63879350d134a84"><div class="ttname"><a href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a></div><div class="ttdeci">#define NN_LOG(...)</div><div class="ttdoc">Adds the string specified in the parameter as a log entry.</div><div class="ttdef"><b>Definition:</b> nn_Log.h:33</div></div>
<div class="ttc" id="ann___macro_8h_html_ac6f80ca2ebf15f619391e35806e9635f"><div class="ttname"><a href="nn___macro_8h.html#ac6f80ca2ebf15f619391e35806e9635f">NN_ALIGNOF</a></div><div class="ttdeci">#define NN_ALIGNOF(type)</div><div class="ttdoc">Gets the byte alignment.</div><div class="ttdef"><b>Definition:</b> nn_Macro.h:170</div></div>
<div class="ttc" id="ann___macro_8h_html_af2d1673769927c5eae977d8dde3ce106"><div class="ttname"><a href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a></div><div class="ttdeci">#define NN_UNUSED(variable)</div><div class="ttdoc">Suppresses compiler warnings on intentionally unused variables.</div><div class="ttdef"><b>Definition:</b> nn_Macro.h:610</div></div>
<div class="ttc" id="astruct_n_v_nbuffer_builder_html"><div class="ttname"><a href="struct_n_v_nbuffer_builder.html">NVNbufferBuilder</a></div><div class="ttdoc">Object specifying state used to construct new buffer objects.</div><div class="ttdef"><b>Definition:</b> nvn.h:313</div></div>
<div class="ttc" id="astruct_n_v_ncommand_buffer_html"><div class="ttname"><a href="struct_n_v_ncommand_buffer.html">NVNcommandBuffer</a></div><div class="ttdoc">Collection of commands to send to the GPU via queues.</div><div class="ttdef"><b>Definition:</b> nvn.h:236</div></div>
<div class="ttc" id="astruct_n_v_ncounter_data_html"><div class="ttname"><a href="struct_n_v_ncounter_data.html">NVNcounterData</a></div><div class="ttdoc">Data structure describing how counter values are written to buffer memory.</div><div class="ttdef"><b>Definition:</b> nvn.h:4331</div></div>
<div class="ttc" id="astruct_n_v_ndevice_builder_html"><div class="ttname"><a href="struct_n_v_ndevice_builder.html">NVNdeviceBuilder</a></div><div class="ttdoc">Object specifying state used to construct new device objects.</div><div class="ttdef"><b>Definition:</b> nvn.h:216</div></div>
<div class="ttc" id="astruct_n_v_nqueue_builder_html"><div class="ttname"><a href="struct_n_v_nqueue_builder.html">NVNqueueBuilder</a></div><div class="ttdoc">Object specifying state used to construct new queue objects.</div><div class="ttdef"><b>Definition:</b> nvn.h:226</div></div>
<div class="ttc" id="astruct_n_v_nsampler_html"><div class="ttname"><a href="struct_n_v_nsampler.html">NVNsampler</a></div><div class="ttdoc">GPU-accessible object controlling how texture data are fetched and filtered.</div><div class="ttdef"><b>Definition:</b> nvn.h:358</div></div>
<div class="ttc" id="astruct_n_v_ntexture_html"><div class="ttname"><a href="struct_n_v_ntexture.html">NVNtexture</a></div><div class="ttdoc">Block of GPU-accessible memory and related state used to hold image data.</div><div class="ttdef"><b>Definition:</b> nvn.h:325</div></div>
<div class="ttc" id="astructnn_1_1util_1_1_matrix_row_major4x4f_type_html"><div class="ttname"><a href="structnn_1_1util_1_1_matrix_row_major4x4f_type.html">nn::util::MatrixRowMajor4x4fType</a></div><div class="ttdoc">Represents a four-row, four-column, row-major matrix using a single precision floating point data typ...</div><div class="ttdef"><b>Definition:</b> util_MathTypes.h:422</div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
</body>
</html>

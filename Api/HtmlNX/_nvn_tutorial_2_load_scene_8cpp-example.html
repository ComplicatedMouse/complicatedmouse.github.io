<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NvnTutorial/LoadScene.cpp | NintendoSDK API Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="openclose.js"></script>
<script type="text/javascript" src="searchapi.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NintendoSDK API Reference
   &#160;<span id="projectnumber">14.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">NvnTutorial/LoadScene.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>For an explanation of the source code, see <a class="el" href="_page_sample_nvn_tutorial_library.html">NVN Tutorial Library</a> and <tt>NvnTutorial/LoadScene.cpp</tt>.</p>
<div class="fragment"><div class="line"><span class="comment">/*--------------------------------------------------------------------------------*</span></div>
<div class="line"><span class="comment">  Copyright (C)Nintendo All rights reserved.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  These coded instructions, statements, and computer programs contain proprietary</span></div>
<div class="line"><span class="comment">  information of Nintendo and/or its licensed developers and are protected by</span></div>
<div class="line"><span class="comment">  national and international copyright laws. They may not be disclosed to third</span></div>
<div class="line"><span class="comment">  parties or copied or duplicated in any form, in whole or in part, without the</span></div>
<div class="line"><span class="comment">  prior written consent of Nintendo.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  The content herein is highly confidential and should be handled accordingly.</span></div>
<div class="line"><span class="comment"> *--------------------------------------------------------------------------------*/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_load_scene_8h.html">nvntutorial/LoadScene.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nn___assert_8h.html">nn/nn_Assert.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fs_8h.html">nn/fs.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_tutorial_util_8h.html">nvntutorial/TutorialUtil.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_asset_file_data_holder_8h.html">nvntutorial/AssetFileDataHolder.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_asset_file_loading_helper_8h.html">nvntutorial/AssetFileLoadingHelper.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_camera_8h.html">nvntutorial/Camera.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_shader_helper_8h.html">nvntutorial/ShaderHelper.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_uniform_buffer_manager_8h.html">nvntutorial/UniformBufferManager.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_p_b_r_object_8h.html">nvntutorial/PBRObject.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_p_b_r_object_culled_8h.html">nvntutorial/PBRObjectCulled.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_deferred_directional_light_pass_8h.html">nvntutorial/DeferredDirectionalLightPass.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_deferred_directional_light_pass_a_o_8h.html">nvntutorial/DeferredDirectionalLightPassAO.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_deferred_point_light_object_8h.html">nvntutorial/DeferredPointLightObject.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_sky_box_8h.html">nvntutorial/SkyBox.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_frustum_culling_pass_8h.html">nvntutorial/FrustumCullingPass.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_scalable_a_o_pass_8h.html">nvntutorial/ScalableAOPass.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_scalable_a_o_blur_pass_8h.html">nvntutorial/ScalableAOBlurPass.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nn___log_8h.html">nn/nn_Log.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* @cond</span></div>
<div class="line"><span class="comment"> * rapidxml::parse_error_handler</span></div>
<div class="line"><span class="comment"> * -----------------------------</span></div>
<div class="line"><span class="comment"> * Empty rapidxml error handler. This function must be</span></div>
<div class="line"><span class="comment"> * defined if RAPIDXML_NO_EXCEPTIONS is defined before</span></div>
<div class="line"><span class="comment"> * including rapidxml.hpp.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> rapidxml::parse_error_handler(<span class="keyword">const</span> <span class="keywordtype">char</span> *what, <span class="keywordtype">void</span> *where) { <a name="a0"></a><a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(what); <a class="code" href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a>(where); }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>SceneFileLoad</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadXMLVec3</span></div>
<div class="line"><span class="comment"> * --------------------------</span></div>
<div class="line"><span class="comment"> * Helper function to load a vec3 from the scene file.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadXMLVec3(rapidxml::xml_node&lt;&gt;* node, <a name="_a1"></a><a class="code" href="classnn_1_1util_1_1_vector3f.html">nn::util::Vector3f</a>&amp; vec3)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_attribute&lt;&gt;* attr = node-&gt;first_attribute();</div>
<div class="line">    <a name="a2"></a><a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(attr);</div>
<div class="line">    vec3.SetX(strtof(attr-&gt;value(), <span class="keyword">nullptr</span>));</div>
<div class="line"> </div>
<div class="line">    attr = attr-&gt;next_attribute();</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(attr);</div>
<div class="line">    vec3.SetY(strtof(attr-&gt;value(), <span class="keyword">nullptr</span>));</div>
<div class="line"> </div>
<div class="line">    attr = attr = attr-&gt;next_attribute();</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(attr);</div>
<div class="line">    vec3.SetZ(strtof(attr-&gt;value(), <span class="keyword">nullptr</span>));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadAndParseXMLFile</span></div>
<div class="line"><span class="comment"> * ----------------------------------</span></div>
<div class="line"><span class="comment"> * Loads the scene file and creates the XML</span></div>
<div class="line"><span class="comment"> * document and root node.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">std::pair&lt;rapidxml::xml_node&lt;&gt;*, <span class="keywordtype">char</span>*&gt; LoadAndParseXMLFile(<span class="keyword">const</span> std::string&amp; fileName, rapidxml::xml_document&lt;&gt;&amp; xmlDoc)</div>
<div class="line">{</div>
<div class="line">    <a name="_a3"></a><a class="code" href="structnn_1_1fs_1_1_file_handle.html">nn::fs::FileHandle</a> fileHandle;</div>
<div class="line">    std::string rom(<span class="stringliteral">&quot;rom:/&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    int64_t fileSize;</div>
<div class="line"> </div>
<div class="line">    <a name="a4"></a><a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Loading Scene File: %s\n&quot;</span>, fileName.c_str());</div>
<div class="line"> </div>
<div class="line">    <a name="_a5"></a><a class="code" href="classnn_1_1_result.html">nn::Result</a> res = <a name="a6"></a><a class="code" href="namespacenn_1_1fs.html#a0f2b5b30657b1ffaf1dec49bfb36462b">nn::fs::OpenFile</a>(&amp;fileHandle, (rom + fileName).c_str(), <a name="a7"></a><a class="code" href="namespacenn_1_1fs.html#a4c97b79cce78a95c2333dbc9053b9393afde4472d2b455879cad02aade386ac0d">nn::fs::OpenMode_Read</a>);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(res.IsSuccess());</div>
<div class="line"> </div>
<div class="line">    res = <a name="a8"></a><a class="code" href="namespacenn_1_1fs.html#aba29e01d386e809349d60eccdb15ff21">nn::fs::GetFileSize</a>(&amp;fileSize, fileHandle);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(res.IsSuccess());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">char</span>* pFileHead = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(AlignedAllocate(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(fileSize + 1), 8));</div>
<div class="line">    memset(pFileHead, 0, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(fileSize + 1));</div>
<div class="line">    <span class="keywordtype">size_t</span> out;</div>
<div class="line">    res = <a name="a9"></a><a class="code" href="namespacenn_1_1fs.html#a81801a404563984f8c6cc1483cc6d730">nn::fs::ReadFile</a>(&amp;out, fileHandle, 0, pFileHead, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(fileSize));</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(res.IsSuccess());</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    xmlDoc.parse&lt;0&gt;(pFileHead);</div>
<div class="line"> </div>
<div class="line">    rapidxml::xml_node&lt;&gt;* rootNode = xmlDoc.first_node();</div>
<div class="line"> </div>
<div class="line">    <a name="a10"></a><a class="code" href="namespacenn_1_1fs.html#ac8bd9e828751bd4f953acfa765278f84">nn::fs::CloseFile</a>(fileHandle);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> std::pair&lt;rapidxml::xml_node&lt;&gt;*, <span class="keywordtype">char</span>*&gt;(rootNode, pFileHead);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadGlobalData</span></div>
<div class="line"><span class="comment"> * -----------------------------</span></div>
<div class="line"><span class="comment"> * Loads the near plane, far plane, and global ambient</span></div>
<div class="line"><span class="comment"> * coefficient values.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadGlobalData(rapidxml::xml_node&lt;&gt;* rootNode, <span class="keywordtype">float</span>&amp; near, <span class="keywordtype">float</span> &amp;far, <span class="keywordtype">float</span> &amp;globalAmbient)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* globalDataNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;GlobalData&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (globalDataNode)</div>
<div class="line">    {</div>
<div class="line">        rapidxml::xml_node&lt;&gt;* nearNode = globalDataNode-&gt;first_node(<span class="stringliteral">&quot;Near&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (nearNode)</div>
<div class="line">        {</div>
<div class="line">            rapidxml::xml_attribute&lt;&gt;* attr = nearNode-&gt;first_attribute();</div>
<div class="line">            <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(attr);</div>
<div class="line">            near = strtof(attr-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* farNode = globalDataNode-&gt;first_node(<span class="stringliteral">&quot;Far&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (farNode)</div>
<div class="line">        {</div>
<div class="line">            rapidxml::xml_attribute&lt;&gt;* attr = farNode-&gt;first_attribute();</div>
<div class="line">            <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(attr);</div>
<div class="line">            far = strtof(attr-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* globalAmbientNode = globalDataNode-&gt;first_node(<span class="stringliteral">&quot;GlobalAmbient&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (globalAmbientNode)</div>
<div class="line">        {</div>
<div class="line">            rapidxml::xml_attribute&lt;&gt;* attr = globalAmbientNode-&gt;first_attribute();</div>
<div class="line">            <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(attr);</div>
<div class="line">            globalAmbient = strtof(attr-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadCameraInfo</span></div>
<div class="line"><span class="comment"> * -----------------------------</span></div>
<div class="line"><span class="comment"> * Loads the initial camera position and orientation.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadCameraInfo(rapidxml::xml_node&lt;&gt;* rootNode, Camera* camera)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* cameraNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;Camera&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cameraNode)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="classnn_1_1util_1_1_vector3f.html">nn::util::Vector3f</a> camPos = camera-&gt;GetPosition();</div>
<div class="line">        <span class="keywordtype">float</span> xRot = camera-&gt;GetXRotationAsDegree();</div>
<div class="line">        <span class="keywordtype">float</span> yRot = camera-&gt;GetYRotationAsDegree();</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* positionNode = cameraNode-&gt;first_node(<span class="stringliteral">&quot;Position&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (positionNode)</div>
<div class="line">        {</div>
<div class="line">            SceneFileLoad::LoadXMLVec3(positionNode, camPos);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* rotationNode = cameraNode-&gt;first_node(<span class="stringliteral">&quot;Rotation&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (rotationNode)</div>
<div class="line">        {</div>
<div class="line">            rapidxml::xml_attribute&lt;&gt;* attr = rotationNode-&gt;first_attribute(<span class="stringliteral">&quot;x&quot;</span>);</div>
<div class="line">            <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(attr);</div>
<div class="line">            xRot = strtof(attr-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">            attr = rotationNode-&gt;first_attribute(<span class="stringliteral">&quot;y&quot;</span>);</div>
<div class="line">            <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(attr);</div>
<div class="line">            yRot = strtof(attr-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        camera-&gt;SetCameraState(xRot, yRot, camPos);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadShaders</span></div>
<div class="line"><span class="comment"> * --------------------------</span></div>
<div class="line"><span class="comment"> * Loads the shader files needed to draw the scene.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadShaders(rapidxml::xml_node&lt;&gt;* rootNode, std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; shaders, AssetFileLoadingHelper* assetLoader)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* shaderBlockNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;Shaders&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (shaderBlockNode)</div>
<div class="line">    {</div>
<div class="line">        rapidxml::xml_node&lt;&gt;* shaderNode = shaderBlockNode-&gt;first_node();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">while</span> (shaderNode)</div>
<div class="line">        {</div>
<div class="line">            rapidxml::xml_node&lt;&gt;* fileNode = shaderNode-&gt;first_node(<span class="stringliteral">&quot;FileName&quot;</span>);</div>
<div class="line">            <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(fileNode);</div>
<div class="line"> </div>
<div class="line">            rapidxml::xml_attribute&lt;&gt;* attr = fileNode-&gt;first_attribute();</div>
<div class="line">            <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(attr);</div>
<div class="line"> </div>
<div class="line">            std::string shaderFileName = attr-&gt;value();</div>
<div class="line"> </div>
<div class="line">            shaders[shaderFileName] = assetLoader-&gt;LoadAssetFile(shaderFileName.c_str());</div>
<div class="line"> </div>
<div class="line">            rapidxml::xml_node&lt;&gt;* modelNode = shaderNode-&gt;first_node(<span class="stringliteral">&quot;ModelSetup&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (modelNode)</div>
<div class="line">            {</div>
<div class="line">                rapidxml::xml_attribute&lt;&gt;* modelAttr = modelNode-&gt;first_attribute();</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (atoi(modelAttr-&gt;value()))</div>
<div class="line">                {</div>
<div class="line">                    shaders[shaderFileName]-&gt;SetupAttributeStatesNVN(ShaderHelper::GetAttributeLocationFunction(shaders[shaderFileName]-&gt;GetProgramData()[0]-&gt;m_pProgramName));</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            shaderNode = shaderNode-&gt;next_sibling();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadTextures</span></div>
<div class="line"><span class="comment"> * ---------------------------</span></div>
<div class="line"><span class="comment"> * Loads the texture files needed for the scene.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadTextures(rapidxml::xml_node&lt;&gt;* rootNode,</div>
<div class="line">                  AssetFileLoadingHelper* pAssetLoader,</div>
<div class="line">                  <a name="_a11"></a><a class="code" href="struct_n_v_ndevice.html">NVNdevice</a>* pDevice,</div>
<div class="line">                  <a name="_a12"></a><a class="code" href="struct_n_v_nsampler_builder.html">NVNsamplerBuilder</a>* pSamplerBuilder,</div>
<div class="line">                  TextureIDManager* pTextureIDManager,</div>
<div class="line">                  std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; outTextures)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* texturesNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;Textures&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (texturesNode)</div>
<div class="line">    {</div>
<div class="line">        std::string fileName = texturesNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="structnn_1_1fs_1_1_file_handle.html">nn::fs::FileHandle</a> fileHandle;</div>
<div class="line">        std::string rom(<span class="stringliteral">&quot;rom:/&quot;</span>);</div>
<div class="line">        int64_t fileSize;</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Loading Texture Config\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classnn_1_1_result.html">nn::Result</a> res = <a class="code" href="namespacenn_1_1fs.html#a0f2b5b30657b1ffaf1dec49bfb36462b">nn::fs::OpenFile</a>(&amp;fileHandle, (rom + fileName).c_str(), <a class="code" href="namespacenn_1_1fs.html#a4c97b79cce78a95c2333dbc9053b9393afde4472d2b455879cad02aade386ac0d">nn::fs::OpenMode_Read</a>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(res.IsSuccess());</div>
<div class="line"> </div>
<div class="line">        res = <a class="code" href="namespacenn_1_1fs.html#aba29e01d386e809349d60eccdb15ff21">nn::fs::GetFileSize</a>(&amp;fileSize, fileHandle);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(res.IsSuccess());</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">char</span>* pFileHead = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(AlignedAllocate(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(fileSize + 1), 8));</div>
<div class="line">        memset(pFileHead, 0, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(fileSize + 1));</div>
<div class="line">        <span class="keywordtype">size_t</span> out;</div>
<div class="line">        res = <a class="code" href="namespacenn_1_1fs.html#a81801a404563984f8c6cc1483cc6d730">nn::fs::ReadFile</a>(&amp;out, fileHandle, 0, pFileHead, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(fileSize));</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(res.IsSuccess());</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">char</span>* pTempFileName = pFileHead;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">while</span> ((*pTempFileName) != 0)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">char</span>* pTemp = pTempFileName;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">while</span> ((*pTemp) != <span class="charliteral">&#39;\r&#39;</span> &amp;&amp; (*pTemp) != <span class="charliteral">&#39;\n&#39;</span>)</div>
<div class="line">            {</div>
<div class="line">                pTemp += 1;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            std::string outFileName(pTempFileName, pTemp - pTempFileName);</div>
<div class="line"> </div>
<div class="line">            std::string name = outFileName;</div>
<div class="line"> </div>
<div class="line">            ExtractFileName(name);</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Loading Texture: %s\n&quot;</span>, name.c_str());</div>
<div class="line"> </div>
<div class="line">            outTextures[name] = pAssetLoader-&gt;LoadAssetFile(outFileName.c_str());</div>
<div class="line">            outTextures[name]-&gt;SetupTextureSamplerHandle(pDevice, pTextureIDManager, pSamplerBuilder);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">while</span> ((*pTemp) == <span class="charliteral">&#39;\r&#39;</span> || (*pTemp) == <span class="charliteral">&#39;\n&#39;</span>)</div>
<div class="line">            {</div>
<div class="line">                pTemp += 1;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            pTempFileName = pTemp;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <a class="code" href="namespacenn_1_1fs.html#ac8bd9e828751bd4f953acfa765278f84">nn::fs::CloseFile</a>(fileHandle);</div>
<div class="line">        AlignedDeallocate(pFileHead);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadModel</span></div>
<div class="line"><span class="comment"> * ------------------------</span></div>
<div class="line"><span class="comment"> * Helper function for loading a model file</span></div>
<div class="line"><span class="comment"> * with the given file name.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadModel(<a class="code" href="struct_n_v_ndevice.html">NVNdevice</a>* pDevice, PBRObject::Model* model, <span class="keyword">const</span> std::string&amp; fileName)</div>
<div class="line">{</div>
<div class="line">    model-&gt;SetModelFileName(fileName);</div>
<div class="line"> </div>
<div class="line">    int64_t fileSize = 0;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structnn_1_1fs_1_1_file_handle.html">nn::fs::FileHandle</a> modelFileHandle;</div>
<div class="line">    std::string rom(<span class="stringliteral">&quot;rom:/&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a>(<span class="stringliteral">&quot;Loading Model: %s\n&quot;</span>, model-&gt;GetName().c_str());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classnn_1_1_result.html">nn::Result</a> res = <a class="code" href="namespacenn_1_1fs.html#a0f2b5b30657b1ffaf1dec49bfb36462b">nn::fs::OpenFile</a>(&amp;modelFileHandle, (rom + model-&gt;GetName()).c_str(), <a class="code" href="namespacenn_1_1fs.html#a4c97b79cce78a95c2333dbc9053b9393afde4472d2b455879cad02aade386ac0d">nn::fs::OpenMode_Read</a>);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(res.IsSuccess());</div>
<div class="line"> </div>
<div class="line">    res = <a class="code" href="namespacenn_1_1fs.html#aba29e01d386e809349d60eccdb15ff21">nn::fs::GetFileSize</a>(&amp;fileSize, modelFileHandle);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(res.IsSuccess());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">char</span>* modelFile = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(AlignedAllocate(<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(fileSize + 1), 8));</div>
<div class="line">    memset(modelFile, 0, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(fileSize + 1));</div>
<div class="line">    <span class="keywordtype">size_t</span> out;</div>
<div class="line">    res = <a class="code" href="namespacenn_1_1fs.html#a81801a404563984f8c6cc1483cc6d730">nn::fs::ReadFile</a>(&amp;out, modelFileHandle, 0, modelFile, <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(fileSize));</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(res.IsSuccess());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespacenn_1_1fs.html#ac8bd9e828751bd4f953acfa765278f84">nn::fs::CloseFile</a>(modelFileHandle);</div>
<div class="line"> </div>
<div class="line">    model-&gt;SetupFromBinaryFile(modelFile, pDevice);</div>
<div class="line"> </div>
<div class="line">    AlignedDeallocate(modelFile);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadPBRObjects</span></div>
<div class="line"><span class="comment"> * -----------------------------</span></div>
<div class="line"><span class="comment"> * Loads the object data to draw the scene. Model files</span></div>
<div class="line"><span class="comment"> * will be loaded as they are reference by the models.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadPBRObjects(rapidxml::xml_node&lt;&gt;* rootNode,</div>
<div class="line">                    <a class="code" href="struct_n_v_ndevice.html">NVNdevice</a>* pDevice,</div>
<div class="line">                    UniformBufferManager* pUniformManager,</div>
<div class="line">                    UniformBufferManager* pStaticUniformManager,</div>
<div class="line">                    std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; shaders,</div>
<div class="line">                    std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; textures,</div>
<div class="line">                    std::map&lt;std::string, PBRObject::Model&gt;&amp; models,</div>
<div class="line">                    std::vector&lt;PBRObject::Object&gt;&amp; objects)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* pbrObjectBlockNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;PBRObjects&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pbrObjectBlockNode)</div>
<div class="line">    {</div>
<div class="line">        rapidxml::xml_node&lt;&gt;* objectNode = pbrObjectBlockNode-&gt;first_node();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">while</span> (objectNode)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (objectNode-&gt;name() == std::string(<span class="stringliteral">&quot;ObjectFile&quot;</span>))</div>
<div class="line">            {</div>
<div class="line">                std::string childFileName = objectNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_document&lt;&gt; xmlDoc;</div>
<div class="line"> </div>
<div class="line">                std::pair&lt;rapidxml::xml_node&lt;&gt;*, <span class="keywordtype">char</span>*&gt; xmlLoad = SceneFileLoad::LoadAndParseXMLFile(childFileName, xmlDoc);</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* childRootNode = xmlLoad.first;</div>
<div class="line">                <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(childRootNode);</div>
<div class="line"> </div>
<div class="line">                LoadPBRObjects(childRootNode, pDevice, pUniformManager, pStaticUniformManager, shaders, textures, models, objects);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                objects.push_back(PBRObject::Object());</div>
<div class="line">                PBRObject::Object&amp; <span class="keywordtype">object</span> = objects.back();</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* nameNode = objectNode-&gt;first_node(<span class="stringliteral">&quot;Name&quot;</span>);</div>
<div class="line">                <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(nameNode);</div>
<div class="line">                std::string objectName = nameNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                <span class="keywordtype">object</span>.SetName(objectName);</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* cullNode = objectNode-&gt;first_node(<span class="stringliteral">&quot;BackFaceCull&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (cullNode)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordtype">int</span> backFaceCull = atoi(cullNode-&gt;first_attribute()-&gt;value());</div>
<div class="line">                    <span class="keywordtype">object</span>.SetBackFaceCull(backFaceCull);</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* fileNameNode = objectNode-&gt;first_node(<span class="stringliteral">&quot;FileName&quot;</span>);</div>
<div class="line">                <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(fileNameNode);</div>
<div class="line"> </div>
<div class="line">                std::string modelFileName = fileNameNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (models.find(modelFileName) == models.end())</div>
<div class="line">                {</div>
<div class="line">                    PBRObject::Model* pModel = &amp;models[modelFileName];</div>
<div class="line">                    LoadModel(pDevice, pModel, modelFileName);</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                PBRObject::Model* pModel = &amp;models[modelFileName];</div>
<div class="line"> </div>
<div class="line">                <span class="keywordtype">object</span>.SetModel(modelFileName);</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* lodBlockNode = objectNode-&gt;first_node(<span class="stringliteral">&quot;LODInfo&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordtype">int</span> useLods = 0;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (lodBlockNode)</div>
<div class="line">                {</div>
<div class="line">                    rapidxml::xml_node&lt;&gt;* lodTotalLevelsNode = lodBlockNode-&gt;first_node(<span class="stringliteral">&quot;Levels&quot;</span>);</div>
<div class="line">                    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(lodTotalLevelsNode);</div>
<div class="line">                    <span class="keywordtype">object</span>.SetNumLodLevels(atoi(lodTotalLevelsNode-&gt;first_attribute()-&gt;value()) + 1);</div>
<div class="line"> </div>
<div class="line">                    PBRModelData::LodInfo baseInfo;</div>
<div class="line">                    baseInfo.m_Name = modelFileName;</div>
<div class="line">                    baseInfo.m_StartDistance = 0.0f;</div>
<div class="line">                    baseInfo.m_TransitionArea = 0.0f;</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordtype">object</span>.AddLod(baseInfo, 0);</div>
<div class="line"> </div>
<div class="line">                    rapidxml::xml_node&lt;&gt;* lodNode = lodBlockNode-&gt;first_node(<span class="stringliteral">&quot;LOD&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                    useLods = 1;</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">while</span> (lodNode)</div>
<div class="line">                    {</div>
<div class="line">                        PBRModelData::LodInfo info;</div>
<div class="line"> </div>
<div class="line">                        rapidxml::xml_node&lt;&gt;* lodNameNode = lodNode-&gt;first_node(<span class="stringliteral">&quot;Name&quot;</span>);</div>
<div class="line">                        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(lodNameNode);</div>
<div class="line">                        info.m_Name = lodNameNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (info.m_Name != <span class="stringliteral">&quot;&quot;</span> &amp;&amp; models.find(info.m_Name) == models.end())</div>
<div class="line">                        {</div>
<div class="line">                            PBRObject::Model* pLodModel = &amp;models[info.m_Name];</div>
<div class="line">                            LoadModel(pDevice, pLodModel, info.m_Name);</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        rapidxml::xml_node&lt;&gt;* lodDistNode = lodNode-&gt;first_node(<span class="stringliteral">&quot;Distance&quot;</span>);</div>
<div class="line">                        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(lodDistNode);</div>
<div class="line">                        info.m_StartDistance = strtof(lodDistNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">                        rapidxml::xml_node&lt;&gt;* lodTransNode = lodNode-&gt;first_node(<span class="stringliteral">&quot;Transition&quot;</span>);</div>
<div class="line">                        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(lodTransNode);</div>
<div class="line">                        info.m_TransitionArea = strtof(lodTransNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">                        rapidxml::xml_node&lt;&gt;* lodLevelNode = lodNode-&gt;first_node(<span class="stringliteral">&quot;Level&quot;</span>);</div>
<div class="line">                        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(lodLevelNode);</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordtype">object</span>.AddLod(info, atoi(lodLevelNode-&gt;first_attribute()-&gt;value()));</div>
<div class="line"> </div>
<div class="line">                        lodNode = lodNode-&gt;next_sibling();</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* commandBufferMemoryNode = objectNode-&gt;first_node(<span class="stringliteral">&quot;CommandBufferMemory&quot;</span>);</div>
<div class="line">                <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(commandBufferMemoryNode);</div>
<div class="line"> </div>
<div class="line">                uint32_t commandMemorySize = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(atoi(commandBufferMemoryNode-&gt;first_attribute(<span class="stringliteral">&quot;command&quot;</span>)-&gt;value()));</div>
<div class="line">                uint32_t controlMemorySize = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(atoi(commandBufferMemoryNode-&gt;first_attribute(<span class="stringliteral">&quot;control&quot;</span>)-&gt;value()));</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* objShaderNode = objectNode-&gt;first_node(<span class="stringliteral">&quot;Shaders&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (objShaderNode)</div>
<div class="line">                {</div>
<div class="line">                    rapidxml::xml_node&lt;&gt;* shaderNode = objShaderNode-&gt;first_node();</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">while</span> (shaderNode)</div>
<div class="line">                    {</div>
<div class="line">                        std::string shaderName = shaderNode-&gt;first_node(<span class="stringliteral">&quot;Name&quot;</span>)-&gt;first_attribute()-&gt;value();</div>
<div class="line">                        <span class="keywordtype">int</span> setupAttr = atoi(shaderNode-&gt;first_node(<span class="stringliteral">&quot;SetupAttribute&quot;</span>)-&gt;first_attribute()-&gt;value());</div>
<div class="line">                        <span class="keywordtype">int</span> setupMesh = atoi(shaderNode-&gt;first_node(<span class="stringliteral">&quot;SetupMeshUniform&quot;</span>)-&gt;first_attribute()-&gt;value());</div>
<div class="line"> </div>
<div class="line">                        std::string programName;</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (shaders[shaderName]-&gt;GetProgramData().size())</div>
<div class="line">                        {</div>
<div class="line">                            programName = shaders[shaderName]-&gt;GetProgramData()[0]-&gt;m_pProgramName;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (shaders[shaderName]-&gt;GetSpecializedProgramData().size())</div>
<div class="line">                        {</div>
<div class="line">                            programName = shaders[shaderName]-&gt;GetSpecializedProgramData()[0]-&gt;m_pProgramName;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line">                            <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(<span class="keyword">false</span>, <span class="stringliteral">&quot;No shader in asset data holder.&quot;</span>);</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (setupAttr == 1)</div>
<div class="line">                        {</div>
<div class="line">                            pModel-&gt;SetupShaderAttribute(programName, ShaderHelper::GetAttributeLocationFunction(programName));</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (setupMesh == 1)</div>
<div class="line">                        {</div>
<div class="line">                            pModel-&gt;SetupMeshUniforms(programName, pStaticUniformManager, textures, useLods);</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordtype">object</span>.SetupModelUniforms(programName, pUniformManager);</div>
<div class="line"> </div>
<div class="line">                        rapidxml::xml_node&lt;&gt;* bindModelShaderNode = shaderNode-&gt;first_node(<span class="stringliteral">&quot;BindModelShader&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordtype">bool</span> bindModelShader = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (bindModelShaderNode != <span class="keyword">nullptr</span>)</div>
<div class="line">                        {</div>
<div class="line">                            bindModelShader = atoi(bindModelShaderNode-&gt;first_attribute()-&gt;value()) &gt; 0;</div>
<div class="line"> </div>
<div class="line">                            <span class="keywordflow">if</span> (bindModelShader == <span class="keyword">false</span>)</div>
<div class="line">                            {</div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* materialNode = shaderNode-&gt;first_node(<span class="stringliteral">&quot;Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(materialNode != <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;Missing Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                PBRModelData::MaterialData material;</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* diffuseNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;Kd&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (diffuseNode)</div>
<div class="line">                                {</div>
<div class="line">                                    LoadXMLVec3(diffuseNode, material.m_Diffuse);</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* specularNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;Ks&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (specularNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_Specular = strtof(specularNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* emissiveNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;Ke&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (emissiveNode)</div>
<div class="line">                                {</div>
<div class="line">                                    LoadXMLVec3(emissiveNode, material.m_Emissive);</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* roughnessNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;Pr&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (roughnessNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_Roughness = strtof(roughnessNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* metallicNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;Pm&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (metallicNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_Metallic = strtof(metallicNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* diffuseMapNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;DiffuseMap&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (diffuseMapNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_DiffuseMap = diffuseMapNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* specularMapNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;SpecularMap&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (specularMapNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_SpecularMap = specularMapNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* emissiveMapNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;EmissiveMap&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (emissiveMapNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_EmissiveMap = emissiveMapNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* roughnessMapNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;RoughnessMap&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (roughnessMapNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_RoughnessMap = roughnessMapNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* metallicMapNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;MetallicMap&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (metallicMapNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_MetallicMap = metallicMapNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* normalMapNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;NormalMap&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (normalMapNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_NormalMap = normalMapNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* alphaMaskNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;AlphaMask&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (alphaMaskNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_AlphaMask = alphaMaskNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordtype">object</span>.SetupMaterialUniforms(programName, pStaticUniformManager, textures, material, useLods);</div>
<div class="line">                            }</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        pModel-&gt;SetupModelCommandBuffer(shaders[shaderName], pDevice, commandMemorySize, controlMemorySize, bindModelShader);</div>
<div class="line"> </div>
<div class="line">                        <span class="keyword">const</span> std::vector&lt;PBRModelData::LodInfo&gt;&amp; objectLodInfo = <span class="keywordtype">object</span>.GetLodInfo();</div>
<div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> lodIdx = 0; lodIdx &lt; objectLodInfo.size(); ++lodIdx)</div>
<div class="line">                        {</div>
<div class="line">                            std::string lodModelName = objectLodInfo[lodIdx].m_Name;</div>
<div class="line">                            PBRObject::Model* pLodModel = &amp;models[lodModelName];</div>
<div class="line"> </div>
<div class="line">                            <span class="keywordflow">if</span> (lodModelName == <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line">                                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">                            <span class="keywordflow">if</span> (setupAttr == 1)</div>
<div class="line">                            {</div>
<div class="line">                                pLodModel-&gt;SetupShaderAttribute(programName, ShaderHelper::GetAttributeLocationFunction(programName));</div>
<div class="line">                            }</div>
<div class="line"> </div>
<div class="line">                            <span class="keywordflow">if</span> (setupMesh == 1)</div>
<div class="line">                            {</div>
<div class="line">                                pLodModel-&gt;SetupMeshUniforms(programName, pStaticUniformManager, textures, useLods);</div>
<div class="line">                            }</div>
<div class="line"> </div>
<div class="line">                            pLodModel-&gt;SetupModelCommandBuffer(shaders[shaderName], pDevice, commandMemorySize, controlMemorySize, bindModelShader);</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        shaderNode = shaderNode-&gt;next_sibling();</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* transformNode = objectNode-&gt;first_node(<span class="stringliteral">&quot;Transform&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (transformNode)</div>
<div class="line">                {</div>
<div class="line">                    rapidxml::xml_node&lt;&gt;* scaleNode = transformNode-&gt;first_node(<span class="stringliteral">&quot;Scale&quot;</span>);</div>
<div class="line">                    rapidxml::xml_node&lt;&gt;* translateNode = transformNode-&gt;first_node(<span class="stringliteral">&quot;Translate&quot;</span>);</div>
<div class="line">                    rapidxml::xml_node&lt;&gt;* rotateNode = transformNode-&gt;first_node(<span class="stringliteral">&quot;Rotate&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">if</span> (scaleNode)</div>
<div class="line">                    {</div>
<div class="line">                        <a class="code" href="classnn_1_1util_1_1_vector3f.html">nn::util::Vector3f</a> tempVec;</div>
<div class="line">                        SceneFileLoad::LoadXMLVec3(scaleNode, tempVec);</div>
<div class="line">                        <span class="keywordtype">object</span>.SetScale(tempVec);</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">if</span> (translateNode)</div>
<div class="line">                    {</div>
<div class="line">                        <a class="code" href="classnn_1_1util_1_1_vector3f.html">nn::util::Vector3f</a> tempVec;</div>
<div class="line">                        SceneFileLoad::LoadXMLVec3(translateNode, tempVec);</div>
<div class="line">                        <span class="keywordtype">object</span>.SetTranslate(<a class="code" href="classnn_1_1util_1_1_vector3f.html">nn::util::Vector3f</a>(tempVec.<a name="a13"></a><a class="code" href="classnn_1_1util_1_1_vector3f.html#a2f69d4207575e05d3ddd7d565194905b">GetX</a>(), tempVec.<a name="a14"></a><a class="code" href="classnn_1_1util_1_1_vector3f.html#a3d9bc410087239e149cfedbd4daf5541">GetY</a>(), tempVec.<a name="a15"></a><a class="code" href="classnn_1_1util_1_1_vector3f.html#af8970ad1e115501b853e2ae4245f5e22">GetZ</a>()<span class="comment">/* + 32.0f*/</span>));</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">if</span> (rotateNode)</div>
<div class="line">                    {</div>
<div class="line">                        <a class="code" href="classnn_1_1util_1_1_vector3f.html">nn::util::Vector3f</a> tempVec;</div>
<div class="line">                        SceneFileLoad::LoadXMLVec3(rotateNode, tempVec);</div>
<div class="line">                        <span class="keywordtype">object</span>.SetRotate(tempVec);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            objectNode = objectNode-&gt;next_sibling();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">} <span class="comment">// NOLINT(impl/function_size)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadPBRObjects</span></div>
<div class="line"><span class="comment"> * -----------------------------</span></div>
<div class="line"><span class="comment"> * Loads the object data to draw the scene. Model files</span></div>
<div class="line"><span class="comment"> * will be loaded as they are reference by the models.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadPBRObjects(rapidxml::xml_node&lt;&gt;* rootNode,</div>
<div class="line">                    <a class="code" href="struct_n_v_ndevice.html">NVNdevice</a>* pDevice,</div>
<div class="line">                    UniformBufferManager* pUniformManager,</div>
<div class="line">                    UniformBufferManager* pStaticUniformManager,</div>
<div class="line">                    std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; shaders,</div>
<div class="line">                    std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; textures,</div>
<div class="line">                    std::map&lt;std::string, PBRObject::ModelCulled&gt;&amp; models,</div>
<div class="line">                    std::vector&lt;PBRObject::ObjectCulled&gt;&amp; objects)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* pbrObjectBlockNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;PBRObjects&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pbrObjectBlockNode)</div>
<div class="line">    {</div>
<div class="line">        rapidxml::xml_node&lt;&gt;* objectNode = pbrObjectBlockNode-&gt;first_node();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">while</span> (objectNode)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (objectNode-&gt;name() == std::string(<span class="stringliteral">&quot;ObjectFile&quot;</span>))</div>
<div class="line">            {</div>
<div class="line">                std::string childFileName = objectNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_document&lt;&gt; xmlDoc;</div>
<div class="line"> </div>
<div class="line">                std::pair&lt;rapidxml::xml_node&lt;&gt;*, <span class="keywordtype">char</span>*&gt; xmlLoad = SceneFileLoad::LoadAndParseXMLFile(childFileName, xmlDoc);</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* childRootNode = xmlLoad.first;</div>
<div class="line">                <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(childRootNode);</div>
<div class="line"> </div>
<div class="line">                LoadPBRObjects(childRootNode, pDevice, pUniformManager, pStaticUniformManager, shaders, textures, models, objects);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                objects.push_back(PBRObject::ObjectCulled());</div>
<div class="line">                PBRObject::ObjectCulled&amp; <span class="keywordtype">object</span> = objects.back();</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* nameNode = objectNode-&gt;first_node(<span class="stringliteral">&quot;Name&quot;</span>);</div>
<div class="line">                <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(nameNode);</div>
<div class="line">                std::string objectName = nameNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                <span class="keywordtype">object</span>.SetName(objectName);</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* cullNode = objectNode-&gt;first_node(<span class="stringliteral">&quot;BackFaceCull&quot;</span>);</div>
<div class="line">                <span class="keywordflow">if</span> (cullNode)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordtype">int</span> backFaceCull = atoi(cullNode-&gt;first_attribute()-&gt;value());</div>
<div class="line">                    <span class="keywordtype">object</span>.SetBackFaceCull(backFaceCull);</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* fileNameNode = objectNode-&gt;first_node(<span class="stringliteral">&quot;FileName&quot;</span>);</div>
<div class="line">                <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(fileNameNode);</div>
<div class="line"> </div>
<div class="line">                std::string modelFileName = fileNameNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (models.find(modelFileName) == models.end())</div>
<div class="line">                {</div>
<div class="line">                    PBRObject::Model* pModel = &amp;models[modelFileName];</div>
<div class="line"> </div>
<div class="line">                    LoadModel(pDevice, pModel, modelFileName);</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                PBRObject::Model* pModel = &amp;models[modelFileName];</div>
<div class="line"> </div>
<div class="line">                <span class="keywordtype">object</span>.SetModel(modelFileName);</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* lodBlockNode = objectNode-&gt;first_node(<span class="stringliteral">&quot;LODInfo&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordtype">int</span> useLods = 0;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (lodBlockNode)</div>
<div class="line">                {</div>
<div class="line">                    rapidxml::xml_node&lt;&gt;* lodTotalLevelsNode = lodBlockNode-&gt;first_node(<span class="stringliteral">&quot;Levels&quot;</span>);</div>
<div class="line">                    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(lodTotalLevelsNode);</div>
<div class="line">                    <span class="keywordtype">object</span>.SetNumLodLevels(atoi(lodTotalLevelsNode-&gt;first_attribute()-&gt;value()) + 1);</div>
<div class="line"> </div>
<div class="line">                    PBRModelData::LodInfo baseInfo;</div>
<div class="line">                    baseInfo.m_Name = modelFileName;</div>
<div class="line">                    baseInfo.m_StartDistance = 0.0f;</div>
<div class="line">                    baseInfo.m_TransitionArea = 0.0f;</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordtype">object</span>.AddLod(baseInfo, 0);</div>
<div class="line"> </div>
<div class="line">                    rapidxml::xml_node&lt;&gt;* lodNode = lodBlockNode-&gt;first_node(<span class="stringliteral">&quot;LOD&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                    useLods = 1;</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">while</span> (lodNode)</div>
<div class="line">                    {</div>
<div class="line">                        PBRModelData::LodInfo info;</div>
<div class="line"> </div>
<div class="line">                        rapidxml::xml_node&lt;&gt;* lodNameNode = lodNode-&gt;first_node(<span class="stringliteral">&quot;Name&quot;</span>);</div>
<div class="line">                        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(lodNameNode);</div>
<div class="line">                        info.m_Name = lodNameNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (info.m_Name != <span class="stringliteral">&quot;&quot;</span> &amp;&amp; models.find(info.m_Name) == models.end())</div>
<div class="line">                        {</div>
<div class="line">                            PBRObject::Model* pLodModel = &amp;models[info.m_Name];</div>
<div class="line">                            LoadModel(pDevice, pLodModel, info.m_Name);</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        rapidxml::xml_node&lt;&gt;* lodDistNode = lodNode-&gt;first_node(<span class="stringliteral">&quot;Distance&quot;</span>);</div>
<div class="line">                        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(lodDistNode);</div>
<div class="line">                        info.m_StartDistance = strtof(lodDistNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">                        rapidxml::xml_node&lt;&gt;* lodTransNode = lodNode-&gt;first_node(<span class="stringliteral">&quot;Transition&quot;</span>);</div>
<div class="line">                        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(lodTransNode);</div>
<div class="line">                        info.m_TransitionArea = strtof(lodTransNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">                        rapidxml::xml_node&lt;&gt;* lodLevelNode = lodNode-&gt;first_node(<span class="stringliteral">&quot;Level&quot;</span>);</div>
<div class="line">                        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(lodLevelNode);</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordtype">object</span>.AddLod(info, atoi(lodLevelNode-&gt;first_attribute()-&gt;value()));</div>
<div class="line"> </div>
<div class="line">                        lodNode = lodNode-&gt;next_sibling();</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* commandBufferMemoryNode = objectNode-&gt;first_node(<span class="stringliteral">&quot;CommandBufferMemory&quot;</span>);</div>
<div class="line">                <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(commandBufferMemoryNode);</div>
<div class="line"> </div>
<div class="line">                uint32_t commandMemorySize = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(atoi(commandBufferMemoryNode-&gt;first_attribute(<span class="stringliteral">&quot;command&quot;</span>)-&gt;value()));</div>
<div class="line">                uint32_t controlMemorySize = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(atoi(commandBufferMemoryNode-&gt;first_attribute(<span class="stringliteral">&quot;control&quot;</span>)-&gt;value()));</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* objShaderNode = objectNode-&gt;first_node(<span class="stringliteral">&quot;Shaders&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (objShaderNode)</div>
<div class="line">                {</div>
<div class="line">                    rapidxml::xml_node&lt;&gt;* shaderNode = objShaderNode-&gt;first_node();</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">while</span> (shaderNode)</div>
<div class="line">                    {</div>
<div class="line">                        std::string shaderName = shaderNode-&gt;first_node(<span class="stringliteral">&quot;Name&quot;</span>)-&gt;first_attribute()-&gt;value();</div>
<div class="line">                        <span class="keywordtype">int</span> setupAttr = atoi(shaderNode-&gt;first_node(<span class="stringliteral">&quot;SetupAttribute&quot;</span>)-&gt;first_attribute()-&gt;value());</div>
<div class="line">                        <span class="keywordtype">int</span> setupMesh = atoi(shaderNode-&gt;first_node(<span class="stringliteral">&quot;SetupMeshUniform&quot;</span>)-&gt;first_attribute()-&gt;value());</div>
<div class="line"> </div>
<div class="line">                        std::string programName;</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (shaders[shaderName]-&gt;GetProgramData().size())</div>
<div class="line">                        {</div>
<div class="line">                            programName = shaders[shaderName]-&gt;GetProgramData()[0]-&gt;m_pProgramName;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (shaders[shaderName]-&gt;GetSpecializedProgramData().size())</div>
<div class="line">                        {</div>
<div class="line">                            programName = shaders[shaderName]-&gt;GetSpecializedProgramData()[0]-&gt;m_pProgramName;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                        {</div>
<div class="line">                            <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(<span class="keyword">false</span>, <span class="stringliteral">&quot;No shader in asset data holder.&quot;</span>);</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (setupAttr == 1)</div>
<div class="line">                        {</div>
<div class="line">                            pModel-&gt;SetupShaderAttribute(programName, ShaderHelper::GetAttributeLocationFunction(programName));</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (setupMesh == 1)</div>
<div class="line">                        {</div>
<div class="line">                            pModel-&gt;SetupMeshUniforms(programName, pStaticUniformManager, textures, useLods);</div>
<div class="line">                            <span class="keyword">dynamic_cast&lt;</span>PBRObject::ModelCulled*<span class="keyword">&gt;</span>(pModel)-&gt;SetupModelDrawIndirectData(programName);</div>
<div class="line">                            <span class="keyword">dynamic_cast&lt;</span>PBRObject::ModelCulled*<span class="keyword">&gt;</span>(pModel)-&gt;SetupBoundingBox(programName);</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordtype">object</span>.SetupModelUniforms(programName, pUniformManager);</div>
<div class="line"> </div>
<div class="line">                        rapidxml::xml_node&lt;&gt;* bindModelShaderNode = shaderNode-&gt;first_node(<span class="stringliteral">&quot;BindModelShader&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordtype">bool</span> bindModelShader = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (bindModelShaderNode != <span class="keyword">nullptr</span>)</div>
<div class="line">                        {</div>
<div class="line">                            bindModelShader = atoi(bindModelShaderNode-&gt;first_attribute()-&gt;value()) &gt; 0;</div>
<div class="line"> </div>
<div class="line">                            <span class="keywordflow">if</span> (bindModelShader == <span class="keyword">false</span>)</div>
<div class="line">                            {</div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* materialNode = shaderNode-&gt;first_node(<span class="stringliteral">&quot;Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(materialNode != <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;Missing Material&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                PBRModelData::MaterialData material;</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* diffuseNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;Kd&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (diffuseNode)</div>
<div class="line">                                {</div>
<div class="line">                                    LoadXMLVec3(diffuseNode, material.m_Diffuse);</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* specularNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;Ks&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (specularNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_Specular = strtof(specularNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* emissiveNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;Ke&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (emissiveNode)</div>
<div class="line">                                {</div>
<div class="line">                                    LoadXMLVec3(emissiveNode, material.m_Emissive);</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* roughnessNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;Pr&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (roughnessNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_Roughness = strtof(roughnessNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* metallicNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;Pm&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (metallicNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_Metallic = strtof(metallicNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* diffuseMapNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;DiffuseMap&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (diffuseMapNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_DiffuseMap = diffuseMapNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* specularMapNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;SpecularMap&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (specularMapNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_SpecularMap = specularMapNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* emissiveMapNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;EmissiveMap&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (emissiveMapNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_EmissiveMap = emissiveMapNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* roughnessMapNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;RoughnessMap&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (roughnessMapNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_RoughnessMap = roughnessMapNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* metallicMapNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;MetallicMap&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (metallicMapNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_MetallicMap = metallicMapNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* normalMapNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;NormalMap&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (normalMapNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_NormalMap = normalMapNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                rapidxml::xml_node&lt;&gt;* alphaMaskNode = materialNode-&gt;first_node(<span class="stringliteral">&quot;AlphaMask&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordflow">if</span> (alphaMaskNode)</div>
<div class="line">                                {</div>
<div class="line">                                    material.m_AlphaMask = alphaMaskNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">                                }</div>
<div class="line"> </div>
<div class="line">                                <span class="keywordtype">object</span>.SetupMaterialUniforms(programName, pStaticUniformManager, textures, material, useLods);</div>
<div class="line">                            }</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        pModel-&gt;SetupModelCommandBuffer(shaders[shaderName], pDevice, commandMemorySize, controlMemorySize, bindModelShader);</div>
<div class="line"> </div>
<div class="line">                        <span class="keyword">const</span> std::vector&lt;PBRModelData::LodInfo&gt;&amp; objectLodInfo = <span class="keywordtype">object</span>.GetLodInfo();</div>
<div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> lodIdx = 0; lodIdx &lt; objectLodInfo.size(); ++lodIdx)</div>
<div class="line">                        {</div>
<div class="line">                            std::string lodModelName = objectLodInfo[lodIdx].m_Name;</div>
<div class="line">                            PBRObject::Model* pLodModel = &amp;models[lodModelName];</div>
<div class="line"> </div>
<div class="line">                            <span class="keywordflow">if</span> (lodModelName == <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line">                                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">                            <span class="keywordflow">if</span> (setupAttr == 1)</div>
<div class="line">                            {</div>
<div class="line">                                pLodModel-&gt;SetupShaderAttribute(programName, ShaderHelper::GetAttributeLocationFunction(programName));</div>
<div class="line">                            }</div>
<div class="line"> </div>
<div class="line">                            <span class="keywordflow">if</span> (setupMesh == 1)</div>
<div class="line">                            {</div>
<div class="line">                                pLodModel-&gt;SetupMeshUniforms(programName, pStaticUniformManager, textures, useLods);</div>
<div class="line">                                <span class="keyword">dynamic_cast&lt;</span>PBRObject::ModelCulled*<span class="keyword">&gt;</span>(pLodModel)-&gt;SetupModelDrawIndirectData(programName);</div>
<div class="line">                                <span class="keyword">dynamic_cast&lt;</span>PBRObject::ModelCulled*<span class="keyword">&gt;</span>(pLodModel)-&gt;SetupBoundingBox(programName);</div>
<div class="line">                            }</div>
<div class="line"> </div>
<div class="line">                            pLodModel-&gt;SetupModelCommandBuffer(shaders[shaderName], pDevice, commandMemorySize, controlMemorySize, bindModelShader);</div>
<div class="line">                        }</div>
<div class="line"> </div>
<div class="line">                        shaderNode = shaderNode-&gt;next_sibling();</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                rapidxml::xml_node&lt;&gt;* transformNode = objectNode-&gt;first_node(<span class="stringliteral">&quot;Transform&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (transformNode)</div>
<div class="line">                {</div>
<div class="line">                    rapidxml::xml_node&lt;&gt;* scaleNode = transformNode-&gt;first_node(<span class="stringliteral">&quot;Scale&quot;</span>);</div>
<div class="line">                    rapidxml::xml_node&lt;&gt;* translateNode = transformNode-&gt;first_node(<span class="stringliteral">&quot;Translate&quot;</span>);</div>
<div class="line">                    rapidxml::xml_node&lt;&gt;* rotateNode = transformNode-&gt;first_node(<span class="stringliteral">&quot;Rotate&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">if</span> (scaleNode)</div>
<div class="line">                    {</div>
<div class="line">                        <a class="code" href="classnn_1_1util_1_1_vector3f.html">nn::util::Vector3f</a> tempVec;</div>
<div class="line">                        SceneFileLoad::LoadXMLVec3(scaleNode, tempVec);</div>
<div class="line">                        <span class="keywordtype">object</span>.SetScale(tempVec);</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">if</span> (translateNode)</div>
<div class="line">                    {</div>
<div class="line">                        <a class="code" href="classnn_1_1util_1_1_vector3f.html">nn::util::Vector3f</a> tempVec;</div>
<div class="line">                        SceneFileLoad::LoadXMLVec3(translateNode, tempVec);</div>
<div class="line">                        <span class="keywordtype">object</span>.SetTranslate(<a class="code" href="classnn_1_1util_1_1_vector3f.html">nn::util::Vector3f</a>(tempVec.<a class="code" href="classnn_1_1util_1_1_vector3f.html#a2f69d4207575e05d3ddd7d565194905b">GetX</a>(), tempVec.<a class="code" href="classnn_1_1util_1_1_vector3f.html#a3d9bc410087239e149cfedbd4daf5541">GetY</a>(), tempVec.<a class="code" href="classnn_1_1util_1_1_vector3f.html#af8970ad1e115501b853e2ae4245f5e22">GetZ</a>()<span class="comment">/* + 32.0f*/</span>));</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">if</span> (rotateNode)</div>
<div class="line">                    {</div>
<div class="line">                        <a class="code" href="classnn_1_1util_1_1_vector3f.html">nn::util::Vector3f</a> tempVec;</div>
<div class="line">                        SceneFileLoad::LoadXMLVec3(rotateNode, tempVec);</div>
<div class="line">                        <span class="keywordtype">object</span>.SetRotate(tempVec);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            objectNode = objectNode-&gt;next_sibling();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">} <span class="comment">// NOLINT(impl/function_size)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadDirectionalLightData</span></div>
<div class="line"><span class="comment"> * ---------------------------------------</span></div>
<div class="line"><span class="comment"> * Loads the directional light data.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadDirectionalLightData( rapidxml::xml_node&lt;&gt;* dirLightNode,</div>
<div class="line">                               std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; shaders,</div>
<div class="line">                               UniformBufferManager* pUniformManager,</div>
<div class="line">                               Camera* pCamera,</div>
<div class="line">                               <span class="keywordtype">float</span> globalAmbient,</div>
<div class="line">                               DeferredDirectionalLightPass** ppLightObj )</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* shaderNode = dirLightNode-&gt;first_node(<span class="stringliteral">&quot;Shader&quot;</span>);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(shaderNode);</div>
<div class="line"> </div>
<div class="line">    std::string shaderName = shaderNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">    (*ppLightObj)-&gt;Init(shaders[shaderName]);</div>
<div class="line">    (*ppLightObj)-&gt;SetupUniforms(pUniformManager);</div>
<div class="line">    (*ppLightObj)-&gt;SetEyePos(<a name="_a16"></a><a class="code" href="classnn_1_1util_1_1_vector4f.html">nn::util::Vector4f</a>(pCamera-&gt;GetPosition(), 1.0f));</div>
<div class="line">    (*ppLightObj)-&gt;SetGlobalAmbient(globalAmbient);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classnn_1_1util_1_1_vector3f.html">nn::util::Vector3f</a> tempVec3;</div>
<div class="line"> </div>
<div class="line">    rapidxml::xml_node&lt;&gt;* intensityNode = dirLightNode-&gt;first_node(<span class="stringliteral">&quot;LightIntensity&quot;</span>);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(intensityNode);</div>
<div class="line">    SceneFileLoad::LoadXMLVec3(intensityNode, tempVec3);</div>
<div class="line">    (*ppLightObj)-&gt;SetLightIntensity(<a class="code" href="classnn_1_1util_1_1_vector4f.html">nn::util::Vector4f</a>(tempVec3, 1.0f));</div>
<div class="line"> </div>
<div class="line">    rapidxml::xml_node&lt;&gt;* dirNode = dirLightNode-&gt;first_node(<span class="stringliteral">&quot;LightDir&quot;</span>);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(dirNode);</div>
<div class="line">    SceneFileLoad::LoadXMLVec3(dirNode, tempVec3);</div>
<div class="line">    (*ppLightObj)-&gt;SetLightDir(<a class="code" href="classnn_1_1util_1_1_vector4f.html">nn::util::Vector4f</a>(tempVec3, 1.0f));</div>
<div class="line"> </div>
<div class="line">    rapidxml::xml_node&lt;&gt;* posNode = dirLightNode-&gt;first_node(<span class="stringliteral">&quot;LightPos&quot;</span>);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(posNode);</div>
<div class="line">    SceneFileLoad::LoadXMLVec3(posNode, tempVec3);</div>
<div class="line">    (*ppLightObj)-&gt;SetLightPos(<a class="code" href="classnn_1_1util_1_1_vector3f.html">nn::util::Vector3f</a>(tempVec3));</div>
<div class="line"> </div>
<div class="line">    rapidxml::xml_node&lt;&gt;* shadowMapSizeNode = dirLightNode-&gt;first_node(<span class="stringliteral">&quot;ShadowMapSize&quot;</span>);</div>
<div class="line">    uint32_t shadowWidth = atoi(shadowMapSizeNode-&gt;first_attribute(<span class="stringliteral">&quot;width&quot;</span>)-&gt;value());</div>
<div class="line">    uint32_t shadowHeight = atoi(shadowMapSizeNode-&gt;first_attribute(<span class="stringliteral">&quot;height&quot;</span>)-&gt;value());</div>
<div class="line">    (*ppLightObj)-&gt;SetShadowMapSize(shadowWidth, shadowHeight);</div>
<div class="line"> </div>
<div class="line">    rapidxml::xml_node&lt;&gt;* shadowFrustumSizeNode = dirLightNode-&gt;first_node(<span class="stringliteral">&quot;ShadowFrustum&quot;</span>);</div>
<div class="line">    <span class="keywordtype">float</span> frustumWidth = strtof(shadowFrustumSizeNode-&gt;first_attribute(<span class="stringliteral">&quot;width&quot;</span>)-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">    <span class="keywordtype">float</span> frustumHeight = strtof(shadowFrustumSizeNode-&gt;first_attribute(<span class="stringliteral">&quot;height&quot;</span>)-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">    <span class="keywordtype">float</span> near = strtof(shadowFrustumSizeNode-&gt;first_attribute(<span class="stringliteral">&quot;near&quot;</span>)-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">    <span class="keywordtype">float</span> far = strtof(shadowFrustumSizeNode-&gt;first_attribute(<span class="stringliteral">&quot;far&quot;</span>)-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">    (*ppLightObj)-&gt;SetShadowFrustumSize(frustumWidth, frustumHeight, near, far);</div>
<div class="line"> </div>
<div class="line">    rapidxml::xml_node&lt;&gt;* outsideMapValNode = dirLightNode-&gt;first_node(<span class="stringliteral">&quot;OutsideShadowVal&quot;</span>);</div>
<div class="line">    <span class="keywordtype">float</span> outsideMapVal = strtof(outsideMapValNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">    (*ppLightObj)-&gt;SetOutsideShadowMapVal(outsideMapVal);</div>
<div class="line"> </div>
<div class="line">    (*ppLightObj)-&gt;CalculateShadowMatrices();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadDirectionalLight</span></div>
<div class="line"><span class="comment"> * -----------------------------------</span></div>
<div class="line"><span class="comment"> * Loads the directional light pass.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadDirectionalLight(rapidxml::xml_node&lt;&gt;* rootNode,</div>
<div class="line">                          std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; shaders,</div>
<div class="line">                          UniformBufferManager* pUniformManager,</div>
<div class="line">                          Camera* pCamera,</div>
<div class="line">                          <span class="keywordtype">float</span> globalAmbient,</div>
<div class="line">                          DeferredDirectionalLightPass** ppLightObj)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* dirLightNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;DirectionalLight&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (dirLightNode)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">void</span>* place = AlignedAllocate(<span class="keyword">sizeof</span>(DeferredDirectionalLightPass), <a name="a17"></a><a class="code" href="nn___macro_8h.html#ac6f80ca2ebf15f619391e35806e9635f">NN_ALIGNOF</a>(DeferredDirectionalLightPass));</div>
<div class="line">        (*ppLightObj) = <span class="keyword">new</span>(place) DeferredDirectionalLightPass;</div>
<div class="line"> </div>
<div class="line">        LoadDirectionalLightData(dirLightNode,</div>
<div class="line">                                 shaders,</div>
<div class="line">                                 pUniformManager,</div>
<div class="line">                                 pCamera,</div>
<div class="line">                                 globalAmbient,</div>
<div class="line">                                 ppLightObj);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadDirectionalLightAO</span></div>
<div class="line"><span class="comment"> * -------------------------------------</span></div>
<div class="line"><span class="comment"> * Loads the ambient occlusion version of the directional light pass.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadDirectionalLightAO(rapidxml::xml_node&lt;&gt;* rootNode,</div>
<div class="line">                            std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; shaders,</div>
<div class="line">                            UniformBufferManager* pUniformManager,</div>
<div class="line">                            Camera* pCamera,</div>
<div class="line">                            <span class="keywordtype">float</span> globalAmbient,</div>
<div class="line">                            DeferredDirectionalLightPassAO** ppLightObj)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* dirLightNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;DirectionalLight&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (dirLightNode)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">void</span>* place = AlignedAllocate(<span class="keyword">sizeof</span>(DeferredDirectionalLightPassAO), <a class="code" href="nn___macro_8h.html#ac6f80ca2ebf15f619391e35806e9635f">NN_ALIGNOF</a>(DeferredDirectionalLightPassAO));</div>
<div class="line">        (*ppLightObj) = <span class="keyword">new</span>(place) DeferredDirectionalLightPassAO;</div>
<div class="line"> </div>
<div class="line">        DeferredDirectionalLightPass* pBaseLight = <span class="keyword">dynamic_cast&lt;</span>DeferredDirectionalLightPass*<span class="keyword">&gt;</span>(*ppLightObj);</div>
<div class="line"> </div>
<div class="line">        LoadDirectionalLightData(dirLightNode,</div>
<div class="line">                                 shaders,</div>
<div class="line">                                 pUniformManager,</div>
<div class="line">                                 pCamera,</div>
<div class="line">                                 globalAmbient,</div>
<div class="line">                                 &amp;pBaseLight);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadPointLightBlock</span></div>
<div class="line"><span class="comment"> * ----------------------------------</span></div>
<div class="line"><span class="comment"> * Helper function to load a list of point lights.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadPointLightBlock(rapidxml::xml_node&lt;&gt;* rootNode,</div>
<div class="line">                         <a class="code" href="struct_n_v_ndevice.html">NVNdevice</a>* pDevice,</div>
<div class="line">                         uint32_t screenWidth,</div>
<div class="line">                         uint32_t screenHeight,</div>
<div class="line">                         AssetFileDataHolder* shader,</div>
<div class="line">                         AssetFileDataHolder* debugShader,</div>
<div class="line">                         AssetFileDataHolder* stencilShader,</div>
<div class="line">                         PBRObject::Model* model,</div>
<div class="line">                         Camera* pCamera,</div>
<div class="line">                         UniformBufferManager* pUniformManager,</div>
<div class="line">                         TextureIDManager* pTextureIDManager,</div>
<div class="line">                         std::vector&lt;DeferredPointLightObject*&gt;&amp; pointLights)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* pointLightNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;PointLight&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (pointLightNode)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">void</span>* place = AlignedAllocate(<span class="keyword">sizeof</span>(DeferredPointLightObject), <a class="code" href="nn___macro_8h.html#ac6f80ca2ebf15f619391e35806e9635f">NN_ALIGNOF</a>(DeferredPointLightObject));</div>
<div class="line">        DeferredPointLightObject* light = NULL;</div>
<div class="line">        light = <span class="keyword">new</span>(place) DeferredPointLightObject;</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* objNode = pointLightNode-&gt;first_node(<span class="stringliteral">&quot;LightObjectName&quot;</span>);</div>
<div class="line">        std::string lightObjName;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">while</span> (objNode)</div>
<div class="line">        {</div>
<div class="line">            lightObjName = objNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">            light-&gt;AddIgnoreShadow(lightObjName);</div>
<div class="line"> </div>
<div class="line">            objNode = objNode-&gt;next_sibling(<span class="stringliteral">&quot;LightObjectName&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* radiusNode = pointLightNode-&gt;first_node(<span class="stringliteral">&quot;Radius&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(radiusNode);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">float</span> radius = strtof(radiusNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* colorNode = pointLightNode-&gt;first_node(<span class="stringliteral">&quot;Color&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(colorNode);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classnn_1_1util_1_1_vector3f.html">nn::util::Vector3f</a> colorVec;</div>
<div class="line">        SceneFileLoad::LoadXMLVec3(colorNode, colorVec);</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* intensityNode = pointLightNode-&gt;first_node(<span class="stringliteral">&quot;Intensity&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(intensityNode);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">float</span> intensity = strtof(intensityNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* lightPosNode = pointLightNode-&gt;first_node(<span class="stringliteral">&quot;Position&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(lightPosNode);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classnn_1_1util_1_1_vector3f.html">nn::util::Vector3f</a> lightPosVec;</div>
<div class="line">        SceneFileLoad::LoadXMLVec3(lightPosNode, lightPosVec);</div>
<div class="line"> </div>
<div class="line">        light-&gt;Init(shader);</div>
<div class="line">        light-&gt;SetDebugDrawShader(debugShader);</div>
<div class="line">        light-&gt;SetStencilShader(stencilShader);</div>
<div class="line">        light-&gt;SetLightGeometry(model);</div>
<div class="line">        light-&gt;SetLightIntensity(<a class="code" href="classnn_1_1util_1_1_vector4f.html">nn::util::Vector4f</a>(colorVec, 1.0f), intensity);</div>
<div class="line">        light-&gt;SetLightPos(<a class="code" href="classnn_1_1util_1_1_vector4f.html">nn::util::Vector4f</a>(lightPosVec.<a class="code" href="classnn_1_1util_1_1_vector3f.html#a2f69d4207575e05d3ddd7d565194905b">GetX</a>(), lightPosVec.<a class="code" href="classnn_1_1util_1_1_vector3f.html#a3d9bc410087239e149cfedbd4daf5541">GetY</a>(), lightPosVec.<a class="code" href="classnn_1_1util_1_1_vector3f.html#af8970ad1e115501b853e2ae4245f5e22">GetZ</a>(), 1.0f));</div>
<div class="line">        light-&gt;SetLightRadius(radius);</div>
<div class="line">        light-&gt;SetScreenSize(screenWidth, screenHeight);</div>
<div class="line">        light-&gt;SetEyePos(pCamera-&gt;GetPosition());</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* shadowNode = pointLightNode-&gt;first_node(<span class="stringliteral">&quot;ShadowSize&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (shadowNode)</div>
<div class="line">        {</div>
<div class="line">            uint32_t height = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(atoi(shadowNode-&gt;first_attribute(<span class="stringliteral">&quot;height&quot;</span>)-&gt;value()));</div>
<div class="line">            uint32_t width = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(atoi(shadowNode-&gt;first_attribute(<span class="stringliteral">&quot;width&quot;</span>)-&gt;value()));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">float</span> sampleRadius = strtof(shadowNode-&gt;first_attribute(<span class="stringliteral">&quot;sampleRadius&quot;</span>)-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line">            <span class="keywordtype">float</span> cullDistance = strtof(shadowNode-&gt;first_attribute(<span class="stringliteral">&quot;cullDist&quot;</span>)-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">            light-&gt;SetupShadows(<span class="keyword">true</span>, width, height, sampleRadius, cullDistance, pDevice, pTextureIDManager);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            light-&gt;SetupShadows(<span class="keyword">false</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        light-&gt;SetupUniforms(pUniformManager);</div>
<div class="line"> </div>
<div class="line">        pointLights.push_back(light);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        pointLightNode = pointLightNode-&gt;next_sibling();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::SetupPointLights</span></div>
<div class="line"><span class="comment"> * -------------------------------</span></div>
<div class="line"><span class="comment"> * Sets up the point lights with info loaded from the xml file.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> SetupPointLights(rapidxml::xml_node&lt;&gt;* pointLightDataNode,</div>
<div class="line">                      <a class="code" href="struct_n_v_ndevice.html">NVNdevice</a>* pDevice,</div>
<div class="line">                      uint32_t screenWidth,</div>
<div class="line">                      uint32_t screenHeight,</div>
<div class="line">                      std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; shaders,</div>
<div class="line">                      PBRObject::Model* pModel,</div>
<div class="line">                      Camera* pCamera,</div>
<div class="line">                      UniformBufferManager* pUniformManager,</div>
<div class="line">                      TextureIDManager* pTextureIDManager,</div>
<div class="line">                      std::vector&lt;DeferredPointLightObject*&gt;&amp; pointLights)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* lightGeoNode = pointLightDataNode-&gt;first_node(<span class="stringliteral">&quot;LightGeometry&quot;</span>);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(lightGeoNode);</div>
<div class="line"> </div>
<div class="line">    rapidxml::xml_node&lt;&gt;* commandBufferMemoryNode = lightGeoNode-&gt;first_node(<span class="stringliteral">&quot;CommandBufferMemory&quot;</span>);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(commandBufferMemoryNode);</div>
<div class="line"> </div>
<div class="line">    uint32_t commandMemorySize = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(atoi(commandBufferMemoryNode-&gt;first_attribute(<span class="stringliteral">&quot;command&quot;</span>)-&gt;value()));</div>
<div class="line">    uint32_t controlMemorySize = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(atoi(commandBufferMemoryNode-&gt;first_attribute(<span class="stringliteral">&quot;control&quot;</span>)-&gt;value()));</div>
<div class="line"> </div>
<div class="line">    std::string shaderName = lightGeoNode-&gt;first_node(<span class="stringliteral">&quot;Shader&quot;</span>)-&gt;first_attribute()-&gt;value();</div>
<div class="line">    std::string programName = shaders[shaderName]-&gt;GetProgramData()[0]-&gt;m_pProgramName;</div>
<div class="line"> </div>
<div class="line">    pModel-&gt;SetupShaderAttribute(programName, ShaderHelper::GetAttributeLocationFunction(programName));</div>
<div class="line">    pModel-&gt;SetupModelCommandBuffer(shaders[shaderName], pDevice, commandMemorySize, controlMemorySize);</div>
<div class="line"> </div>
<div class="line">    std::string debugShaderName = lightGeoNode-&gt;first_node(<span class="stringliteral">&quot;DebugShader&quot;</span>)-&gt;first_attribute()-&gt;value();</div>
<div class="line">    std::string debugProgramName = shaders[debugShaderName]-&gt;GetProgramData()[0]-&gt;m_pProgramName;</div>
<div class="line"> </div>
<div class="line">    pModel-&gt;SetupShaderAttribute(debugProgramName, ShaderHelper::GetAttributeLocationFunction(debugProgramName));</div>
<div class="line">    pModel-&gt;SetupModelCommandBuffer(shaders[debugShaderName], pDevice, commandMemorySize, controlMemorySize);</div>
<div class="line"> </div>
<div class="line">    std::string stencilShaderName = lightGeoNode-&gt;first_node(<span class="stringliteral">&quot;StencilShader&quot;</span>)-&gt;first_attribute()-&gt;value();</div>
<div class="line">    std::string stencilProgramName = shaders[stencilShaderName]-&gt;GetProgramData()[0]-&gt;m_pProgramName;</div>
<div class="line"> </div>
<div class="line">    pModel-&gt;SetupShaderAttribute(stencilProgramName, ShaderHelper::GetAttributeLocationFunction(stencilProgramName));</div>
<div class="line">    pModel-&gt;SetupModelCommandBuffer(shaders[stencilShaderName], pDevice, commandMemorySize, controlMemorySize);</div>
<div class="line"> </div>
<div class="line">    rapidxml::xml_node&lt;&gt;* pointLightFileNode = pointLightDataNode-&gt;first_node(<span class="stringliteral">&quot;PointLightFile&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (pointLightFileNode)</div>
<div class="line">    {</div>
<div class="line">        std::string childFileName = pointLightFileNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_document&lt;&gt; xmlDoc;</div>
<div class="line"> </div>
<div class="line">        std::pair&lt;rapidxml::xml_node&lt;&gt;*, <span class="keywordtype">char</span>*&gt; xmlLoad = SceneFileLoad::LoadAndParseXMLFile(childFileName, xmlDoc);</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* childRootNode = xmlLoad.first;</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(childRootNode);</div>
<div class="line"> </div>
<div class="line">        LoadPointLightBlock(childRootNode,</div>
<div class="line">                            pDevice,</div>
<div class="line">                            screenWidth,</div>
<div class="line">                            screenHeight,</div>
<div class="line">                            shaders[shaderName],</div>
<div class="line">                            shaders[debugShaderName],</div>
<div class="line">                            shaders[stencilShaderName],</div>
<div class="line">                            pModel,</div>
<div class="line">                            pCamera,</div>
<div class="line">                            pUniformManager,</div>
<div class="line">                            pTextureIDManager,</div>
<div class="line">                            pointLights);</div>
<div class="line"> </div>
<div class="line">        pointLightFileNode = pointLightFileNode-&gt;next_sibling(<span class="stringliteral">&quot;PointLightFile&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    rapidxml::xml_node&lt;&gt;* pointLightBlockNode = pointLightDataNode-&gt;first_node(<span class="stringliteral">&quot;PointLights&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (pointLightBlockNode)</div>
<div class="line">    {</div>
<div class="line">        LoadPointLightBlock(pointLightBlockNode,</div>
<div class="line">                            pDevice,</div>
<div class="line">                            screenWidth,</div>
<div class="line">                            screenHeight,</div>
<div class="line">                            shaders[shaderName],</div>
<div class="line">                            shaders[debugShaderName],</div>
<div class="line">                            shaders[stencilShaderName],</div>
<div class="line">                            pModel,</div>
<div class="line">                            pCamera,</div>
<div class="line">                            pUniformManager,</div>
<div class="line">                            pTextureIDManager,</div>
<div class="line">                            pointLights);</div>
<div class="line"> </div>
<div class="line">        pointLightBlockNode = pointLightDataNode-&gt;next_sibling(<span class="stringliteral">&quot;PointLights&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadPointLights</span></div>
<div class="line"><span class="comment"> * ------------------------------</span></div>
<div class="line"><span class="comment"> * Loads the point lights for the scene. Can be from</span></div>
<div class="line"><span class="comment"> * a child scene file.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadPointLights(rapidxml::xml_node&lt;&gt;* rootNode,</div>
<div class="line">                     <a class="code" href="struct_n_v_ndevice.html">NVNdevice</a>* pDevice,</div>
<div class="line">                     uint32_t screenWidth,</div>
<div class="line">                     uint32_t screenHeight,</div>
<div class="line">                     std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; shaders,</div>
<div class="line">                     std::map&lt;std::string, PBRObject::Model&gt;&amp; models,</div>
<div class="line">                     Camera* pCamera,</div>
<div class="line">                     UniformBufferManager* pUniformManager,</div>
<div class="line">                     TextureIDManager* pTextureIDManager,</div>
<div class="line">                     std::vector&lt;DeferredPointLightObject*&gt;&amp; pointLights)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* pointLightDataNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;PointLightData&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pointLightDataNode)</div>
<div class="line">    {</div>
<div class="line">        rapidxml::xml_node&lt;&gt;* lightGeoNode = pointLightDataNode-&gt;first_node(<span class="stringliteral">&quot;LightGeometry&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(lightGeoNode);</div>
<div class="line"> </div>
<div class="line">        std::string modelFileName = lightGeoNode-&gt;first_node(<span class="stringliteral">&quot;FileName&quot;</span>)-&gt;first_attribute()-&gt;value();</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(models.find(modelFileName) == models.end());</div>
<div class="line"> </div>
<div class="line">        PBRObject::Model&amp; model = models[modelFileName];</div>
<div class="line">        LoadModel(pDevice, &amp;model, modelFileName);</div>
<div class="line"> </div>
<div class="line">        SetupPointLights(pointLightDataNode,</div>
<div class="line">                         pDevice,</div>
<div class="line">                         screenWidth,</div>
<div class="line">                         screenHeight,</div>
<div class="line">                         shaders,</div>
<div class="line">                         &amp;model,</div>
<div class="line">                         pCamera,</div>
<div class="line">                         pUniformManager,</div>
<div class="line">                         pTextureIDManager,</div>
<div class="line">                         pointLights);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadPointLights</span></div>
<div class="line"><span class="comment"> * ------------------------------</span></div>
<div class="line"><span class="comment"> * Loads the point lights for the scene. Can be from</span></div>
<div class="line"><span class="comment"> * a child scene file. (With cullable models)</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadPointLights(rapidxml::xml_node&lt;&gt;* rootNode,</div>
<div class="line">                     <a class="code" href="struct_n_v_ndevice.html">NVNdevice</a>* pDevice,</div>
<div class="line">                     uint32_t screenWidth,</div>
<div class="line">                     uint32_t screenHeight,</div>
<div class="line">                     std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; shaders,</div>
<div class="line">                     std::map&lt;std::string, PBRObject::ModelCulled&gt;&amp; models,</div>
<div class="line">                     Camera* pCamera,</div>
<div class="line">                     UniformBufferManager* pUniformManager,</div>
<div class="line">                     TextureIDManager* pTextureIDManager,</div>
<div class="line">                     std::vector&lt;DeferredPointLightObject*&gt;&amp; pointLights)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* pointLightDataNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;PointLightData&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pointLightDataNode)</div>
<div class="line">    {</div>
<div class="line">        rapidxml::xml_node&lt;&gt;* lightGeoNode = pointLightDataNode-&gt;first_node(<span class="stringliteral">&quot;LightGeometry&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(lightGeoNode);</div>
<div class="line"> </div>
<div class="line">        std::string modelFileName = lightGeoNode-&gt;first_node(<span class="stringliteral">&quot;FileName&quot;</span>)-&gt;first_attribute()-&gt;value();</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(models.find(modelFileName) == models.end());</div>
<div class="line"> </div>
<div class="line">        PBRObject::ModelCulled&amp; model = models[modelFileName];</div>
<div class="line">        LoadModel(pDevice, &amp;model, modelFileName);</div>
<div class="line"> </div>
<div class="line">        SetupPointLights(pointLightDataNode,</div>
<div class="line">                         pDevice,</div>
<div class="line">                         screenWidth,</div>
<div class="line">                         screenHeight,</div>
<div class="line">                         shaders,</div>
<div class="line">                         &amp;model,</div>
<div class="line">                         pCamera,</div>
<div class="line">                         pUniformManager,</div>
<div class="line">                         pTextureIDManager,</div>
<div class="line">                         pointLights);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::SetupSkyBox</span></div>
<div class="line"><span class="comment"> * --------------------------</span></div>
<div class="line"><span class="comment"> * Sets up the SkyBox with info loaded from the xml file.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> SetupSkyBox(rapidxml::xml_node&lt;&gt;* skyBoxNode,</div>
<div class="line">                 <a class="code" href="struct_n_v_ndevice.html">NVNdevice</a>* pDevice,</div>
<div class="line">                 UniformBufferManager* pUniformManager,</div>
<div class="line">                 std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; textures,</div>
<div class="line">                 std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; shaders,</div>
<div class="line">                 PBRObject::Model* pModel,</div>
<div class="line">                 <span class="keywordtype">float</span> farPlane,</div>
<div class="line">                 SkyBox** ppSkyBox)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* commandBufferMemoryNode = skyBoxNode-&gt;first_node(<span class="stringliteral">&quot;CommandBufferMemory&quot;</span>);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(commandBufferMemoryNode);</div>
<div class="line"> </div>
<div class="line">    uint32_t commandMemorySize = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(atoi(commandBufferMemoryNode-&gt;first_attribute(<span class="stringliteral">&quot;command&quot;</span>)-&gt;value()));</div>
<div class="line">    uint32_t controlMemorySize = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(atoi(commandBufferMemoryNode-&gt;first_attribute(<span class="stringliteral">&quot;control&quot;</span>)-&gt;value()));</div>
<div class="line"> </div>
<div class="line">    rapidxml::xml_node&lt;&gt;* shaderNode = skyBoxNode-&gt;first_node(<span class="stringliteral">&quot;Shader&quot;</span>);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(shaderNode);</div>
<div class="line">    std::string shaderName = shaderNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">    rapidxml::xml_node&lt;&gt;* textureNode = skyBoxNode-&gt;first_node(<span class="stringliteral">&quot;Texture&quot;</span>);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(textureNode);</div>
<div class="line">    std::string textureName = textureNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">    ExtractFileName(textureName);</div>
<div class="line"> </div>
<div class="line">    rapidxml::xml_node&lt;&gt;* scaleNode = skyBoxNode-&gt;first_node(<span class="stringliteral">&quot;Scale&quot;</span>);</div>
<div class="line">    <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(scaleNode);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">float</span> scale = strtof(scaleNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">    std::string programName = shaders[shaderName]-&gt;GetProgramData()[0]-&gt;m_pProgramName;</div>
<div class="line"> </div>
<div class="line">    pModel-&gt;SetupShaderAttribute(programName, ShaderHelper::GetAttributeLocationFunction(programName));</div>
<div class="line">    pModel-&gt;SetupModelCommandBuffer(shaders[shaderName], pDevice, commandMemorySize, controlMemorySize);</div>
<div class="line"> </div>
<div class="line">    (*ppSkyBox)-&gt;Init(shaders[shaderName]);</div>
<div class="line">    (*ppSkyBox)-&gt;SetupUniforms(pUniformManager);</div>
<div class="line">    (*ppSkyBox)-&gt;SetSkyTextureHandle(textures[textureName]-&gt;GetTextureData()[0]-&gt;m_TextureHandle);</div>
<div class="line">    (*ppSkyBox)-&gt;SetGeometry(pModel);</div>
<div class="line">    (*ppSkyBox)-&gt;SetScale(scale * farPlane);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadSkyBox</span></div>
<div class="line"><span class="comment"> * -------------------------</span></div>
<div class="line"><span class="comment"> * Loads information needed for rendering the sky box.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadSkyBox(rapidxml::xml_node&lt;&gt;* rootNode,</div>
<div class="line">                <a class="code" href="struct_n_v_ndevice.html">NVNdevice</a>* pDevice,</div>
<div class="line">                UniformBufferManager* pUniformManager,</div>
<div class="line">                std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; textures,</div>
<div class="line">                std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; shaders,</div>
<div class="line">                std::map&lt;std::string, PBRObject::Model&gt;&amp; models,</div>
<div class="line">                <span class="keywordtype">float</span> farPlane,</div>
<div class="line">                SkyBox** ppSkyBox)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* skyBoxNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;SkyBox&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (skyBoxNode)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">void</span>* place = AlignedAllocate(<span class="keyword">sizeof</span>(SkyBox), <a class="code" href="nn___macro_8h.html#ac6f80ca2ebf15f619391e35806e9635f">NN_ALIGNOF</a>(SkyBox));</div>
<div class="line">        (*ppSkyBox) = <span class="keyword">new</span>(place) SkyBox;</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* geoNode = skyBoxNode-&gt;first_node(<span class="stringliteral">&quot;Geometry&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(geoNode);</div>
<div class="line"> </div>
<div class="line">        std::string modelFileName = geoNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(models.find(modelFileName) == models.end());</div>
<div class="line"> </div>
<div class="line">        PBRObject::Model&amp; model = models[modelFileName];</div>
<div class="line">        LoadModel(pDevice, &amp;model, modelFileName);</div>
<div class="line"> </div>
<div class="line">        SetupSkyBox(skyBoxNode,</div>
<div class="line">                    pDevice,</div>
<div class="line">                    pUniformManager,</div>
<div class="line">                    textures,</div>
<div class="line">                    shaders,</div>
<div class="line">                    &amp;model,</div>
<div class="line">                    farPlane,</div>
<div class="line">                    ppSkyBox);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadSkyBox</span></div>
<div class="line"><span class="comment"> * -------------------------</span></div>
<div class="line"><span class="comment"> * Loads information needed for rendering the sky box.</span></div>
<div class="line"><span class="comment"> * (With cullable models)</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadSkyBox(rapidxml::xml_node&lt;&gt;* rootNode,</div>
<div class="line">                <a class="code" href="struct_n_v_ndevice.html">NVNdevice</a>* pDevice,</div>
<div class="line">                UniformBufferManager* pUniformManager,</div>
<div class="line">                std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; textures,</div>
<div class="line">                std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; shaders,</div>
<div class="line">                std::map&lt;std::string, PBRObject::ModelCulled&gt;&amp; models,</div>
<div class="line">                <span class="keywordtype">float</span> farPlane,</div>
<div class="line">                SkyBox** ppSkyBox)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* skyBoxNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;SkyBox&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (skyBoxNode)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">void</span>* place = AlignedAllocate(<span class="keyword">sizeof</span>(SkyBox), <a class="code" href="nn___macro_8h.html#ac6f80ca2ebf15f619391e35806e9635f">NN_ALIGNOF</a>(SkyBox));</div>
<div class="line">        (*ppSkyBox) = <span class="keyword">new</span>(place) SkyBox;</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* geoNode = skyBoxNode-&gt;first_node(<span class="stringliteral">&quot;Geometry&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(geoNode);</div>
<div class="line"> </div>
<div class="line">        std::string modelFileName = geoNode-&gt;first_attribute()-&gt;value();</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(models.find(modelFileName) == models.end());</div>
<div class="line"> </div>
<div class="line">        PBRObject::ModelCulled&amp; model = models[modelFileName];</div>
<div class="line">        LoadModel(pDevice, &amp;model, modelFileName);</div>
<div class="line"> </div>
<div class="line">        SetupSkyBox(skyBoxNode,</div>
<div class="line">                    pDevice,</div>
<div class="line">                    pUniformManager,</div>
<div class="line">                    textures,</div>
<div class="line">                    shaders,</div>
<div class="line">                    &amp;model,</div>
<div class="line">                    farPlane,</div>
<div class="line">                    ppSkyBox);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadSAO</span></div>
<div class="line"><span class="comment"> * -----------------------</span></div>
<div class="line"><span class="comment"> * Loads information needed for scalable ambient obscurance pass.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadSAO(rapidxml::xml_node&lt;&gt;* rootNode,</div>
<div class="line">             <span class="keywordtype">float</span> fov,</div>
<div class="line">             uint32_t screenWidth,</div>
<div class="line">             uint32_t screenHeight,</div>
<div class="line">             UniformBufferManager* pUniformManager,</div>
<div class="line">             std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; shaders,</div>
<div class="line">             ScalableAOPass** ppSAOPass)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* saoNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;SAO&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (saoNode)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">void</span>* place = AlignedAllocate(<span class="keyword">sizeof</span>(ScalableAOPass), <a class="code" href="nn___macro_8h.html#ac6f80ca2ebf15f619391e35806e9635f">NN_ALIGNOF</a>(ScalableAOPass));</div>
<div class="line">        (*ppSAOPass) = <span class="keyword">new</span>(place) ScalableAOPass;</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* shaderNode = saoNode-&gt;first_node(<span class="stringliteral">&quot;Shader&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(shaderNode);</div>
<div class="line">        std::string shaderName = shaderNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* biasNode = saoNode-&gt;first_node(<span class="stringliteral">&quot;Bias&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(biasNode);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">float</span> bias = strtof(biasNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* radiusNode = saoNode-&gt;first_node(<span class="stringliteral">&quot;Radius&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(radiusNode);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">float</span> radius = strtof(radiusNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* intensityNode = saoNode-&gt;first_node(<span class="stringliteral">&quot;Intensity&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(intensityNode);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">float</span> intensity = strtof(intensityNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* powerExponentNode = saoNode-&gt;first_node(<span class="stringliteral">&quot;PowerExponent&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(powerExponentNode);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">float</span> powerExponent = strtof(powerExponentNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* renderScaleNode = saoNode-&gt;first_node(<span class="stringliteral">&quot;RenderScale&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(renderScaleNode);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">float</span> renderScale = strtof(renderScaleNode-&gt;first_attribute()-&gt;value(), <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">        std::string programName = shaders[shaderName]-&gt;GetProgramData()[0]-&gt;m_pProgramName;</div>
<div class="line"> </div>
<div class="line">        (*ppSAOPass)-&gt;Init(shaders[shaderName]);</div>
<div class="line">        (*ppSAOPass)-&gt;SetupUniforms(pUniformManager);</div>
<div class="line">        (*ppSAOPass)-&gt;SetBias(bias);</div>
<div class="line">        (*ppSAOPass)-&gt;SetRadius(radius);</div>
<div class="line">        (*ppSAOPass)-&gt;SetIntensity(intensity);</div>
<div class="line">        (*ppSAOPass)-&gt;SetPowerExponent(powerExponent);</div>
<div class="line">        (*ppSAOPass)-&gt;SetWidth(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(screenWidth) * renderScale));</div>
<div class="line">        (*ppSAOPass)-&gt;SetHeight(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(screenHeight) * renderScale));</div>
<div class="line">        (*ppSAOPass)-&gt;SetProjectionScale(<span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(screenWidth) * renderScale / fabs(2.0f * tanf(fov)));</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadSAOBlur</span></div>
<div class="line"><span class="comment"> * -------------------------------</span></div>
<div class="line"><span class="comment"> * Loads information needed for SAO blur pass.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadSAOBlur(rapidxml::xml_node&lt;&gt;* rootNode,</div>
<div class="line">                 UniformBufferManager* pUniformManager,</div>
<div class="line">                 std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; shaders,</div>
<div class="line">                 ScalableAOBlurPass** ppScalableAOBlurPass)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* saoBlurNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;SAOBlur&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (saoBlurNode)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">void</span>* place = AlignedAllocate(<span class="keyword">sizeof</span>(ScalableAOBlurPass), <a class="code" href="nn___macro_8h.html#ac6f80ca2ebf15f619391e35806e9635f">NN_ALIGNOF</a>(ScalableAOBlurPass));</div>
<div class="line">        (*ppScalableAOBlurPass) = <span class="keyword">new</span>(place) ScalableAOBlurPass;</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* shaderNode = saoBlurNode-&gt;first_node(<span class="stringliteral">&quot;Shader&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(shaderNode);</div>
<div class="line">        std::string shaderName = shaderNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">        (*ppScalableAOBlurPass)-&gt;Init(shaders[shaderName]);</div>
<div class="line">        (*ppScalableAOBlurPass)-&gt;SetupUniforms(pUniformManager);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SceneFileLoad::LoadFrustumCulling</span></div>
<div class="line"><span class="comment"> * ---------------------------------</span></div>
<div class="line"><span class="comment"> * Loads information needed for frustum culling.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">void</span> LoadFrustumCulling(rapidxml::xml_node&lt;&gt;* rootNode,</div>
<div class="line">                        <a class="code" href="struct_n_v_ndevice.html">NVNdevice</a>* pDevice,</div>
<div class="line">                        UniformBufferManager* pUniformManager,</div>
<div class="line">                        std::map&lt;std::string, AssetFileDataHolder*&gt;&amp; shaders,</div>
<div class="line">                        std::map&lt;std::string, PBRObject::ModelCulled&gt;&amp; models,</div>
<div class="line">                        std::vector&lt;PBRObject::ObjectCulled&gt;&amp; objects,</div>
<div class="line">                        FrustumCullingPass** ppFrustumCullingPass)</div>
<div class="line">{</div>
<div class="line">    rapidxml::xml_node&lt;&gt;* frustumCullingNode = rootNode-&gt;first_node(<span class="stringliteral">&quot;FrustumCulling&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (frustumCullingNode)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">void</span>* place = AlignedAllocate(<span class="keyword">sizeof</span>(FrustumCullingPass), <a class="code" href="nn___macro_8h.html#ac6f80ca2ebf15f619391e35806e9635f">NN_ALIGNOF</a>(FrustumCullingPass));</div>
<div class="line">        (*ppFrustumCullingPass) = <span class="keyword">new</span>(place) FrustumCullingPass;</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* shaderNode = frustumCullingNode-&gt;first_node(<span class="stringliteral">&quot;Shader&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(shaderNode);</div>
<div class="line">        std::string shaderName = shaderNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* frustumDebugShaderNode = frustumCullingNode-&gt;first_node(<span class="stringliteral">&quot;ViewFrustumDebugShader&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(frustumDebugShaderNode);</div>
<div class="line">        std::string frustumDebugShaderName = frustumDebugShaderNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* debugDrawShaderNode = frustumCullingNode-&gt;first_node(<span class="stringliteral">&quot;DebugDrawObjectShader&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(debugDrawShaderNode);</div>
<div class="line">        std::string debugDrawShaderName = debugDrawShaderNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* debugCameraObjectNode = frustumCullingNode-&gt;first_node(<span class="stringliteral">&quot;DebugCameraObject&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(debugCameraObjectNode);</div>
<div class="line">        std::string modelFileName = debugCameraObjectNode-&gt;first_attribute()-&gt;value();</div>
<div class="line"> </div>
<div class="line">        rapidxml::xml_node&lt;&gt;* commandBufferMemoryNode = frustumCullingNode-&gt;first_node(<span class="stringliteral">&quot;CommandBufferMemory&quot;</span>);</div>
<div class="line">        <a class="code" href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a>(commandBufferMemoryNode);</div>
<div class="line"> </div>
<div class="line">        uint32_t commandMemorySize = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(atoi(commandBufferMemoryNode-&gt;first_attribute(<span class="stringliteral">&quot;command&quot;</span>)-&gt;value()));</div>
<div class="line">        uint32_t controlMemorySize = <span class="keyword">static_cast&lt;</span>uint32_t<span class="keyword">&gt;</span>(atoi(commandBufferMemoryNode-&gt;first_attribute(<span class="stringliteral">&quot;control&quot;</span>)-&gt;value()));</div>
<div class="line"> </div>
<div class="line">        PBRObject::ModelCulled&amp; model = models[modelFileName];</div>
<div class="line">        LoadModel(pDevice, &amp;model, modelFileName);</div>
<div class="line">        std::string programName = shaders[debugDrawShaderName]-&gt;GetProgramData()[0]-&gt;m_pProgramName;</div>
<div class="line"> </div>
<div class="line">        model.SetupShaderAttribute(programName, ShaderHelper::GetAttributeLocationFunction(programName));</div>
<div class="line">        model.SetupModelCommandBuffer(shaders[debugDrawShaderName], pDevice, commandMemorySize, controlMemorySize);</div>
<div class="line"> </div>
<div class="line">        (*ppFrustumCullingPass)-&gt;Init(shaders[shaderName]);</div>
<div class="line">        (*ppFrustumCullingPass)-&gt;SetupInstanceData(pDevice, models, objects);</div>
<div class="line">        (*ppFrustumCullingPass)-&gt;SetupDebugDraw(pDevice, pUniformManager, shaders[frustumDebugShaderName], shaders[debugDrawShaderName], models, objects, &amp;models[modelFileName]);</div>
<div class="line">        (*ppFrustumCullingPass)-&gt;SetupUniforms(pUniformManager);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace SceneFileLoad</span></div>
<div class="ttc" id="a_asset_file_data_holder_8h_html"><div class="ttname"><a href="_asset_file_data_holder_8h.html">AssetFileDataHolder.h</a></div><div class="ttdoc">This files defines some structures that hold the data provided by an asset file created by Tutorial02...</div></div>
<div class="ttc" id="a_asset_file_loading_helper_8h_html"><div class="ttname"><a href="_asset_file_loading_helper_8h.html">AssetFileLoadingHelper.h</a></div><div class="ttdoc">This file defines a helper class used to load in asset files generated by Tutorial02.</div></div>
<div class="ttc" id="a_camera_8h_html"><div class="ttname"><a href="_camera_8h.html">Camera.h</a></div><div class="ttdoc">This class keeps track of the main rendering camera's position and orientation.</div></div>
<div class="ttc" id="a_deferred_directional_light_pass_8h_html"><div class="ttname"><a href="_deferred_directional_light_pass_8h.html">DeferredDirectionalLightPass.h</a></div><div class="ttdoc">This class handles the directional light pass for the deferred renderer.</div></div>
<div class="ttc" id="a_deferred_directional_light_pass_a_o_8h_html"><div class="ttname"><a href="_deferred_directional_light_pass_a_o_8h.html">DeferredDirectionalLightPassAO.h</a></div><div class="ttdoc">This class adds screen space ambient occlusion to the deferred lighting pass.</div></div>
<div class="ttc" id="a_deferred_point_light_object_8h_html"><div class="ttname"><a href="_deferred_point_light_object_8h.html">DeferredPointLightObject.h</a></div><div class="ttdoc">This class holds the information for the deferred point light and it's shadow map.</div></div>
<div class="ttc" id="a_frustum_culling_pass_8h_html"><div class="ttname"><a href="_frustum_culling_pass_8h.html">FrustumCullingPass.h</a></div><div class="ttdoc">This class handles the frustum culling calculations.</div></div>
<div class="ttc" id="a_load_scene_8h_html"><div class="ttname"><a href="_load_scene_8h.html">LoadScene.h</a></div><div class="ttdoc">This file defines some helper functions for loading the various objects, textures,...</div></div>
<div class="ttc" id="a_p_b_r_object_8h_html"><div class="ttname"><a href="_p_b_r_object_8h.html">PBRObject.h</a></div><div class="ttdoc">This file defines some classes that handle the model and material data, uniform updating,...</div></div>
<div class="ttc" id="a_p_b_r_object_culled_8h_html"><div class="ttname"><a href="_p_b_r_object_culled_8h.html">PBRObjectCulled.h</a></div><div class="ttdoc">This file defines a version of the PBRObject classes used for frustum culling.</div></div>
<div class="ttc" id="a_scalable_a_o_blur_pass_8h_html"><div class="ttname"><a href="_scalable_a_o_blur_pass_8h.html">ScalableAOBlurPass.h</a></div><div class="ttdoc">This class blurs the output of the SAO pass.</div></div>
<div class="ttc" id="a_scalable_a_o_pass_8h_html"><div class="ttname"><a href="_scalable_a_o_pass_8h.html">ScalableAOPass.h</a></div><div class="ttdoc">The main idea behind the SAO algorithm is to provide a faster and more stable performance than the tr...</div></div>
<div class="ttc" id="a_shader_helper_8h_html"><div class="ttname"><a href="_shader_helper_8h.html">ShaderHelper.h</a></div><div class="ttdoc">This file defines a helper function for getting the attribute location function pointer for a given s...</div></div>
<div class="ttc" id="a_sky_box_8h_html"><div class="ttname"><a href="_sky_box_8h.html">SkyBox.h</a></div><div class="ttdoc">This class handles render the sky box for the scene.</div></div>
<div class="ttc" id="a_tutorial_util_8h_html"><div class="ttname"><a href="_tutorial_util_8h.html">TutorialUtil.h</a></div><div class="ttdoc">This file defines the interface for utility functions used in the tutorials.</div></div>
<div class="ttc" id="a_uniform_buffer_manager_8h_html"><div class="ttname"><a href="_uniform_buffer_manager_8h.html">UniformBufferManager.h</a></div><div class="ttdoc">This file defines a class that manages memory for uniform buffers by using multiple chunks of of GPU ...</div></div>
<div class="ttc" id="aclassnn_1_1_result_html"><div class="ttname"><a href="classnn_1_1_result.html">nn::Result</a></div><div class="ttdoc">Represents the generic result of an operation.</div><div class="ttdef"><b>Definition:</b> nn_Result.h:32</div></div>
<div class="ttc" id="aclassnn_1_1util_1_1_vector3f_html"><div class="ttname"><a href="classnn_1_1util_1_1_vector3f.html">nn::util::Vector3f</a></div><div class="ttdoc">Class that expresses three-dimensional vectors using a single precision floating number type.</div><div class="ttdef"><b>Definition:</b> util_Vector.h:296</div></div>
<div class="ttc" id="aclassnn_1_1util_1_1_vector3f_html_a2f69d4207575e05d3ddd7d565194905b"><div class="ttname"><a href="classnn_1_1util_1_1_vector3f.html#a2f69d4207575e05d3ddd7d565194905b">nn::util::Vector3f::GetX</a></div><div class="ttdeci">float GetX() const NN_NOEXCEPT</div><div class="ttdoc">Gets the x-component.</div></div>
<div class="ttc" id="aclassnn_1_1util_1_1_vector3f_html_a3d9bc410087239e149cfedbd4daf5541"><div class="ttname"><a href="classnn_1_1util_1_1_vector3f.html#a3d9bc410087239e149cfedbd4daf5541">nn::util::Vector3f::GetY</a></div><div class="ttdeci">float GetY() const NN_NOEXCEPT</div><div class="ttdoc">Gets the y-component.</div></div>
<div class="ttc" id="aclassnn_1_1util_1_1_vector3f_html_af8970ad1e115501b853e2ae4245f5e22"><div class="ttname"><a href="classnn_1_1util_1_1_vector3f.html#af8970ad1e115501b853e2ae4245f5e22">nn::util::Vector3f::GetZ</a></div><div class="ttdeci">float GetZ() const NN_NOEXCEPT</div><div class="ttdoc">Gets the z-component.</div></div>
<div class="ttc" id="aclassnn_1_1util_1_1_vector4f_html"><div class="ttname"><a href="classnn_1_1util_1_1_vector4f.html">nn::util::Vector4f</a></div><div class="ttdoc">Class that expresses four-dimensional vectors using a single precision floating number type.</div><div class="ttdef"><b>Definition:</b> util_Vector.h:573</div></div>
<div class="ttc" id="afs_8h_html"><div class="ttname"><a href="fs_8h.html">fs.h</a></div><div class="ttdoc">Declarations of API resources for the file system.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a0f2b5b30657b1ffaf1dec49bfb36462b"><div class="ttname"><a href="namespacenn_1_1fs.html#a0f2b5b30657b1ffaf1dec49bfb36462b">nn::fs::OpenFile</a></div><div class="ttdeci">Result OpenFile(FileHandle *outValue, const char *path, int mode) NN_NOEXCEPT</div><div class="ttdoc">Opens a file.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a4c97b79cce78a95c2333dbc9053b9393afde4472d2b455879cad02aade386ac0d"><div class="ttname"><a href="namespacenn_1_1fs.html#a4c97b79cce78a95c2333dbc9053b9393afde4472d2b455879cad02aade386ac0d">nn::fs::OpenMode_Read</a></div><div class="ttdeci">@ OpenMode_Read</div><div class="ttdoc">Specifies read mode.</div><div class="ttdef"><b>Definition:</b> fs_FileSystem.h:39</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_a81801a404563984f8c6cc1483cc6d730"><div class="ttname"><a href="namespacenn_1_1fs.html#a81801a404563984f8c6cc1483cc6d730">nn::fs::ReadFile</a></div><div class="ttdeci">Result ReadFile(FileHandle handle, int64_t offset, void *buffer, size_t size, const ReadOption &amp;option) NN_NOEXCEPT</div><div class="ttdoc">Loads the content of the file into the specified memory.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_aba29e01d386e809349d60eccdb15ff21"><div class="ttname"><a href="namespacenn_1_1fs.html#aba29e01d386e809349d60eccdb15ff21">nn::fs::GetFileSize</a></div><div class="ttdeci">Result GetFileSize(int64_t *outValue, FileHandle handle) NN_NOEXCEPT</div><div class="ttdoc">Gets the size of a file.</div></div>
<div class="ttc" id="anamespacenn_1_1fs_html_ac8bd9e828751bd4f953acfa765278f84"><div class="ttname"><a href="namespacenn_1_1fs.html#ac8bd9e828751bd4f953acfa765278f84">nn::fs::CloseFile</a></div><div class="ttdeci">void CloseFile(FileHandle handle) NN_NOEXCEPT</div><div class="ttdoc">Closes a file.</div></div>
<div class="ttc" id="ann___assert_8h_html"><div class="ttname"><a href="nn___assert_8h.html">nn_Assert.h</a></div><div class="ttdoc">Declarations for API resources to test whether conditions are satisfied.</div></div>
<div class="ttc" id="ann___assert_8h_html_ade59d1d911907a16c0241f8fe3b31542"><div class="ttname"><a href="nn___assert_8h.html#ade59d1d911907a16c0241f8fe3b31542">NN_ASSERT</a></div><div class="ttdeci">#define NN_ASSERT(condition,...)</div><div class="ttdoc">Tests whether a condition is satisfied.</div><div class="ttdef"><b>Definition:</b> nn_Assert.h:124</div></div>
<div class="ttc" id="ann___log_8h_html"><div class="ttname"><a href="nn___log_8h.html">nn_Log.h</a></div><div class="ttdoc">Declarations for the logging API.</div></div>
<div class="ttc" id="ann___log_8h_html_a2d720c8bc6b733bce63879350d134a84"><div class="ttname"><a href="nn___log_8h.html#a2d720c8bc6b733bce63879350d134a84">NN_LOG</a></div><div class="ttdeci">#define NN_LOG(...)</div><div class="ttdoc">Adds the string specified in the parameter as a log entry.</div><div class="ttdef"><b>Definition:</b> nn_Log.h:33</div></div>
<div class="ttc" id="ann___macro_8h_html_ac6f80ca2ebf15f619391e35806e9635f"><div class="ttname"><a href="nn___macro_8h.html#ac6f80ca2ebf15f619391e35806e9635f">NN_ALIGNOF</a></div><div class="ttdeci">#define NN_ALIGNOF(type)</div><div class="ttdoc">Gets the byte alignment.</div><div class="ttdef"><b>Definition:</b> nn_Macro.h:170</div></div>
<div class="ttc" id="ann___macro_8h_html_af2d1673769927c5eae977d8dde3ce106"><div class="ttname"><a href="nn___macro_8h.html#af2d1673769927c5eae977d8dde3ce106">NN_UNUSED</a></div><div class="ttdeci">#define NN_UNUSED(variable)</div><div class="ttdoc">Suppresses compiler warnings on intentionally unused variables.</div><div class="ttdef"><b>Definition:</b> nn_Macro.h:610</div></div>
<div class="ttc" id="astruct_n_v_ndevice_html"><div class="ttname"><a href="struct_n_v_ndevice.html">NVNdevice</a></div><div class="ttdoc">API class used to represent a specific GPU/device.</div><div class="ttdef"><b>Definition:</b> nvn.h:221</div></div>
<div class="ttc" id="astruct_n_v_nsampler_builder_html"><div class="ttname"><a href="struct_n_v_nsampler_builder.html">NVNsamplerBuilder</a></div><div class="ttdoc">Object specifying state used to construct new sampler objects.</div><div class="ttdef"><b>Definition:</b> nvn.h:352</div></div>
<div class="ttc" id="astructnn_1_1fs_1_1_file_handle_html"><div class="ttname"><a href="structnn_1_1fs_1_1_file_handle.html">nn::fs::FileHandle</a></div><div class="ttdoc">Handle for working with a file.</div><div class="ttdef"><b>Definition:</b> fs_File.h:90</div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
</body>
</html>

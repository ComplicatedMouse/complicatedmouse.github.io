<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<script type="text/javascript" src="../tocDataApi.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>Using Vibration Nodes | NintendoSDK Documents</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="text-align: center;"><img src="../template/img/noscript.svg" /></div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- Using Vibration Nodes -->
<div class="pagetitle" id="PageId_323663455">Using Vibration Nodes</div>
<div class="text_separate">
<h1 id="Anchor_323663455_h1_1">Sample Vibration Node Structure</h1>
<p>This section introduces a specific example of how to use vibration nodes.</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre><span class="cp">#include &lt;nn/hid/hid_Vibration.h&gt;
</span>&nbsp;
<span class="nn">nn::hid::</span><span class="n">VibrationDeviceHandle</span> <span class="n">vibrationDeviceL</span><span class="p">;</span>
<span class="nn">nn::hid::</span><span class="n">VibrationDeviceHandle</span> <span class="n">vibrationDeviceR</span><span class="p">;</span>
&nbsp;
<span class="cm">/* Process for getting VibrationDeviceHandle */</span>
&nbsp;
<span class="c1">// Create the instances of the vibration nodes.
</span><span class="nn">nn::hid::</span><span class="n">VibrationPlayer</span> <span class="n">player1</span><span class="p">;</span>
<span class="nn">nn::hid::</span><span class="n">VibrationPlayer</span> <span class="n">player2</span><span class="p">;</span>
<span class="nn">nn::hid::</span><span class="n">VibrationPlayer</span> <span class="n">player3</span><span class="p">;</span>
<span class="nn">nn::hid::</span><span class="n">VibrationMixer</span> <span class="n">mixer</span><span class="p">;</span>

<span class="nn">nn::hid::</span><span class="n">VibrationPlayer</span> <span class="n">playerA</span><span class="p">;</span>
<span class="nn">nn::hid::</span><span class="n">VibrationPlayer</span> <span class="n">playerB</span><span class="p">;</span>
<span class="nn">nn::hid::</span><span class="n">VibrationTarget</span> <span class="n">targetA</span><span class="p">(</span><span class="n">vibrationDeviceL</span><span class="p">);</span>
<span class="nn">nn::hid::</span><span class="n">VibrationTarget</span> <span class="n">targetB</span><span class="p">(</span><span class="n">vibrationDeviceR</span><span class="p">);</span>
&nbsp;
<span class="c1">// Create the connection instances.
// Connect Player1, Player2, and Player3 to MixerA.
</span><span class="nn">nn::hid::</span><span class="n">VibrationNodeConnection</span> <span class="n">connectionFromPlayer1ToMixer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">player1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mixer</span><span class="p">);</span>
<span class="nn">nn::hid::</span><span class="n">VibrationNodeConnection</span> <span class="n">connectionFromPlayer2ToMixer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">player2</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mixer</span><span class="p">);</span>
<span class="nn">nn::hid::</span><span class="n">VibrationNodeConnection</span> <span class="n">connectionFromPlayer3ToMixer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">player3</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mixer</span><span class="p">);</span>

<span class="c1">// PlayerA and Mixer are connected to TargetA.
</span><span class="nn">nn::hid::</span><span class="n">VibrationNodeConnection</span> <span class="n">connectionFromPlayerAToTargetA</span><span class="p">(</span><span class="o">&amp;</span><span class="n">playerA</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">targetA</span><span class="p">);</span>
<span class="nn">nn::hid::</span><span class="n">VibrationNodeConnection</span> <span class="n">connectionFromMixerToTargetA</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mixer</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">targetA</span><span class="p">);</span>

<span class="c1">// PlayerB and Mixer are connected to TargetB.
</span><span class="nn">nn::hid::</span><span class="n">VibrationNodeConnection</span> <span class="n">connectionFromPlayerBToTargetB</span><span class="p">(</span><span class="o">&amp;</span><span class="n">playerB</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">targetB</span><span class="p">);</span>
<span class="nn">nn::hid::</span><span class="n">VibrationNodeConnection</span> <span class="n">connectionFromMixerToTargetB</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mixer</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">targetB</span><span class="p">);</span></pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>
  <br />
</p>
<p>At this point, you have created a digraph like the one shown in the following figure.</p>
<p>
  <br />
</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_323663455/323663449.png" height="250" class="embedded-image" />
  </span>
</p>
<p>
  <br />
</p>
<p>PlayerA only sends vibrations to TargetA and PlayerB only sends vibrations to TargetB.<br />Only configure PlayerA and PlayerB this way if you only want them to cause specific controllers to vibrate.<br />The Mixer produces vibrations that are sent to both TargetA and TargetB.<br />To implement panning, adjust the <code><em>gainLow</em></code> and <code><em>gainHigh</em></code> values (from <code><span class="ApiLink_nn__hid__VibrationModulation">nn::hid::VibrationModulation</span></code>) that you set for <code><em>connectionFromMixerToTargetA</em></code> and <code><em>connectionFromMixerToTargetB</em></code>.</p>
<p>
  <strong>Note:</strong> For more information about implementing panning, see <span class="ApiLink_NN_APILINK_HID_VIB_PLAY">Controlling the Vibration Motor Using a Vibration File</span> (Samples/Sources/Applications/HidVibrationPlayer) and <span class="ApiLink_NN_APILINK_HID_VIB_ROLLINGBALL">An Interactive Technical Demo Using the Vibration Feature</span> (Samples/Sources/Applications/HidVibrationRollingBall), which are included in the SDK.</p>
<p>
  <br />
</p>
<p>In a first-person shooter game, for example, this graph structure could be used as follows.<br />Set the following vibration waveforms for each <code><span class="ApiLink_nn__hid__VibrationPlayer">nn::hid::VibrationPlayer</span></code>.</p>
<ul>
  <li>Player1: Vibration waveform caused by enemy attacks (that is, the sound of gunfire)</li>
  <li>Player2: Vibration waveform caused by enemy bombs (that is, the sound of explosions)</li>
  <li>Player3: Vibration waveform caused by enemy movements (that is, the sound of vehicle engines)</li>
  <li>PlayerA: Vibration waveform indicating that there is an obstacle to the left of the player</li>
  <li>PlayerB: Vibration waveform indicating that there is an obstacle to the right of the player</li>
</ul>
<p>Each <code><span class="ApiLink_nn__hid__VibrationPlayer">nn::hid::VibrationPlayer</span></code> calls <code><span class="ApiLink_nn__hid__VibrationPlayer__Play">nn::hid::VibrationPlayer::Play</span>()</code> for their respective actions.<br />From Player1 to Player3, a variety of vibration waveforms are set for the same enemy. These vibration waveforms are sent to the Mixer to be mixed together.</p>
<p>This use of the Mixer collects vibrations from enemies into a single output group.<br />By configuring <code><em>connectionFromMixerToTargetA</em></code> and <code><em>connectionFromMixerToTargetB</em></code> according to the relative positions of the player and the enemy in addition to the distance between them, you can express their spatial relationship with vibration.<br /> You can use vibrations in this way to make your game a more immersive experience.</p>
<h2 id="Anchor_323663455_h2_1">Example Implementation in SDK Sample</h2>
<p>For a detailed example of vibration nodes being implemented, see <span class="ApiLink_NN_APILINK_HID_VIB_PLAY">Controlling the Vibration Motor Using a Vibration File</span> (Samples/Sources/Applications/HidVibrationPlayer), which is included in the SDK.</p>
<p>
  <code>nns::hid::VibrationNodeFramework</code> is a framework for using vibration nodes in a simple manner. It can play back four vibration files simultaneously.<br />In addition to adjusting the gain, pitch, playback speed, and playback delay, you can also adjust the left and right panning when playing back each file.<br />You can do other things using left and right panning, such as only playing back the left or right side.<br />Through a combination of left and right panning and playback delays, you can also easily implement effects like vibrating the right side after vibrating the left side.</p>
<p>The internal implementation connects four instances of <code><span class="ApiLink_nn__hid__VibrationPlayer">nn::hid::VibrationPlayer</span></code> and two instances of <code><span class="ApiLink_nn__hid__VibrationPlayer">nn::hid::VibrationPlayer</span></code> to each other using eight individual instances of <code><span class="ApiLink_nn__hid__VibrationNodeConnection">nn::hid::VibrationNodeConnection</span></code>.</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>Samples/Sources/Applications/HidVibrationPlayer/VibrationNodeFramework.h
Samples/Sources/Applications/HidVibrationPlayer/VibrationNodeFramework.cpp</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<h1 id="Anchor_323663455_h1_2">
  <br />Choosing a Mix Mode for Vibration Values</h1>
<p> In general, <code><span class="ApiLink_nn__hid__VibrationMixer">nn::hid::VibrationMixer</span></code> can be configured with one of two mix modes (<code><span class="ApiLink_nn__hid__VibrationMixMode">nn::hid::VibrationMixMode</span></code>): <code><span class="ApiLink_nn__hid__VibrationMixMode_MaxAmplitude">nn::hid::VibrationMixMode_MaxAmplitude</span></code>, which uses the vibration value that has the largest amplitude, or <code><span class="ApiLink_nn__hid__VibrationMixMode_AmplitudeSum">nn::hid::VibrationMixMode_AmplitudeSum</span></code>, which takes the sum of all the amplitudes.<br /><br /><br />This section describes how to choose between the two modes.</p>
<h2 id="Anchor_323663455_h2_2">VibrationMixMode_AmplitudeSum</h2>
<p>This mix mode takes the sum of all the input amplitudes.<br />It is an effective way to represent small, overlapping vibrations.</p>
<p>
  <br />
</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_323663455/323663450.png" width="600" class="embedded-image" />
  </span>
</p>
<p>
  <br />
</p>
<p>For example, you could use this to represent the vibrations caused by a large number of small rocks falling to the ground.<br />This mix mode allows you to add all the small impact vibrations together.<br />A single vibration is small, but multiple simultaneous vibrations produce a proportionally large response.</p>
<p>The SDK includes <span class="ApiLink_NN_APILINK_HID_VIB_GENERATOR">Generating Simple Vibration Waveforms From Parameters</span> (<code>Samples/Sources/Applications/HidVibrationGenerator</code>). The sample application lets you experience vibration whenever you touch a line; this feedback is more pronounced when you touch more than one line at a time.<br /></p>
<p>If two strong vibrations overlap, however, they produce a waveform with the maximum amplitude. As a result, it is impossible to tell whether one or two large vibrations have occurred.<br /><br />The next method, <code><span class="ApiLink_nn__hid__VibrationMixMode_MaxAmplitude">nn::hid::VibrationMixMode_MaxAmplitude</span></code>, is effective in situations like these.</p>
<h2 id="Anchor_323663455_h2_3">VibrationMixMode_MaxAmplitude </h2>
<p>This mix mode takes the input vibration value with the largest amplitude.<br />It is useful when you only want to select the strongest vibration.</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_323663455/323663451.png" width="600" class="embedded-image" />
  </span>
</p>
<p>
  <br />
</p>
<p>For example, you could use this mode to provide vibration for damage and vehicular movement.<br />If these are both strong vibrations and they occur at the same time, <code><span class="ApiLink_nn__hid__VibrationMixMode_MaxAmplitude">nn::hid::VibrationMixMode_MaxAmplitude</span></code> causes the amplitude to be capped at its maximum value and makes it impossible to determine the source of the vibration.<br /><br />In that situation, you can use this mix mode to play back only the strongest vibration.</p>
<p>If damage produces a stronger vibration than a vehicle, only the former&rsquo;s vibration will be played when damage is incurred and only the latter&rsquo;s vibration will be played when the vehicle is in motion.<br /><br />This allows you to emphasize the most important gameplay elements.</p>
<p>If you are not sure which mix mode to use, we recommend starting off with <code><span class="ApiLink_nn__hid__VibrationMixMode_AmplitudeSum">nn::hid::VibrationMixMode_AmplitudeSum</span></code> and then switching to <code><span class="ApiLink_nn__hid__VibrationMixMode_MaxAmplitude">nn::hid::VibrationMixMode_MaxAmplitude</span></code> if you encounter any problems.<br /></p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
<p>&nbsp;</p>
<hr />
<p>CONFIDENTIAL</p>
</div>
</div>
<!--AddLink-->
<script>
var NintendoSdkApiRefernce = {
    idMap: {},
    linkRewrite: function ()
    {
        var idMap = NintendoSdkApiRefernce.idMap;
        function rewrite(el)
        {
            var e = idMap[el.className];
            if (e === undefined)
            {
                return;
            }
            var html = '';
            html += '<a href=';
            html += e.url;
            html += ' target="_blank" rel="noopener noreferrer" >';
            html += el.innerHTML;
            html += '</a>';
            el.innerHTML = html;
        }
        var apiLinkElems = document.querySelectorAll('span[class*="ApiLink_"]');
        for (var i = 0, n = apiLinkElems.length; i< n; ++i) {
            rewrite(apiLinkElems[i]);
        }
    }
};
function SetUrl( id, url )
{
    NintendoSdkApiRefernce.idMap[id] = { url: url };
}
SetUrl( 'ApiLink_nn__hid__VibrationModulation', '../../../Api/HtmlNX/structnn_1_1hid_1_1_vibration_modulation.html' )
SetUrl( 'ApiLink_NN_APILINK_HID_VIB_PLAY', '../../../Api/HtmlNX/_page_sample_hid_vibration_player.html' )
SetUrl( 'ApiLink_NN_APILINK_HID_VIB_ROLLINGBALL', '../../../Api/HtmlNX/_page_sample_hid_vibration_rolling_ball.html' )
SetUrl( 'ApiLink_nn__hid__VibrationPlayer', '../../../Api/HtmlNX/classnn_1_1hid_1_1_vibration_player.html' )
SetUrl( 'ApiLink_nn__hid__VibrationPlayer__Play', '../../../Api/HtmlNX/classnn_1_1hid_1_1_vibration_player.html#a998b9abac8dec9e28679982c650d8479' )
SetUrl( 'ApiLink_nn__hid__VibrationNodeConnection', '../../../Api/HtmlNX/classnn_1_1hid_1_1_vibration_node_connection.html' )
SetUrl( 'ApiLink_nn__hid__VibrationMixer', '../../../Api/HtmlNX/classnn_1_1hid_1_1_vibration_mixer.html' )
SetUrl( 'ApiLink_nn__hid__VibrationMixMode', '../../../Api/HtmlNX/namespacenn_1_1hid.html#adc165fa9fa37eeefe20379b2998e917d' )
SetUrl( 'ApiLink_nn__hid__VibrationMixMode_MaxAmplitude', '../../../Api/HtmlNX/namespacenn_1_1hid.html#adc165fa9fa37eeefe20379b2998e917da1797c669c6e76af275b3b3d2020f9c59' )
SetUrl( 'ApiLink_nn__hid__VibrationMixMode_AmplitudeSum', '../../../Api/HtmlNX/namespacenn_1_1hid.html#adc165fa9fa37eeefe20379b2998e917da76ca4048abcea197549c5c5d534e7927' )
SetUrl( 'ApiLink_NN_APILINK_HID_VIB_GENERATOR', '../../../Api/HtmlNX/_page_sample_hid_vibration_generator.html' )

NintendoSdkApiRefernce.linkRewrite();
</script>
<!--AddLink-->
</body>
</html>

<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<script type="text/javascript" src="../tocDataApi.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>Support for Shader Model 5.0 | NintendoSDK Documents</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="text-align: center;"><img src="../template/img/noscript.svg" /></div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- Support for Shader Model 5.0 -->
<div class="pagetitle" id="PageId_202545788">Support for Shader Model 5.0</div>
<div class="text_separate">
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_202545788_h1_1">Support for Shader Model 5.0 </a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_202545788_h2_1">Intrinsic functions</a>
      </li>
      <li>
        <a href="#Anchor_202545788_h2_2">Interlocked intrinsics</a>
      </li>
      <li>
        <a href="#Anchor_202545788_h2_3">StructuredBuffer, RWStructuredBuffer</a>
      </li>
      <ul>
        <li>
          <a href="#Anchor_202545788_h3_1">Declaration</a>
        </li>
        <li>
          <a href="#Anchor_202545788_h3_2">Access</a>
        </li>
        <li>
          <a href="#Anchor_202545788_h3_3">Declaring and Accessing a User-Defined Structure</a>
        </li>
      </ul>
      <li>
        <a href="#Anchor_202545788_h2_4">ByteAddressBuffer, RWByteAddressBuffer</a>
      </li>
      <ul>
        <li>
          <a href="#Anchor_202545788_h3_4">Member Functions</a>
        </li>
        <ul>
          <li>
            <a href="#Anchor_202545788_h4_1">ByteAddressBuffer</a>
          </li>
          <li>
            <a href="#Anchor_202545788_h4_2">RWByteAddressBuffer</a>
          </li>
        </ul>
      </ul>
      <li>
        <a href="#Anchor_202545788_h2_5">Notes</a>
      </li>
      <ul>
        <li>
          <a href="#Anchor_202545788_h3_5">The ByteAddressBuffer address cannot be used as a return value for functions at the present time.</a>
        </li>
        <li>
          <a href="#Anchor_202545788_h3_6">Conversion cannot be performed correctly if the type conversion and operator precedence are complicated.</a>
        </li>
        <li>
          <a href="#Anchor_202545788_h3_7">AppendStructuredBuffer is not supported.</a>
        </li>
      </ul>
    </ul>
  </ul>
</p>
<h1 id="Anchor_202545788_h1_1">Support for Shader Model 5.0 </h1>
<p>SLConverter has partial support for Shader Model 5.0 instructions.</p>
<p>Read below to see what is supported.</p>
<h2 id="Anchor_202545788_h2_1">Intrinsic functions</h2>
<p>SLConverter supports the following intrinsic functions.</p>
<table class="table">
  <tbody>
    <tr>
      <th>HLSL</th>
      <th>GLSL</th>
    </tr>
    <tr>
      <td>asint</td>
      <td>floatBitsToInt</td>
    </tr>
    <tr>
      <td>asuint</td>
      <td>floatBitsToUInt</td>
    </tr>
    <tr>
      <td>ddx_coarse</td>
      <td>dFdxCoarse</td>
    </tr>
    <tr>
      <td>ddx_fine</td>
      <td>dFdxFine</td>
    </tr>
    <tr>
      <td>countbits</td>
      <td>bitCount</td>
    </tr>
    <tr>
      <td>fma</td>
      <td>fma</td>
    </tr>
    <tr>
      <td>mad</td>
      <td>fma</td>
    </tr>
    <tr>
      <td>reversebits</td>
      <td>bitfieldReverse</td>
    </tr>
    <tr>
      <td>f16tof32</td>
      <td>unpackHalf2x16</td>
    </tr>
  </tbody>
</table>
<p>The following are not supported because there are no corresponding GLSL instructions for the HLSL instructions.</p>
<ul style="list-style-type: square;">
  <li>dst</li>
  <li>firstbithigh</li>
  <li>firstbitlow</li>
  <li>f32tof16</li>
  <li>msad4</li>
  <li>rcp</li>
</ul>
<h2 id="Anchor_202545788_h2_2">Interlocked intrinsics</h2>
<p>SLConverter supports the following interlocked intrinsics.</p>
<table class="table">
  <tbody>
    <tr>
      <th>HLSL</th>
      <th>GLSL</th>
    </tr>
    <tr>
      <td>
        <p>InterlockedAdd</p>
      </td>
      <td>
        <p>AtomicAdd</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>InterlockedAnd</p>
      </td>
      <td>
        <p>AtomicAnd</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>InterlockedCompareExchange</p>
      </td>
      <td>
        <p>AtomicCompSwap</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>InterlockedExchange</p>
      </td>
      <td>
        <p>AtomicExchange</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>InterlockedMax</p>
      </td>
      <td>
        <p>AtomicMax</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>InterlockedMin</p>
      </td>
      <td>
        <p>AtomicMin</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>InterlockedOr</p>
      </td>
      <td>
        <p>AtomicOr</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>InterlockedXor</p>
      </td>
      <td>
        <p>AtomicXor</p>
      </td>
    </tr>
  </tbody>
</table>
<p>The following are not supported because there are no corresponding GLSL instructions for the HLSL instructions.</p>
<ul style="list-style-type: square;">
  <li>InterlockedCompareStore</li>
</ul>
<p> </p>
<div>
  <h2 id="Anchor_202545788_h2_3">StructuredBuffer, RWStructuredBuffer</h2>
</div>
<p>
  <code>StructuredBuffer</code>/<code>RWStructuredBuffer</code> are converted to <code>ARB_shader_structured_buffer_object</code> (SSBOs), as described below.</p>
<ul style="list-style-type: square;">
  <li>When the SSBO is created, it is defined as <code><em>variable name</em> + _dec</code> so that the object is given a type name.</li>
  <li>The data is created inside <code>data[]</code>.</li>
</ul>
<h3 id="Anchor_202545788_h3_1">Declaration</h3>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>StructuredBuffer&lt;float&gt; mySB:reg;</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>layout(binding=reg, std430) buffer mySB_dec {
&nbsp;&nbsp;&nbsp;&nbsp;float data[];
}mySB;</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<h3 id="Anchor_202545788_h3_2">Access</h3>
<table class="table">
  <tbody>
    <tr>
      <th>HLSL</th>
      <th>GLSL</th>
    </tr>
    <tr>
      <td>mySB[index]</td>
      <td>mySB.data[index]</td>
    </tr>
  </tbody>
</table>
<h3 id="Anchor_202545788_h3_3">Declaring and Accessing a User-Defined Structure</h3>
<p>To use a structure like the one shown below, that has been defined by the user, declare and access it in the following way.</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>struct MyStruct{
&nbsp;&nbsp;&nbsp;&nbsp;float fValue;
&nbsp;&nbsp;&nbsp;&nbsp;matrix mat;
};</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<table class="table">
  <tbody>
    <tr>
      <th> </th>
      <th>HLSL</th>
      <th>GLSL</th>
    </tr>
    <tr>
      <td>Declarations</td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>StructuredBuffer&lt;MyStruct&gt; mySB;</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>layout(binding=reg, std430) buffer mySB_dec {
&nbsp;&nbsp;&nbsp;&nbsp;MyStruct data[];
}mySB;</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
    </tr>
    <tr>
      <td>Access</td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>mySB[index].fValue;
mySB[index].mat;</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>mySB.data[index].fValue;
mySB.data[index].mat;</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
    </tr>
    <tr>
      <td>Member Functions</td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>mySB.GetDimensions(numStruct, stride);</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>numStruct = mySB.data.length();</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
        <p>GLSL cannot get the bind size of a data type, so it is not assigned to <code>stride</code>.</p>
      </td>
    </tr>
  </tbody>
</table>
<p> </p>
<h2 id="Anchor_202545788_h2_4">ByteAddressBuffer, RWByteAddressBuffer</h2>
<p>
  <code>ByteAddressBuffer </code>/ <code>RWByteAddressBuffer</code> are converted to SSBOs in the same way as <code>StructuredBuffer</code>.</p>
<table class="table">
  <tbody>
    <tr>
      <th> </th>
      <th>HLSL</th>
      <th>GLSL</th>
    </tr>
    <tr>
      <td>Declarations</td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>RWByteAddresBuffer myBAB;</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>layout(binding=reg, std430) buffer myBAB_dec {
&nbsp;&nbsp;&nbsp;&nbsp;uint data[];
}myBAB;</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
    </tr>
    <tr>
      <td>Access</td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>uint index = xxxx * 4;
myBAB[index];</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>uint index = xxxx * 4;
myBAB.data[index/4];</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
        <ul style="list-style-type: square;">
          <li>In HLSL, access to <code>ByteAddressBuffer</code> is byte type and it is assumed that the index specifier is an integer multiple of 4, so the value is divided by 4 in GLSL.</li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
<h3 id="Anchor_202545788_h3_4">Member Functions</h3>
<h4 id="Anchor_202545788_h4_1">ByteAddressBuffer</h4>
<table class="table">
  <tbody>
    <tr>
      <th>Function Name</th>
      <th>HLSL</th>
      <th>GLSL</th>
    </tr>
    <tr>
      <td>
        <p>GetDimensions</p>
      </td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>myBAB.GetDimensions( uint numStruct );</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>numStruct = myBAB.data.length();</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
    </tr>
    <tr>
      <td> Load-Load4</td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>uint ret = myBAB.Load( uint address );</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>uint ret = myBAB.data[uint address/4];</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
    </tr>
  </tbody>
</table>
<h4 id="Anchor_202545788_h4_2">RWByteAddressBuffer</h4>
<table class="table">
  <tbody>
    <tr>
      <th>Function Name</th>
      <th>HLSL</th>
      <th>GLSL</th>
    </tr>
    <tr>
      <td>
        <p>Interlocked instructions</p>
        <p>(Supports the instructions listed <a href="#Anchor_202545788_h2_2">here</a>.)</p>
        <p> </p>
      </td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>myBAB.InterlockedXXX( uint dest, uint value, uint original_value);</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>uint original_value = AtomicXXX( myBAB.data[dest],value);</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
    </tr>
    <tr>
      <td>Store-Store4</td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>myBAB.Store( uint address, value);</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
      <td>
        <table class="codeblock">
          <tbody>
            <tr>
              <td class="code">
                <div class="codeblock"><pre>myBAB.data[address] = value;</pre></div>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
    </tr>
  </tbody>
</table>
<h2 id="Anchor_202545788_h2_5">Notes</h2>
<h3 id="Anchor_202545788_h3_5">The ByteAddressBuffer address cannot be used as a return value for functions at the present time.</h3>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>ByteAddressBuffer.Load( hoge(x) );            // NG
ByteAddressBuffer.Load( uint address );        // OK</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<h3 id="Anchor_202545788_h3_6">
  <br />Conversion cannot be performed correctly if the type conversion and operator precedence are complicated.</h3>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>uint2 value;
float4(f16tof32(value),f16tof32(value &gt;&gt; 16));     // NG
&nbsp;
uint2 rshift = uint2(16);
float4(f16tof32(value),f16tof32(value &gt;&gt; rshift)); // OK</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<h3 id="Anchor_202545788_h3_7">
  <br />AppendStructuredBuffer is not supported.</h3>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
<p>&nbsp;</p>
<hr />
<p>CONFIDENTIAL</p>
</div>
</div>
</body>
</html>

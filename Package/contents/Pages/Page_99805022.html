<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<script type="text/javascript" src="../tocDataApi.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>OpusEncoder | NintendoSDK Documents</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="text-align: center;"><img src="../template/img/noscript.svg" /></div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- OpusEncoder -->
<div class="pagetitle" id="PageId_99805022">OpusEncoder</div>
<div class="text_separate">
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_99805022_h1_1">Overview</a>
    </li>
    <li>
      <a href="#Anchor_99805022_h1_2">How to Use</a>
    </li>
    <li>
      <a href="#Anchor_99805022_h1_3">Important Information</a>
    </li>
  </ul>
</p>
<h1 id="Anchor_99805022_h1_1">Overview</h1>
<p>OpusEncoder is a PC tool for encoding the input PCM data in the Opus format. It is located in <code>Tools/Codec/AudioCodec/</code>.</p>
<p>This tool is dependent on the following DLLs. These are contained in NintendoSDK.</p>
<ul>
  <li>
    <code>Tools/Codec/AudioCodec/AudioCodec.dll</code>
  </li>
  <li>
    <code>Tools/Codec/AudioCodec/ToolFoundation.dll</code>
  </li>
  <li>
    <code>Tools/Codec/AudioCodec/GameToolFoundation.dll</code>
  </li>
</ul>
<p>The core portion of the output Opus data is in the regular Opus format, but the headers are in the proprietary Nintendo format.</p>
<h1 id="Anchor_99805022_h1_2">How to Use</h1>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>OpusEncoder.exe: Converts a waveform file to Opus data.

How to use: OpusEncoder.exe [-o&lt;output-filepath&gt;] [--bitrate=&lt;bitrate&gt;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[--framesize=&lt;framesize&gt;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[--bitrate-control=&lt;bitrate-control&gt;] [-v]  [--disable-prediction]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input-filepath&gt;

Available Arguments:
&nbsp;&nbsp;-o, --output &lt;output-filepath&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specifies the output file. If nothing is specified,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the output file is named the same as the input file, but with the extension changed to .opus.
&nbsp;&nbsp;--bitrate &lt;bitrate&gt;       Specify the bit rate in bits per second. &lt;6000 - 510000&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Default value: 96000]
&nbsp;&nbsp;--framesize &lt;framesize&gt;    Specify the frame size in milliseconds. 2.5, 5, 10, 20 may be specified in celt mode, 
while 10, 20 may be specified in silk mode.
&nbsp;[Default value: 20]
&nbsp;&nbsp;--bitrate-control &lt;bitrate-control&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specifies how to control the bit rate. cbr (constant bit rate)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vbr (variable bit rate)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cvbr (constrained variable bit rate) [Default value:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cvbr]
&nbsp;&nbsp;--coding-mode &lt;coding-mode&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specifies the audio coding mode. You can specify either 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;celt, for the encryption mode for music source files, or 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;silk, for the encryption mode for voice source files. [Default value: celt]
&nbsp;&nbsp;-v, --verbose              Generates a detailed log.
&nbsp;&nbsp;--disable-prediction       Disables the prediction feature in CELT mode.
&nbsp;&nbsp;--complexity &lt;complexity&gt;  The opus complexity level. You can specify 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values from 0 to 10. [Default value: 10]
&nbsp;&nbsp;&lt;input-filepath&gt;           Specifies the input file.</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<h2 id="Anchor_99805022_h2_1">Multistream Support</h2>
<p>It is a feature for encoding sound sources with three or more channels. Opus encoding operates on individual streams. Up to two channels of sound data are encoded in a single stream. To encode a sound source with three or more channels, Opus data comprised of two or more streams is created. This data is called multistream Opus data.</p>
<p>This multistream Opus data can be decoded using <code><span class="ApiLink_nn__codec__OpusMultiStreamDecoder">nn::codec::OpusMultiStreamDecoder</span>.</code> For more information, see the <span class="ApiLink_PageSampleCodecOpusMultiStreamDecoder">opus multistream decoder sample</span>.</p>
<h2 id="Anchor_99805022_h2_2">Options</h2>
<h3 id="Anchor_99805022_h3_1">--bitrate</h3>
<p>Specifies the bit rate for compressed Opus packets.</p>
<p>Note the following.</p>
<ul>
  <li>The header is unique, so the actual bit rate is higher than the specified value.</li>
  <li>The maximum bit rate differs for mono and stereo audio sources.<ul><li>The maximum bit rate that can be specified for mono is 300 kbps, while the maximum for stereo is 510 kbps.</li></ul></li>
</ul>
<h3 id="Anchor_99805022_h3_2">--framesize</h3>
<p>Specifies the frame length for Opus packets, in milliseconds.</p>
<p>Note the following.</p>
<ul>
  <li>If you are using <code><span class="ApiLink_nn__codec__HardwareOpusDecoder">nn::codec::HardwareOpusDecoder</span></code>, each call to the <code><span class="ApiLink_nn__codec__HardwareOpusDecoder__DecodeInterleaved">nn::codec::HardwareOpusDecoder::DecodeInterleaved</span>()</code> function creates overhead.<br />When a longer frame length is used for audio encoding, more samples can be decoded at a time, and this reduces the overhead associated with calling the decode functions.<ul><li><code><span class="ApiLink_nn__codec__OpusDecoder">nn::codec::OpusDecoder</span></code> is a library so there is only minor overhead and this does not apply.</li></ul></li>
</ul>
<h3 id="Anchor_99805022_h3_3">--bitrate-control</h3>
<p>Specifies the bit rate control mode for Opus packets.</p>
<ul>
  <li>vbr (variable bit rate)<br />Encodes more efficiently than other modes.<br />Encoding matches the average bit rate to the specified bit rate.<br />The bit rate at the frame level might not always match the specified bit rate.</li>
  <li>cvbr (constrained variable bit rate)<br />This mode is the same as &quot;CBR&quot; mode for MP3 and AAC.<br />Encoding matches the average bit rate to the specified bit rate.<br />The bit rate at the frame level might not always match the specified bit rate.</li>
  <li>cbr (constant bit rate)<br />Data is encoded so that the bit rate in every frame matches the specified bit rate.</li>
</ul>
<p>For more information, see <a href="https://tools.ietf.org/html/rfc6716">2.1.8. Constant/Variable Bit Rate</a> in the Opus codec RFC <a href="https://tools.ietf.org/html/rfc6716#section-2.1.8">documentation (RFC6716)</a>.</p>
<h3 id="Anchor_99805022_h3_4">--coding-mode</h3>
<p>Specifies the coding mode for Opus packets.</p>
<p>Note the following.</p>
<ul>
  <li>In <code>silk</code> coding mode, the bandwidth in the encoder is set to 16 kHz (Nyquist frequency of 8 kHz).<ul><li>In <code>celt</code> coding mode, the bandwidth is a maximum of 48 kHz (Nyquist frequency of 20 kHz).</li></ul></li>
</ul>
<h3 id="Anchor_99805022_h3_5">--disable-prediction</h3>
<p>Disables the prediction feature in CELT mode.</p>
<p>Disabling the prediction feature may negatively affect the output audio quality. For example, if you encode a local signal such as a sine wave in the frequency domain, noise may be produced as a result of the decoding process.</p>
<p>On the other hand, the prediction feature can be helpful when playback begins in the middle of a file, such as during random seeks and loop playback.</p>
<ul>
  <li>When the prediction feature is enabled, beginning playback in the middle of a file may produce noise and short fades if you do not start decoding at the Opus frame equivalent to 3,840 samples in advance.<ul><li>When the frame size is 20 milliseconds, this setting is equivalent to decoding 4 opus frames in advance.</li></ul></li>
  <li>When the prediction feature is disabled, beginning playback in the middle of a file does not produce noise or short fades if you start decoding one Opus frame in advance.<ul><li>In addition, beginning decoding at an earlier Opus frame as described previously is not expected to be required if playback does not begin near either end of an Opus frame as measured by the position of the unencoded sample.<ul><li>If the frame size is 20 milliseconds, it is probably sufficient to avoid the 120 samples (the value of <code><em>preSkipCount</em></code>) on either end of the frame.</li></ul></li></ul></li>
</ul>
<p>For run-time implementation examples, see the <code>CodecOpusDecoder</code> sample projects.</p>
<h3 id="Anchor_99805022_h3_6">--complexity</h3>
<p>Specifies the complexity level for opus.</p>
<p>You can specify any integer value between 0 and 10 for <code>complexity level</code>. Specifying a larger value improves the sound quality, but also tends to increase the processing load.<br /><em>Processing load</em> refers to both the processing time of the OpusEncoder tool and the processing time of the <code><span class="ApiLink_nn__codec__OpusDecoder">nn::codec::OpusDecoder</span></code> class or the <code><span class="ApiLink_nn__codec__HardwareOpusDecoder">nn::codec::HardwareOpusDecoder</span></code> class of the <code>codec</code> library, which perform the decoding.<br />The actual sound quality and processing time vary depending on the sound source, so measure and check if necessary.</p>
<p>The default is <code>10</code>.</p>
<h2 id="Anchor_99805022_h2_3">Usage Examples</h2>
<h3 id="Anchor_99805022_h3_7">Encoding Input.wav as Output.opus</h3>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>$ OpusEncoder.exe -o output.opus input.wav </pre></div>
      </td>
    </tr>
  </tbody>
</table>
<h3 id="Anchor_99805022_h3_8">Specifying the Bit Rate and Frame Size and Encoding</h3>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>$ OpusEncoder.exe --bitrate=48000 --framesize=10 input.wav </pre></div>
      </td>
    </tr>
  </tbody>
</table>
<h1 id="Anchor_99805022_h1_3">Important Information</h1>
<ul>
  <li>Depending on the opus specification, the input wave sampling rate must be 48000 Hz, 24000 Hz, 16000 Hz, 12000 Hz, or 8000 Hz.</li>
  <li>Depending on the parameters, clipping noise may be generated when the encoded results are decoded.<ul><li>As a workaround, lower the amplitude of the source waveforms used as input.</li></ul></li>
</ul>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
<p>&nbsp;</p>
<hr />
<p>CONFIDENTIAL</p>
</div>
</div>
<!--AddLink-->
<script>
var NintendoSdkApiRefernce = {
    idMap: {},
    linkRewrite: function ()
    {
        var idMap = NintendoSdkApiRefernce.idMap;
        function rewrite(el)
        {
            var e = idMap[el.className];
            if (e === undefined)
            {
                return;
            }
            var html = '';
            html += '<a href=';
            html += e.url;
            html += ' target="_blank" rel="noopener noreferrer" >';
            html += el.innerHTML;
            html += '</a>';
            el.innerHTML = html;
        }
        var apiLinkElems = document.querySelectorAll('span[class*="ApiLink_"]');
        for (var i = 0, n = apiLinkElems.length; i< n; ++i) {
            rewrite(apiLinkElems[i]);
        }
    }
};
function SetUrl( id, url )
{
    NintendoSdkApiRefernce.idMap[id] = { url: url };
}
SetUrl( 'ApiLink_nn__codec__OpusMultiStreamDecoder', '../../../Api/HtmlNX/classnn_1_1codec_1_1_opus_multi_stream_decoder.html' )
SetUrl( 'ApiLink_PageSampleCodecOpusMultiStreamDecoder', '../../../Api/HtmlNX/_page_sample_codec_opus_multi_stream_decoder.html' )
SetUrl( 'ApiLink_nn__codec__HardwareOpusDecoder', '../../../Api/HtmlNX/classnn_1_1codec_1_1_hardware_opus_decoder.html' )
SetUrl( 'ApiLink_nn__codec__HardwareOpusDecoder__DecodeInterleaved', '../../../Api/HtmlNX/classnn_1_1codec_1_1_hardware_opus_decoder.html#a5c5b85cf56d335ec26ce5a8947adf46c' )
SetUrl( 'ApiLink_nn__codec__OpusDecoder', '../../../Api/HtmlNX/classnn_1_1codec_1_1_opus_decoder.html' )

NintendoSdkApiRefernce.linkRewrite();
</script>
<!--AddLink-->
</body>
</html>

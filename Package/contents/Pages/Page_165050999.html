<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<script type="text/javascript" src="../tocDataApi.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>Pointing Mode | NintendoSDK Documents</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="text-align: center;"><img src="../template/img/noscript.svg" /></div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- Pointing Mode -->
<div class="pagetitle" id="PageId_165050999">Pointing Mode</div>
<div class="text_separate">
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_165050999_h1_1">Introduction</a>
    </li>
    <li>
      <a href="#Anchor_165050999_h1_2">Pointing Mode</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_165050999_h2_1">Overview</a>
      </li>
      <ul>
        <li>
          <a href="#Anchor_165050999_h3_1">Retroreflective Bar Specifications</a>
        </li>
      </ul>
      <li>
        <a href="#Anchor_165050999_h2_2">Settings</a>
      </li>
      <li>
        <a href="#Anchor_165050999_h2_3">Output Format</a>
      </li>
    </ul>
    <li>
      <a href="#Anchor_165050999_h1_3">Using Pointing Mode</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_165050999_h2_4">Sample of Pointing Mode</a>
      </li>
    </ul>
  </ul>
</p>
<h1 id="Anchor_165050999_h1_1">Introduction</h1>
<p>Pointing mode is the mode for pointing to the screen using the IR Motion Camera by detecting a retroreflective bar placed in the vicinity of the screen.</p>
<div class="note_new">
  <div class="note_new_left">Note</div>
  <div class="note_new_right">
    <p>The retroreflective bar you are using will not support pointing mode if it does not meet the specifications required by the <code>irsensor</code> library.<br />If a retroreflective bar is used with the retail product, you must check with the IR Motion Camera development team at Nintendo in advance and receive confirmation when mastering your content.</p>
  </div>
</div>
<h1 id="Anchor_165050999_h1_2">Pointing Mode</h1>
<h2 id="Anchor_165050999_h2_1">Overview</h2>
<p>Detection of a retroreflective bar with reflective materials set at three points along the bar. The coordinates of these three points are used to calculate a center that serves as the pointing coordinates.</p>
<div class="info_new">
  <div class="info_new_left">Info</div>
  <div class="info_new_right">
    <p>Retroreflective material is designed to efficiently reflect light back in the same direction from which it came. By shining the light from a point light source like the IR Motion Camera and capturing the reflected light with an IR camera, this material can serve as a marker for a specific point.<br />As the reflection efficiency of the material increases, the distance from the bar at which light is detected also increases.</p>
  </div>
</div>
<p>For more information about the coordinate system for the data that is output, see <a href="../Pages/Page_112902609.html#Anchor_112902609_h2_8">IR Motion Camera Coordinate System</a>.</p>
<h3 id="Anchor_165050999_h3_1">Retroreflective Bar Specifications</h3>
<p>The following image shows the hardware configuration. The height is 1 cm. This bar is placed in the vicinity of the screen that is the pointing target. (For example, on top of the screen.)<br />The areas depicted in light gray can generate noise, so try to use materials that reflect as little light as possible for these parts of the bar.</p>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_165050999/258028150.png" height="187" class="embedded-image" />
  </span>
</p>
<p>In addition, you must select a retroreflective material that can be discerned from at least 4 meters.</p>
<p>The following image shows an example of a bar.</p>
<ul style="list-style-type: square;">
  <li>Left photo: A self-standing retroreflective bar made from plastic</li>
  <li>Right photo: Placement of the retroreflective bar on top of a monitor.</li>
</ul>
<p>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_165050999/258036485.JPG" height="250" class="embedded-image" />
  </span>
  <span class="embedded-file-wrapper ">
    <img src="../Attachments/Attach_165050999/258036458.JPG" height="250" class="embedded-image" />
  </span>
</p>
<div class="info_new">
  <div class="info_new_left">Info</div>
  <div class="info_new_right">
    <p>The <code>irsensor</code> library is guaranteed to operate with a bar that satisfies the specifications prescribed above. Contact the development team if you have questions.</p>
  </div>
</div>
<h2 id="Anchor_165050999_h2_2">Settings</h2>
<p>In pointing mode, there are no settings that can be configured by the application. Parameters like the adjustment of camera brightness that accompany changes in the distance between the controller and the retroreflective bar are configured automatically by the system.</p>
<p> The only thing that the application can do is call the <code><span class="ApiLink_nn__irsensor__RunPointingProcessor">nn::irsensor::RunPointingProcessor</span></code> function to activate pointing mode.</p>
<h2 id="Anchor_165050999_h2_3">Output Format</h2>
<p>In pointing mode, data is output in the following formats.</p>
<table class="wrapped">
  <colgroup>
    <col />
    <col />
    <col />
  </colgroup>
  <tbody>
    <tr>
      <th>Item</th>
      <th>Description</th>
      <th>Value Range</th>
    </tr>
    <tr>
      <td>
        <code>samplingNumber</code>
      </td>
      <td>Value that increases each time processed results are received.</td>
      <td>0 or greater</td>
    </tr>
    <tr>
      <td>timeStamp</td>
      <td>
        <p>The time that has elapsed since the last data set was obtained.</p>
      </td>
      <td>0 or greater</td>
    </tr>
    <tr>
      <td>pointingStatus</td>
      <td>The status of the detected pointing coordinates.<br />If the status is abnormal, the cause of the error is output.</td>
      <td>PointingStatus_DataValid,<br />PointingStatus_LackOfObjects</td>
    </tr>
    <tr>
      <td>
        <p>
          <code>position</code>
        </p>
      </td>
      <td>The normalized pointing coordinates.<br />Values are normalized to have the center at (0.0f, 0.0f), the upper-right corner at (1.0f, 1.0f), and an aspect ratio of 4:3.</td>
      <td>(-1.0, -1.0) to (1.0, 1.0)</td>
    </tr>
  </tbody>
</table>
<p>The details for each cluster are stored in the following format.</p>
<p>These output values are stored as members of the <code><span class="ApiLink_nn__irsensor__PointingProcessorState">nn::irsensor::PointingProcessorState</span></code> structure.</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre><span class="k">struct</span> <span class="n">PointingProcessorState</span>
<span class="p">{</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">int64_t</span> <span class="n">samplingNumber</span><span class="p">;</span>                            <span class="c1">//!&lt; A value of 0 or greater, which increments each time processed results are received from the pointing processor.
</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">::</span><span class="nn">nn::</span><span class="n">TimeSpanType</span> <span class="n">deltaTime</span><span class="p">;</span>   <span class="c1">//!&lt; Information about the time from when the process started to when the results were obtained. The difference from the time span of past data is calculated and used. (This value is 0 or greater.)
</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">PointingStatus</span> <span class="n">pointingStatus</span><span class="p">;</span>  <span class="c1">//!&lt; The status of the detected pointing data.
</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">::</span><span class="nn">nn::util::</span><span class="n">Float2</span> <span class="n">position</span><span class="p">;</span>    <span class="c1">//!&lt; The normalized pointing position coordinates. (Values are normalized to have the center at (0.0f, 0.0f), the upper-right corner at (1.0f, 1.0f), and an aspect ratio of 4:3.)
</span></pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>To get the output data, call the <code><span class="ApiLink_nn__irsensor__GetPointingProcessorStates">nn::irsensor::GetPointingProcessorStates</span></code> function and pass it a buffer for the output format.</p>
<h1 id="Anchor_165050999_h1_3">Using Pointing Mode</h1>
<p>To use pointing mode, follow this basic workflow.</p>
<ol>
  <li>
    <p>Get <code><span class="ApiLink_nn__irsensor__IrCameraHandle">nn::irsensor::IrCameraHandle</span></code> for the specified <code><span class="ApiLink_nn__hid__NpadIdType">nn::hid::NpadIdType</span></code>, and initialize the IR Motion Camera.</p>
    <table class="codeblock">
      <tbody>
        <tr>
          <td class="code">
            <div class="codeblock"><pre><span class="cp">#include &lt;nn/irsensor.h&gt;
</span>
<span class="nn">nn::irsensor::</span><span class="n">IrCameraHandle</span> <span class="n">handle</span> <span class="o">=</span> <span class="nn">nn::irsensor::</span><span class="n">GetIrCameraHandle</span><span class="p">(</span><span class="n">npadIdType</span><span class="p">);</span>
<span class="nn">nn::irsensor::</span><span class="n">Initialize</span><span class="p">(</span><span class="n">handle</span><span class="p">);</span></pre></div>
          </td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>To begin capture, call the <code><span class="ApiLink_nn__irsensor__RunPointingProcessor">nn::irsensor::RunPointingProcessor</span></code> function and specify the obtained <code><span class="ApiLink_nn__irsensor__IrCameraHandle">nn::irsensor::IrCameraHandle</span></code> as an argument.</p>
    <table class="codeblock">
      <tbody>
        <tr>
          <td class="code">
            <div class="codeblock"><pre>&nbsp;<span class="nn">nn::irsensor::</span><span class="n">RunPointingProcessor</span><span class="p">(</span><span class="n">handle</span><span class="p">);</span></pre></div>
          </td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>Prepare a buffer for <code><span class="ApiLink_nn__irsensor__PointingProcessorState">nn::irsensor::PointingProcessorState</span></code> and call the <code><span class="ApiLink_nn__irsensor__GetPointingProcessorStates">nn::irsensor::GetPointingProcessorStates</span></code>function.  <br /> The <code><span class="ApiLink_nn__irsensor__GetClusteringProcessorStates">nn::irsensor::GetClusteringProcessorStates</span></code> function can get up to <code><span class="ApiLink_nn__irsensor__ClusteringProcessorStateCountMax">nn::irsensor::ClusteringProcessorStateCountMax</span></code> processed results at one time.<br />The latest processed results as of the time the function call was made are retrieved. However, the results are updated at intervals of 15 milliseconds or less due to the restrictions on the speed of data transfer via the controller&rsquo;s Bluetooth module. As a result, we recommend practices such as polling the results to be obtained in synchronization with the game frames.<br /><br />The data is refreshed at 5-millisecond intervals internally, so ideally you can get three sets of new data during that 15-millisecond interval.<br />We recommend getting more information when you are drawing trajectories and the like.</p>
    <table class="codeblock">
      <tbody>
        <tr>
          <td class="code">
            <div class="codeblock"><pre><span class="nn">nn::irsensor::</span><span class="n">PointingProcessorState</span> <span class="n">state</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">count</span><span class="p">;</span>
<span class="nn">nn::irsensor::</span><span class="n">GetPointingProcessorStates</span><span class="p">(</span><span class="o">&amp;</span><span class="n">state</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">count</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">handle</span><span class="p">);</span></pre></div>
          </td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>To stop pointing mode, call the <code><span class="ApiLink_nn__irsensor__StopImageProcessor">nn::irsensor::StopImageProcessor</span></code> function and specify the <code><span class="ApiLink_nn__irsensor__IrCameraHandle">nn::irsensor::IrCameraHandle</span></code> you want to stop as an argument.<br />Call the <code><span class="ApiLink_nn__irsensor__Finalize">nn::irsensor::Finalize</span></code> function to finalize the IR Motion Camera.</p>
    <table class="codeblock">
      <tbody>
        <tr>
          <td class="code">
            <div class="codeblock"><pre><span class="nn">nn::irsensor::</span><span class="n">StopImageProcessor</span><span class="p">(</span><span class="n">handle</span><span class="p">);</span>
<span class="nn">nn::irsensor::</span><span class="n">Finalize</span><span class="p">(</span><span class="n">handle</span><span class="p">);</span></pre></div>
          </td>
        </tr>
      </tbody>
    </table>
    <h2 id="Anchor_165050999_h2_4">Sample of Pointing Mode</h2>
    <p>See the sample program in the <code>Samples\Sources\Applications\IrSensorPointingBasic</code> directory.<br /><br /></p>
  </li>
</ol>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
<p>&nbsp;</p>
<hr />
<p>CONFIDENTIAL</p>
</div>
</div>
<!--AddLink-->
<script>
var NintendoSdkApiRefernce = {
    idMap: {},
    linkRewrite: function ()
    {
        var idMap = NintendoSdkApiRefernce.idMap;
        function rewrite(el)
        {
            var e = idMap[el.className];
            if (e === undefined)
            {
                return;
            }
            var html = '';
            html += '<a href=';
            html += e.url;
            html += ' target="_blank" rel="noopener noreferrer" >';
            html += el.innerHTML;
            html += '</a>';
            el.innerHTML = html;
        }
        var apiLinkElems = document.querySelectorAll('span[class*="ApiLink_"]');
        for (var i = 0, n = apiLinkElems.length; i< n; ++i) {
            rewrite(apiLinkElems[i]);
        }
    }
};
function SetUrl( id, url )
{
    NintendoSdkApiRefernce.idMap[id] = { url: url };
}
SetUrl( 'ApiLink_nn__irsensor__RunPointingProcessor', '../../../Api/HtmlNX/namespacenn_1_1irsensor.html#a35ef293f2a5162a81e7c07ea3693de82' )
SetUrl( 'ApiLink_nn__irsensor__PointingProcessorState', '../../../Api/HtmlNX/structnn_1_1irsensor_1_1_pointing_processor_state.html' )
SetUrl( 'ApiLink_nn__irsensor__GetPointingProcessorStates', '../../../Api/HtmlNX/namespacenn_1_1irsensor.html#affe5dbef15c8120623fa7301622502e1' )
SetUrl( 'ApiLink_nn__irsensor__IrCameraHandle', '../../../Api/HtmlNX/structnn_1_1irsensor_1_1_ir_camera_handle.html' )
SetUrl( 'ApiLink_nn__hid__NpadIdType', '../../../Api/HtmlNX/namespacenn_1_1hid.html#a5923008962b52bf501f91b30013aedd6' )
SetUrl( 'ApiLink_nn__irsensor__GetClusteringProcessorStates', '../../../Api/HtmlNX/namespacenn_1_1irsensor.html#af83d851b9b53c14d5e661f240ac482c2' )
SetUrl( 'ApiLink_nn__irsensor__ClusteringProcessorStateCountMax', '../../../Api/HtmlNX/namespacenn_1_1irsensor.html#a20ebaaa373036fe0859a0315e33a42fe' )
SetUrl( 'ApiLink_nn__irsensor__StopImageProcessor', '../../../Api/HtmlNX/namespacenn_1_1irsensor.html#a3052171f2c63aafc0e4a164366ae22d7' )
SetUrl( 'ApiLink_nn__irsensor__Finalize', '../../../Api/HtmlNX/namespacenn_1_1irsensor.html#a6265f5c6e6d6fc0e67fc6882a8945284' )

NintendoSdkApiRefernce.linkRewrite();
</script>
<!--AddLink-->
</body>
</html>

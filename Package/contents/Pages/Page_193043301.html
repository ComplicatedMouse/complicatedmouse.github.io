<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<script type="text/javascript" src="../tocDataApi.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>Material Referencing | NintendoSDK Documents</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="text-align: center;"><img src="../template/img/noscript.svg" /></div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- Material Referencing -->
<div class="pagetitle" id="PageId_193043301">Material Referencing</div>
<div class="text_separate">
<div class="note_new">
  <div class="note_new_left">Note</div>
  <div class="note_new_right">
    <p>The material referencing feature is currently operating under test. When using this feature, note that its operation and specifications may change in the future, without advance notice.</p>
  </div>
</div>
<p>
  <br />
</p>
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_193043301_h1_1">Overview</a>
    </li>
    <li>
      <a href="#Anchor_193043301_h1_2">Workflow</a>
    </li>
    <li>
      <a href="#Anchor_193043301_h1_3">Creating Parent Materials</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_193043301_h2_1">Setting Values for Shader Parameters Whose Settings Are to Be Shared</a>
      </li>
      <li>
        <a href="#Anchor_193043301_h2_2">Child Material Restriction Settings</a>
      </li>
    </ul>
    <li>
      <a href="#Anchor_193043301_h1_4">Material Referencing Settings (Parent Material Assignment)</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_193043301_h2_3">Parent Material Assignment Using the Assign Utility</a>
      </li>
      <li>
        <a href="#Anchor_193043301_h2_4">Manual Parent Material Assignment in 3DEditor</a>
      </li>
    </ul>
    <li>
      <a href="#Anchor_193043301_h1_5">Editing Child Materials</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_193043301_h2_5">Editing Shader Parameter Values</a>
      </li>
      <li>
        <a href="#Anchor_193043301_h2_6">Editing Parent Materials</a>
      </li>
    </ul>
    <li>
      <a href="#Anchor_193043301_h1_6">Converting to Binary Resources</a>
    </li>
    <li>
      <a href="#Anchor_193043301_h1_7">Applying a Parent Material and Multiple Material References</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_193043301_h2_7">Resolving Child Material Restrictions</a>
      </li>
      <li>
        <a href="#Anchor_193043301_h2_8">Resolving the Value</a>
      </li>
      <li>
        <a href="#Anchor_193043301_h2_9">Example</a>
      </li>
    </ul>
  </ul>
</p>
<h1 id="Anchor_193043301_h1_1">Overview</h1>
<p>This page describes the material referencing feature of 3DEditor and how to embed it. The descriptions on this page use the following terms.</p>
<table class="wrapped">
  <colgroup>
    <col />
    <col />
  </colgroup>
  <tbody>
    <tr>
      <th>Term</th>
      <th>Description</th>
    </tr>
    <tr>
      <td>
        <p>Material Referencing</p>
      </td>
      <td>The name of this feature.</td>
    </tr>
    <tr>
      <td>Parent material</td>
      <td>The name of a material that is referenced from another material.</td>
    </tr>
    <tr>
      <td>Child material</td>
      <td>The name of a material that references another material.</td>
    </tr>
  </tbody>
</table>
<h1 id="Anchor_193043301_h1_2">Workflow</h1>
<p>The following figure shows an example of the workflow with material referencing embedded. The flows in the red squares are described in later sections.</p>
<p>
  <br />
</p>
<div class="flowchart-svg-inline">
  <img src="../Attachments/Attach_193043301/flowchart_1.svg" />
</div>
<h1 id="Anchor_193043301_h1_3">Creating Parent Materials</h1>
<p>Prepare a parent material that has shared settings across multiple materials. In the standard flow, you edit the created model's intermediate file in 3DEditor and configure the parent material.</p>
<h2 id="Anchor_193043301_h2_1">Setting Values for Shader Parameters Whose Settings Are to Be Shared</h2>
<p>Set the values for shader parameters whose settings are to be shared. Using the same procedure as with standard material editing, configure the parameter values on the shader page of the material property window.</p>
<h2 id="Anchor_193043301_h2_2">Child Material Restriction Settings</h2>
<p>Configure restrictions on shader parameters for child materials. This setting can be used to forcibly reference the parent material's values, or to always set the value using the child material. Right-click a shader parameter label to open the shortcut menu and configure the settings.</p>
<p>For more information, see <a href="../Pages/Page_83955594.html#Anchor_83955594_MaterialReferenceMenu">Material Referencing Settings</a>.</p>
<h1 id="Anchor_193043301_h1_4">Material Referencing Settings (Parent Material Assignment)</h1>
<p>To use material referencing, you must first complete the preparations for using material referencing for the target model, such as in a post-export script of the DCC tool export plug-in. More specifically, the following process is required.</p>
<ol>
  <li>Assign a shader to the model intermediate file</li>
  <li>Assign a parent material to the model intermediate file</li>
</ol>
<p>The parent material and the assigned target material must have the same shading model assigned. You must assign a shader to the target model before assigning the parent model.</p>
<p>You can conduct these processes manually in 3DEditor or run them from the command line using the <a href="../Pages/Page_83956043.html">assign utility</a>.</p>
<h2 id="Anchor_193043301_h2_3">Parent Material Assignment Using the Assign Utility</h2>
<p>For examples of various assign utility processes, see the example commands for <a href="../Pages/Page_83956043.html#Anchor_83956043_AssignModelShaderExample">assigning parent shaders to models</a> and <a href="../Pages/Page_83956043.html#Anchor_83956043_AssignParentMaterialExample">assigning parent materials</a>.</p>
<h2 id="Anchor_193043301_h2_4">Manual Parent Material Assignment in 3DEditor</h2>
<p>Use the following procedure to assign parent materials in 3DEditor.</p>
<ol>
  <li>Load a model intermediate file with a child material in 3DEditor</li>
  <li>Load a model intermediate file with a parent material in 3DEditor</li>
  <li>Using the <a href="../Pages/Page_83955594.html">Shader page of the material property window</a>, set the same shader definitions for the child material as the parent material in the shading model (this procedure is not necessary if the definitions have been set in advance).</li>
  <li>Open the <a href="../Pages/Page_193048085.html">Material Reference page of the material property window</a> for the child material.</li>
  <li>Add the parent material using the <strong>Add</strong> button</li>
</ol>
<h1 id="Anchor_193043301_h1_5">Editing Child Materials</h1>
<h2 id="Anchor_193043301_h2_5">Editing Shader Parameter Values</h2>
<p>Edits materials with material referencing configured in 3DEditor.</p>
<p>On the shader page of the material property window for the child material, right-click a shader parameter label to open the shortcut menu. You can switch between using the parent material values, overwriting the values, and using the default values.</p>
<p>For more information, see <a href="../Pages/Page_83955594.html#Anchor_83955594_MaterialReferenceMenu">Material Referencing Settings</a>.</p>
<h2 id="Anchor_193043301_h2_6">Editing Parent Materials</h2>
<p>You can add, delete, and edit parent materials from the Parent Material Page of the material property window. At the location, you can also manually configure material referencing.</p>
<p>For more information, see <a href="../Pages/Page_193048085.html">Material Property Window: Material Reference Page</a>.</p>
<h1 id="Anchor_193043301_h1_6">Converting to Binary Resources</h1>
<p>Binary resources do not leave material referencing information. Before converting to the binary resource, you must first apply the parent material settings in the child material. You can perform this process using the <a href="../Pages/Page_83956043.html">assign utility</a> feature for applying a parent material.</p>
<p>The model intermediate file, with the parent material settings applied, is a temporary file for converting to the binary resource; as a result, it is written to a temporary folder. The model intermediate file with the parent material settings applied, can be handled in the same way as not using material referencing. You can convert the file to the binary resource in the known manner using the <a href="../Pages/Page_83955997.html">3D binary converter</a> and reference the file in the game application.</p>
<p>For more information about resolving specific references when the parent material is applied, see <a href="#Anchor_193043301_ApplyParentMaterial">Applying a Parent Material and Multiple Material References</a>. For a specific coding example of this process using the assign utility, see <a href="../Pages/Page_83956043.html#Anchor_83956043_ApplyParentMaterialExample">Applying a Parent Material</a>.</p>
<p>
  <a name="Anchor_193043301_ApplyParentMaterial"></a>
</p>
<h1 id="Anchor_193043301_h1_7">Applying a Parent Material and Multiple Material References</h1>
<p>This section describes the specification for reference resolution when <a href="../Pages/Page_83956043.html">assign utility</a> is used to apply the parent material. It also describes the behavior when there are multiple material references (multiple parent materials set for one material), and when there are redundant parameter settings for the parent material being referenced.</p>
<h2 id="Anchor_193043301_h2_7">Resolving Child Material Restrictions</h2>
<p>Search the parent materials in the order they were set (the order shown in the Material Reference page of the material property window in 3DEditor), and use the settings of the first parent material found where <strong>Child Material Restrictions</strong> is not set to <strong>None</strong>. If you are using the <strong>Fix using the parent material value</strong> option, the child material uses the parameter value of this parent material. If the parent material is referencing a different parent material, the method described in Resolving the Value is used to resolve the value of the parent material, and the resulting value is used to determine which parameter value to use. If you are using the <strong>Require the use of values for child material settings</strong> option, the child material will use its own value. If you are using <strong>Always reference value using child material</strong>, the method described in Resolving the Value is used to resolve the value that will be treated as the child material value to reference, and that value is used to determine which parameter value to use. If <strong>None</strong> has been set for all of the parent materials, the method described in Resolving the Value is used to resolve the value, and the resulting value is used to determine which parameter value to use.</p>
<p>
  <br />
</p>
<div class="flowchart-svg-inline">
  <img src="../Attachments/Attach_193043301/flowchart_2.svg" />
</div>
<p>
  <br />
</p>
<p>The following example shows the search order. When the parent material is assigned to <code>EnemyMatA</code>, conduct a search in the order of the numbers enclosed in brackets ([ ]).</p>
<ul>
  <li>EnemyMatA [9]<ul><li>EnemyBaseMatA [4]<ul><li>BaseMatA [1]</li><li>BaseMatB [2]</li><li>BaseMatX [3]</li></ul></li><li>EnemyBaseMatB [8]<br /><ul><li>BaseMatC [5]</li><li>BaseMatD [6]</li><li>BaseMatX [7]</li></ul></li></ul></li>
</ul>
<p>
  <br />
</p>
<div class="flowchart-svg-inline">
  <img src="../Attachments/Attach_193043301/flowchart_3.svg" />
</div>
<h2 id="Anchor_193043301_h2_8">Resolving the Value</h2>
<p>If <strong>Overwrite</strong> is set as the value for the child material, that child material's value is used. If <strong>Reference Parent Material Values</strong> is set as the value for the child material, search the parent materials in the opposite order that they were set (from bottom to top of the order shown in the Material Reference page of the material property window in 3DEditor), and use the value of the first parent material found that is set to <strong>Overwrite</strong> or <strong>Use default value</strong>. When the search results show that <strong>Reference Parent Material Value</strong> is set for all materials, use the material shader parameter value searched last.</p>
<p>For example, when the parent material is assigned to EnemyMatA in the following order, conduct a search in the order of the numbers enclosed in brackets ([ ]).</p>
<ul>
  <li>EnemyMatA [1]<ul><li>EnemyBaseMatA [6]<ul><li>BaseMatA [9]</li><li>BaseMatB [8]</li><li>BaseMatX [7]</li></ul></li><li>EnemyBaseMatB [2]<br /><ul><li>BaseMatC [5]</li><li>BaseMatD [4]</li><li>BaseMatX [3]</li></ul></li></ul></li>
</ul>
<p>
  <br />
</p>
<div class="flowchart-svg-inline">
  <img src="../Attachments/Attach_193043301/flowchart_4.svg" />
</div>
<h2 id="Anchor_193043301_h2_9">
  <br />Example</h2>
<h3 id="Anchor_193043301_h3_1">Overwriting the Parent Material Value With the Child Material</h3>
<p>When you set the value to <strong>Overwrite</strong> on the child material side, it ultimately uses the value of <strong>Child Material</strong>.</p>
<p>
  <br />
</p>
<div class="flowchart-svg-inline">
  <img src="../Attachments/Attach_193043301/flowchart_5.svg" />
</div>
<h3 id="Anchor_193043301_h3_2">Referencing the Parent Material From the Child Material</h3>
<p>When you set the value to <strong>Reference the value of the parent material</strong>, the parent material value is ultimately used.</p>
<p>
  <br />
</p>
<div class="flowchart-svg-inline">
  <img src="../Attachments/Attach_193043301/flowchart_6.svg" />
</div>
<h3 id="Anchor_193043301_h3_3">Example of Forcing the Child Material to Reference the Parent Material Value</h3>
<p>When you set <strong>Child Material Restrictions</strong> to <strong>Fix using the parent material value</strong> on the parent material side, the child material value is forcibly treated as <strong>Reference the value of the parent material</strong>, so the parent material value is ultimately used.</p>
<p>
  <br />
</p>
<div class="flowchart-svg-inline">
  <img src="../Attachments/Attach_193043301/flowchart_7.svg" />
</div>
<h3 id="Anchor_193043301_h3_4">Example of Forcibly Overwriting With the Child Material Value</h3>
<p>When <strong>Child Material Restrictions</strong> is set to <strong>Require the use of values for child material settings</strong> on the parent material side, the child material value is handled forcibly as <strong>Overwrite</strong>, so the child material value is ultimately used.</p>
<p>
  <br />
</p>
<div class="flowchart-svg-inline">
  <img src="../Attachments/Attach_193043301/flowchart_8.svg" />
</div>
<h3 id="Anchor_193043301_h3_5">Multistage Referencing</h3>
<p>Searches for <strong>Child Material Restrictions</strong> from Material A to Material D, and the first material found with something other than <strong>None</strong> set becomes Material B. The <strong>Child Material Restrictions</strong> for Material B is <strong>Fix using the parent material value</strong>, so the values for the Material B child materials Material C and Material D are ultimately treated as <strong>Reference the value of the parent material</strong>. As a result, Material D refers to the value of Material B. However, because the value for Material B is set to <strong>Reference the value of the parent material</strong>, the value ultimately used by Material D is the value for Material A, which refers to Material B.</p>
<p>
  <br />
</p>
<div class="flowchart-svg-inline">
  <img src="../Attachments/Attach_193043301/flowchart_9.svg" />
</div>
<h3 id="Anchor_193043301_h3_6">Multiple Referencing</h3>
<p>Searches for <strong>Child Material Restrictions</strong> in the order of Reference 1, Reference 2, Reference 3 (the order in which they were added in 3DEditor), and the first material found that is set to something other than <strong>None</strong> becomes Material B. The <strong>Child Material Restrictions</strong> for Material B is <strong>Fix using the parent material value</strong>, so the value for Material C, which was added after Material B, and the value for Material D, which is a child material, are forcibly set to <strong>Reference the value of the parent material</strong>. As a result, Material D directly references the value of Material B. However, because the value for Material B is set to <strong>Reference the value of the parent material</strong>, the value ultimately used by Material D is the value for Material A, which refers to Material B.</p>
<p>
  <br />
</p>
<div class="flowchart-svg-inline">
  <img src="../Attachments/Attach_193043301/flowchart_10.svg" />
</div>
<p>
  <br />
  <br />
</p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
<p>&nbsp;</p>
<hr />
<p>CONFIDENTIAL</p>
</div>
</div>
</body>
</html>

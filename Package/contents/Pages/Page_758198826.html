<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<script type="text/javascript" src="../tocDataApi.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>Scripting | NintendoSDK Documents</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="text-align: center;"><img src="../template/img/noscript.svg" /></div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- Scripting -->
<div class="pagetitle" id="PageId_758198826">Scripting</div>
<div class="text_separate">
<p>The profiler supports running Windows PowerShell script files in order to perform automated GUI control.&nbsp;This enables a consistent method to take the same suite of profiles multiple times, as required for any automated testing process.</p>
<h1 id="Anchor_758198826_h1_1">Windows PowerShell</h1>
<p>Windows PowerShell scripting allows for fairly complex behavior. However, it is beyond the scope of this&nbsp;document to explain all its scripting language features. You can find more details on Windows&nbsp;PowerShell scripting from Microsoft.</p>
<h1 id="Anchor_758198826_h1_2">Get Output from a Script</h1>
<p>When the profiler runs a script, the script's text output is written to standard output. Unfortunately, if the profiler is launched from Windows Explorer, any text output will be lost. To record and view the script's output, start the profiler from a Windows PowerShell command prompt and pipe the output to the default output target.&nbsp;</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre><span class="p">&amp;</span> <span class="s2">&quot;./Nintendo CPU Profiler.exe&quot;</span> <span class="p">|</span> <span class="nb">Out-Default</span></pre></div>
      </td>
    </tr>
  </tbody>
</table>
<h1 id="Anchor_758198826_h1_3">Cmdlets</h1>
<p>
  <span style="color: rgb(34,34,34);">A&nbsp;</span>cmdlet<span style="color: rgb(34,34,34);">&nbsp;(pronounced &quot;command-let&quot;) is a lightweight Windows&nbsp;</span>PowerShell<span style="color: rgb(34,34,34);">&nbsp;script that is similar to a function call.&nbsp;</span>The profiler allows for scripting by creating profiler-specific cmdlets that do some kind of work within the profiler. All built-in cmdlets in Windows PowerShell should also be&nbsp;available as well. Extended cmdlets that have been installed separately may not be available.</p>
<p>All of the profiler's cmdlets start with the prefix 'Profiler-'.</p>
<p>
  <strong>Note:</strong> In Windows PowerShell, cmdlets are not case-sensitive.</p>
<p>Profiler cmdlet arguments are space separated and text not enclosed in quotes is converted to upper-case&nbsp;for internal comparisons. This will cause a problem with function names. As such, all function names will&nbsp;need to be enclosed in quotation marks (&quot;&quot;). Quotation marks will also allow for C++ function names with&nbsp;multiple arguments and/or template information to contain spaces if needed.</p>
<p>If the argument name is surrounded by [], passing in the name is optional. If the argument name is omitted, then the order of the arguments must be passed in the order shown.</p>
<p>
  <ul class="PageTree">
    <li>
      <a href="../Pages/Page_753912780.html">Scripting Cmdlets</a>
    </li>
    <ul>
      <li>
        <a href="../Pages/Page_753912985.html">Profiler-Analyze</a>
      </li>
      <li>
        <a href="../Pages/Page_753912992.html">Profiler-Assembly</a>
      </li>
      <li>
        <a href="../Pages/Page_1216599709.html">Profiler-BufferMode</a>
      </li>
      <li>
        <a href="../Pages/Page_753913002.html">Profiler-Callstacks</a>
      </li>
      <li>
        <a href="../Pages/Page_753913012.html">Profiler-Connect</a>
      </li>
      <li>
        <a href="../Pages/Page_753913027.html">Profiler-Copy</a>
      </li>
      <li>
        <a href="../Pages/Page_753913033.html">Profiler-Exit</a>
      </li>
      <li>
        <a href="../Pages/Page_753913040.html">Profiler-Filter</a>
      </li>
      <li>
        <a href="../Pages/Page_962042348.html">Profiler-GroupBy</a>
      </li>
      <li>
        <a href="../Pages/Page_753913050.html">Profiler-Instrument</a>
      </li>
      <li>
        <a href="../Pages/Page_753913060.html">Profiler-Marked</a>
      </li>
      <li>
        <a href="../Pages/Page_753913073.html">Profiler-NX-Cores</a>
      </li>
      <li>
        <a href="../Pages/Page_1216599778.html">Profiler-NX-FileSystemTrace</a>
      </li>
      <li>
        <a href="../Pages/Page_753913091.html">Profiler-NX-GpuTrace</a>
      </li>
      <li>
        <a href="../Pages/Page_753913102.html">Profiler-NX-PowerStats</a>
      </li>
      <li>
        <a href="../Pages/Page_753913122.html">Profiler-NX-SampleMode</a>
      </li>
      <li>
        <a href="../Pages/Page_753913136.html">Profiler-NX-Scenario</a>
      </li>
      <li>
        <a href="../Pages/Page_753913150.html">Profiler-NX-ThreadState</a>
      </li>
      <li>
        <a href="../Pages/Page_753913158.html">Profiler-NX-WaitFor</a>
      </li>
      <li>
        <a href="../Pages/Page_753913167.html">Profiler-Open</a>
      </li>
      <li>
        <a href="../Pages/Page_753913174.html">Profiler-PerfCounters</a>
      </li>
      <li>
        <a href="../Pages/Page_753913181.html">Profiler-Sample</a>
      </li>
      <li>
        <a href="../Pages/Page_753913197.html">Profiler-Save</a>
      </li>
      <li>
        <a href="../Pages/Page_753913203.html">Profiler-Select</a>
      </li>
      <li>
        <a href="../Pages/Page_753913211.html">Profiler-ShowTab</a>
      </li>
      <li>
        <a href="../Pages/Page_753913219.html">Profiler-Sort</a>
      </li>
      <li>
        <a href="../Pages/Page_753913227.html">Profiler-Start</a>
      </li>
      <li>
        <a href="../Pages/Page_753913234.html">Profiler-Stop</a>
      </li>
      <li>
        <a href="../Pages/Page_753913245.html">Profiler-Sync</a>
      </li>
      <li>
        <a href="../Pages/Page_764975510.html">Profiler-Timeline</a>
      </li>
      <li>
        <a href="../Pages/Page_753913256.html">Profiler-TreeControl</a>
      </li>
      <li>
        <a href="../Pages/Page_753913265.html">Profiler-Units</a>
      </li>
      <li>
        <a href="../Pages/Page_753913277.html">Profiler-Unsync</a>
      </li>
      <li>
        <a href="../Pages/Page_753913285.html">Profiler-Wait</a>
      </li>
      <li>
        <a href="../Pages/Page_753913296.html">Profiler-WaitFor</a>
      </li>
    </ul>
    <li>
      <a href="../Pages/Page_753912799.html">Scripting Examples</a>
    </li>
    <ul>
      <li>
        <a href="../Pages/Page_753912817.html">Example 1: Take a Profile and Save it to Disk</a>
      </li>
      <li>
        <a href="../Pages/Page_753912826.html">Example 2: Connect to a Dev Kit, Take a Profile, and Disconnect</a>
      </li>
      <li>
        <a href="../Pages/Page_753912837.html">Example 3: Get a List of the Top 5 Functions in a Bad Frame</a>
      </li>
      <li>
        <a href="../Pages/Page_753912843.html">Example 4: Get the Disassembly of the Most Hit Function</a>
      </li>
      <li>
        <a href="../Pages/Page_753912850.html">Example 5: Sync to a Running Application where the Profiler Library is Integrated</a>
      </li>
      <li>
        <a href="../Pages/Page_753912866.html">Example 6: Take a Code Block Only Profile</a>
      </li>
      <li>
        <a href="../Pages/Page_753912872.html">Example 7: Create a Dump of the Detailed Profile Info</a>
      </li>
      <li>
        <a href="../Pages/Page_753912880.html">Example 8: Take an Instrumented Profile of the Most Hit Function</a>
      </li>
      <li>
        <a href="../Pages/Page_753912891.html">Example 9: Take a Profile and Exit the Profiler</a>
      </li>
    </ul>
  </ul>
</p>
<h1 id="Anchor_758198826_h1_4">Other Useful Commands</h1>
<p>The following are some additional properties, commands, and function&nbsp;calls that may prove useful.</p>
<p>
  <br />
</p>
<p>
  <strong>[Environment]::CurrentDirectory</strong>
</p>
<p style="margin-left: 60.0px;">Gets the current directory of the profiler application. This will usually be the directory from which the profiler EXE&nbsp;was launched.</p>
<p>
  <br />
</p>
<p>
  <strong>[Nintendo.CPU.Profiler.Scripting.ScriptingCore]::NProfFilename</strong>
</p>
<p style="margin-left: 60.0px;">The entire filename of the currently loaded NPROF file. If no NPROF is loaded, or if this is a new profile&nbsp;that has not yet been saved, this will contain an empty string.</p>
<p>
  <br />
</p>
<p>
  <strong>[Nintendo.CPU.Profiler.Scripting.ScriptingCore]::ScriptDirectory</strong>
</p>
<p style="margin-left: 60.0px;">The directory from which the currently executing script was loaded.</p>
<p>
  <br />
</p>
<p>
  <strong>[Nintendo.CPU.Profiler.Scripting.ScriptingGUI]::ELFDirectory</strong>
</p>
<p style="margin-left: 60.0px;">The directory of the NSS that is current synced.</p>
<h1 id="Anchor_758198826_h1_5">Examples</h1>
<p>The following examples demonstrate what the scripting system can do.</p>
<p>
  <ul class="PageTree">
    <li>
      <a href="../Pages/Page_753912780.html">Scripting Cmdlets</a>
    </li>
    <ul>
      <li>
        <a href="../Pages/Page_753912985.html">Profiler-Analyze</a>
      </li>
      <li>
        <a href="../Pages/Page_753912992.html">Profiler-Assembly</a>
      </li>
      <li>
        <a href="../Pages/Page_1216599709.html">Profiler-BufferMode</a>
      </li>
      <li>
        <a href="../Pages/Page_753913002.html">Profiler-Callstacks</a>
      </li>
      <li>
        <a href="../Pages/Page_753913012.html">Profiler-Connect</a>
      </li>
      <li>
        <a href="../Pages/Page_753913027.html">Profiler-Copy</a>
      </li>
      <li>
        <a href="../Pages/Page_753913033.html">Profiler-Exit</a>
      </li>
      <li>
        <a href="../Pages/Page_753913040.html">Profiler-Filter</a>
      </li>
      <li>
        <a href="../Pages/Page_962042348.html">Profiler-GroupBy</a>
      </li>
      <li>
        <a href="../Pages/Page_753913050.html">Profiler-Instrument</a>
      </li>
      <li>
        <a href="../Pages/Page_753913060.html">Profiler-Marked</a>
      </li>
      <li>
        <a href="../Pages/Page_753913073.html">Profiler-NX-Cores</a>
      </li>
      <li>
        <a href="../Pages/Page_1216599778.html">Profiler-NX-FileSystemTrace</a>
      </li>
      <li>
        <a href="../Pages/Page_753913091.html">Profiler-NX-GpuTrace</a>
      </li>
      <li>
        <a href="../Pages/Page_753913102.html">Profiler-NX-PowerStats</a>
      </li>
      <li>
        <a href="../Pages/Page_753913122.html">Profiler-NX-SampleMode</a>
      </li>
      <li>
        <a href="../Pages/Page_753913136.html">Profiler-NX-Scenario</a>
      </li>
      <li>
        <a href="../Pages/Page_753913150.html">Profiler-NX-ThreadState</a>
      </li>
      <li>
        <a href="../Pages/Page_753913158.html">Profiler-NX-WaitFor</a>
      </li>
      <li>
        <a href="../Pages/Page_753913167.html">Profiler-Open</a>
      </li>
      <li>
        <a href="../Pages/Page_753913174.html">Profiler-PerfCounters</a>
      </li>
      <li>
        <a href="../Pages/Page_753913181.html">Profiler-Sample</a>
      </li>
      <li>
        <a href="../Pages/Page_753913197.html">Profiler-Save</a>
      </li>
      <li>
        <a href="../Pages/Page_753913203.html">Profiler-Select</a>
      </li>
      <li>
        <a href="../Pages/Page_753913211.html">Profiler-ShowTab</a>
      </li>
      <li>
        <a href="../Pages/Page_753913219.html">Profiler-Sort</a>
      </li>
      <li>
        <a href="../Pages/Page_753913227.html">Profiler-Start</a>
      </li>
      <li>
        <a href="../Pages/Page_753913234.html">Profiler-Stop</a>
      </li>
      <li>
        <a href="../Pages/Page_753913245.html">Profiler-Sync</a>
      </li>
      <li>
        <a href="../Pages/Page_764975510.html">Profiler-Timeline</a>
      </li>
      <li>
        <a href="../Pages/Page_753913256.html">Profiler-TreeControl</a>
      </li>
      <li>
        <a href="../Pages/Page_753913265.html">Profiler-Units</a>
      </li>
      <li>
        <a href="../Pages/Page_753913277.html">Profiler-Unsync</a>
      </li>
      <li>
        <a href="../Pages/Page_753913285.html">Profiler-Wait</a>
      </li>
      <li>
        <a href="../Pages/Page_753913296.html">Profiler-WaitFor</a>
      </li>
    </ul>
    <li>
      <a href="../Pages/Page_753912799.html">Scripting Examples</a>
    </li>
    <ul>
      <li>
        <a href="../Pages/Page_753912817.html">Example 1: Take a Profile and Save it to Disk</a>
      </li>
      <li>
        <a href="../Pages/Page_753912826.html">Example 2: Connect to a Dev Kit, Take a Profile, and Disconnect</a>
      </li>
      <li>
        <a href="../Pages/Page_753912837.html">Example 3: Get a List of the Top 5 Functions in a Bad Frame</a>
      </li>
      <li>
        <a href="../Pages/Page_753912843.html">Example 4: Get the Disassembly of the Most Hit Function</a>
      </li>
      <li>
        <a href="../Pages/Page_753912850.html">Example 5: Sync to a Running Application where the Profiler Library is Integrated</a>
      </li>
      <li>
        <a href="../Pages/Page_753912866.html">Example 6: Take a Code Block Only Profile</a>
      </li>
      <li>
        <a href="../Pages/Page_753912872.html">Example 7: Create a Dump of the Detailed Profile Info</a>
      </li>
      <li>
        <a href="../Pages/Page_753912880.html">Example 8: Take an Instrumented Profile of the Most Hit Function</a>
      </li>
      <li>
        <a href="../Pages/Page_753912891.html">Example 9: Take a Profile and Exit the Profiler</a>
      </li>
    </ul>
  </ul>
</p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
<p>&nbsp;</p>
<hr />
<p>CONFIDENTIAL</p>
</div>
</div>
</body>
</html>

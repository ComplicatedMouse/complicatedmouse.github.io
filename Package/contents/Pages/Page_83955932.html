<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<script type="text/javascript" src="../tocDataApi.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>Layout Archiver | NintendoSDK Documents</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="text-align: center;"><img src="../template/img/noscript.svg" /></div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- Layout Archiver -->
<div class="pagetitle" id="PageId_83955932">Layout Archiver</div>
<div class="text_separate">
<h1 id="Anchor_83955932_h1_1">Layout Archiver</h1>
<h2 id="Anchor_83955932_h2_1">Introduction</h2>
<h3 id="Anchor_83955932_h3_1">What Is Layout Archiver?</h3>
<p>Layout Archiver (LayoutArchiver) is a tool for collecting data used by the library into one file so it can be used by the layout library. The data includes pane placement information, animations, textures, and other data output by the Layout Converter.</p>
<h3 id="Anchor_83955932_h3_2">Layout Archiver Features</h3>
<h4 id="Anchor_83955932_h4_1">Automatic Alignment Settings Inside Archives</h4>
<p>If the archive includes textures (BFLIM files), the layout archiver reads out the alignment required by textures inside the BFLIM files and automatically locates them with the correct alignment.<br />Automatic alignment is also performed for fonts.<br />The user does not need to specify the alignment of files in the archive when the Layout Archiver is used.</p>
<h4 id="Anchor_83955932_h4_2">High-Speed Operations</h4>
<p>Layout Archiver maintains a hash of filenames in the archive that is used when searching for files at run time. High-speed operations are possible even with many files.</p>
<h4 id="Anchor_83955932_h4_3">Combining Resources in an Appropriate Format for Each Platform</h4>
<p>You combine multiple texture intermediate (FTXB) files into a single texture resource binary (BNTX) file. When doing so, platform-specific tiling occurs.<br />The same type of resource merging is performed for the shaders.</p>
<h2 id="Anchor_83955932_h2_2">Using the Layout Archiver</h2>
<h3 id="Anchor_83955932_h3_3">Location of the Executable File</h3>
<p>Layout Archiver is located in the following directory.</p>
<ul class="simple">
  <li>Tools\Graphics\LayoutTools\LayoutArchiver.exe</li>
</ul>
<h3 id="Anchor_83955932_h3_4">Command-Line Format</h3>
<p>Layout Archiver uses the following command-line format.</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>LayoutArchiver.exe [mode][option] archive_path [file_or_directory_name ... ]</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>mode and option may be specified in any order.<br />The first name specified on the command line (excluding the command name, mode, option, and optional parameters) is the archive path.</p>
<p>Layout Archiver distinguishes between uppercase and lowercase letters for filenames and directory names. Either the slash or the backslash (in Japanese fonts, the &yen; symbol) can be used as a delimiter.<br /></p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>Use forward slashes to separate directories and files in path names such as data/scene1/picture.dat. 
Use backward slashes (yen signs) to separate directories and files in paths such as data\scene1\picture.dat.</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>You can follow a directory name with a slash or a backslash.<br />This indicates that the name describes a directory, not a file, so the task that checks for this is omitted and the process assumes that the name is a directory.</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>data/screen1 indicates a file or directory.
data/screen1/ indicates a directory. (If it is not a directory, an error occurs.)</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>If a folder has been specified for the archive, all files included under that folder are included in the archive.</p>
<h3 id="Anchor_83955932_h3_5">Mode</h3>
<p>Layout Archiver has three modes. The following options can be used to specify the mode.<br />If more than one mode is specified, the final mode specified becomes the active mode.</p>
<h4 id="Anchor_83955932_h4_4">-c</h4>
<p>Creates a new archive. If the mode is omitted, <code>-c</code> is assumed.</p>
<h4 id="Anchor_83955932_h4_5">-l</h4>
<p>Displays information in standard output about the files stored in the archive, listing the path, size, alignment, and endian type.<br />Specify the <code>-M</code> option to show whether two archive files match.</p>
<h4 id="Anchor_83955932_h4_6">-r</h4>
<p>Extracts all files stored in an archive.<br />The extracted files are expanded inside a folder that has the same name as the archive, but prefixed with an underscore.<br />You cannot specify an archive name with an absolute path, so take care to specify a folder using <code>-D</code>.<br />The following code is an example.</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>LayoutArchiver.exe -r layout.arc -D work-dir</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>In this example, the files would be extracted inside a created folder named <code><strong>_layout.arc</strong></code>.</p>
<h3 id="Anchor_83955932_h3_6">Options</h3>
<p>The following options are available with Layout Archiver.</p>
<h4 id="Anchor_83955932_h4_7">-h, --help</h4>
<p>Exports archive Help to the standard output.</p>
<h4 id="Anchor_83955932_h4_8">-s, --silent</h4>
<p>Prevents logging (default output).</p>
<h4 id="Anchor_83955932_h4_9">
  <code>-v, --verbose</code>
</h4>
<p>Displays process progress when creating a new archive. The alignment specifications for each file being archived are also displayed.</p>
<h4 id="Anchor_83955932_h4_10">-p name, --platform name</h4>
<p>Specify a target platform name. This option will be deprecated in the future. Use <code>--tile-mode</code> instead.</p>
<h4 id="Anchor_83955932_h4_11">-t name, --tile-mode name</h4>
<p>Specifies the tiling mode for the target texture. (Example: <code>--tile-mode linear</code>)</p>
<p>Specify <strong>linear</strong> when exporting a binary for Windows or OpenGL.</p>
<p>For more information about exporting a binary for platforms other than Windows or OpenGL, see <a href="../Pages/Page_95696747.html">Platform-Specific Information</a>.</p>
<p>This option is required.</p>
<h4 id="Anchor_83955932_h4_12">-a name, --api-type name</h4>
<p>Specifies the target rendering API type. (Example: <code>--api-type Gl</code>)</p>
<p>Specifies <strong>GI</strong> when generating binary files for Windows / OpenGL.<br />For more information about exporting a binary for platforms other than Windows or OpenGL, see <a href="../Pages/Page_95696747.html">Platform-Specific Information</a>.</p>
<p>This option is required.</p>
<h4 id="Anchor_83955932_h4_13">-C name, --code-type name</h4>
<p>Specifies the target shader code type. (Example: <code>--code-type Source</code>)<br />Specify <strong>Source</strong> when exporting a binary for Windows or OpenGL.<br />For more information about exporting a binary for platforms other than Windows or OpenGL, see <a href="../Pages/Page_95696747.html">Platform-Specific Information</a>.</p>
<p>This option is required.</p>
<h4 id="Anchor_83955932_h4_14">-k, --keep-ftxb</h4>
<p>When integrating texture FTXB files within the input data into one BNTX file, this option keeps the original FTXB files without deleting them.</p>
<h4 id="Anchor_83955932_h4_15">-x, --keep-shader-variation-xml</h4>
<p>When shader variation table XML files are integrated into a single BUSHVT, the original XML files remain and are not deleted.</p>
<h4 id="Anchor_83955932_h4_16">--shader-cache-path dir<br /></h4>
<p>Specifies the cache directory <strong><code>dir</code></strong> when converting the shader. This makes the second and subsequent conversions faster when there are no changes to the content of the shader.</p>
<h4 id="Anchor_83955932_h4_17">-n</h4>
<p>When creating an archive, does not write the file path to the archive unless there is a hash value conflict.<br />If an incorrect path name is used when obtaining a file from the archive, a different file might be obtained.<br />(If the <code>-n</code> option is not specified, the filename is always deemed &quot;incorrect.&quot;)</p>
<p>A file path cannot be obtained using the <code>ReadEntry</code> method of <code>ArcExtractor</code>.</p>
<p>As a result, the process for obtaining a file from an archive is faster and you may be able to reduce the capacity of the archive size.<br />Consider using this option if the <code>GetResource</code> method of <code>ArcResourceAccessor</code> is taking too long.</p>
<h4 id="Anchor_83955932_h4_18">-E type</h4>
<p>Specifies the endianness of archive files (little or big). Archive files are big-endian by default. Normally you do not need to specify this option.</p>
<h4 id="Anchor_83955932_h4_19">-K key</h4>
<p>Specifies the use of the unsigned 32-bit integers for hash keys when hashing entries in the file.<br />This option is set automatically if omitted. Normally you do not need to specify this option.</p>
<h4 id="Anchor_83955932_h4_20">-A align</h4>
<p>Specifies the use of the specified alignment as the default for the entire archive.</p>
<ul>
  <li>If a different alignment is specified in individual script files, that alignment takes priority.</li>
  <li>If an invalid alignment is specified, the alignment is automatically set to 4.</li>
</ul>
<h4 id="Anchor_83955932_h4_21">-D dir</h4>
<p>Changes the working directory to use during archiving to the directory specified by <code>dir</code>.<br />If relative paths are used to specify the parameter archive path or files and directories to archive, you must specify paths as relative paths from <code>dir</code> rather than the current directory if this option is used.<br />Because the path specified for files and directories to archive is used as is for the path in the archive, you can change the base location of the path inside the archive by using this option.</p>
<h4 id="Anchor_83955932_h4_22">-X dir</h4>
<p>You can use this option to specify any directory names to exclude from the file to archive.<br />For example, specifying <code>-X font</code> excludes all files in the font folder from being included in the archive. Up to 16 such directories can be specified.</p>
<h4 id="Anchor_83955932_h4_23">-M arc</h4>
<p>Compares two archive files to determine whether they match. This option must be specified together with <code>-l</code>.<br />The following code is an example.</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>&nbsp;LayoutArchiver.exe -l -M a.arc b.arc</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>
  <br />If the files are the same, <strong>matched</strong> is displayed. If they do not match, <strong>failed</strong> is displayed.</p>
<h4 id="Anchor_83955932_h4_24">--tile-optimize name</h4>
<p>Specifies the tiling optimization mode when a texture binary file is being output.<br />Specify <code>performance</code> for optimization for higher performance, specify <code>size</code> for optimization to make the file smaller, and specify <code>size_auto</code> to automatically select size optimization according to the data reduction rate.<br />When <code>size_auto</code> is specified, specify the threshold value of the data reduction rate using the <code>--tile-size-threshold</code> option.<br />If you do not specify this option, optimization for performance is executed.<br />This option only has an effect when a specific mode is specified using the <code>--tile-mode</code> option.</p>
<p>Conforms to the option with the same name in <a href="../Pages/Page_239574379.html">3D Texture Converter</a>.</p>
<h4 id="Anchor_83955932_h4_25">--tile-size-threshold name</h4>
<p>If you specified <code>size_auto</code> using the <code>--tile-optimize</code> option, specify an integer from 0 to 100 for the threshold value [%] to judge whether to execute optimization for size.<br />Textures for which (size for size priority / size for performance priority) x 100 is less than the threshold value are optimized for size. All other textures are optimized for performance.<br />The larger the threshold value, the higher the probability that size priority is selected.<br />If you do not specify this option, the threshold value is 75.</p>
<p>Conforms to the option with the same name in <a href="../Pages/Page_239574379.html">3D Texture Converter</a>.</p>
<h3 id="Anchor_83955932_h3_7">Usage Examples</h3>
<p>Layout Converter is assumed to output layout binary resources in the folder named <code>brsrc</code> located in the current folder. The structure in the BRSRC file is as follows.</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>brsrc/blyt/layout.bflyt 
brsrc/anim/layout_show.bflan 
brsrc/anim/layout_hide.bflan 
brsrc/timg/texture1^h.ftxb
brsrc/timg/texture2^h.ftxb</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>Execute the following command to make an archiver that can be used by the layout library.</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>LayoutArchiver.exe -D brsrc ../layout.arc . --tile-mode linear --api-type Gl --code-type Source</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>Executing this command creates a file in the current directory named <code>layout.arc</code> that contains the following files.</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>./blyt/layout.bflyt 
./anim/layout_show.bflan 
./anim/layout_hide.bflan 
./timg/__Combined.bntx</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>If you load this archive on the runtime side and attach to <code>ArcResourceAccessor</code> as follows, layouts can be built using this resource accessor.</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre>accessor-&gt;Attach(binary, &quot;.&quot;);</pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>If you load this archive on the runtime side and attach to <code>ArcResourceAccessor</code> as follows, layouts can be built using this resource accessor.</p>
<p>The reason for changing the working directory to <code>brsrc</code> using the <code>-D</code> option is to bring <code>blyt</code> folders and so on to the top inside the archive by creating an archive with that folder as the base.</p>
<p>Although you can make other configurations by setting the current root folder attached to <code>ArcResourceAccessor</code> to a path other than <code>.</code>, we typically recommend using a configuration where BLYT files are brought to the top of the archive.</p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
<p>&nbsp;</p>
<hr />
<p>CONFIDENTIAL</p>
</div>
</div>
</body>
</html>

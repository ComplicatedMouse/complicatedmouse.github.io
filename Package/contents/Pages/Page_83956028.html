<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<script type="text/javascript" src="../tocDataApi.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>Mutex Class | NintendoSDK Documents</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="text-align: center;"><img src="../template/img/noscript.svg" /></div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- Mutex Class -->
<div class="pagetitle" id="PageId_83956028">Mutex Class</div>
<div class="text_separate">
<p>
  <ul class="macro_toc">
    <li>
      <a href="#Anchor_83956028_h1_1">Mutex Class</a>
    </li>
    <ul>
      <li>
        <a href="#Anchor_83956028_h2_1">Feature Overview</a>
      </li>
      <li>
        <a href="#Anchor_83956028_h2_2">Use Cases of the Mutex Class</a>
      </li>
      <li>
        <a href="#Anchor_83956028_h2_3">Use with std::lock_guard</a>
      </li>
      <li>
        <a href="#Anchor_83956028_h2_4">Notes on Using the Mutex Class</a>
      </li>
      <ul>
        <li>
          <a href="#Anchor_83956028_h3_1">Lock Level Feature</a>
        </li>
      </ul>
    </ul>
  </ul>
</p>
<h1 id="Anchor_83956028_h1_1">Mutex Class</h1>
<h2 id="Anchor_83956028_h2_1">Feature Overview</h2>
<p>The <code><span class="ApiLink_nn__os__Mutex">Mutex</span></code> class is a synchronization feature that allows mutual exclusion of shared resources that are being used among multiple <a href="../Pages/Page_83955697.html">threads</a>.<br />This mechanism prevents certain areas within programs from being run simultaneously within multiple threads. It also prevents resources from being accessed by multiple threads simultaneously.</p>
<p>The <code><span class="ApiLink_nn__os__Mutex">Mutex</span></code> class wraps the <a href="../Pages/Page_83955800.html">Mutex Features</a> using the <code><span class="ApiLink_nn__os__MutexType">nn::os::MutexType</span></code> object. The <code>Barrier</code> class contains the following member functions. For more information, see the API reference.</p>
<table class="wrapped">
  <colgroup>
    <col />
    <col />
    <col />
  </colgroup>
  <tbody>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Comments</th>
    </tr>
    <tr>
      <td>
        <span class="ApiLink_nn__os__Mutex__Mutex(bool_recursive)_NN_NOEXCEPT">Mutex</span>
      </td>
      <td>Constructor</td>
      <td>Initialization equivalent to <code><span class="ApiLink_void_nn__os__InitializeMutex(MutexType_*mutex|_bool_recursive|_int_lockLevel)_NN_NOEXCEPT">InitializeMutex()</span></code>.</td>
    </tr>
    <tr>
      <td>
        <span class="ApiLink_nn__os__Mutex__~Mutex()_NN_NOEXCEPT">~Mutex</span>
      </td>
      <td>Destructor</td>
      <td>Destruction equivalent to <code><span class="ApiLink_void_nn__os__FinalizeMutex(MutexType_*mutex)_NN_NOEXCEPT">FinalizeMutex()</span></code>.</td>
    </tr>
    <tr>
      <td>
        <span class="ApiLink_void_nn__os__Mutex__Lock()_NN_NOEXCEPT">Lock</span>
      </td>
      <td>Gets a lock</td>
      <td>Lock equivalent to <code><span class="ApiLink_void_nn__os__LockMutex(MutexType_*mutex)_NN_NOEXCEPT">LockMutex()</span></code>.</td>
    </tr>
    <tr>
      <td>
        <span class="ApiLink_bool_nn__os__Mutex__TryLock()_NN_NOEXCEPT">TryLock</span>
      </td>
      <td>Attempts to get a lock</td>
      <td>Lock equivalent to <code><span class="ApiLink_bool_nn__os__TryLockMutex(MutexType_*mutex)_NN_NOEXCEPT">TryLockMutex()</span></code>.</td>
    </tr>
    <tr>
      <td>
        <span class="ApiLink_void_nn__os__Mutex__Unlock()_NN_NOEXCEPT">Unlock</span>
      </td>
      <td>Releases lock</td>
      <td>Unlock equivalent to  <code><span class="ApiLink_void_nn__os__UnlockMutex(MutexType_*mutex)_NN_NOEXCEPT">UnlockMutex()</span></code>.</td>
    </tr>
    <tr>
      <td>
        <span class="ApiLink_bool_nn__os__Mutex__IsLockedByCurrentThread()_const_NN_NOEXCEPT">IsLockedByCurrentThread</span>
      </td>
      <td>Returns whether it is locked by the current thread.</td>
      <td>Equivalent to the <span class="ApiLink_bool_nn__os__IsMutexLockedByCurrentThread(const_MutexType_*mutex)_NN_NOEXCEPT">IsMutexLockedByCurrentThread()</span> function.</td>
    </tr>
    <tr>
      <td>
        <span class="ApiLink_void_nn__os__Mutex__lock()_NN_NOEXCEPT">lock</span>
      </td>
      <td>Gets a lock</td>
      <td>Equivalent to <code>Lock</code>.</td>
    </tr>
    <tr>
      <td>
        <span class="ApiLink_bool_nn__os__Mutex__try_lock()_NN_NOEXCEPT">try_lock</span>
      </td>
      <td>Attempts to get a lock</td>
      <td>Equivalent to <code>TryLock</code>.</td>
    </tr>
    <tr>
      <td>
        <span class="ApiLink_void_nn__os__Mutex__unlock()_NN_NOEXCEPT">unlock</span>
      </td>
      <td>Releases lock</td>
      <td>Equivalent to <code>Unlock</code>.</td>
    </tr>
  </tbody>
</table>
<p>
  <br />
</p>
<p>You may specify the lock level and whether to allow recursive locks in the constructor. See the <a href="../Pages/Page_83955800.html">Mutex Feature</a> for information about each feature.</p>
<p>The <code><span class="ApiLink_nn__os__Mutex">Mutex</span></code> class meets the C++ <code>BasicLockable</code> and <code>Lockable</code> requirements, and may be passed as type arguments to  <code>std::lock_guard</code> and <code>std::unique_lock</code>. For more information, see the following section.</p>
<p>
  <br />
</p>
<h2 id="Anchor_83956028_h2_2">Use Cases of the Mutex Class</h2>
<p>The <code><span class="ApiLink_nn__os__Mutex">Mutex</span></code> class is commonly used as a member variable of some class. The next example's <code>Counter</code> class provides a thread-safe feature for incrementing and decrementing the counter.</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre><span class="cp">#include &lt;nn/os.h&gt;
</span>
<span class="k">class</span> <span class="nc">Counter</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// Use constructor to initialize the Mutex class to disallow recursive locks
</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Counter</span><span class="p">()</span> <span class="o">:</span> <span class="n">m_Counter</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">m_Mutex</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span> <span class="p">{}</span>

&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">void</span> <span class="n">Increment</span><span class="p">()</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">m_Mutex</span><span class="p">.</span><span class="n">Lock</span><span class="p">();</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">++</span><span class="n">m_Counter</span><span class="p">;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">m_Mutex</span><span class="p">.</span><span class="n">Unlock</span><span class="p">();</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>

&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">void</span> <span class="n">Decrement</span><span class="p">()</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">m_Mutex</span><span class="p">.</span><span class="n">Lock</span><span class="p">();</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">--</span><span class="n">m_Counter</span><span class="p">;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">m_Mutex</span><span class="p">.</span><span class="n">Unlock</span><span class="p">();</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>

&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">int</span> <span class="n">Get</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_Counter</span><span class="p">;</span> <span class="p">}</span>

<span class="k">private</span><span class="o">:</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">int</span>             <span class="n">m_Counter</span><span class="p">;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="nn">nn::os::</span><span class="n">Mutex</span>   <span class="n">m_Mutex</span><span class="p">;</span>
<span class="p">};</span></pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>
  <br />
</p>
<p>Set <code>m_Mutex(false)</code> in the <code>Counter</code> class constructor to initialize a <code><span class="ApiLink_nn__os__Mutex">Mutex</span></code> class instance with recursive locks disallowed.</p>
<p>
  <code>Increment()</code> and <code>Decrement()</code> member functions will increment and decrement after getting a <code>m_Mutex</code> lock. As a result, calling these member functions simultaneously from multiple threads will not access the <code>m_Counter</code> variable.</p>
<p>
  <br />
</p>
<h2 id="Anchor_83956028_h2_3">Use with std::lock_guard</h2>
<p>The lock section within <code>Increment</code> and <code>Decrement</code> may be more safely written using <code>std::lock_guard</code> from the C++ standard library. The following are a few examples.</p>
<table class="codeblock">
  <tbody>
    <tr>
      <td class="code">
        <div class="codeblock"><pre><span class="cp">#include &lt;mutex&gt;
#include &lt;nn/os.h&gt;
</span>
<span class="k">class</span> <span class="nc">Counter</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// Use constructor to initialize the Mutex class to disallow recursive locks
</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">Counter</span><span class="p">()</span> <span class="o">:</span> <span class="n">m_Counter</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">m_Mutex</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span> <span class="p">{}</span>

&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">void</span> <span class="n">Increment</span><span class="p">()</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nn">std::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="nn">nn::os::</span><span class="n">Mutex</span><span class="o">&gt;</span> <span class="n">lock</span><span class="p">(</span> <span class="n">m_Mutex</span> <span class="p">);</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">++</span><span class="n">m_Counter</span><span class="p">;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>

&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">void</span> <span class="n">Decrement</span><span class="p">()</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">{</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nn">std::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="nn">nn::os::</span><span class="n">Mutex</span><span class="o">&gt;</span> <span class="n">lock</span><span class="p">(</span> <span class="n">m_Mutex</span> <span class="p">);</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="o">--</span><span class="n">m_Counter</span><span class="p">;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>

&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">int</span> <span class="n">Get</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_Counter</span><span class="p">;</span> <span class="p">}</span>

<span class="k">private</span><span class="o">:</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">int</span>             <span class="n">m_Counter</span><span class="p">;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="nn">nn::os::</span><span class="n">Mutex</span>   <span class="n">m_Mutex</span><span class="p">;</span>
<span class="p">};</span></pre></div>
      </td>
    </tr>
  </tbody>
</table>
<p>This method is known as Scoped Locking Pattern. In the preceding example, to call <code>m_Mutex.Unlock</code> before the same blockscope is completed, call <code>m_Mutex.Lock</code> at the head of the block scope where <code>std::lock_gaurd</code> is written.</p>
<p>
  <br />
</p>
<h2 id="Anchor_83956028_h2_4">Notes on Using the Mutex Class</h2>
<h3 id="Anchor_83956028_h3_1">Lock Level Feature</h3>
<p>The lock level feature is disabled in the Release build version, so lock level values are not checked no matter what parameters have been specified.<br />If you want to use the lock level feature, use the Debug build or Develop build version.</p>
<p>
  <br />
</p>
<p>
  <br />
</p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
<p>&nbsp;</p>
<hr />
<p>CONFIDENTIAL</p>
</div>
</div>
<!--AddLink-->
<script>
var NintendoSdkApiRefernce = {
    idMap: {},
    linkRewrite: function ()
    {
        var idMap = NintendoSdkApiRefernce.idMap;
        function rewrite(el)
        {
            var e = idMap[el.className];
            if (e === undefined)
            {
                return;
            }
            var html = '';
            html += '<a href=';
            html += e.url;
            html += ' target="_blank" rel="noopener noreferrer" >';
            html += el.innerHTML;
            html += '</a>';
            el.innerHTML = html;
        }
        var apiLinkElems = document.querySelectorAll('span[class*="ApiLink_"]');
        for (var i = 0, n = apiLinkElems.length; i< n; ++i) {
            rewrite(apiLinkElems[i]);
        }
    }
};
function SetUrl( id, url )
{
    NintendoSdkApiRefernce.idMap[id] = { url: url };
}
SetUrl( 'ApiLink_nn__os__Mutex', '../../../Api/HtmlNX/classnn_1_1os_1_1_mutex.html' )
SetUrl( 'ApiLink_nn__os__MutexType', '../../../Api/HtmlNX/structnn_1_1os_1_1_mutex_type.html' )
SetUrl( 'ApiLink_nn__os__Mutex__Mutex(bool_recursive)_NN_NOEXCEPT', '../../../Api/HtmlNX/classnn_1_1os_1_1_mutex.html#a74d0a167cb838c2d6c7929f7f4da2bac' )
SetUrl( 'ApiLink_void_nn__os__InitializeMutex(MutexType_*mutex|_bool_recursive|_int_lockLevel)_NN_NOEXCEPT', '../../../Api/HtmlNX/namespacenn_1_1os.html#a8d0a550df15490a884932a062dc26533' )
SetUrl( 'ApiLink_nn__os__Mutex__~Mutex()_NN_NOEXCEPT', '../../../Api/HtmlNX/classnn_1_1os_1_1_mutex.html#a6adb6927fa6324214ed568bccd270ada' )
SetUrl( 'ApiLink_void_nn__os__FinalizeMutex(MutexType_*mutex)_NN_NOEXCEPT', '../../../Api/HtmlNX/namespacenn_1_1os.html#a8ce43d38754bf3049ab8d60b9d9e0046' )
SetUrl( 'ApiLink_void_nn__os__Mutex__Lock()_NN_NOEXCEPT', '../../../Api/HtmlNX/classnn_1_1os_1_1_mutex.html#a8a3082a5a4f31f639ba51fb3f2b044eb' )
SetUrl( 'ApiLink_void_nn__os__LockMutex(MutexType_*mutex)_NN_NOEXCEPT', '../../../Api/HtmlNX/namespacenn_1_1os.html#a8d4678856d87c3faea21f47ced342bb6' )
SetUrl( 'ApiLink_bool_nn__os__Mutex__TryLock()_NN_NOEXCEPT', '../../../Api/HtmlNX/classnn_1_1os_1_1_mutex.html#aa41a772a84f70c3c684031564368c169' )
SetUrl( 'ApiLink_bool_nn__os__TryLockMutex(MutexType_*mutex)_NN_NOEXCEPT', '../../../Api/HtmlNX/namespacenn_1_1os.html#af32963cc501eefcb10a0ebb993080b9f' )
SetUrl( 'ApiLink_void_nn__os__Mutex__Unlock()_NN_NOEXCEPT', '../../../Api/HtmlNX/classnn_1_1os_1_1_mutex.html#a8f421c40740a957ae8011dc2713f9e4e' )
SetUrl( 'ApiLink_void_nn__os__UnlockMutex(MutexType_*mutex)_NN_NOEXCEPT', '../../../Api/HtmlNX/namespacenn_1_1os.html#aa661a7036a18c378a694ad67941cd75e' )
SetUrl( 'ApiLink_bool_nn__os__Mutex__IsLockedByCurrentThread()_const_NN_NOEXCEPT', '../../../Api/HtmlNX/classnn_1_1os_1_1_mutex.html#ae2e4a6528ba9fa991c22ae22877fbfe6' )
SetUrl( 'ApiLink_bool_nn__os__IsMutexLockedByCurrentThread(const_MutexType_*mutex)_NN_NOEXCEPT', '../../../Api/HtmlNX/namespacenn_1_1os.html#a3a2107dd611741af2a44adf2dad29c74' )
SetUrl( 'ApiLink_void_nn__os__Mutex__lock()_NN_NOEXCEPT', '../../../Api/HtmlNX/classnn_1_1os_1_1_mutex.html#a6701cd89b8ea896e18f2613d982dd110' )
SetUrl( 'ApiLink_bool_nn__os__Mutex__try_lock()_NN_NOEXCEPT', '../../../Api/HtmlNX/classnn_1_1os_1_1_mutex.html#a5f7ade45057b283416f7d401eaa38ff1' )
SetUrl( 'ApiLink_void_nn__os__Mutex__unlock()_NN_NOEXCEPT', '../../../Api/HtmlNX/classnn_1_1os_1_1_mutex.html#a398a0109fc604211f06d48c2b4018812' )

NintendoSdkApiRefernce.linkRewrite();
</script>
<!--AddLink-->
</body>
</html>

<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<script type="text/javascript" src="../template/js/jquery/jquery.js"></script>
<script type="text/javascript" src="../template/js/common/manualLib.js"></script>
<script type="text/javascript" src="../tocData.js"></script>
<script type="text/javascript" src="../tocDataApi.js"></script>
<link rel="stylesheet" type="text/css" href="../template/css/template.css" />
<title>Query | NintendoSDK Documents</title>
</head>
<body data-reassemble="autoindex=no,forceNoLabel=yes">
<div id="autoindex_content">
<div class="body_content">
<noscript>
<div style="text-align: center;"><img src="../template/img/noscript.svg" /></div>
</noscript>
<div class="page_navigation_top">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
</table>
</div>
<div class="breadcrumb"></div>

<!-- Query -->
<div class="pagetitle" id="PageId_124009862">Query</div>
<div class="text_separate">
<h1 id="Anchor_124009862_h1_1">Query</h1>
<h2 id="Anchor_124009862_h2_1">Overview</h2>
<p>The query feature provides a way for the application to get specific information about the GPU.</p>
<p>Queries are made by setting query commands in the command buffer.<br />The query result is written asynchronously by the GPU, meaning that immediately after the function has been called the value is not valid. For this reason, when reading the query result with the CPU, you must synchronize the action through the <a href="../Pages/Page_83956110.html">Queue</a> or <a href="../Pages/Page_83955552.html">Fence</a> feature to ensure that the asynchronous writing has completed.</p>
<p>All queries that look at time stamps have a scope, and the information written to the query result is within that specified scope. Each scope is bounded by a beginning and an end. The beginnings and ends must appear as pairs.</p>
<p>The query result is written to a <code><a href="../Pages/Page_95690541.html">Buffer</a></code> object. The buffer that the query result is written to must be initialized with the information specified by <code><span class="ApiLink_void_nn__gfx__TSamplerInfo__SetGpuAccessFlags(int_value)_NN_NOEXCEPT">nn::gfx::GpuAccess_QueryBuffer</span> </code> in a flag set using <code><span class="ApiLink_nn__gfx__GpuAccess_QueryBuffer">nn::gfx::BufferInfo::SetGpuAccessFlags</span></code>.</p>
<p>The written query result differs in size, format, and location depending on the platform and which low-level graphics API is being used. A common utility has been prepared for reading the different results. For more information, see the separate sections for each query type.</p>
<h2 id="Anchor_124009862_h2_2">Pipeline Queries</h2>
<h3 id="Anchor_124009862_h3_1">Setting the Begin/End Commands</h3>
<p>Begin the query using <code><span class="ApiLink_void_nn__gfx__TCommandBuffer__BeginQuery(QueryTarget_target)_NN_NOEXCEPT">nn::gfx::CommandBuffer::BeginQuery</span></code>, and end the query using <code><span class="ApiLink_void_nn__gfx__TCommandBuffer__EndQuery(const_GpuAddress_&dstBufferAddress|_QueryTarget_target)_NN_NOEXCEPT">nn::gfx::CommandBuffer::EndQuery</span></code>. The query results for the specified <code><span class="ApiLink_nn__gfx__QueryTarget">nn::gfx::QueryTarget</span></code> within the scope defined by a beginning and end are written to the location specified by <code><span class="ApiLink_nn__gfx__GpuAddress">nn::gfx::GpuAddress</span></code>.</p>
<h3 id="Anchor_124009862_h3_2">Interpreting the Results</h3>
<p>The written query result can be interpreted as <code><span class="ApiLink_nn__gfx__TQueryBuffer">nn::gfx::QueryBuffer</span></code>. Note that this class is merely a utility that represents the layout of the written query results. It does not represent a low-level graphics API object. To get the result values, use <code><span class="ApiLink_int64_t_nn__gfx__TQueryBuffer__GetValue()_const_NN_NOEXCEPT">GetValue</span></code>.</p>
<h2 id="Anchor_124009862_h2_3">Time Stamp Queries</h2>
<p>Unlike other queries, time stamp queries do not have a scope.</p>
<h3 id="Anchor_124009862_h3_3">Setting Commands</h3>
<p>Use <code><span class="ApiLink_void_nn__gfx__TCommandBuffer__WriteTimestamp(const_GpuAddress_&dstBufferAddress)_NN_NOEXCEPT">nn::gfx::CommandBuffer::WriteTimestamp</span></code> to set a command for a time stamp query in the command buffer. When the GPU has finished processing all commands set in the command buffer before this query, the GPU time stamp for that moment is written to the location specified by <code><span class="ApiLink_nn__gfx__GpuAddress">nn::gfx::GpuAddress</span></code>.</p>
<h3 id="Anchor_124009862_h3_4">Interpreting the Results</h3>
<p>The written query result can be interpreted as <code><span class="ApiLink_nn__gfx__TTimestampBuffer">nn::gfx::TimestampBuffer</span></code>. Note that this class is merely a utility that represents the layout of the written query results. It does not represent a low-level graphics API object. To get the result values, use <code><span class="ApiLink_int64_t_nn__gfx__TTimestampBuffer__GetValue()_const_NN_NOEXCEPT">GetValue</span></code>.</p>
<h3 id="Anchor_124009862_h3_5">Converting to Time</h3>
<p>To get the difference between two time stamps as an amount of time, call <code><span class="ApiLink_nn__TimeSpan_nn__gfx__GetDuration(int64_t_startTimestampValue|_int64_t_endTimestampValue)_NN_NOEXCEPT">nn::gfx::GetDuration</span></code>. Set the smaller time stamp for the first parameter and the larger time stamp for the second parameter to get the time between them as a <code><span class="ApiLink_nn__TimeSpan">nn::TimeSpan</span></code>-type value.</p>
</div>
<div class="breadcrumb_bottom"></div>
<div class="page_navigation">
<table class="page_navi_root">
<tr>
<td class="page_navi_left"></td>
<td class="page_navi_right"></td>
</tr>
<tr><td colspan="2" class="page_navi_bottom"></td></tr>
</table>
</div>
<p>&nbsp;</p>
<hr />
<p>CONFIDENTIAL</p>
</div>
</div>
<!--AddLink-->
<script>
var NintendoSdkApiRefernce = {
    idMap: {},
    linkRewrite: function ()
    {
        var idMap = NintendoSdkApiRefernce.idMap;
        function rewrite(el)
        {
            var e = idMap[el.className];
            if (e === undefined)
            {
                return;
            }
            var html = '';
            html += '<a href=';
            html += e.url;
            html += ' target="_blank" rel="noopener noreferrer" >';
            html += el.innerHTML;
            html += '</a>';
            el.innerHTML = html;
        }
        var apiLinkElems = document.querySelectorAll('span[class*="ApiLink_"]');
        for (var i = 0, n = apiLinkElems.length; i< n; ++i) {
            rewrite(apiLinkElems[i]);
        }
    }
};
function SetUrl( id, url )
{
    NintendoSdkApiRefernce.idMap[id] = { url: url };
}
SetUrl( 'ApiLink_void_nn__gfx__TSamplerInfo__SetGpuAccessFlags(int_value)_NN_NOEXCEPT', '../../../Api/HtmlNX/classnn_1_1gfx_1_1_buffer_info.html#a8baa33ab5cf098fcec0e1609c6ecf0c7' )
SetUrl( 'ApiLink_nn__gfx__GpuAccess_QueryBuffer', '../../../Api/HtmlNX/namespacenn_1_1gfx.html#a24dbcd6d86531138895622b5a854e4f5a37837da53e8a54a085715aa973eb8475' )
SetUrl( 'ApiLink_void_nn__gfx__TCommandBuffer__BeginQuery(QueryTarget_target)_NN_NOEXCEPT', '../../../Api/HtmlNX/classnn_1_1gfx_1_1_t_command_buffer.html#a0381b042fcebe5e9c2b53d71f0d6c4e3' )
SetUrl( 'ApiLink_void_nn__gfx__TCommandBuffer__EndQuery(const_GpuAddress_&dstBufferAddress|_QueryTarget_target)_NN_NOEXCEPT', '../../../Api/HtmlNX/classnn_1_1gfx_1_1_t_command_buffer.html#a03300c989d50ccaf02a409cd7a3b0c96' )
SetUrl( 'ApiLink_nn__gfx__QueryTarget', '../../../Api/HtmlNX/namespacenn_1_1gfx.html#a48005f3f40b9a2a1048a070dfb310161' )
SetUrl( 'ApiLink_nn__gfx__GpuAddress', '../../../Api/HtmlNX/classnn_1_1gfx_1_1_gpu_address.html' )
SetUrl( 'ApiLink_nn__gfx__TQueryBuffer', '../../../Api/HtmlNX/classnn_1_1gfx_1_1_t_query_buffer.html' )
SetUrl( 'ApiLink_int64_t_nn__gfx__TQueryBuffer__GetValue()_const_NN_NOEXCEPT', '../../../Api/HtmlNX/classnn_1_1gfx_1_1_t_query_buffer.html#ac24cb3b1c8ffa4655f7f5ccdac5f98e9' )
SetUrl( 'ApiLink_void_nn__gfx__TCommandBuffer__WriteTimestamp(const_GpuAddress_&dstBufferAddress)_NN_NOEXCEPT', '../../../Api/HtmlNX/classnn_1_1gfx_1_1_t_command_buffer.html#a844da8f21965e819a3fbdfd6bdc0b438' )
SetUrl( 'ApiLink_nn__gfx__TTimestampBuffer', '../../../Api/HtmlNX/classnn_1_1gfx_1_1_t_timestamp_buffer.html' )
SetUrl( 'ApiLink_int64_t_nn__gfx__TTimestampBuffer__GetValue()_const_NN_NOEXCEPT', '../../../Api/HtmlNX/classnn_1_1gfx_1_1_t_timestamp_buffer.html#a831902d449c7307bc464303c68bec608' )
SetUrl( 'ApiLink_nn__TimeSpan_nn__gfx__GetDuration(int64_t_startTimestampValue|_int64_t_endTimestampValue)_NN_NOEXCEPT', '../../../Api/HtmlNX/namespacenn_1_1gfx.html#a7aaf329dc4ff0c6784ba34d156292983' )
SetUrl( 'ApiLink_nn__TimeSpan', '../../../Api/HtmlNX/classnn_1_1_time_span.html' )

NintendoSdkApiRefernce.linkRewrite();
</script>
<!--AddLink-->
</body>
</html>
